var PE=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var LD=PE((PD,Ew)=>{function UE(r,t){for(var e=0;e<t.length;e++){const n=t[e];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in r)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(r,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function e(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=e(a);fetch(a.href,i)}})();var Vf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zE(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var j0={exports:{}},$l={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r2;function HE(){if(r2)return $l;r2=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,a,i){var c=null;if(i!==void 0&&(c=""+i),a.key!==void 0&&(c=""+a.key),"key"in a){i={};for(var f in a)f!=="key"&&(i[f]=a[f])}else i=a;return a=i.ref,{$$typeof:r,type:n,key:c,ref:a!==void 0?a:null,props:i}}return $l.Fragment=t,$l.jsx=e,$l.jsxs=e,$l}var a2;function VE(){return a2||(a2=1,j0.exports=HE()),j0.exports}var Fn=VE(),X0={exports:{}},wt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i2;function WE(){if(i2)return wt;i2=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),c=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),w=Symbol.iterator;function C(Y){return Y===null||typeof Y!="object"?null:(Y=w&&Y[w]||Y["@@iterator"],typeof Y=="function"?Y:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,N={};function D(Y,fe,Ae){this.props=Y,this.context=fe,this.refs=N,this.updater=Ae||S}D.prototype.isReactComponent={},D.prototype.setState=function(Y,fe){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,fe,"setState")},D.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function M(){}M.prototype=D.prototype;function B(Y,fe,Ae){this.props=Y,this.context=fe,this.refs=N,this.updater=Ae||S}var k=B.prototype=new M;k.constructor=B,R(k,D.prototype),k.isPureReactComponent=!0;var L=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},W=Object.prototype.hasOwnProperty;function G(Y,fe,Ae,Te,Le,Ve){return Ae=Ve.ref,{$$typeof:r,type:Y,key:fe,ref:Ae!==void 0?Ae:null,props:Ve}}function q(Y,fe){return G(Y.type,fe,void 0,void 0,void 0,Y.props)}function H(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===r}function Z(Y){var fe={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(Ae){return fe[Ae]})}var ie=/\/+/g;function ee(Y,fe){return typeof Y=="object"&&Y!==null&&Y.key!=null?Z(""+Y.key):fe.toString(36)}function me(){}function xe(Y){switch(Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason;default:switch(typeof Y.status=="string"?Y.then(me,me):(Y.status="pending",Y.then(function(fe){Y.status==="pending"&&(Y.status="fulfilled",Y.value=fe)},function(fe){Y.status==="pending"&&(Y.status="rejected",Y.reason=fe)})),Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason}}throw Y}function $(Y,fe,Ae,Te,Le){var Ve=typeof Y;(Ve==="undefined"||Ve==="boolean")&&(Y=null);var Ie=!1;if(Y===null)Ie=!0;else switch(Ve){case"bigint":case"string":case"number":Ie=!0;break;case"object":switch(Y.$$typeof){case r:case t:Ie=!0;break;case x:return Ie=Y._init,$(Ie(Y._payload),fe,Ae,Te,Le)}}if(Ie)return Le=Le(Y),Ie=Te===""?"."+ee(Y,0):Te,L(Le)?(Ae="",Ie!=null&&(Ae=Ie.replace(ie,"$&/")+"/"),$(Le,fe,Ae,"",function(ht){return ht})):Le!=null&&(H(Le)&&(Le=q(Le,Ae+(Le.key==null||Y&&Y.key===Le.key?"":(""+Le.key).replace(ie,"$&/")+"/")+Ie)),fe.push(Le)),1;Ie=0;var ut=Te===""?".":Te+":";if(L(Y))for(var He=0;He<Y.length;He++)Te=Y[He],Ve=ut+ee(Te,He),Ie+=$(Te,fe,Ae,Ve,Le);else if(He=C(Y),typeof He=="function")for(Y=He.call(Y),He=0;!(Te=Y.next()).done;)Te=Te.value,Ve=ut+ee(Te,He++),Ie+=$(Te,fe,Ae,Ve,Le);else if(Ve==="object"){if(typeof Y.then=="function")return $(xe(Y),fe,Ae,Te,Le);throw fe=String(Y),Error("Objects are not valid as a React child (found: "+(fe==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":fe)+"). If you meant to render a collection of children, use an array instead.")}return Ie}function te(Y,fe,Ae){if(Y==null)return Y;var Te=[],Le=0;return $(Y,Te,"","",function(Ve){return fe.call(Ae,Ve,Le++)}),Te}function re(Y){if(Y._status===-1){var fe=Y._result;fe=fe(),fe.then(function(Ae){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=Ae)},function(Ae){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=Ae)}),Y._status===-1&&(Y._status=0,Y._result=fe)}if(Y._status===1)return Y._result.default;throw Y._result}var he=typeof reportError=="function"?reportError:function(Y){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var fe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Y=="object"&&Y!==null&&typeof Y.message=="string"?String(Y.message):String(Y),error:Y});if(!window.dispatchEvent(fe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Y);return}console.error(Y)};function Se(){}return wt.Children={map:te,forEach:function(Y,fe,Ae){te(Y,function(){fe.apply(this,arguments)},Ae)},count:function(Y){var fe=0;return te(Y,function(){fe++}),fe},toArray:function(Y){return te(Y,function(fe){return fe})||[]},only:function(Y){if(!H(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}},wt.Component=D,wt.Fragment=e,wt.Profiler=a,wt.PureComponent=B,wt.StrictMode=n,wt.Suspense=p,wt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,wt.__COMPILER_RUNTIME={__proto__:null,c:function(Y){return F.H.useMemoCache(Y)}},wt.cache=function(Y){return function(){return Y.apply(null,arguments)}},wt.cloneElement=function(Y,fe,Ae){if(Y==null)throw Error("The argument must be a React element, but you passed "+Y+".");var Te=R({},Y.props),Le=Y.key,Ve=void 0;if(fe!=null)for(Ie in fe.ref!==void 0&&(Ve=void 0),fe.key!==void 0&&(Le=""+fe.key),fe)!W.call(fe,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&fe.ref===void 0||(Te[Ie]=fe[Ie]);var Ie=arguments.length-2;if(Ie===1)Te.children=Ae;else if(1<Ie){for(var ut=Array(Ie),He=0;He<Ie;He++)ut[He]=arguments[He+2];Te.children=ut}return G(Y.type,Le,void 0,void 0,Ve,Te)},wt.createContext=function(Y){return Y={$$typeof:c,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null},Y.Provider=Y,Y.Consumer={$$typeof:i,_context:Y},Y},wt.createElement=function(Y,fe,Ae){var Te,Le={},Ve=null;if(fe!=null)for(Te in fe.key!==void 0&&(Ve=""+fe.key),fe)W.call(fe,Te)&&Te!=="key"&&Te!=="__self"&&Te!=="__source"&&(Le[Te]=fe[Te]);var Ie=arguments.length-2;if(Ie===1)Le.children=Ae;else if(1<Ie){for(var ut=Array(Ie),He=0;He<Ie;He++)ut[He]=arguments[He+2];Le.children=ut}if(Y&&Y.defaultProps)for(Te in Ie=Y.defaultProps,Ie)Le[Te]===void 0&&(Le[Te]=Ie[Te]);return G(Y,Ve,void 0,void 0,null,Le)},wt.createRef=function(){return{current:null}},wt.forwardRef=function(Y){return{$$typeof:f,render:Y}},wt.isValidElement=H,wt.lazy=function(Y){return{$$typeof:x,_payload:{_status:-1,_result:Y},_init:re}},wt.memo=function(Y,fe){return{$$typeof:d,type:Y,compare:fe===void 0?null:fe}},wt.startTransition=function(Y){var fe=F.T,Ae={};F.T=Ae;try{var Te=Y(),Le=F.S;Le!==null&&Le(Ae,Te),typeof Te=="object"&&Te!==null&&typeof Te.then=="function"&&Te.then(Se,he)}catch(Ve){he(Ve)}finally{F.T=fe}},wt.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},wt.use=function(Y){return F.H.use(Y)},wt.useActionState=function(Y,fe,Ae){return F.H.useActionState(Y,fe,Ae)},wt.useCallback=function(Y,fe){return F.H.useCallback(Y,fe)},wt.useContext=function(Y){return F.H.useContext(Y)},wt.useDebugValue=function(){},wt.useDeferredValue=function(Y,fe){return F.H.useDeferredValue(Y,fe)},wt.useEffect=function(Y,fe,Ae){var Te=F.H;if(typeof Ae=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Te.useEffect(Y,fe)},wt.useId=function(){return F.H.useId()},wt.useImperativeHandle=function(Y,fe,Ae){return F.H.useImperativeHandle(Y,fe,Ae)},wt.useInsertionEffect=function(Y,fe){return F.H.useInsertionEffect(Y,fe)},wt.useLayoutEffect=function(Y,fe){return F.H.useLayoutEffect(Y,fe)},wt.useMemo=function(Y,fe){return F.H.useMemo(Y,fe)},wt.useOptimistic=function(Y,fe){return F.H.useOptimistic(Y,fe)},wt.useReducer=function(Y,fe,Ae){return F.H.useReducer(Y,fe,Ae)},wt.useRef=function(Y){return F.H.useRef(Y)},wt.useState=function(Y){return F.H.useState(Y)},wt.useSyncExternalStore=function(Y,fe,Ae){return F.H.useSyncExternalStore(Y,fe,Ae)},wt.useTransition=function(){return F.H.useTransition()},wt.version="19.1.1",wt}var o2;function $p(){return o2||(o2=1,X0.exports=WE()),X0.exports}var De=$p(),Y0={exports:{}},ec={},q0={exports:{}},K0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s2;function GE(){return s2||(s2=1,(function(r){function t(te,re){var he=te.length;te.push(re);e:for(;0<he;){var Se=he-1>>>1,Y=te[Se];if(0<a(Y,re))te[Se]=re,te[he]=Y,he=Se;else break e}}function e(te){return te.length===0?null:te[0]}function n(te){if(te.length===0)return null;var re=te[0],he=te.pop();if(he!==re){te[0]=he;e:for(var Se=0,Y=te.length,fe=Y>>>1;Se<fe;){var Ae=2*(Se+1)-1,Te=te[Ae],Le=Ae+1,Ve=te[Le];if(0>a(Te,he))Le<Y&&0>a(Ve,Te)?(te[Se]=Ve,te[Le]=he,Se=Le):(te[Se]=Te,te[Ae]=he,Se=Ae);else if(Le<Y&&0>a(Ve,he))te[Se]=Ve,te[Le]=he,Se=Le;else break e}}return re}function a(te,re){var he=te.sortIndex-re.sortIndex;return he!==0?he:te.id-re.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var c=Date,f=c.now();r.unstable_now=function(){return c.now()-f}}var p=[],d=[],x=1,w=null,C=3,S=!1,R=!1,N=!1,D=!1,M=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function L(te){for(var re=e(d);re!==null;){if(re.callback===null)n(d);else if(re.startTime<=te)n(d),re.sortIndex=re.expirationTime,t(p,re);else break;re=e(d)}}function F(te){if(N=!1,L(te),!R)if(e(p)!==null)R=!0,W||(W=!0,ee());else{var re=e(d);re!==null&&$(F,re.startTime-te)}}var W=!1,G=-1,q=5,H=-1;function Z(){return D?!0:!(r.unstable_now()-H<q)}function ie(){if(D=!1,W){var te=r.unstable_now();H=te;var re=!0;try{e:{R=!1,N&&(N=!1,B(G),G=-1),S=!0;var he=C;try{t:{for(L(te),w=e(p);w!==null&&!(w.expirationTime>te&&Z());){var Se=w.callback;if(typeof Se=="function"){w.callback=null,C=w.priorityLevel;var Y=Se(w.expirationTime<=te);if(te=r.unstable_now(),typeof Y=="function"){w.callback=Y,L(te),re=!0;break t}w===e(p)&&n(p),L(te)}else n(p);w=e(p)}if(w!==null)re=!0;else{var fe=e(d);fe!==null&&$(F,fe.startTime-te),re=!1}}break e}finally{w=null,C=he,S=!1}re=void 0}}finally{re?ee():W=!1}}}var ee;if(typeof k=="function")ee=function(){k(ie)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,xe=me.port2;me.port1.onmessage=ie,ee=function(){xe.postMessage(null)}}else ee=function(){M(ie,0)};function $(te,re){G=M(function(){te(r.unstable_now())},re)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(te){te.callback=null},r.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<te?Math.floor(1e3/te):5},r.unstable_getCurrentPriorityLevel=function(){return C},r.unstable_next=function(te){switch(C){case 1:case 2:case 3:var re=3;break;default:re=C}var he=C;C=re;try{return te()}finally{C=he}},r.unstable_requestPaint=function(){D=!0},r.unstable_runWithPriority=function(te,re){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var he=C;C=te;try{return re()}finally{C=he}},r.unstable_scheduleCallback=function(te,re,he){var Se=r.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?Se+he:Se):he=Se,te){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=he+Y,te={id:x++,callback:re,priorityLevel:te,startTime:he,expirationTime:Y,sortIndex:-1},he>Se?(te.sortIndex=he,t(d,te),e(p)===null&&te===e(d)&&(N?(B(G),G=-1):N=!0,$(F,he-Se))):(te.sortIndex=Y,t(p,te),R||S||(R=!0,W||(W=!0,ee()))),te},r.unstable_shouldYield=Z,r.unstable_wrapCallback=function(te){var re=C;return function(){var he=C;C=re;try{return te.apply(this,arguments)}finally{C=he}}}})(K0)),K0}var u2;function jE(){return u2||(u2=1,q0.exports=GE()),q0.exports}var Z0={exports:{}},Br={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l2;function XE(){if(l2)return Br;l2=1;var r=$p();function t(p){var d="https://react.dev/errors/"+p;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)d+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+p+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(p,d,x){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:w==null?null:""+w,children:p,containerInfo:d,implementation:x}}var c=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,d){if(p==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Br.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Br.createPortal=function(p,d){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return i(p,d,null,x)},Br.flushSync=function(p){var d=c.T,x=n.p;try{if(c.T=null,n.p=2,p)return p()}finally{c.T=d,n.p=x,n.d.f()}},Br.preconnect=function(p,d){typeof p=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(p,d))},Br.prefetchDNS=function(p){typeof p=="string"&&n.d.D(p)},Br.preinit=function(p,d){if(typeof p=="string"&&d&&typeof d.as=="string"){var x=d.as,w=f(x,d.crossOrigin),C=typeof d.integrity=="string"?d.integrity:void 0,S=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;x==="style"?n.d.S(p,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:w,integrity:C,fetchPriority:S}):x==="script"&&n.d.X(p,{crossOrigin:w,integrity:C,fetchPriority:S,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Br.preinitModule=function(p,d){if(typeof p=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var x=f(d.as,d.crossOrigin);n.d.M(p,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(p)},Br.preload=function(p,d){if(typeof p=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var x=d.as,w=f(x,d.crossOrigin);n.d.L(p,x,{crossOrigin:w,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Br.preloadModule=function(p,d){if(typeof p=="string")if(d){var x=f(d.as,d.crossOrigin);n.d.m(p,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(p)},Br.requestFormReset=function(p){n.d.r(p)},Br.unstable_batchedUpdates=function(p,d){return p(d)},Br.useFormState=function(p,d,x){return c.H.useFormState(p,d,x)},Br.useFormStatus=function(){return c.H.useHostTransitionStatus()},Br.version="19.1.1",Br}var c2;function YE(){if(c2)return Z0.exports;c2=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Z0.exports=XE(),Z0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f2;function qE(){if(f2)return ec;f2=1;var r=jE(),t=$p(),e=YE();function n(o){var u="https://react.dev/errors/"+o;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)u+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+o+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function i(o){var u=o,g=o;if(o.alternate)for(;u.return;)u=u.return;else{o=u;do u=o,(u.flags&4098)!==0&&(g=u.return),o=u.return;while(o)}return u.tag===3?g:null}function c(o){if(o.tag===13){var u=o.memoizedState;if(u===null&&(o=o.alternate,o!==null&&(u=o.memoizedState)),u!==null)return u.dehydrated}return null}function f(o){if(i(o)!==o)throw Error(n(188))}function p(o){var u=o.alternate;if(!u){if(u=i(o),u===null)throw Error(n(188));return u!==o?null:o}for(var g=o,y=u;;){var A=g.return;if(A===null)break;var T=A.alternate;if(T===null){if(y=A.return,y!==null){g=y;continue}break}if(A.child===T.child){for(T=A.child;T;){if(T===g)return f(A),o;if(T===y)return f(A),u;T=T.sibling}throw Error(n(188))}if(g.return!==y.return)g=A,y=T;else{for(var P=!1,j=A.child;j;){if(j===g){P=!0,g=A,y=T;break}if(j===y){P=!0,y=A,g=T;break}j=j.sibling}if(!P){for(j=T.child;j;){if(j===g){P=!0,g=T,y=A;break}if(j===y){P=!0,y=T,g=A;break}j=j.sibling}if(!P)throw Error(n(189))}}if(g.alternate!==y)throw Error(n(190))}if(g.tag!==3)throw Error(n(188));return g.stateNode.current===g?o:u}function d(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o;for(o=o.child;o!==null;){if(u=d(o),u!==null)return u;o=o.sibling}return null}var x=Object.assign,w=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),B=Symbol.for("react.consumer"),k=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),H=Symbol.for("react.activity"),Z=Symbol.for("react.memo_cache_sentinel"),ie=Symbol.iterator;function ee(o){return o===null||typeof o!="object"?null:(o=ie&&o[ie]||o["@@iterator"],typeof o=="function"?o:null)}var me=Symbol.for("react.client.reference");function xe(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===me?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case R:return"Fragment";case D:return"Profiler";case N:return"StrictMode";case F:return"Suspense";case W:return"SuspenseList";case H:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case S:return"Portal";case k:return(o.displayName||"Context")+".Provider";case B:return(o._context.displayName||"Context")+".Consumer";case L:var u=o.render;return o=o.displayName,o||(o=u.displayName||u.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case G:return u=o.displayName||null,u!==null?u:xe(o.type)||"Memo";case q:u=o._payload,o=o._init;try{return xe(o(u))}catch{}}return null}var $=Array.isArray,te=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he={pending:!1,data:null,method:null,action:null},Se=[],Y=-1;function fe(o){return{current:o}}function Ae(o){0>Y||(o.current=Se[Y],Se[Y]=null,Y--)}function Te(o,u){Y++,Se[Y]=o.current,o.current=u}var Le=fe(null),Ve=fe(null),Ie=fe(null),ut=fe(null);function He(o,u){switch(Te(Ie,u),Te(Ve,o),Te(Le,null),u.nodeType){case 9:case 11:o=(o=u.documentElement)&&(o=o.namespaceURI)?Dm(o):0;break;default:if(o=u.tagName,u=u.namespaceURI)u=Dm(u),o=Mm(u,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}Ae(Le),Te(Le,o)}function ht(){Ae(Le),Ae(Ve),Ae(Ie)}function jt(o){o.memoizedState!==null&&Te(ut,o);var u=Le.current,g=Mm(u,o.type);u!==g&&(Te(Ve,o),Te(Le,g))}function it(o){Ve.current===o&&(Ae(Le),Ae(Ve)),ut.current===o&&(Ae(ut),ql._currentValue=he)}var Rt=Object.prototype.hasOwnProperty,Ye=r.unstable_scheduleCallback,zt=r.unstable_cancelCallback,Bt=r.unstable_shouldYield,Xt=r.unstable_requestPaint,Ct=r.unstable_now,At=r.unstable_getCurrentPriorityLevel,ct=r.unstable_ImmediatePriority,Yr=r.unstable_UserBlockingPriority,We=r.unstable_NormalPriority,Hr=r.unstable_LowPriority,Vr=r.unstable_IdlePriority,fr=r.log,Wr=r.unstable_setDisableYieldValue,Pn=null,Cn=null;function sn(o){if(typeof fr=="function"&&Wr(o),Cn&&typeof Cn.setStrictMode=="function")try{Cn.setStrictMode(Pn,o)}catch{}}var Ht=Math.clz32?Math.clz32:al,Xs=Math.log,ho=Math.LN2;function al(o){return o>>>=0,o===0?32:31-(Xs(o)/ho|0)|0}var $t=256,ze=4194304;function Yt(o){var u=o&42;if(u!==0)return u;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function Vt(o,u,g){var y=o.pendingLanes;if(y===0)return 0;var A=0,T=o.suspendedLanes,P=o.pingedLanes;o=o.warmLanes;var j=y&134217727;return j!==0?(y=j&~T,y!==0?A=Yt(y):(P&=j,P!==0?A=Yt(P):g||(g=j&~o,g!==0&&(A=Yt(g))))):(j=y&~T,j!==0?A=Yt(j):P!==0?A=Yt(P):g||(g=y&~o,g!==0&&(A=Yt(g)))),A===0?0:u!==0&&u!==A&&(u&T)===0&&(T=A&-A,g=u&-u,T>=g||T===32&&(g&4194048)!==0)?u:A}function un(o,u){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&u)===0}function os(o,u){switch(o){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ys(){var o=$t;return $t<<=1,($t&4194048)===0&&($t=256),o}function il(){var o=ze;return ze<<=1,(ze&62914560)===0&&(ze=4194304),o}function Lt(o){for(var u=[],g=0;31>g;g++)u.push(o);return u}function oa(o,u){o.pendingLanes|=u,u!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function Dc(o,u,g,y,A,T){var P=o.pendingLanes;o.pendingLanes=g,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=g,o.entangledLanes&=g,o.errorRecoveryDisabledLanes&=g,o.shellSuspendCounter=0;var j=o.entanglements,ne=o.expirationTimes,ve=o.hiddenUpdates;for(g=P&~g;0<g;){var Ne=31-Ht(g),Oe=1<<Ne;j[Ne]=0,ne[Ne]=-1;var ye=ve[Ne];if(ye!==null)for(ve[Ne]=null,Ne=0;Ne<ye.length;Ne++){var we=ye[Ne];we!==null&&(we.lane&=-536870913)}g&=~Oe}y!==0&&ol(o,y,0),T!==0&&A===0&&o.tag!==0&&(o.suspendedLanes|=T&~(P&~u))}function ol(o,u,g){o.pendingLanes|=u,o.suspendedLanes&=~u;var y=31-Ht(u);o.entangledLanes|=u,o.entanglements[y]=o.entanglements[y]|1073741824|g&4194090}function qr(o,u){var g=o.entangledLanes|=u;for(o=o.entanglements;g;){var y=31-Ht(g),A=1<<y;A&u|o[y]&u&&(o[y]|=u),g&=~A}}function ss(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Xn(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function Oi(){var o=re.p;return o!==0?o:(o=window.event,o===void 0?32:Qm(o.type))}function qs(o,u){var g=re.p;try{return re.p=o,u()}finally{re.p=g}}var Qn=Math.random().toString(36).slice(2),hr="__reactFiber$"+Qn,Nn="__reactProps$"+Qn,Ja="__reactContainer$"+Qn,dr="__reactEvents$"+Qn,Bi="__reactListeners$"+Qn,Kr="__reactHandles$"+Qn,je="__reactResources$"+Qn,_a="__reactMarker$"+Qn;function us(o){delete o[hr],delete o[Nn],delete o[dr],delete o[Bi],delete o[Kr]}function Un(o){var u=o[hr];if(u)return u;for(var g=o.parentNode;g;){if(u=g[Ja]||g[hr]){if(g=u.alternate,u.child!==null||g!==null&&g.child!==null)for(o=Lm(o);o!==null;){if(g=o[hr])return g;o=Lm(o)}return u}o=g,g=o.parentNode}return null}function sa(o){if(o=o[hr]||o[Ja]){var u=o.tag;if(u===5||u===6||u===13||u===26||u===27||u===3)return o}return null}function $a(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o.stateNode;throw Error(n(33))}function Ua(o){var u=o[je];return u||(u=o[je]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function en(o){o[_a]=!0}var Mc=new Set,Oc={};function pr(o,u){Dn(o,u),Dn(o+"Capture",u)}function Dn(o,u){for(Oc[o]=u,o=0;o<u.length;o++)Mc.add(u[o])}var pn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),sl={},za={};function ul(o){return Rt.call(za,o)?!0:Rt.call(sl,o)?!1:pn.test(o)?za[o]=!0:(sl[o]=!0,!1)}function Be(o,u,g){if(ul(u))if(g===null)o.removeAttribute(u);else{switch(typeof g){case"undefined":case"function":case"symbol":o.removeAttribute(u);return;case"boolean":var y=u.toLowerCase().slice(0,5);if(y!=="data-"&&y!=="aria-"){o.removeAttribute(u);return}}o.setAttribute(u,""+g)}}function Ks(o,u,g){if(g===null)o.removeAttribute(u);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(u);return}o.setAttribute(u,""+g)}}function Wt(o,u,g,y){if(y===null)o.removeAttribute(g);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(g);return}o.setAttributeNS(u,g,""+y)}}var ei,Bc;function Nt(o){if(ei===void 0)try{throw Error()}catch(g){var u=g.stack.trim().match(/\n( *(at )?)/);ei=u&&u[1]||"",Bc=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ei+o+Bc}var Ft=!1;function St(o,u){if(!o||Ft)return"";Ft=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var y={DetermineComponentFrameRoot:function(){try{if(u){var Oe=function(){throw Error()};if(Object.defineProperty(Oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Oe,[])}catch(we){var ye=we}Reflect.construct(o,[],Oe)}else{try{Oe.call()}catch(we){ye=we}o.call(Oe.prototype)}}else{try{throw Error()}catch(we){ye=we}(Oe=o())&&typeof Oe.catch=="function"&&Oe.catch(function(){})}}catch(we){if(we&&ye&&typeof we.stack=="string")return[we.stack,ye.stack]}return[null,null]}};y.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(y.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(y.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=y.DetermineComponentFrameRoot(),P=T[0],j=T[1];if(P&&j){var ne=P.split(`
`),ve=j.split(`
`);for(A=y=0;y<ne.length&&!ne[y].includes("DetermineComponentFrameRoot");)y++;for(;A<ve.length&&!ve[A].includes("DetermineComponentFrameRoot");)A++;if(y===ne.length||A===ve.length)for(y=ne.length-1,A=ve.length-1;1<=y&&0<=A&&ne[y]!==ve[A];)A--;for(;1<=y&&0<=A;y--,A--)if(ne[y]!==ve[A]){if(y!==1||A!==1)do if(y--,A--,0>A||ne[y]!==ve[A]){var Ne=`
`+ne[y].replace(" at new "," at ");return o.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",o.displayName)),Ne}while(1<=y&&0<=A);break}}}finally{Ft=!1,Error.prepareStackTrace=g}return(g=o?o.displayName||o.name:"")?Nt(g):""}function ll(o){switch(o.tag){case 26:case 27:case 5:return Nt(o.type);case 16:return Nt("Lazy");case 13:return Nt("Suspense");case 19:return Nt("SuspenseList");case 0:case 15:return St(o.type,!1);case 11:return St(o.type.render,!1);case 1:return St(o.type,!0);case 31:return Nt("Activity");default:return""}}function Zs(o){try{var u="";do u+=ll(o),o=o.return;while(o);return u}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}function Ir(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Mn(o){var u=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function ti(o){var u=Mn(o)?"checked":"value",g=Object.getOwnPropertyDescriptor(o.constructor.prototype,u),y=""+o[u];if(!o.hasOwnProperty(u)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var A=g.get,T=g.set;return Object.defineProperty(o,u,{configurable:!0,get:function(){return A.call(this)},set:function(P){y=""+P,T.call(this,P)}}),Object.defineProperty(o,u,{enumerable:g.enumerable}),{getValue:function(){return y},setValue:function(P){y=""+P},stopTracking:function(){o._valueTracker=null,delete o[u]}}}}function Qs(o){o._valueTracker||(o._valueTracker=ti(o))}function bn(o){if(!o)return!1;var u=o._valueTracker;if(!u)return!0;var g=u.getValue(),y="";return o&&(y=Mn(o)?o.checked?"true":"false":o.value),o=y,o!==g?(u.setValue(o),!0):!1}function ua(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var Qh=/[\n"\\]/g;function Jn(o){return o.replace(Qh,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function Zt(o,u,g,y,A,T,P,j){o.name="",P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?o.type=P:o.removeAttribute("type"),u!=null?P==="number"?(u===0&&o.value===""||o.value!=u)&&(o.value=""+Ir(u)):o.value!==""+Ir(u)&&(o.value=""+Ir(u)):P!=="submit"&&P!=="reset"||o.removeAttribute("value"),u!=null?pe(o,P,Ir(u)):g!=null?pe(o,P,Ir(g)):y!=null&&o.removeAttribute("value"),A==null&&T!=null&&(o.defaultChecked=!!T),A!=null&&(o.checked=A&&typeof A!="function"&&typeof A!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?o.name=""+Ir(j):o.removeAttribute("name")}function $n(o,u,g,y,A,T,P,j){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(o.type=T),u!=null||g!=null){if(!(T!=="submit"&&T!=="reset"||u!=null))return;g=g!=null?""+Ir(g):"",u=u!=null?""+Ir(u):g,j||u===o.value||(o.value=u),o.defaultValue=u}y=y??A,y=typeof y!="function"&&typeof y!="symbol"&&!!y,o.checked=j?o.checked:!!y,o.defaultChecked=!!y,P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(o.name=P)}function pe(o,u,g){u==="number"&&ua(o.ownerDocument)===o||o.defaultValue===""+g||(o.defaultValue=""+g)}function K(o,u,g,y){if(o=o.options,u){u={};for(var A=0;A<g.length;A++)u["$"+g[A]]=!0;for(g=0;g<o.length;g++)A=u.hasOwnProperty("$"+o[g].value),o[g].selected!==A&&(o[g].selected=A),A&&y&&(o[g].defaultSelected=!0)}else{for(g=""+Ir(g),u=null,A=0;A<o.length;A++){if(o[A].value===g){o[A].selected=!0,y&&(o[A].defaultSelected=!0);return}u!==null||o[A].disabled||(u=o[A])}u!==null&&(u.selected=!0)}}function nt(o,u,g){if(u!=null&&(u=""+Ir(u),u!==o.value&&(o.value=u),g==null)){o.defaultValue!==u&&(o.defaultValue=u);return}o.defaultValue=g!=null?""+Ir(g):""}function zn(o,u,g,y){if(u==null){if(y!=null){if(g!=null)throw Error(n(92));if($(y)){if(1<y.length)throw Error(n(93));y=y[0]}g=y}g==null&&(g=""),u=g}g=Ir(u),o.defaultValue=g,y=o.textContent,y===g&&y!==""&&y!==null&&(o.value=y)}function er(o,u){if(u){var g=o.firstChild;if(g&&g===o.lastChild&&g.nodeType===3){g.nodeValue=u;return}}o.textContent=u}var Jh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Js(o,u,g){var y=u.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?y?o.setProperty(u,""):u==="float"?o.cssFloat="":o[u]="":y?o.setProperty(u,g):typeof g!="number"||g===0||Jh.has(u)?u==="float"?o.cssFloat=g:o[u]=(""+g).trim():o[u]=g+"px"}function Gr(o,u,g){if(u!=null&&typeof u!="object")throw Error(n(62));if(o=o.style,g!=null){for(var y in g)!g.hasOwnProperty(y)||u!=null&&u.hasOwnProperty(y)||(y.indexOf("--")===0?o.setProperty(y,""):y==="float"?o.cssFloat="":o[y]="");for(var A in u)y=u[A],u.hasOwnProperty(A)&&g[A]!==y&&Js(o,A,y)}else for(var T in u)u.hasOwnProperty(T)&&Js(o,T,u[T])}function rt(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mn=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),kc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $s(o){return kc.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var ls=null;function po(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var ni=null,go=null;function Hn(o){var u=sa(o);if(u&&(o=u.stateNode)){var g=o[Nn]||null;e:switch(o=u.stateNode,u.type){case"input":if(Zt(o,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),u=g.name,g.type==="radio"&&u!=null){for(g=o;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+Jn(""+u)+'"][type="radio"]'),u=0;u<g.length;u++){var y=g[u];if(y!==o&&y.form===o.form){var A=y[Nn]||null;if(!A)throw Error(n(90));Zt(y,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name)}}for(u=0;u<g.length;u++)y=g[u],y.form===o.form&&bn(y)}break e;case"textarea":nt(o,g.value,g.defaultValue);break e;case"select":u=g.value,u!=null&&K(o,!!g.multiple,u,!1)}}}var ki=!1;function Ha(o,u,g){if(ki)return o(u,g);ki=!0;try{var y=o(u);return y}finally{if(ki=!1,(ni!==null||go!==null)&&(wf(),ni&&(u=ni,o=go,go=ni=null,Hn(u),o)))for(u=0;u<o.length;u++)Hn(o[u])}}function ot(o,u){var g=o.stateNode;if(g===null)return null;var y=g[Nn]||null;if(y===null)return null;g=y[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(o=o.type,y=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!y;break e;default:o=!1}if(o)return null;if(g&&typeof g!="function")throw Error(n(231,u,typeof g));return g}var Va=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mt=!1;if(Va)try{var An={};Object.defineProperty(An,"passive",{get:function(){mt=!0}}),window.addEventListener("test",An,An),window.removeEventListener("test",An,An)}catch{mt=!1}var ri=null,cs=null,fs=null;function ai(){if(fs)return fs;var o,u=cs,g=u.length,y,A="value"in ri?ri.value:ri.textContent,T=A.length;for(o=0;o<g&&u[o]===A[o];o++);var P=g-o;for(y=1;y<=P&&u[g-y]===A[T-y];y++);return fs=A.slice(o,1<y?1-y:void 0)}function eu(o){var u=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&u===13&&(o=13)):o=u,o===10&&(o=13),32<=o||o===13?o:0}function ii(){return!0}function vo(){return!1}function Yn(o){function u(g,y,A,T,P){this._reactName=g,this._targetInst=A,this.type=y,this.nativeEvent=T,this.target=P,this.currentTarget=null;for(var j in o)o.hasOwnProperty(j)&&(g=o[j],this[j]=g?g(T):T[j]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?ii:vo,this.isPropagationStopped=vo,this}return x(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=ii)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=ii)},persist:function(){},isPersistent:ii}),u}var oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},si=Yn(oi),Wa=x({},oi,{view:0,detail:0}),Rr=Yn(Wa),tu,nu,mo,ru=x({},Wa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ds,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==mo&&(mo&&o.type==="mousemove"?(tu=o.screenX-mo.screenX,nu=o.screenY-mo.screenY):nu=tu=0,mo=o),tu)},movementY:function(o){return"movementY"in o?o.movementY:nu}}),Lc=Yn(ru),$h=x({},ru,{dataTransfer:0}),Qt=Yn($h),Fc=x({},Wa,{relatedTarget:0}),xo=Yn(Fc),ui=x({},oi,{animationName:0,elapsedTime:0,pseudoElement:0}),ed=Yn(ui),Ce=x({},oi,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),bt=Yn(Ce),tr=x({},oi,{data:0}),hs=Yn(tr),Pc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},td={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rd(o){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(o):(o=nd[o])?!!u[o]:!1}function ds(){return rd}var Vn=x({},Wa,{key:function(o){if(o.key){var u=Pc[o.key]||o.key;if(u!=="Unidentified")return u}return o.type==="keypress"?(o=eu(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?td[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ds,charCode:function(o){return o.type==="keypress"?eu(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?eu(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),cl=Yn(Vn),wn=x({},ru,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ps=Yn(wn),Li=x({},Wa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ds}),tn=Yn(Li),st=x({},oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),ad=Yn(st),hn=x({},ru,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Fi=Yn(hn),yo=x({},oi,{newState:0,oldState:0}),id=Yn(yo),Ta=[9,13,27,32],gs=Va&&"CompositionEvent"in window,bo=null;Va&&"documentMode"in document&&(bo=document.documentMode);var fl=Va&&"TextEvent"in window&&!bo,hl=Va&&(!gs||bo&&8<bo&&11>=bo),dl=" ",Uc=!1;function Pi(o,u){switch(o){case"keyup":return Ta.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function au(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var wo=!1;function vs(o,u){switch(o){case"compositionend":return au(u);case"keypress":return u.which!==32?null:(Uc=!0,dl);case"textInput":return o=u.data,o===dl&&Uc?null:o;default:return null}}function od(o,u){if(wo)return o==="compositionend"||!gs&&Pi(o,u)?(o=ai(),fs=cs=ri=null,wo=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return hl&&u.locale!=="ko"?null:u.data;default:return null}}var li={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ms(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u==="input"?!!li[o.type]:u==="textarea"}function jr(o,u,g,y){ni?go?go.push(y):go=[y]:ni=y,u=Tf(u,"onChange"),0<u.length&&(g=new si("onChange","change",null,g,y),o.push({event:g,listeners:u}))}var Eo=null,Nr=null;function sd(o){_m(o,0)}function Co(o){var u=$a(o);if(bn(u))return o}function zc(o,u){if(o==="change")return u}var pl=!1;if(Va){var Zr;if(Va){var gl="oninput"in document;if(!gl){var iu=document.createElement("div");iu.setAttribute("oninput","return;"),gl=typeof iu.oninput=="function"}Zr=gl}else Zr=!1;pl=Zr&&(!document.documentMode||9<document.documentMode)}function Ao(){Eo&&(Eo.detachEvent("onpropertychange",kt),Nr=Eo=null)}function kt(o){if(o.propertyName==="value"&&Co(Nr)){var u=[];jr(u,Nr,o,po(o)),Ha(sd,u)}}function ou(o,u,g){o==="focusin"?(Ao(),Eo=u,Nr=g,Eo.attachEvent("onpropertychange",kt)):o==="focusout"&&Ao()}function U(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Co(Nr)}function s(o,u){if(o==="click")return Co(u)}function l(o,u){if(o==="input"||o==="change")return Co(u)}function h(o,u){return o===u&&(o!==0||1/o===1/u)||o!==o&&u!==u}var v=typeof Object.is=="function"?Object.is:h;function m(o,u){if(v(o,u))return!0;if(typeof o!="object"||o===null||typeof u!="object"||u===null)return!1;var g=Object.keys(o),y=Object.keys(u);if(g.length!==y.length)return!1;for(y=0;y<g.length;y++){var A=g[y];if(!Rt.call(u,A)||!v(o[A],u[A]))return!1}return!0}function b(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function E(o,u){var g=b(o);o=0;for(var y;g;){if(g.nodeType===3){if(y=o+g.textContent.length,o<=u&&y>=u)return{node:g,offset:u-o};o=y}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=b(g)}}function _(o,u){return o&&u?o===u?!0:o&&o.nodeType===3?!1:u&&u.nodeType===3?_(o,u.parentNode):"contains"in o?o.contains(u):o.compareDocumentPosition?!!(o.compareDocumentPosition(u)&16):!1:!1}function I(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var u=ua(o.document);u instanceof o.HTMLIFrameElement;){try{var g=typeof u.contentWindow.location.href=="string"}catch{g=!1}if(g)o=u.contentWindow;else break;u=ua(o.document)}return u}function O(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u&&(u==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||u==="textarea"||o.contentEditable==="true")}var z=Va&&"documentMode"in document&&11>=document.documentMode,V=null,Q=null,ae=null,se=!1;function de(o,u,g){var y=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;se||V==null||V!==ua(y)||(y=V,"selectionStart"in y&&O(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),ae&&m(ae,y)||(ae=y,y=Tf(Q,"onSelect"),0<y.length&&(u=new si("onSelect","select",null,u,g),o.push({event:u,listeners:y}),u.target=V)))}function be(o,u){var g={};return g[o.toLowerCase()]=u.toLowerCase(),g["Webkit"+o]="webkit"+u,g["Moz"+o]="moz"+u,g}var Pe={animationend:be("Animation","AnimationEnd"),animationiteration:be("Animation","AnimationIteration"),animationstart:be("Animation","AnimationStart"),transitionrun:be("Transition","TransitionRun"),transitionstart:be("Transition","TransitionStart"),transitioncancel:be("Transition","TransitionCancel"),transitionend:be("Transition","TransitionEnd")},Ue={},Fe={};Va&&(Fe=document.createElement("div").style,"AnimationEvent"in window||(delete Pe.animationend.animation,delete Pe.animationiteration.animation,delete Pe.animationstart.animation),"TransitionEvent"in window||delete Pe.transitionend.transition);function xt(o){if(Ue[o])return Ue[o];if(!Pe[o])return o;var u=Pe[o],g;for(g in u)if(u.hasOwnProperty(g)&&g in Fe)return Ue[o]=u[g];return o}var gt=xt("animationend"),wr=xt("animationiteration"),Qr=xt("animationstart"),Dr=xt("transitionrun"),nn=xt("transitionstart"),nr=xt("transitioncancel"),Mr=xt("transitionend"),Ui=new Map,ci="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ci.push("scrollEnd");function la(o,u){Ui.set(o,u),pr(u,[o])}var Hc=new WeakMap;function Ia(o,u){if(typeof o=="object"&&o!==null){var g=Hc.get(o);return g!==void 0?g:(u={value:o,source:u,stack:Zs(u)},Hc.set(o,u),u)}return{value:o,source:u,stack:Zs(u)}}var Ra=[],su=0,ud=0;function Vc(){for(var o=su,u=ud=su=0;u<o;){var g=Ra[u];Ra[u++]=null;var y=Ra[u];Ra[u++]=null;var A=Ra[u];Ra[u++]=null;var T=Ra[u];if(Ra[u++]=null,y!==null&&A!==null){var P=y.pending;P===null?A.next=A:(A.next=P.next,P.next=A),y.pending=A}T!==0&&cg(g,A,T)}}function Wc(o,u,g,y){Ra[su++]=o,Ra[su++]=u,Ra[su++]=g,Ra[su++]=y,ud|=y,o.lanes|=y,o=o.alternate,o!==null&&(o.lanes|=y)}function ld(o,u,g,y){return Wc(o,u,g,y),Gc(o)}function uu(o,u){return Wc(o,null,null,u),Gc(o)}function cg(o,u,g){o.lanes|=g;var y=o.alternate;y!==null&&(y.lanes|=g);for(var A=!1,T=o.return;T!==null;)T.childLanes|=g,y=T.alternate,y!==null&&(y.childLanes|=g),T.tag===22&&(o=T.stateNode,o===null||o._visibility&1||(A=!0)),o=T,T=T.return;return o.tag===3?(T=o.stateNode,A&&u!==null&&(A=31-Ht(g),o=T.hiddenUpdates,y=o[A],y===null?o[A]=[u]:y.push(u),u.lane=g|536870912),T):null}function Gc(o){if(50<zl)throw zl=0,g0=null,Error(n(185));for(var u=o.return;u!==null;)o=u,u=o.return;return o.tag===3?o.stateNode:null}var lu={};function Cw(o,u,g,y){this.tag=o,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ca(o,u,g,y){return new Cw(o,u,g,y)}function cd(o){return o=o.prototype,!(!o||!o.isReactComponent)}function zi(o,u){var g=o.alternate;return g===null?(g=ca(o.tag,u,o.key,o.mode),g.elementType=o.elementType,g.type=o.type,g.stateNode=o.stateNode,g.alternate=o,o.alternate=g):(g.pendingProps=u,g.type=o.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=o.flags&65011712,g.childLanes=o.childLanes,g.lanes=o.lanes,g.child=o.child,g.memoizedProps=o.memoizedProps,g.memoizedState=o.memoizedState,g.updateQueue=o.updateQueue,u=o.dependencies,g.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},g.sibling=o.sibling,g.index=o.index,g.ref=o.ref,g.refCleanup=o.refCleanup,g}function fg(o,u){o.flags&=65011714;var g=o.alternate;return g===null?(o.childLanes=0,o.lanes=u,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=g.childLanes,o.lanes=g.lanes,o.child=g.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=g.memoizedProps,o.memoizedState=g.memoizedState,o.updateQueue=g.updateQueue,o.type=g.type,u=g.dependencies,o.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),o}function jc(o,u,g,y,A,T){var P=0;if(y=o,typeof o=="function")cd(o)&&(P=1);else if(typeof o=="string")P=SE(o,g,Le.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case H:return o=ca(31,g,u,A),o.elementType=H,o.lanes=T,o;case R:return xs(g.children,A,T,u);case N:P=8,A|=24;break;case D:return o=ca(12,g,u,A|2),o.elementType=D,o.lanes=T,o;case F:return o=ca(13,g,u,A),o.elementType=F,o.lanes=T,o;case W:return o=ca(19,g,u,A),o.elementType=W,o.lanes=T,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case M:case k:P=10;break e;case B:P=9;break e;case L:P=11;break e;case G:P=14;break e;case q:P=16,y=null;break e}P=29,g=Error(n(130,o===null?"null":typeof o,"")),y=null}return u=ca(P,g,u,A),u.elementType=o,u.type=y,u.lanes=T,u}function xs(o,u,g,y){return o=ca(7,o,y,u),o.lanes=g,o}function fd(o,u,g){return o=ca(6,o,null,u),o.lanes=g,o}function hd(o,u,g){return u=ca(4,o.children!==null?o.children:[],o.key,u),u.lanes=g,u.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},u}var cu=[],fu=0,Xc=null,Yc=0,Na=[],Da=0,ys=null,Hi=1,Vi="";function bs(o,u){cu[fu++]=Yc,cu[fu++]=Xc,Xc=o,Yc=u}function hg(o,u,g){Na[Da++]=Hi,Na[Da++]=Vi,Na[Da++]=ys,ys=o;var y=Hi;o=Vi;var A=32-Ht(y)-1;y&=~(1<<A),g+=1;var T=32-Ht(u)+A;if(30<T){var P=A-A%5;T=(y&(1<<P)-1).toString(32),y>>=P,A-=P,Hi=1<<32-Ht(u)+A|g<<A|y,Vi=T+o}else Hi=1<<T|g<<A|y,Vi=o}function dd(o){o.return!==null&&(bs(o,1),hg(o,1,0))}function pd(o){for(;o===Xc;)Xc=cu[--fu],cu[fu]=null,Yc=cu[--fu],cu[fu]=null;for(;o===ys;)ys=Na[--Da],Na[Da]=null,Vi=Na[--Da],Na[Da]=null,Hi=Na[--Da],Na[Da]=null}var Xr=null,On=null,qt=!1,ws=null,fi=!1,gd=Error(n(519));function Es(o){var u=Error(n(418,""));throw xl(Ia(u,o)),gd}function dg(o){var u=o.stateNode,g=o.type,y=o.memoizedProps;switch(u[hr]=o,u[Nn]=y,g){case"dialog":Mt("cancel",u),Mt("close",u);break;case"iframe":case"object":case"embed":Mt("load",u);break;case"video":case"audio":for(g=0;g<Vl.length;g++)Mt(Vl[g],u);break;case"source":Mt("error",u);break;case"img":case"image":case"link":Mt("error",u),Mt("load",u);break;case"details":Mt("toggle",u);break;case"input":Mt("invalid",u),$n(u,y.value,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name,!0),Qs(u);break;case"select":Mt("invalid",u);break;case"textarea":Mt("invalid",u),zn(u,y.value,y.defaultValue,y.children),Qs(u)}g=y.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||u.textContent===""+g||y.suppressHydrationWarning===!0||Nm(u.textContent,g)?(y.popover!=null&&(Mt("beforetoggle",u),Mt("toggle",u)),y.onScroll!=null&&Mt("scroll",u),y.onScrollEnd!=null&&Mt("scrollend",u),y.onClick!=null&&(u.onclick=If),u=!0):u=!1,u||Es(o)}function pg(o){for(Xr=o.return;Xr;)switch(Xr.tag){case 5:case 13:fi=!1;return;case 27:case 3:fi=!0;return;default:Xr=Xr.return}}function vl(o){if(o!==Xr)return!1;if(!qt)return pg(o),qt=!0,!1;var u=o.tag,g;if((g=u!==3&&u!==27)&&((g=u===5)&&(g=o.type,g=!(g!=="form"&&g!=="button")||D0(o.type,o.memoizedProps)),g=!g),g&&On&&Es(o),pg(o),u===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));e:{for(o=o.nextSibling,u=0;o;){if(o.nodeType===8)if(g=o.data,g==="/$"){if(u===0){On=ja(o.nextSibling);break e}u--}else g!=="$"&&g!=="$!"&&g!=="$?"||u++;o=o.nextSibling}On=null}}else u===27?(u=On,zo(o.type)?(o=k0,k0=null,On=o):On=u):On=Xr?ja(o.stateNode.nextSibling):null;return!0}function ml(){On=Xr=null,qt=!1}function gg(){var o=ws;return o!==null&&(ea===null?ea=o:ea.push.apply(ea,o),ws=null),o}function xl(o){ws===null?ws=[o]:ws.push(o)}var vd=fe(null),Cs=null,Wi=null;function So(o,u,g){Te(vd,u._currentValue),u._currentValue=g}function Gi(o){o._currentValue=vd.current,Ae(vd)}function md(o,u,g){for(;o!==null;){var y=o.alternate;if((o.childLanes&u)!==u?(o.childLanes|=u,y!==null&&(y.childLanes|=u)):y!==null&&(y.childLanes&u)!==u&&(y.childLanes|=u),o===g)break;o=o.return}}function xd(o,u,g,y){var A=o.child;for(A!==null&&(A.return=o);A!==null;){var T=A.dependencies;if(T!==null){var P=A.child;T=T.firstContext;e:for(;T!==null;){var j=T;T=A;for(var ne=0;ne<u.length;ne++)if(j.context===u[ne]){T.lanes|=g,j=T.alternate,j!==null&&(j.lanes|=g),md(T.return,g,o),y||(P=null);break e}T=j.next}}else if(A.tag===18){if(P=A.return,P===null)throw Error(n(341));P.lanes|=g,T=P.alternate,T!==null&&(T.lanes|=g),md(P,g,o),P=null}else P=A.child;if(P!==null)P.return=A;else for(P=A;P!==null;){if(P===o){P=null;break}if(A=P.sibling,A!==null){A.return=P.return,P=A;break}P=P.return}A=P}}function yl(o,u,g,y){o=null;for(var A=u,T=!1;A!==null;){if(!T){if((A.flags&524288)!==0)T=!0;else if((A.flags&262144)!==0)break}if(A.tag===10){var P=A.alternate;if(P===null)throw Error(n(387));if(P=P.memoizedProps,P!==null){var j=A.type;v(A.pendingProps.value,P.value)||(o!==null?o.push(j):o=[j])}}else if(A===ut.current){if(P=A.alternate,P===null)throw Error(n(387));P.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(o!==null?o.push(ql):o=[ql])}A=A.return}o!==null&&xd(u,o,g,y),u.flags|=262144}function qc(o){for(o=o.firstContext;o!==null;){if(!v(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function As(o){Cs=o,Wi=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Or(o){return vg(Cs,o)}function Kc(o,u){return Cs===null&&As(o),vg(o,u)}function vg(o,u){var g=u._currentValue;if(u={context:u,memoizedValue:g,next:null},Wi===null){if(o===null)throw Error(n(308));Wi=u,o.dependencies={lanes:0,firstContext:u},o.flags|=524288}else Wi=Wi.next=u;return g}var Aw=typeof AbortController<"u"?AbortController:function(){var o=[],u=this.signal={aborted:!1,addEventListener:function(g,y){o.push(y)}};this.abort=function(){u.aborted=!0,o.forEach(function(g){return g()})}},Sw=r.unstable_scheduleCallback,_w=r.unstable_NormalPriority,rr={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yd(){return{controller:new Aw,data:new Map,refCount:0}}function bl(o){o.refCount--,o.refCount===0&&Sw(_w,function(){o.controller.abort()})}var wl=null,bd=0,hu=0,du=null;function Tw(o,u){if(wl===null){var g=wl=[];bd=0,hu=E0(),du={status:"pending",value:void 0,then:function(y){g.push(y)}}}return bd++,u.then(mg,mg),u}function mg(){if(--bd===0&&wl!==null){du!==null&&(du.status="fulfilled");var o=wl;wl=null,hu=0,du=null;for(var u=0;u<o.length;u++)(0,o[u])()}}function Iw(o,u){var g=[],y={status:"pending",value:null,reason:null,then:function(A){g.push(A)}};return o.then(function(){y.status="fulfilled",y.value=u;for(var A=0;A<g.length;A++)(0,g[A])(u)},function(A){for(y.status="rejected",y.reason=A,A=0;A<g.length;A++)(0,g[A])(void 0)}),y}var xg=te.S;te.S=function(o,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&Tw(o,u),xg!==null&&xg(o,u)};var Ss=fe(null);function wd(){var o=Ss.current;return o!==null?o:gn.pooledCache}function Zc(o,u){u===null?Te(Ss,Ss.current):Te(Ss,u.pool)}function yg(){var o=wd();return o===null?null:{parent:rr._currentValue,pool:o}}var El=Error(n(460)),bg=Error(n(474)),Qc=Error(n(542)),Ed={then:function(){}};function wg(o){return o=o.status,o==="fulfilled"||o==="rejected"}function Jc(){}function Eg(o,u,g){switch(g=o[g],g===void 0?o.push(u):g!==u&&(u.then(Jc,Jc),u=g),u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,Ag(o),o;default:if(typeof u.status=="string")u.then(Jc,Jc);else{if(o=gn,o!==null&&100<o.shellSuspendCounter)throw Error(n(482));o=u,o.status="pending",o.then(function(y){if(u.status==="pending"){var A=u;A.status="fulfilled",A.value=y}},function(y){if(u.status==="pending"){var A=u;A.status="rejected",A.reason=y}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,Ag(o),o}throw Cl=u,El}}var Cl=null;function Cg(){if(Cl===null)throw Error(n(459));var o=Cl;return Cl=null,o}function Ag(o){if(o===El||o===Qc)throw Error(n(483))}var _o=!1;function Cd(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ad(o,u){o=o.updateQueue,u.updateQueue===o&&(u.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function To(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function Io(o,u,g){var y=o.updateQueue;if(y===null)return null;if(y=y.shared,(rn&2)!==0){var A=y.pending;return A===null?u.next=u:(u.next=A.next,A.next=u),y.pending=u,u=Gc(o),cg(o,null,g),u}return Wc(o,y,u,g),Gc(o)}function Al(o,u,g){if(u=u.updateQueue,u!==null&&(u=u.shared,(g&4194048)!==0)){var y=u.lanes;y&=o.pendingLanes,g|=y,u.lanes=g,qr(o,g)}}function Sd(o,u){var g=o.updateQueue,y=o.alternate;if(y!==null&&(y=y.updateQueue,g===y)){var A=null,T=null;if(g=g.firstBaseUpdate,g!==null){do{var P={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};T===null?A=T=P:T=T.next=P,g=g.next}while(g!==null);T===null?A=T=u:T=T.next=u}else A=T=u;g={baseState:y.baseState,firstBaseUpdate:A,lastBaseUpdate:T,shared:y.shared,callbacks:y.callbacks},o.updateQueue=g;return}o=g.lastBaseUpdate,o===null?g.firstBaseUpdate=u:o.next=u,g.lastBaseUpdate=u}var _d=!1;function Sl(){if(_d){var o=du;if(o!==null)throw o}}function _l(o,u,g,y){_d=!1;var A=o.updateQueue;_o=!1;var T=A.firstBaseUpdate,P=A.lastBaseUpdate,j=A.shared.pending;if(j!==null){A.shared.pending=null;var ne=j,ve=ne.next;ne.next=null,P===null?T=ve:P.next=ve,P=ne;var Ne=o.alternate;Ne!==null&&(Ne=Ne.updateQueue,j=Ne.lastBaseUpdate,j!==P&&(j===null?Ne.firstBaseUpdate=ve:j.next=ve,Ne.lastBaseUpdate=ne))}if(T!==null){var Oe=A.baseState;P=0,Ne=ve=ne=null,j=T;do{var ye=j.lane&-536870913,we=ye!==j.lane;if(we?(Pt&ye)===ye:(y&ye)===ye){ye!==0&&ye===hu&&(_d=!0),Ne!==null&&(Ne=Ne.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var dt=o,lt=j;ye=u;var fn=g;switch(lt.tag){case 1:if(dt=lt.payload,typeof dt=="function"){Oe=dt.call(fn,Oe,ye);break e}Oe=dt;break e;case 3:dt.flags=dt.flags&-65537|128;case 0:if(dt=lt.payload,ye=typeof dt=="function"?dt.call(fn,Oe,ye):dt,ye==null)break e;Oe=x({},Oe,ye);break e;case 2:_o=!0}}ye=j.callback,ye!==null&&(o.flags|=64,we&&(o.flags|=8192),we=A.callbacks,we===null?A.callbacks=[ye]:we.push(ye))}else we={lane:ye,tag:j.tag,payload:j.payload,callback:j.callback,next:null},Ne===null?(ve=Ne=we,ne=Oe):Ne=Ne.next=we,P|=ye;if(j=j.next,j===null){if(j=A.shared.pending,j===null)break;we=j,j=we.next,we.next=null,A.lastBaseUpdate=we,A.shared.pending=null}}while(!0);Ne===null&&(ne=Oe),A.baseState=ne,A.firstBaseUpdate=ve,A.lastBaseUpdate=Ne,T===null&&(A.shared.lanes=0),Lo|=P,o.lanes=P,o.memoizedState=Oe}}function Sg(o,u){if(typeof o!="function")throw Error(n(191,o));o.call(u)}function _g(o,u){var g=o.callbacks;if(g!==null)for(o.callbacks=null,o=0;o<g.length;o++)Sg(g[o],u)}var pu=fe(null),$c=fe(0);function Tg(o,u){o=Qi,Te($c,o),Te(pu,u),Qi=o|u.baseLanes}function Td(){Te($c,Qi),Te(pu,pu.current)}function Id(){Qi=$c.current,Ae(pu),Ae($c)}var Ro=0,_t=null,ln=null,qn=null,ef=!1,gu=!1,_s=!1,tf=0,Tl=0,vu=null,Rw=0;function Wn(){throw Error(n(321))}function Rd(o,u){if(u===null)return!1;for(var g=0;g<u.length&&g<o.length;g++)if(!v(o[g],u[g]))return!1;return!0}function Nd(o,u,g,y,A,T){return Ro=T,_t=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,te.H=o===null||o.memoizedState===null?cv:fv,_s=!1,T=g(y,A),_s=!1,gu&&(T=Rg(u,g,y,A)),Ig(o),T}function Ig(o){te.H=uf;var u=ln!==null&&ln.next!==null;if(Ro=0,qn=ln=_t=null,ef=!1,Tl=0,vu=null,u)throw Error(n(300));o===null||gr||(o=o.dependencies,o!==null&&qc(o)&&(gr=!0))}function Rg(o,u,g,y){_t=o;var A=0;do{if(gu&&(vu=null),Tl=0,gu=!1,25<=A)throw Error(n(301));if(A+=1,qn=ln=null,o.updateQueue!=null){var T=o.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}te.H=Lw,T=u(g,y)}while(gu);return T}function Nw(){var o=te.H,u=o.useState()[0];return u=typeof u.then=="function"?Il(u):u,o=o.useState()[0],(ln!==null?ln.memoizedState:null)!==o&&(_t.flags|=1024),u}function Dd(){var o=tf!==0;return tf=0,o}function Md(o,u,g){u.updateQueue=o.updateQueue,u.flags&=-2053,o.lanes&=~g}function Od(o){if(ef){for(o=o.memoizedState;o!==null;){var u=o.queue;u!==null&&(u.pending=null),o=o.next}ef=!1}Ro=0,qn=ln=_t=null,gu=!1,Tl=tf=0,vu=null}function Jr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qn===null?_t.memoizedState=qn=o:qn=qn.next=o,qn}function Kn(){if(ln===null){var o=_t.alternate;o=o!==null?o.memoizedState:null}else o=ln.next;var u=qn===null?_t.memoizedState:qn.next;if(u!==null)qn=u,ln=o;else{if(o===null)throw _t.alternate===null?Error(n(467)):Error(n(310));ln=o,o={memoizedState:ln.memoizedState,baseState:ln.baseState,baseQueue:ln.baseQueue,queue:ln.queue,next:null},qn===null?_t.memoizedState=qn=o:qn=qn.next=o}return qn}function Bd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Il(o){var u=Tl;return Tl+=1,vu===null&&(vu=[]),o=Eg(vu,o,u),u=_t,(qn===null?u.memoizedState:qn.next)===null&&(u=u.alternate,te.H=u===null||u.memoizedState===null?cv:fv),o}function nf(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Il(o);if(o.$$typeof===k)return Or(o)}throw Error(n(438,String(o)))}function kd(o){var u=null,g=_t.updateQueue;if(g!==null&&(u=g.memoCache),u==null){var y=_t.alternate;y!==null&&(y=y.updateQueue,y!==null&&(y=y.memoCache,y!=null&&(u={data:y.data.map(function(A){return A.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),g===null&&(g=Bd(),_t.updateQueue=g),g.memoCache=u,g=u.data[u.index],g===void 0)for(g=u.data[u.index]=Array(o),y=0;y<o;y++)g[y]=Z;return u.index++,g}function ji(o,u){return typeof u=="function"?u(o):u}function rf(o){var u=Kn();return Ld(u,ln,o)}function Ld(o,u,g){var y=o.queue;if(y===null)throw Error(n(311));y.lastRenderedReducer=g;var A=o.baseQueue,T=y.pending;if(T!==null){if(A!==null){var P=A.next;A.next=T.next,T.next=P}u.baseQueue=A=T,y.pending=null}if(T=o.baseState,A===null)o.memoizedState=T;else{u=A.next;var j=P=null,ne=null,ve=u,Ne=!1;do{var Oe=ve.lane&-536870913;if(Oe!==ve.lane?(Pt&Oe)===Oe:(Ro&Oe)===Oe){var ye=ve.revertLane;if(ye===0)ne!==null&&(ne=ne.next={lane:0,revertLane:0,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null}),Oe===hu&&(Ne=!0);else if((Ro&ye)===ye){ve=ve.next,ye===hu&&(Ne=!0);continue}else Oe={lane:0,revertLane:ve.revertLane,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null},ne===null?(j=ne=Oe,P=T):ne=ne.next=Oe,_t.lanes|=ye,Lo|=ye;Oe=ve.action,_s&&g(T,Oe),T=ve.hasEagerState?ve.eagerState:g(T,Oe)}else ye={lane:Oe,revertLane:ve.revertLane,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null},ne===null?(j=ne=ye,P=T):ne=ne.next=ye,_t.lanes|=Oe,Lo|=Oe;ve=ve.next}while(ve!==null&&ve!==u);if(ne===null?P=T:ne.next=j,!v(T,o.memoizedState)&&(gr=!0,Ne&&(g=du,g!==null)))throw g;o.memoizedState=T,o.baseState=P,o.baseQueue=ne,y.lastRenderedState=T}return A===null&&(y.lanes=0),[o.memoizedState,y.dispatch]}function Fd(o){var u=Kn(),g=u.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=o;var y=g.dispatch,A=g.pending,T=u.memoizedState;if(A!==null){g.pending=null;var P=A=A.next;do T=o(T,P.action),P=P.next;while(P!==A);v(T,u.memoizedState)||(gr=!0),u.memoizedState=T,u.baseQueue===null&&(u.baseState=T),g.lastRenderedState=T}return[T,y]}function Ng(o,u,g){var y=_t,A=Kn(),T=qt;if(T){if(g===void 0)throw Error(n(407));g=g()}else g=u();var P=!v((ln||A).memoizedState,g);P&&(A.memoizedState=g,gr=!0),A=A.queue;var j=Og.bind(null,y,A,o);if(Rl(2048,8,j,[o]),A.getSnapshot!==u||P||qn!==null&&qn.memoizedState.tag&1){if(y.flags|=2048,mu(9,af(),Mg.bind(null,y,A,g,u),null),gn===null)throw Error(n(349));T||(Ro&124)!==0||Dg(y,u,g)}return g}function Dg(o,u,g){o.flags|=16384,o={getSnapshot:u,value:g},u=_t.updateQueue,u===null?(u=Bd(),_t.updateQueue=u,u.stores=[o]):(g=u.stores,g===null?u.stores=[o]:g.push(o))}function Mg(o,u,g,y){u.value=g,u.getSnapshot=y,Bg(u)&&kg(o)}function Og(o,u,g){return g(function(){Bg(u)&&kg(o)})}function Bg(o){var u=o.getSnapshot;o=o.value;try{var g=u();return!v(o,g)}catch{return!0}}function kg(o){var u=uu(o,2);u!==null&&ga(u,o,2)}function Pd(o){var u=Jr();if(typeof o=="function"){var g=o;if(o=g(),_s){sn(!0);try{g()}finally{sn(!1)}}}return u.memoizedState=u.baseState=o,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:o},u}function Lg(o,u,g,y){return o.baseState=g,Ld(o,ln,typeof y=="function"?y:ji)}function Dw(o,u,g,y,A){if(sf(o))throw Error(n(485));if(o=u.action,o!==null){var T={payload:A,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(P){T.listeners.push(P)}};te.T!==null?g(!0):T.isTransition=!1,y(T),g=u.pending,g===null?(T.next=u.pending=T,Fg(u,T)):(T.next=g.next,u.pending=g.next=T)}}function Fg(o,u){var g=u.action,y=u.payload,A=o.state;if(u.isTransition){var T=te.T,P={};te.T=P;try{var j=g(A,y),ne=te.S;ne!==null&&ne(P,j),Pg(o,u,j)}catch(ve){Ud(o,u,ve)}finally{te.T=T}}else try{T=g(A,y),Pg(o,u,T)}catch(ve){Ud(o,u,ve)}}function Pg(o,u,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(y){Ug(o,u,y)},function(y){return Ud(o,u,y)}):Ug(o,u,g)}function Ug(o,u,g){u.status="fulfilled",u.value=g,zg(u),o.state=g,u=o.pending,u!==null&&(g=u.next,g===u?o.pending=null:(g=g.next,u.next=g,Fg(o,g)))}function Ud(o,u,g){var y=o.pending;if(o.pending=null,y!==null){y=y.next;do u.status="rejected",u.reason=g,zg(u),u=u.next;while(u!==y)}o.action=null}function zg(o){o=o.listeners;for(var u=0;u<o.length;u++)(0,o[u])()}function Hg(o,u){return u}function Vg(o,u){if(qt){var g=gn.formState;if(g!==null){e:{var y=_t;if(qt){if(On){t:{for(var A=On,T=fi;A.nodeType!==8;){if(!T){A=null;break t}if(A=ja(A.nextSibling),A===null){A=null;break t}}T=A.data,A=T==="F!"||T==="F"?A:null}if(A){On=ja(A.nextSibling),y=A.data==="F!";break e}}Es(y)}y=!1}y&&(u=g[0])}}return g=Jr(),g.memoizedState=g.baseState=u,y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hg,lastRenderedState:u},g.queue=y,g=sv.bind(null,_t,y),y.dispatch=g,y=Pd(!1),T=Gd.bind(null,_t,!1,y.queue),y=Jr(),A={state:u,dispatch:null,action:o,pending:null},y.queue=A,g=Dw.bind(null,_t,A,T,g),A.dispatch=g,y.memoizedState=o,[u,g,!1]}function Wg(o){var u=Kn();return Gg(u,ln,o)}function Gg(o,u,g){if(u=Ld(o,u,Hg)[0],o=rf(ji)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var y=Il(u)}catch(P){throw P===El?Qc:P}else y=u;u=Kn();var A=u.queue,T=A.dispatch;return g!==u.memoizedState&&(_t.flags|=2048,mu(9,af(),Mw.bind(null,A,g),null)),[y,T,o]}function Mw(o,u){o.action=u}function jg(o){var u=Kn(),g=ln;if(g!==null)return Gg(u,g,o);Kn(),u=u.memoizedState,g=Kn();var y=g.queue.dispatch;return g.memoizedState=o,[u,y,!1]}function mu(o,u,g,y){return o={tag:o,create:g,deps:y,inst:u,next:null},u=_t.updateQueue,u===null&&(u=Bd(),_t.updateQueue=u),g=u.lastEffect,g===null?u.lastEffect=o.next=o:(y=g.next,g.next=o,o.next=y,u.lastEffect=o),o}function af(){return{destroy:void 0,resource:void 0}}function Xg(){return Kn().memoizedState}function of(o,u,g,y){var A=Jr();y=y===void 0?null:y,_t.flags|=o,A.memoizedState=mu(1|u,af(),g,y)}function Rl(o,u,g,y){var A=Kn();y=y===void 0?null:y;var T=A.memoizedState.inst;ln!==null&&y!==null&&Rd(y,ln.memoizedState.deps)?A.memoizedState=mu(u,T,g,y):(_t.flags|=o,A.memoizedState=mu(1|u,T,g,y))}function Yg(o,u){of(8390656,8,o,u)}function qg(o,u){Rl(2048,8,o,u)}function Kg(o,u){return Rl(4,2,o,u)}function Zg(o,u){return Rl(4,4,o,u)}function Qg(o,u){if(typeof u=="function"){o=o();var g=u(o);return function(){typeof g=="function"?g():u(null)}}if(u!=null)return o=o(),u.current=o,function(){u.current=null}}function Jg(o,u,g){g=g!=null?g.concat([o]):null,Rl(4,4,Qg.bind(null,u,o),g)}function zd(){}function $g(o,u){var g=Kn();u=u===void 0?null:u;var y=g.memoizedState;return u!==null&&Rd(u,y[1])?y[0]:(g.memoizedState=[o,u],o)}function ev(o,u){var g=Kn();u=u===void 0?null:u;var y=g.memoizedState;if(u!==null&&Rd(u,y[1]))return y[0];if(y=o(),_s){sn(!0);try{o()}finally{sn(!1)}}return g.memoizedState=[y,u],y}function Hd(o,u,g){return g===void 0||(Ro&1073741824)!==0?o.memoizedState=u:(o.memoizedState=g,o=rm(),_t.lanes|=o,Lo|=o,g)}function tv(o,u,g,y){return v(g,u)?g:pu.current!==null?(o=Hd(o,g,y),v(o,u)||(gr=!0),o):(Ro&42)===0?(gr=!0,o.memoizedState=g):(o=rm(),_t.lanes|=o,Lo|=o,u)}function nv(o,u,g,y,A){var T=re.p;re.p=T!==0&&8>T?T:8;var P=te.T,j={};te.T=j,Gd(o,!1,u,g);try{var ne=A(),ve=te.S;if(ve!==null&&ve(j,ne),ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var Ne=Iw(ne,y);Nl(o,u,Ne,pa(o))}else Nl(o,u,y,pa(o))}catch(Oe){Nl(o,u,{then:function(){},status:"rejected",reason:Oe},pa())}finally{re.p=T,te.T=P}}function Ow(){}function Vd(o,u,g,y){if(o.tag!==5)throw Error(n(476));var A=rv(o).queue;nv(o,A,u,he,g===null?Ow:function(){return av(o),g(y)})}function rv(o){var u=o.memoizedState;if(u!==null)return u;u={memoizedState:he,baseState:he,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:he},next:null};var g={};return u.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:g},next:null},o.memoizedState=u,o=o.alternate,o!==null&&(o.memoizedState=u),u}function av(o){var u=rv(o).next.queue;Nl(o,u,{},pa())}function Wd(){return Or(ql)}function iv(){return Kn().memoizedState}function ov(){return Kn().memoizedState}function Bw(o){for(var u=o.return;u!==null;){switch(u.tag){case 24:case 3:var g=pa();o=To(g);var y=Io(u,o,g);y!==null&&(ga(y,u,g),Al(y,u,g)),u={cache:yd()},o.payload=u;return}u=u.return}}function kw(o,u,g){var y=pa();g={lane:y,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null},sf(o)?uv(u,g):(g=ld(o,u,g,y),g!==null&&(ga(g,o,y),lv(g,u,y)))}function sv(o,u,g){var y=pa();Nl(o,u,g,y)}function Nl(o,u,g,y){var A={lane:y,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null};if(sf(o))uv(u,A);else{var T=o.alternate;if(o.lanes===0&&(T===null||T.lanes===0)&&(T=u.lastRenderedReducer,T!==null))try{var P=u.lastRenderedState,j=T(P,g);if(A.hasEagerState=!0,A.eagerState=j,v(j,P))return Wc(o,u,A,0),gn===null&&Vc(),!1}catch{}finally{}if(g=ld(o,u,A,y),g!==null)return ga(g,o,y),lv(g,u,y),!0}return!1}function Gd(o,u,g,y){if(y={lane:2,revertLane:E0(),action:y,hasEagerState:!1,eagerState:null,next:null},sf(o)){if(u)throw Error(n(479))}else u=ld(o,g,y,2),u!==null&&ga(u,o,2)}function sf(o){var u=o.alternate;return o===_t||u!==null&&u===_t}function uv(o,u){gu=ef=!0;var g=o.pending;g===null?u.next=u:(u.next=g.next,g.next=u),o.pending=u}function lv(o,u,g){if((g&4194048)!==0){var y=u.lanes;y&=o.pendingLanes,g|=y,u.lanes=g,qr(o,g)}}var uf={readContext:Or,use:nf,useCallback:Wn,useContext:Wn,useEffect:Wn,useImperativeHandle:Wn,useLayoutEffect:Wn,useInsertionEffect:Wn,useMemo:Wn,useReducer:Wn,useRef:Wn,useState:Wn,useDebugValue:Wn,useDeferredValue:Wn,useTransition:Wn,useSyncExternalStore:Wn,useId:Wn,useHostTransitionStatus:Wn,useFormState:Wn,useActionState:Wn,useOptimistic:Wn,useMemoCache:Wn,useCacheRefresh:Wn},cv={readContext:Or,use:nf,useCallback:function(o,u){return Jr().memoizedState=[o,u===void 0?null:u],o},useContext:Or,useEffect:Yg,useImperativeHandle:function(o,u,g){g=g!=null?g.concat([o]):null,of(4194308,4,Qg.bind(null,u,o),g)},useLayoutEffect:function(o,u){return of(4194308,4,o,u)},useInsertionEffect:function(o,u){of(4,2,o,u)},useMemo:function(o,u){var g=Jr();u=u===void 0?null:u;var y=o();if(_s){sn(!0);try{o()}finally{sn(!1)}}return g.memoizedState=[y,u],y},useReducer:function(o,u,g){var y=Jr();if(g!==void 0){var A=g(u);if(_s){sn(!0);try{g(u)}finally{sn(!1)}}}else A=u;return y.memoizedState=y.baseState=A,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:A},y.queue=o,o=o.dispatch=kw.bind(null,_t,o),[y.memoizedState,o]},useRef:function(o){var u=Jr();return o={current:o},u.memoizedState=o},useState:function(o){o=Pd(o);var u=o.queue,g=sv.bind(null,_t,u);return u.dispatch=g,[o.memoizedState,g]},useDebugValue:zd,useDeferredValue:function(o,u){var g=Jr();return Hd(g,o,u)},useTransition:function(){var o=Pd(!1);return o=nv.bind(null,_t,o.queue,!0,!1),Jr().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,u,g){var y=_t,A=Jr();if(qt){if(g===void 0)throw Error(n(407));g=g()}else{if(g=u(),gn===null)throw Error(n(349));(Pt&124)!==0||Dg(y,u,g)}A.memoizedState=g;var T={value:g,getSnapshot:u};return A.queue=T,Yg(Og.bind(null,y,T,o),[o]),y.flags|=2048,mu(9,af(),Mg.bind(null,y,T,g,u),null),g},useId:function(){var o=Jr(),u=gn.identifierPrefix;if(qt){var g=Vi,y=Hi;g=(y&~(1<<32-Ht(y)-1)).toString(32)+g,u="«"+u+"R"+g,g=tf++,0<g&&(u+="H"+g.toString(32)),u+="»"}else g=Rw++,u="«"+u+"r"+g.toString(32)+"»";return o.memoizedState=u},useHostTransitionStatus:Wd,useFormState:Vg,useActionState:Vg,useOptimistic:function(o){var u=Jr();u.memoizedState=u.baseState=o;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=g,u=Gd.bind(null,_t,!0,g),g.dispatch=u,[o,u]},useMemoCache:kd,useCacheRefresh:function(){return Jr().memoizedState=Bw.bind(null,_t)}},fv={readContext:Or,use:nf,useCallback:$g,useContext:Or,useEffect:qg,useImperativeHandle:Jg,useInsertionEffect:Kg,useLayoutEffect:Zg,useMemo:ev,useReducer:rf,useRef:Xg,useState:function(){return rf(ji)},useDebugValue:zd,useDeferredValue:function(o,u){var g=Kn();return tv(g,ln.memoizedState,o,u)},useTransition:function(){var o=rf(ji)[0],u=Kn().memoizedState;return[typeof o=="boolean"?o:Il(o),u]},useSyncExternalStore:Ng,useId:iv,useHostTransitionStatus:Wd,useFormState:Wg,useActionState:Wg,useOptimistic:function(o,u){var g=Kn();return Lg(g,ln,o,u)},useMemoCache:kd,useCacheRefresh:ov},Lw={readContext:Or,use:nf,useCallback:$g,useContext:Or,useEffect:qg,useImperativeHandle:Jg,useInsertionEffect:Kg,useLayoutEffect:Zg,useMemo:ev,useReducer:Fd,useRef:Xg,useState:function(){return Fd(ji)},useDebugValue:zd,useDeferredValue:function(o,u){var g=Kn();return ln===null?Hd(g,o,u):tv(g,ln.memoizedState,o,u)},useTransition:function(){var o=Fd(ji)[0],u=Kn().memoizedState;return[typeof o=="boolean"?o:Il(o),u]},useSyncExternalStore:Ng,useId:iv,useHostTransitionStatus:Wd,useFormState:jg,useActionState:jg,useOptimistic:function(o,u){var g=Kn();return ln!==null?Lg(g,ln,o,u):(g.baseState=o,[o,g.queue.dispatch])},useMemoCache:kd,useCacheRefresh:ov},xu=null,Dl=0;function lf(o){var u=Dl;return Dl+=1,xu===null&&(xu=[]),Eg(xu,o,u)}function Ml(o,u){u=u.props.ref,o.ref=u!==void 0?u:null}function cf(o,u){throw u.$$typeof===w?Error(n(525)):(o=Object.prototype.toString.call(u),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":o)))}function hv(o){var u=o._init;return u(o._payload)}function dv(o){function u(ce,ue){if(o){var ge=ce.deletions;ge===null?(ce.deletions=[ue],ce.flags|=16):ge.push(ue)}}function g(ce,ue){if(!o)return null;for(;ue!==null;)u(ce,ue),ue=ue.sibling;return null}function y(ce){for(var ue=new Map;ce!==null;)ce.key!==null?ue.set(ce.key,ce):ue.set(ce.index,ce),ce=ce.sibling;return ue}function A(ce,ue){return ce=zi(ce,ue),ce.index=0,ce.sibling=null,ce}function T(ce,ue,ge){return ce.index=ge,o?(ge=ce.alternate,ge!==null?(ge=ge.index,ge<ue?(ce.flags|=67108866,ue):ge):(ce.flags|=67108866,ue)):(ce.flags|=1048576,ue)}function P(ce){return o&&ce.alternate===null&&(ce.flags|=67108866),ce}function j(ce,ue,ge,Me){return ue===null||ue.tag!==6?(ue=fd(ge,ce.mode,Me),ue.return=ce,ue):(ue=A(ue,ge),ue.return=ce,ue)}function ne(ce,ue,ge,Me){var Ke=ge.type;return Ke===R?Ne(ce,ue,ge.props.children,Me,ge.key):ue!==null&&(ue.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===q&&hv(Ke)===ue.type)?(ue=A(ue,ge.props),Ml(ue,ge),ue.return=ce,ue):(ue=jc(ge.type,ge.key,ge.props,null,ce.mode,Me),Ml(ue,ge),ue.return=ce,ue)}function ve(ce,ue,ge,Me){return ue===null||ue.tag!==4||ue.stateNode.containerInfo!==ge.containerInfo||ue.stateNode.implementation!==ge.implementation?(ue=hd(ge,ce.mode,Me),ue.return=ce,ue):(ue=A(ue,ge.children||[]),ue.return=ce,ue)}function Ne(ce,ue,ge,Me,Ke){return ue===null||ue.tag!==7?(ue=xs(ge,ce.mode,Me,Ke),ue.return=ce,ue):(ue=A(ue,ge),ue.return=ce,ue)}function Oe(ce,ue,ge){if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return ue=fd(""+ue,ce.mode,ge),ue.return=ce,ue;if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case C:return ge=jc(ue.type,ue.key,ue.props,null,ce.mode,ge),Ml(ge,ue),ge.return=ce,ge;case S:return ue=hd(ue,ce.mode,ge),ue.return=ce,ue;case q:var Me=ue._init;return ue=Me(ue._payload),Oe(ce,ue,ge)}if($(ue)||ee(ue))return ue=xs(ue,ce.mode,ge,null),ue.return=ce,ue;if(typeof ue.then=="function")return Oe(ce,lf(ue),ge);if(ue.$$typeof===k)return Oe(ce,Kc(ce,ue),ge);cf(ce,ue)}return null}function ye(ce,ue,ge,Me){var Ke=ue!==null?ue.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return Ke!==null?null:j(ce,ue,""+ge,Me);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case C:return ge.key===Ke?ne(ce,ue,ge,Me):null;case S:return ge.key===Ke?ve(ce,ue,ge,Me):null;case q:return Ke=ge._init,ge=Ke(ge._payload),ye(ce,ue,ge,Me)}if($(ge)||ee(ge))return Ke!==null?null:Ne(ce,ue,ge,Me,null);if(typeof ge.then=="function")return ye(ce,ue,lf(ge),Me);if(ge.$$typeof===k)return ye(ce,ue,Kc(ce,ge),Me);cf(ce,ge)}return null}function we(ce,ue,ge,Me,Ke){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return ce=ce.get(ge)||null,j(ue,ce,""+Me,Ke);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case C:return ce=ce.get(Me.key===null?ge:Me.key)||null,ne(ue,ce,Me,Ke);case S:return ce=ce.get(Me.key===null?ge:Me.key)||null,ve(ue,ce,Me,Ke);case q:var Tt=Me._init;return Me=Tt(Me._payload),we(ce,ue,ge,Me,Ke)}if($(Me)||ee(Me))return ce=ce.get(ge)||null,Ne(ue,ce,Me,Ke,null);if(typeof Me.then=="function")return we(ce,ue,ge,lf(Me),Ke);if(Me.$$typeof===k)return we(ce,ue,ge,Kc(ue,Me),Ke);cf(ue,Me)}return null}function dt(ce,ue,ge,Me){for(var Ke=null,Tt=null,at=ue,ft=ue=0,mr=null;at!==null&&ft<ge.length;ft++){at.index>ft?(mr=at,at=null):mr=at.sibling;var Gt=ye(ce,at,ge[ft],Me);if(Gt===null){at===null&&(at=mr);break}o&&at&&Gt.alternate===null&&u(ce,at),ue=T(Gt,ue,ft),Tt===null?Ke=Gt:Tt.sibling=Gt,Tt=Gt,at=mr}if(ft===ge.length)return g(ce,at),qt&&bs(ce,ft),Ke;if(at===null){for(;ft<ge.length;ft++)at=Oe(ce,ge[ft],Me),at!==null&&(ue=T(at,ue,ft),Tt===null?Ke=at:Tt.sibling=at,Tt=at);return qt&&bs(ce,ft),Ke}for(at=y(at);ft<ge.length;ft++)mr=we(at,ce,ft,ge[ft],Me),mr!==null&&(o&&mr.alternate!==null&&at.delete(mr.key===null?ft:mr.key),ue=T(mr,ue,ft),Tt===null?Ke=mr:Tt.sibling=mr,Tt=mr);return o&&at.forEach(function(jo){return u(ce,jo)}),qt&&bs(ce,ft),Ke}function lt(ce,ue,ge,Me){if(ge==null)throw Error(n(151));for(var Ke=null,Tt=null,at=ue,ft=ue=0,mr=null,Gt=ge.next();at!==null&&!Gt.done;ft++,Gt=ge.next()){at.index>ft?(mr=at,at=null):mr=at.sibling;var jo=ye(ce,at,Gt.value,Me);if(jo===null){at===null&&(at=mr);break}o&&at&&jo.alternate===null&&u(ce,at),ue=T(jo,ue,ft),Tt===null?Ke=jo:Tt.sibling=jo,Tt=jo,at=mr}if(Gt.done)return g(ce,at),qt&&bs(ce,ft),Ke;if(at===null){for(;!Gt.done;ft++,Gt=ge.next())Gt=Oe(ce,Gt.value,Me),Gt!==null&&(ue=T(Gt,ue,ft),Tt===null?Ke=Gt:Tt.sibling=Gt,Tt=Gt);return qt&&bs(ce,ft),Ke}for(at=y(at);!Gt.done;ft++,Gt=ge.next())Gt=we(at,ce,ft,Gt.value,Me),Gt!==null&&(o&&Gt.alternate!==null&&at.delete(Gt.key===null?ft:Gt.key),ue=T(Gt,ue,ft),Tt===null?Ke=Gt:Tt.sibling=Gt,Tt=Gt);return o&&at.forEach(function(FE){return u(ce,FE)}),qt&&bs(ce,ft),Ke}function fn(ce,ue,ge,Me){if(typeof ge=="object"&&ge!==null&&ge.type===R&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case C:e:{for(var Ke=ge.key;ue!==null;){if(ue.key===Ke){if(Ke=ge.type,Ke===R){if(ue.tag===7){g(ce,ue.sibling),Me=A(ue,ge.props.children),Me.return=ce,ce=Me;break e}}else if(ue.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===q&&hv(Ke)===ue.type){g(ce,ue.sibling),Me=A(ue,ge.props),Ml(Me,ge),Me.return=ce,ce=Me;break e}g(ce,ue);break}else u(ce,ue);ue=ue.sibling}ge.type===R?(Me=xs(ge.props.children,ce.mode,Me,ge.key),Me.return=ce,ce=Me):(Me=jc(ge.type,ge.key,ge.props,null,ce.mode,Me),Ml(Me,ge),Me.return=ce,ce=Me)}return P(ce);case S:e:{for(Ke=ge.key;ue!==null;){if(ue.key===Ke)if(ue.tag===4&&ue.stateNode.containerInfo===ge.containerInfo&&ue.stateNode.implementation===ge.implementation){g(ce,ue.sibling),Me=A(ue,ge.children||[]),Me.return=ce,ce=Me;break e}else{g(ce,ue);break}else u(ce,ue);ue=ue.sibling}Me=hd(ge,ce.mode,Me),Me.return=ce,ce=Me}return P(ce);case q:return Ke=ge._init,ge=Ke(ge._payload),fn(ce,ue,ge,Me)}if($(ge))return dt(ce,ue,ge,Me);if(ee(ge)){if(Ke=ee(ge),typeof Ke!="function")throw Error(n(150));return ge=Ke.call(ge),lt(ce,ue,ge,Me)}if(typeof ge.then=="function")return fn(ce,ue,lf(ge),Me);if(ge.$$typeof===k)return fn(ce,ue,Kc(ce,ge),Me);cf(ce,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint"?(ge=""+ge,ue!==null&&ue.tag===6?(g(ce,ue.sibling),Me=A(ue,ge),Me.return=ce,ce=Me):(g(ce,ue),Me=fd(ge,ce.mode,Me),Me.return=ce,ce=Me),P(ce)):g(ce,ue)}return function(ce,ue,ge,Me){try{Dl=0;var Ke=fn(ce,ue,ge,Me);return xu=null,Ke}catch(at){if(at===El||at===Qc)throw at;var Tt=ca(29,at,null,ce.mode);return Tt.lanes=Me,Tt.return=ce,Tt}finally{}}}var yu=dv(!0),pv=dv(!1),Ma=fe(null),hi=null;function No(o){var u=o.alternate;Te(ar,ar.current&1),Te(Ma,o),hi===null&&(u===null||pu.current!==null||u.memoizedState!==null)&&(hi=o)}function gv(o){if(o.tag===22){if(Te(ar,ar.current),Te(Ma,o),hi===null){var u=o.alternate;u!==null&&u.memoizedState!==null&&(hi=o)}}else Do()}function Do(){Te(ar,ar.current),Te(Ma,Ma.current)}function Xi(o){Ae(Ma),hi===o&&(hi=null),Ae(ar)}var ar=fe(0);function ff(o){for(var u=o;u!==null;){if(u.tag===13){var g=u.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||B0(g)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function jd(o,u,g,y){u=o.memoizedState,g=g(y,u),g=g==null?u:x({},u,g),o.memoizedState=g,o.lanes===0&&(o.updateQueue.baseState=g)}var Xd={enqueueSetState:function(o,u,g){o=o._reactInternals;var y=pa(),A=To(y);A.payload=u,g!=null&&(A.callback=g),u=Io(o,A,y),u!==null&&(ga(u,o,y),Al(u,o,y))},enqueueReplaceState:function(o,u,g){o=o._reactInternals;var y=pa(),A=To(y);A.tag=1,A.payload=u,g!=null&&(A.callback=g),u=Io(o,A,y),u!==null&&(ga(u,o,y),Al(u,o,y))},enqueueForceUpdate:function(o,u){o=o._reactInternals;var g=pa(),y=To(g);y.tag=2,u!=null&&(y.callback=u),u=Io(o,y,g),u!==null&&(ga(u,o,g),Al(u,o,g))}};function vv(o,u,g,y,A,T,P){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(y,T,P):u.prototype&&u.prototype.isPureReactComponent?!m(g,y)||!m(A,T):!0}function mv(o,u,g,y){o=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(g,y),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(g,y),u.state!==o&&Xd.enqueueReplaceState(u,u.state,null)}function Ts(o,u){var g=u;if("ref"in u){g={};for(var y in u)y!=="ref"&&(g[y]=u[y])}if(o=o.defaultProps){g===u&&(g=x({},g));for(var A in o)g[A]===void 0&&(g[A]=o[A])}return g}var hf=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function xv(o){hf(o)}function yv(o){console.error(o)}function bv(o){hf(o)}function df(o,u){try{var g=o.onUncaughtError;g(u.value,{componentStack:u.stack})}catch(y){setTimeout(function(){throw y})}}function wv(o,u,g){try{var y=o.onCaughtError;y(g.value,{componentStack:g.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function Yd(o,u,g){return g=To(g),g.tag=3,g.payload={element:null},g.callback=function(){df(o,u)},g}function Ev(o){return o=To(o),o.tag=3,o}function Cv(o,u,g,y){var A=g.type.getDerivedStateFromError;if(typeof A=="function"){var T=y.value;o.payload=function(){return A(T)},o.callback=function(){wv(u,g,y)}}var P=g.stateNode;P!==null&&typeof P.componentDidCatch=="function"&&(o.callback=function(){wv(u,g,y),typeof A!="function"&&(Fo===null?Fo=new Set([this]):Fo.add(this));var j=y.stack;this.componentDidCatch(y.value,{componentStack:j!==null?j:""})})}function Fw(o,u,g,y,A){if(g.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){if(u=g.alternate,u!==null&&yl(u,g,A,!0),g=Ma.current,g!==null){switch(g.tag){case 13:return hi===null?m0():g.alternate===null&&Bn===0&&(Bn=3),g.flags&=-257,g.flags|=65536,g.lanes=A,y===Ed?g.flags|=16384:(u=g.updateQueue,u===null?g.updateQueue=new Set([y]):u.add(y),y0(o,y,A)),!1;case 22:return g.flags|=65536,y===Ed?g.flags|=16384:(u=g.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([y])},g.updateQueue=u):(g=u.retryQueue,g===null?u.retryQueue=new Set([y]):g.add(y)),y0(o,y,A)),!1}throw Error(n(435,g.tag))}return y0(o,y,A),m0(),!1}if(qt)return u=Ma.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=A,y!==gd&&(o=Error(n(422),{cause:y}),xl(Ia(o,g)))):(y!==gd&&(u=Error(n(423),{cause:y}),xl(Ia(u,g))),o=o.current.alternate,o.flags|=65536,A&=-A,o.lanes|=A,y=Ia(y,g),A=Yd(o.stateNode,y,A),Sd(o,A),Bn!==4&&(Bn=2)),!1;var T=Error(n(520),{cause:y});if(T=Ia(T,g),Ul===null?Ul=[T]:Ul.push(T),Bn!==4&&(Bn=2),u===null)return!0;y=Ia(y,g),g=u;do{switch(g.tag){case 3:return g.flags|=65536,o=A&-A,g.lanes|=o,o=Yd(g.stateNode,y,o),Sd(g,o),!1;case 1:if(u=g.type,T=g.stateNode,(g.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Fo===null||!Fo.has(T))))return g.flags|=65536,A&=-A,g.lanes|=A,A=Ev(A),Cv(A,o,g,y),Sd(g,A),!1}g=g.return}while(g!==null);return!1}var Av=Error(n(461)),gr=!1;function Er(o,u,g,y){u.child=o===null?pv(u,null,g,y):yu(u,o.child,g,y)}function Sv(o,u,g,y,A){g=g.render;var T=u.ref;if("ref"in y){var P={};for(var j in y)j!=="ref"&&(P[j]=y[j])}else P=y;return As(u),y=Nd(o,u,g,P,T,A),j=Dd(),o!==null&&!gr?(Md(o,u,A),Yi(o,u,A)):(qt&&j&&dd(u),u.flags|=1,Er(o,u,y,A),u.child)}function _v(o,u,g,y,A){if(o===null){var T=g.type;return typeof T=="function"&&!cd(T)&&T.defaultProps===void 0&&g.compare===null?(u.tag=15,u.type=T,Tv(o,u,T,y,A)):(o=jc(g.type,null,y,u,u.mode,A),o.ref=u.ref,o.return=u,u.child=o)}if(T=o.child,!t0(o,A)){var P=T.memoizedProps;if(g=g.compare,g=g!==null?g:m,g(P,y)&&o.ref===u.ref)return Yi(o,u,A)}return u.flags|=1,o=zi(T,y),o.ref=u.ref,o.return=u,u.child=o}function Tv(o,u,g,y,A){if(o!==null){var T=o.memoizedProps;if(m(T,y)&&o.ref===u.ref)if(gr=!1,u.pendingProps=y=T,t0(o,A))(o.flags&131072)!==0&&(gr=!0);else return u.lanes=o.lanes,Yi(o,u,A)}return qd(o,u,g,y,A)}function Iv(o,u,g){var y=u.pendingProps,A=y.children,T=o!==null?o.memoizedState:null;if(y.mode==="hidden"){if((u.flags&128)!==0){if(y=T!==null?T.baseLanes|g:g,o!==null){for(A=u.child=o.child,T=0;A!==null;)T=T|A.lanes|A.childLanes,A=A.sibling;u.childLanes=T&~y}else u.childLanes=0,u.child=null;return Rv(o,u,y,g)}if((g&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},o!==null&&Zc(u,T!==null?T.cachePool:null),T!==null?Tg(u,T):Td(),gv(u);else return u.lanes=u.childLanes=536870912,Rv(o,u,T!==null?T.baseLanes|g:g,g)}else T!==null?(Zc(u,T.cachePool),Tg(u,T),Do(),u.memoizedState=null):(o!==null&&Zc(u,null),Td(),Do());return Er(o,u,A,g),u.child}function Rv(o,u,g,y){var A=wd();return A=A===null?null:{parent:rr._currentValue,pool:A},u.memoizedState={baseLanes:g,cachePool:A},o!==null&&Zc(u,null),Td(),gv(u),o!==null&&yl(o,u,y,!0),null}function pf(o,u){var g=u.ref;if(g===null)o!==null&&o.ref!==null&&(u.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(n(284));(o===null||o.ref!==g)&&(u.flags|=4194816)}}function qd(o,u,g,y,A){return As(u),g=Nd(o,u,g,y,void 0,A),y=Dd(),o!==null&&!gr?(Md(o,u,A),Yi(o,u,A)):(qt&&y&&dd(u),u.flags|=1,Er(o,u,g,A),u.child)}function Nv(o,u,g,y,A,T){return As(u),u.updateQueue=null,g=Rg(u,y,g,A),Ig(o),y=Dd(),o!==null&&!gr?(Md(o,u,T),Yi(o,u,T)):(qt&&y&&dd(u),u.flags|=1,Er(o,u,g,T),u.child)}function Dv(o,u,g,y,A){if(As(u),u.stateNode===null){var T=lu,P=g.contextType;typeof P=="object"&&P!==null&&(T=Or(P)),T=new g(y,T),u.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=Xd,u.stateNode=T,T._reactInternals=u,T=u.stateNode,T.props=y,T.state=u.memoizedState,T.refs={},Cd(u),P=g.contextType,T.context=typeof P=="object"&&P!==null?Or(P):lu,T.state=u.memoizedState,P=g.getDerivedStateFromProps,typeof P=="function"&&(jd(u,g,P,y),T.state=u.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(P=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),P!==T.state&&Xd.enqueueReplaceState(T,T.state,null),_l(u,y,T,A),Sl(),T.state=u.memoizedState),typeof T.componentDidMount=="function"&&(u.flags|=4194308),y=!0}else if(o===null){T=u.stateNode;var j=u.memoizedProps,ne=Ts(g,j);T.props=ne;var ve=T.context,Ne=g.contextType;P=lu,typeof Ne=="object"&&Ne!==null&&(P=Or(Ne));var Oe=g.getDerivedStateFromProps;Ne=typeof Oe=="function"||typeof T.getSnapshotBeforeUpdate=="function",j=u.pendingProps!==j,Ne||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(j||ve!==P)&&mv(u,T,y,P),_o=!1;var ye=u.memoizedState;T.state=ye,_l(u,y,T,A),Sl(),ve=u.memoizedState,j||ye!==ve||_o?(typeof Oe=="function"&&(jd(u,g,Oe,y),ve=u.memoizedState),(ne=_o||vv(u,g,ne,y,ye,ve,P))?(Ne||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(u.flags|=4194308)):(typeof T.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=y,u.memoizedState=ve),T.props=y,T.state=ve,T.context=P,y=ne):(typeof T.componentDidMount=="function"&&(u.flags|=4194308),y=!1)}else{T=u.stateNode,Ad(o,u),P=u.memoizedProps,Ne=Ts(g,P),T.props=Ne,Oe=u.pendingProps,ye=T.context,ve=g.contextType,ne=lu,typeof ve=="object"&&ve!==null&&(ne=Or(ve)),j=g.getDerivedStateFromProps,(ve=typeof j=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(P!==Oe||ye!==ne)&&mv(u,T,y,ne),_o=!1,ye=u.memoizedState,T.state=ye,_l(u,y,T,A),Sl();var we=u.memoizedState;P!==Oe||ye!==we||_o||o!==null&&o.dependencies!==null&&qc(o.dependencies)?(typeof j=="function"&&(jd(u,g,j,y),we=u.memoizedState),(Ne=_o||vv(u,g,Ne,y,ye,we,ne)||o!==null&&o.dependencies!==null&&qc(o.dependencies))?(ve||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(y,we,ne),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(y,we,ne)),typeof T.componentDidUpdate=="function"&&(u.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof T.componentDidUpdate!="function"||P===o.memoizedProps&&ye===o.memoizedState||(u.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||P===o.memoizedProps&&ye===o.memoizedState||(u.flags|=1024),u.memoizedProps=y,u.memoizedState=we),T.props=y,T.state=we,T.context=ne,y=Ne):(typeof T.componentDidUpdate!="function"||P===o.memoizedProps&&ye===o.memoizedState||(u.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||P===o.memoizedProps&&ye===o.memoizedState||(u.flags|=1024),y=!1)}return T=y,pf(o,u),y=(u.flags&128)!==0,T||y?(T=u.stateNode,g=y&&typeof g.getDerivedStateFromError!="function"?null:T.render(),u.flags|=1,o!==null&&y?(u.child=yu(u,o.child,null,A),u.child=yu(u,null,g,A)):Er(o,u,g,A),u.memoizedState=T.state,o=u.child):o=Yi(o,u,A),o}function Mv(o,u,g,y){return ml(),u.flags|=256,Er(o,u,g,y),u.child}var Kd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Zd(o){return{baseLanes:o,cachePool:yg()}}function Qd(o,u,g){return o=o!==null?o.childLanes&~g:0,u&&(o|=Oa),o}function Ov(o,u,g){var y=u.pendingProps,A=!1,T=(u.flags&128)!==0,P;if((P=T)||(P=o!==null&&o.memoizedState===null?!1:(ar.current&2)!==0),P&&(A=!0,u.flags&=-129),P=(u.flags&32)!==0,u.flags&=-33,o===null){if(qt){if(A?No(u):Do(),qt){var j=On,ne;if(ne=j){e:{for(ne=j,j=fi;ne.nodeType!==8;){if(!j){j=null;break e}if(ne=ja(ne.nextSibling),ne===null){j=null;break e}}j=ne}j!==null?(u.memoizedState={dehydrated:j,treeContext:ys!==null?{id:Hi,overflow:Vi}:null,retryLane:536870912,hydrationErrors:null},ne=ca(18,null,null,0),ne.stateNode=j,ne.return=u,u.child=ne,Xr=u,On=null,ne=!0):ne=!1}ne||Es(u)}if(j=u.memoizedState,j!==null&&(j=j.dehydrated,j!==null))return B0(j)?u.lanes=32:u.lanes=536870912,null;Xi(u)}return j=y.children,y=y.fallback,A?(Do(),A=u.mode,j=gf({mode:"hidden",children:j},A),y=xs(y,A,g,null),j.return=u,y.return=u,j.sibling=y,u.child=j,A=u.child,A.memoizedState=Zd(g),A.childLanes=Qd(o,P,g),u.memoizedState=Kd,y):(No(u),Jd(u,j))}if(ne=o.memoizedState,ne!==null&&(j=ne.dehydrated,j!==null)){if(T)u.flags&256?(No(u),u.flags&=-257,u=$d(o,u,g)):u.memoizedState!==null?(Do(),u.child=o.child,u.flags|=128,u=null):(Do(),A=y.fallback,j=u.mode,y=gf({mode:"visible",children:y.children},j),A=xs(A,j,g,null),A.flags|=2,y.return=u,A.return=u,y.sibling=A,u.child=y,yu(u,o.child,null,g),y=u.child,y.memoizedState=Zd(g),y.childLanes=Qd(o,P,g),u.memoizedState=Kd,u=A);else if(No(u),B0(j)){if(P=j.nextSibling&&j.nextSibling.dataset,P)var ve=P.dgst;P=ve,y=Error(n(419)),y.stack="",y.digest=P,xl({value:y,source:null,stack:null}),u=$d(o,u,g)}else if(gr||yl(o,u,g,!1),P=(g&o.childLanes)!==0,gr||P){if(P=gn,P!==null&&(y=g&-g,y=(y&42)!==0?1:ss(y),y=(y&(P.suspendedLanes|g))!==0?0:y,y!==0&&y!==ne.retryLane))throw ne.retryLane=y,uu(o,y),ga(P,o,y),Av;j.data==="$?"||m0(),u=$d(o,u,g)}else j.data==="$?"?(u.flags|=192,u.child=o.child,u=null):(o=ne.treeContext,On=ja(j.nextSibling),Xr=u,qt=!0,ws=null,fi=!1,o!==null&&(Na[Da++]=Hi,Na[Da++]=Vi,Na[Da++]=ys,Hi=o.id,Vi=o.overflow,ys=u),u=Jd(u,y.children),u.flags|=4096);return u}return A?(Do(),A=y.fallback,j=u.mode,ne=o.child,ve=ne.sibling,y=zi(ne,{mode:"hidden",children:y.children}),y.subtreeFlags=ne.subtreeFlags&65011712,ve!==null?A=zi(ve,A):(A=xs(A,j,g,null),A.flags|=2),A.return=u,y.return=u,y.sibling=A,u.child=y,y=A,A=u.child,j=o.child.memoizedState,j===null?j=Zd(g):(ne=j.cachePool,ne!==null?(ve=rr._currentValue,ne=ne.parent!==ve?{parent:ve,pool:ve}:ne):ne=yg(),j={baseLanes:j.baseLanes|g,cachePool:ne}),A.memoizedState=j,A.childLanes=Qd(o,P,g),u.memoizedState=Kd,y):(No(u),g=o.child,o=g.sibling,g=zi(g,{mode:"visible",children:y.children}),g.return=u,g.sibling=null,o!==null&&(P=u.deletions,P===null?(u.deletions=[o],u.flags|=16):P.push(o)),u.child=g,u.memoizedState=null,g)}function Jd(o,u){return u=gf({mode:"visible",children:u},o.mode),u.return=o,o.child=u}function gf(o,u){return o=ca(22,o,null,u),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function $d(o,u,g){return yu(u,o.child,null,g),o=Jd(u,u.pendingProps.children),o.flags|=2,u.memoizedState=null,o}function Bv(o,u,g){o.lanes|=u;var y=o.alternate;y!==null&&(y.lanes|=u),md(o.return,u,g)}function e0(o,u,g,y,A){var T=o.memoizedState;T===null?o.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:y,tail:g,tailMode:A}:(T.isBackwards=u,T.rendering=null,T.renderingStartTime=0,T.last=y,T.tail=g,T.tailMode=A)}function kv(o,u,g){var y=u.pendingProps,A=y.revealOrder,T=y.tail;if(Er(o,u,y.children,g),y=ar.current,(y&2)!==0)y=y&1|2,u.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=u.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Bv(o,g,u);else if(o.tag===19)Bv(o,g,u);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===u)break e;for(;o.sibling===null;){if(o.return===null||o.return===u)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}y&=1}switch(Te(ar,y),A){case"forwards":for(g=u.child,A=null;g!==null;)o=g.alternate,o!==null&&ff(o)===null&&(A=g),g=g.sibling;g=A,g===null?(A=u.child,u.child=null):(A=g.sibling,g.sibling=null),e0(u,!1,A,g,T);break;case"backwards":for(g=null,A=u.child,u.child=null;A!==null;){if(o=A.alternate,o!==null&&ff(o)===null){u.child=A;break}o=A.sibling,A.sibling=g,g=A,A=o}e0(u,!0,g,null,T);break;case"together":e0(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Yi(o,u,g){if(o!==null&&(u.dependencies=o.dependencies),Lo|=u.lanes,(g&u.childLanes)===0)if(o!==null){if(yl(o,u,g,!1),(g&u.childLanes)===0)return null}else return null;if(o!==null&&u.child!==o.child)throw Error(n(153));if(u.child!==null){for(o=u.child,g=zi(o,o.pendingProps),u.child=g,g.return=u;o.sibling!==null;)o=o.sibling,g=g.sibling=zi(o,o.pendingProps),g.return=u;g.sibling=null}return u.child}function t0(o,u){return(o.lanes&u)!==0?!0:(o=o.dependencies,!!(o!==null&&qc(o)))}function Pw(o,u,g){switch(u.tag){case 3:He(u,u.stateNode.containerInfo),So(u,rr,o.memoizedState.cache),ml();break;case 27:case 5:jt(u);break;case 4:He(u,u.stateNode.containerInfo);break;case 10:So(u,u.type,u.memoizedProps.value);break;case 13:var y=u.memoizedState;if(y!==null)return y.dehydrated!==null?(No(u),u.flags|=128,null):(g&u.child.childLanes)!==0?Ov(o,u,g):(No(u),o=Yi(o,u,g),o!==null?o.sibling:null);No(u);break;case 19:var A=(o.flags&128)!==0;if(y=(g&u.childLanes)!==0,y||(yl(o,u,g,!1),y=(g&u.childLanes)!==0),A){if(y)return kv(o,u,g);u.flags|=128}if(A=u.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),Te(ar,ar.current),y)break;return null;case 22:case 23:return u.lanes=0,Iv(o,u,g);case 24:So(u,rr,o.memoizedState.cache)}return Yi(o,u,g)}function Lv(o,u,g){if(o!==null)if(o.memoizedProps!==u.pendingProps)gr=!0;else{if(!t0(o,g)&&(u.flags&128)===0)return gr=!1,Pw(o,u,g);gr=(o.flags&131072)!==0}else gr=!1,qt&&(u.flags&1048576)!==0&&hg(u,Yc,u.index);switch(u.lanes=0,u.tag){case 16:e:{o=u.pendingProps;var y=u.elementType,A=y._init;if(y=A(y._payload),u.type=y,typeof y=="function")cd(y)?(o=Ts(y,o),u.tag=1,u=Dv(null,u,y,o,g)):(u.tag=0,u=qd(null,u,y,o,g));else{if(y!=null){if(A=y.$$typeof,A===L){u.tag=11,u=Sv(null,u,y,o,g);break e}else if(A===G){u.tag=14,u=_v(null,u,y,o,g);break e}}throw u=xe(y)||y,Error(n(306,u,""))}}return u;case 0:return qd(o,u,u.type,u.pendingProps,g);case 1:return y=u.type,A=Ts(y,u.pendingProps),Dv(o,u,y,A,g);case 3:e:{if(He(u,u.stateNode.containerInfo),o===null)throw Error(n(387));y=u.pendingProps;var T=u.memoizedState;A=T.element,Ad(o,u),_l(u,y,null,g);var P=u.memoizedState;if(y=P.cache,So(u,rr,y),y!==T.cache&&xd(u,[rr],g,!0),Sl(),y=P.element,T.isDehydrated)if(T={element:y,isDehydrated:!1,cache:P.cache},u.updateQueue.baseState=T,u.memoizedState=T,u.flags&256){u=Mv(o,u,y,g);break e}else if(y!==A){A=Ia(Error(n(424)),u),xl(A),u=Mv(o,u,y,g);break e}else{switch(o=u.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(On=ja(o.firstChild),Xr=u,qt=!0,ws=null,fi=!0,g=pv(u,null,y,g),u.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling}else{if(ml(),y===A){u=Yi(o,u,g);break e}Er(o,u,y,g)}u=u.child}return u;case 26:return pf(o,u),o===null?(g=zm(u.type,null,u.pendingProps,null))?u.memoizedState=g:qt||(g=u.type,o=u.pendingProps,y=Rf(Ie.current).createElement(g),y[hr]=u,y[Nn]=o,Ar(y,g,o),en(y),u.stateNode=y):u.memoizedState=zm(u.type,o.memoizedProps,u.pendingProps,o.memoizedState),null;case 27:return jt(u),o===null&&qt&&(y=u.stateNode=Fm(u.type,u.pendingProps,Ie.current),Xr=u,fi=!0,A=On,zo(u.type)?(k0=A,On=ja(y.firstChild)):On=A),Er(o,u,u.pendingProps.children,g),pf(o,u),o===null&&(u.flags|=4194304),u.child;case 5:return o===null&&qt&&((A=y=On)&&(y=hE(y,u.type,u.pendingProps,fi),y!==null?(u.stateNode=y,Xr=u,On=ja(y.firstChild),fi=!1,A=!0):A=!1),A||Es(u)),jt(u),A=u.type,T=u.pendingProps,P=o!==null?o.memoizedProps:null,y=T.children,D0(A,T)?y=null:P!==null&&D0(A,P)&&(u.flags|=32),u.memoizedState!==null&&(A=Nd(o,u,Nw,null,null,g),ql._currentValue=A),pf(o,u),Er(o,u,y,g),u.child;case 6:return o===null&&qt&&((o=g=On)&&(g=dE(g,u.pendingProps,fi),g!==null?(u.stateNode=g,Xr=u,On=null,o=!0):o=!1),o||Es(u)),null;case 13:return Ov(o,u,g);case 4:return He(u,u.stateNode.containerInfo),y=u.pendingProps,o===null?u.child=yu(u,null,y,g):Er(o,u,y,g),u.child;case 11:return Sv(o,u,u.type,u.pendingProps,g);case 7:return Er(o,u,u.pendingProps,g),u.child;case 8:return Er(o,u,u.pendingProps.children,g),u.child;case 12:return Er(o,u,u.pendingProps.children,g),u.child;case 10:return y=u.pendingProps,So(u,u.type,y.value),Er(o,u,y.children,g),u.child;case 9:return A=u.type._context,y=u.pendingProps.children,As(u),A=Or(A),y=y(A),u.flags|=1,Er(o,u,y,g),u.child;case 14:return _v(o,u,u.type,u.pendingProps,g);case 15:return Tv(o,u,u.type,u.pendingProps,g);case 19:return kv(o,u,g);case 31:return y=u.pendingProps,g=u.mode,y={mode:y.mode,children:y.children},o===null?(g=gf(y,g),g.ref=u.ref,u.child=g,g.return=u,u=g):(g=zi(o.child,y),g.ref=u.ref,u.child=g,g.return=u,u=g),u;case 22:return Iv(o,u,g);case 24:return As(u),y=Or(rr),o===null?(A=wd(),A===null&&(A=gn,T=yd(),A.pooledCache=T,T.refCount++,T!==null&&(A.pooledCacheLanes|=g),A=T),u.memoizedState={parent:y,cache:A},Cd(u),So(u,rr,A)):((o.lanes&g)!==0&&(Ad(o,u),_l(u,null,null,g),Sl()),A=o.memoizedState,T=u.memoizedState,A.parent!==y?(A={parent:y,cache:y},u.memoizedState=A,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=A),So(u,rr,y)):(y=T.cache,So(u,rr,y),y!==A.cache&&xd(u,[rr],g,!0))),Er(o,u,u.pendingProps.children,g),u.child;case 29:throw u.pendingProps}throw Error(n(156,u.tag))}function qi(o){o.flags|=4}function Fv(o,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!jm(u)){if(u=Ma.current,u!==null&&((Pt&4194048)===Pt?hi!==null:(Pt&62914560)!==Pt&&(Pt&536870912)===0||u!==hi))throw Cl=Ed,bg;o.flags|=8192}}function vf(o,u){u!==null&&(o.flags|=4),o.flags&16384&&(u=o.tag!==22?il():536870912,o.lanes|=u,Cu|=u)}function Ol(o,u){if(!qt)switch(o.tailMode){case"hidden":u=o.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?o.tail=null:g.sibling=null;break;case"collapsed":g=o.tail;for(var y=null;g!==null;)g.alternate!==null&&(y=g),g=g.sibling;y===null?u||o.tail===null?o.tail=null:o.tail.sibling=null:y.sibling=null}}function Sn(o){var u=o.alternate!==null&&o.alternate.child===o.child,g=0,y=0;if(u)for(var A=o.child;A!==null;)g|=A.lanes|A.childLanes,y|=A.subtreeFlags&65011712,y|=A.flags&65011712,A.return=o,A=A.sibling;else for(A=o.child;A!==null;)g|=A.lanes|A.childLanes,y|=A.subtreeFlags,y|=A.flags,A.return=o,A=A.sibling;return o.subtreeFlags|=y,o.childLanes=g,u}function Uw(o,u,g){var y=u.pendingProps;switch(pd(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sn(u),null;case 1:return Sn(u),null;case 3:return g=u.stateNode,y=null,o!==null&&(y=o.memoizedState.cache),u.memoizedState.cache!==y&&(u.flags|=2048),Gi(rr),ht(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(o===null||o.child===null)&&(vl(u)?qi(u):o===null||o.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,gg())),Sn(u),null;case 26:return g=u.memoizedState,o===null?(qi(u),g!==null?(Sn(u),Fv(u,g)):(Sn(u),u.flags&=-16777217)):g?g!==o.memoizedState?(qi(u),Sn(u),Fv(u,g)):(Sn(u),u.flags&=-16777217):(o.memoizedProps!==y&&qi(u),Sn(u),u.flags&=-16777217),null;case 27:it(u),g=Ie.current;var A=u.type;if(o!==null&&u.stateNode!=null)o.memoizedProps!==y&&qi(u);else{if(!y){if(u.stateNode===null)throw Error(n(166));return Sn(u),null}o=Le.current,vl(u)?dg(u):(o=Fm(A,y,g),u.stateNode=o,qi(u))}return Sn(u),null;case 5:if(it(u),g=u.type,o!==null&&u.stateNode!=null)o.memoizedProps!==y&&qi(u);else{if(!y){if(u.stateNode===null)throw Error(n(166));return Sn(u),null}if(o=Le.current,vl(u))dg(u);else{switch(A=Rf(Ie.current),o){case 1:o=A.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:o=A.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":o=A.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":o=A.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":o=A.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof y.is=="string"?A.createElement("select",{is:y.is}):A.createElement("select"),y.multiple?o.multiple=!0:y.size&&(o.size=y.size);break;default:o=typeof y.is=="string"?A.createElement(g,{is:y.is}):A.createElement(g)}}o[hr]=u,o[Nn]=y;e:for(A=u.child;A!==null;){if(A.tag===5||A.tag===6)o.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===u)break e;for(;A.sibling===null;){if(A.return===null||A.return===u)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}u.stateNode=o;e:switch(Ar(o,g,y),g){case"button":case"input":case"select":case"textarea":o=!!y.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&qi(u)}}return Sn(u),u.flags&=-16777217,null;case 6:if(o&&u.stateNode!=null)o.memoizedProps!==y&&qi(u);else{if(typeof y!="string"&&u.stateNode===null)throw Error(n(166));if(o=Ie.current,vl(u)){if(o=u.stateNode,g=u.memoizedProps,y=null,A=Xr,A!==null)switch(A.tag){case 27:case 5:y=A.memoizedProps}o[hr]=u,o=!!(o.nodeValue===g||y!==null&&y.suppressHydrationWarning===!0||Nm(o.nodeValue,g)),o||Es(u)}else o=Rf(o).createTextNode(y),o[hr]=u,u.stateNode=o}return Sn(u),null;case 13:if(y=u.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(A=vl(u),y!==null&&y.dehydrated!==null){if(o===null){if(!A)throw Error(n(318));if(A=u.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(n(317));A[hr]=u}else ml(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Sn(u),A=!1}else A=gg(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=A),A=!0;if(!A)return u.flags&256?(Xi(u),u):(Xi(u),null)}if(Xi(u),(u.flags&128)!==0)return u.lanes=g,u;if(g=y!==null,o=o!==null&&o.memoizedState!==null,g){y=u.child,A=null,y.alternate!==null&&y.alternate.memoizedState!==null&&y.alternate.memoizedState.cachePool!==null&&(A=y.alternate.memoizedState.cachePool.pool);var T=null;y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(T=y.memoizedState.cachePool.pool),T!==A&&(y.flags|=2048)}return g!==o&&g&&(u.child.flags|=8192),vf(u,u.updateQueue),Sn(u),null;case 4:return ht(),o===null&&_0(u.stateNode.containerInfo),Sn(u),null;case 10:return Gi(u.type),Sn(u),null;case 19:if(Ae(ar),A=u.memoizedState,A===null)return Sn(u),null;if(y=(u.flags&128)!==0,T=A.rendering,T===null)if(y)Ol(A,!1);else{if(Bn!==0||o!==null&&(o.flags&128)!==0)for(o=u.child;o!==null;){if(T=ff(o),T!==null){for(u.flags|=128,Ol(A,!1),o=T.updateQueue,u.updateQueue=o,vf(u,o),u.subtreeFlags=0,o=g,g=u.child;g!==null;)fg(g,o),g=g.sibling;return Te(ar,ar.current&1|2),u.child}o=o.sibling}A.tail!==null&&Ct()>yf&&(u.flags|=128,y=!0,Ol(A,!1),u.lanes=4194304)}else{if(!y)if(o=ff(T),o!==null){if(u.flags|=128,y=!0,o=o.updateQueue,u.updateQueue=o,vf(u,o),Ol(A,!0),A.tail===null&&A.tailMode==="hidden"&&!T.alternate&&!qt)return Sn(u),null}else 2*Ct()-A.renderingStartTime>yf&&g!==536870912&&(u.flags|=128,y=!0,Ol(A,!1),u.lanes=4194304);A.isBackwards?(T.sibling=u.child,u.child=T):(o=A.last,o!==null?o.sibling=T:u.child=T,A.last=T)}return A.tail!==null?(u=A.tail,A.rendering=u,A.tail=u.sibling,A.renderingStartTime=Ct(),u.sibling=null,o=ar.current,Te(ar,y?o&1|2:o&1),u):(Sn(u),null);case 22:case 23:return Xi(u),Id(),y=u.memoizedState!==null,o!==null?o.memoizedState!==null!==y&&(u.flags|=8192):y&&(u.flags|=8192),y?(g&536870912)!==0&&(u.flags&128)===0&&(Sn(u),u.subtreeFlags&6&&(u.flags|=8192)):Sn(u),g=u.updateQueue,g!==null&&vf(u,g.retryQueue),g=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==g&&(u.flags|=2048),o!==null&&Ae(Ss),null;case 24:return g=null,o!==null&&(g=o.memoizedState.cache),u.memoizedState.cache!==g&&(u.flags|=2048),Gi(rr),Sn(u),null;case 25:return null;case 30:return null}throw Error(n(156,u.tag))}function zw(o,u){switch(pd(u),u.tag){case 1:return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 3:return Gi(rr),ht(),o=u.flags,(o&65536)!==0&&(o&128)===0?(u.flags=o&-65537|128,u):null;case 26:case 27:case 5:return it(u),null;case 13:if(Xi(u),o=u.memoizedState,o!==null&&o.dehydrated!==null){if(u.alternate===null)throw Error(n(340));ml()}return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 19:return Ae(ar),null;case 4:return ht(),null;case 10:return Gi(u.type),null;case 22:case 23:return Xi(u),Id(),o!==null&&Ae(Ss),o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 24:return Gi(rr),null;case 25:return null;default:return null}}function Pv(o,u){switch(pd(u),u.tag){case 3:Gi(rr),ht();break;case 26:case 27:case 5:it(u);break;case 4:ht();break;case 13:Xi(u);break;case 19:Ae(ar);break;case 10:Gi(u.type);break;case 22:case 23:Xi(u),Id(),o!==null&&Ae(Ss);break;case 24:Gi(rr)}}function Bl(o,u){try{var g=u.updateQueue,y=g!==null?g.lastEffect:null;if(y!==null){var A=y.next;g=A;do{if((g.tag&o)===o){y=void 0;var T=g.create,P=g.inst;y=T(),P.destroy=y}g=g.next}while(g!==A)}}catch(j){dn(u,u.return,j)}}function Mo(o,u,g){try{var y=u.updateQueue,A=y!==null?y.lastEffect:null;if(A!==null){var T=A.next;y=T;do{if((y.tag&o)===o){var P=y.inst,j=P.destroy;if(j!==void 0){P.destroy=void 0,A=u;var ne=g,ve=j;try{ve()}catch(Ne){dn(A,ne,Ne)}}}y=y.next}while(y!==T)}}catch(Ne){dn(u,u.return,Ne)}}function Uv(o){var u=o.updateQueue;if(u!==null){var g=o.stateNode;try{_g(u,g)}catch(y){dn(o,o.return,y)}}}function zv(o,u,g){g.props=Ts(o.type,o.memoizedProps),g.state=o.memoizedState;try{g.componentWillUnmount()}catch(y){dn(o,u,y)}}function kl(o,u){try{var g=o.ref;if(g!==null){switch(o.tag){case 26:case 27:case 5:var y=o.stateNode;break;case 30:y=o.stateNode;break;default:y=o.stateNode}typeof g=="function"?o.refCleanup=g(y):g.current=y}}catch(A){dn(o,u,A)}}function di(o,u){var g=o.ref,y=o.refCleanup;if(g!==null)if(typeof y=="function")try{y()}catch(A){dn(o,u,A)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(A){dn(o,u,A)}else g.current=null}function Hv(o){var u=o.type,g=o.memoizedProps,y=o.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":g.autoFocus&&y.focus();break e;case"img":g.src?y.src=g.src:g.srcSet&&(y.srcset=g.srcSet)}}catch(A){dn(o,o.return,A)}}function n0(o,u,g){try{var y=o.stateNode;sE(y,o.type,g,u),y[Nn]=u}catch(A){dn(o,o.return,A)}}function Vv(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&zo(o.type)||o.tag===4}function r0(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Vv(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&zo(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function a0(o,u,g){var y=o.tag;if(y===5||y===6)o=o.stateNode,u?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(o,u):(u=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,u.appendChild(o),g=g._reactRootContainer,g!=null||u.onclick!==null||(u.onclick=If));else if(y!==4&&(y===27&&zo(o.type)&&(g=o.stateNode,u=null),o=o.child,o!==null))for(a0(o,u,g),o=o.sibling;o!==null;)a0(o,u,g),o=o.sibling}function mf(o,u,g){var y=o.tag;if(y===5||y===6)o=o.stateNode,u?g.insertBefore(o,u):g.appendChild(o);else if(y!==4&&(y===27&&zo(o.type)&&(g=o.stateNode),o=o.child,o!==null))for(mf(o,u,g),o=o.sibling;o!==null;)mf(o,u,g),o=o.sibling}function Wv(o){var u=o.stateNode,g=o.memoizedProps;try{for(var y=o.type,A=u.attributes;A.length;)u.removeAttributeNode(A[0]);Ar(u,y,g),u[hr]=o,u[Nn]=g}catch(T){dn(o,o.return,T)}}var Ki=!1,Gn=!1,i0=!1,Gv=typeof WeakSet=="function"?WeakSet:Set,vr=null;function Hw(o,u){if(o=o.containerInfo,R0=kf,o=I(o),O(o)){if("selectionStart"in o)var g={start:o.selectionStart,end:o.selectionEnd};else e:{g=(g=o.ownerDocument)&&g.defaultView||window;var y=g.getSelection&&g.getSelection();if(y&&y.rangeCount!==0){g=y.anchorNode;var A=y.anchorOffset,T=y.focusNode;y=y.focusOffset;try{g.nodeType,T.nodeType}catch{g=null;break e}var P=0,j=-1,ne=-1,ve=0,Ne=0,Oe=o,ye=null;t:for(;;){for(var we;Oe!==g||A!==0&&Oe.nodeType!==3||(j=P+A),Oe!==T||y!==0&&Oe.nodeType!==3||(ne=P+y),Oe.nodeType===3&&(P+=Oe.nodeValue.length),(we=Oe.firstChild)!==null;)ye=Oe,Oe=we;for(;;){if(Oe===o)break t;if(ye===g&&++ve===A&&(j=P),ye===T&&++Ne===y&&(ne=P),(we=Oe.nextSibling)!==null)break;Oe=ye,ye=Oe.parentNode}Oe=we}g=j===-1||ne===-1?null:{start:j,end:ne}}else g=null}g=g||{start:0,end:0}}else g=null;for(N0={focusedElem:o,selectionRange:g},kf=!1,vr=u;vr!==null;)if(u=vr,o=u.child,(u.subtreeFlags&1024)!==0&&o!==null)o.return=u,vr=o;else for(;vr!==null;){switch(u=vr,T=u.alternate,o=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&T!==null){o=void 0,g=u,A=T.memoizedProps,T=T.memoizedState,y=g.stateNode;try{var dt=Ts(g.type,A,g.elementType===g.type);o=y.getSnapshotBeforeUpdate(dt,T),y.__reactInternalSnapshotBeforeUpdate=o}catch(lt){dn(g,g.return,lt)}}break;case 3:if((o&1024)!==0){if(o=u.stateNode.containerInfo,g=o.nodeType,g===9)O0(o);else if(g===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":O0(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(n(163))}if(o=u.sibling,o!==null){o.return=u.return,vr=o;break}vr=u.return}}function jv(o,u,g){var y=g.flags;switch(g.tag){case 0:case 11:case 15:Oo(o,g),y&4&&Bl(5,g);break;case 1:if(Oo(o,g),y&4)if(o=g.stateNode,u===null)try{o.componentDidMount()}catch(P){dn(g,g.return,P)}else{var A=Ts(g.type,u.memoizedProps);u=u.memoizedState;try{o.componentDidUpdate(A,u,o.__reactInternalSnapshotBeforeUpdate)}catch(P){dn(g,g.return,P)}}y&64&&Uv(g),y&512&&kl(g,g.return);break;case 3:if(Oo(o,g),y&64&&(o=g.updateQueue,o!==null)){if(u=null,g.child!==null)switch(g.child.tag){case 27:case 5:u=g.child.stateNode;break;case 1:u=g.child.stateNode}try{_g(o,u)}catch(P){dn(g,g.return,P)}}break;case 27:u===null&&y&4&&Wv(g);case 26:case 5:Oo(o,g),u===null&&y&4&&Hv(g),y&512&&kl(g,g.return);break;case 12:Oo(o,g);break;case 13:Oo(o,g),y&4&&qv(o,g),y&64&&(o=g.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(g=Zw.bind(null,g),pE(o,g))));break;case 22:if(y=g.memoizedState!==null||Ki,!y){u=u!==null&&u.memoizedState!==null||Gn,A=Ki;var T=Gn;Ki=y,(Gn=u)&&!T?Bo(o,g,(g.subtreeFlags&8772)!==0):Oo(o,g),Ki=A,Gn=T}break;case 30:break;default:Oo(o,g)}}function Xv(o){var u=o.alternate;u!==null&&(o.alternate=null,Xv(u)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(u=o.stateNode,u!==null&&us(u)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var En=null,$r=!1;function Zi(o,u,g){for(g=g.child;g!==null;)Yv(o,u,g),g=g.sibling}function Yv(o,u,g){if(Cn&&typeof Cn.onCommitFiberUnmount=="function")try{Cn.onCommitFiberUnmount(Pn,g)}catch{}switch(g.tag){case 26:Gn||di(g,u),Zi(o,u,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:Gn||di(g,u);var y=En,A=$r;zo(g.type)&&(En=g.stateNode,$r=!1),Zi(o,u,g),Gl(g.stateNode),En=y,$r=A;break;case 5:Gn||di(g,u);case 6:if(y=En,A=$r,En=null,Zi(o,u,g),En=y,$r=A,En!==null)if($r)try{(En.nodeType===9?En.body:En.nodeName==="HTML"?En.ownerDocument.body:En).removeChild(g.stateNode)}catch(T){dn(g,u,T)}else try{En.removeChild(g.stateNode)}catch(T){dn(g,u,T)}break;case 18:En!==null&&($r?(o=En,km(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,g.stateNode),Jl(o)):km(En,g.stateNode));break;case 4:y=En,A=$r,En=g.stateNode.containerInfo,$r=!0,Zi(o,u,g),En=y,$r=A;break;case 0:case 11:case 14:case 15:Gn||Mo(2,g,u),Gn||Mo(4,g,u),Zi(o,u,g);break;case 1:Gn||(di(g,u),y=g.stateNode,typeof y.componentWillUnmount=="function"&&zv(g,u,y)),Zi(o,u,g);break;case 21:Zi(o,u,g);break;case 22:Gn=(y=Gn)||g.memoizedState!==null,Zi(o,u,g),Gn=y;break;default:Zi(o,u,g)}}function qv(o,u){if(u.memoizedState===null&&(o=u.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Jl(o)}catch(g){dn(u,u.return,g)}}function Vw(o){switch(o.tag){case 13:case 19:var u=o.stateNode;return u===null&&(u=o.stateNode=new Gv),u;case 22:return o=o.stateNode,u=o._retryCache,u===null&&(u=o._retryCache=new Gv),u;default:throw Error(n(435,o.tag))}}function o0(o,u){var g=Vw(o);u.forEach(function(y){var A=Qw.bind(null,o,y);g.has(y)||(g.add(y),y.then(A,A))})}function fa(o,u){var g=u.deletions;if(g!==null)for(var y=0;y<g.length;y++){var A=g[y],T=o,P=u,j=P;e:for(;j!==null;){switch(j.tag){case 27:if(zo(j.type)){En=j.stateNode,$r=!1;break e}break;case 5:En=j.stateNode,$r=!1;break e;case 3:case 4:En=j.stateNode.containerInfo,$r=!0;break e}j=j.return}if(En===null)throw Error(n(160));Yv(T,P,A),En=null,$r=!1,T=A.alternate,T!==null&&(T.return=null),A.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)Kv(u,o),u=u.sibling}var Ga=null;function Kv(o,u){var g=o.alternate,y=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:fa(u,o),ha(o),y&4&&(Mo(3,o,o.return),Bl(3,o),Mo(5,o,o.return));break;case 1:fa(u,o),ha(o),y&512&&(Gn||g===null||di(g,g.return)),y&64&&Ki&&(o=o.updateQueue,o!==null&&(y=o.callbacks,y!==null&&(g=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=g===null?y:g.concat(y))));break;case 26:var A=Ga;if(fa(u,o),ha(o),y&512&&(Gn||g===null||di(g,g.return)),y&4){var T=g!==null?g.memoizedState:null;if(y=o.memoizedState,g===null)if(y===null)if(o.stateNode===null){e:{y=o.type,g=o.memoizedProps,A=A.ownerDocument||A;t:switch(y){case"title":T=A.getElementsByTagName("title")[0],(!T||T[_a]||T[hr]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=A.createElement(y),A.head.insertBefore(T,A.querySelector("head > title"))),Ar(T,y,g),T[hr]=o,en(T),y=T;break e;case"link":var P=Wm("link","href",A).get(y+(g.href||""));if(P){for(var j=0;j<P.length;j++)if(T=P[j],T.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&T.getAttribute("rel")===(g.rel==null?null:g.rel)&&T.getAttribute("title")===(g.title==null?null:g.title)&&T.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){P.splice(j,1);break t}}T=A.createElement(y),Ar(T,y,g),A.head.appendChild(T);break;case"meta":if(P=Wm("meta","content",A).get(y+(g.content||""))){for(j=0;j<P.length;j++)if(T=P[j],T.getAttribute("content")===(g.content==null?null:""+g.content)&&T.getAttribute("name")===(g.name==null?null:g.name)&&T.getAttribute("property")===(g.property==null?null:g.property)&&T.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&T.getAttribute("charset")===(g.charSet==null?null:g.charSet)){P.splice(j,1);break t}}T=A.createElement(y),Ar(T,y,g),A.head.appendChild(T);break;default:throw Error(n(468,y))}T[hr]=o,en(T),y=T}o.stateNode=y}else Gm(A,o.type,o.stateNode);else o.stateNode=Vm(A,y,o.memoizedProps);else T!==y?(T===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):T.count--,y===null?Gm(A,o.type,o.stateNode):Vm(A,y,o.memoizedProps)):y===null&&o.stateNode!==null&&n0(o,o.memoizedProps,g.memoizedProps)}break;case 27:fa(u,o),ha(o),y&512&&(Gn||g===null||di(g,g.return)),g!==null&&y&4&&n0(o,o.memoizedProps,g.memoizedProps);break;case 5:if(fa(u,o),ha(o),y&512&&(Gn||g===null||di(g,g.return)),o.flags&32){A=o.stateNode;try{er(A,"")}catch(we){dn(o,o.return,we)}}y&4&&o.stateNode!=null&&(A=o.memoizedProps,n0(o,A,g!==null?g.memoizedProps:A)),y&1024&&(i0=!0);break;case 6:if(fa(u,o),ha(o),y&4){if(o.stateNode===null)throw Error(n(162));y=o.memoizedProps,g=o.stateNode;try{g.nodeValue=y}catch(we){dn(o,o.return,we)}}break;case 3:if(Mf=null,A=Ga,Ga=Nf(u.containerInfo),fa(u,o),Ga=A,ha(o),y&4&&g!==null&&g.memoizedState.isDehydrated)try{Jl(u.containerInfo)}catch(we){dn(o,o.return,we)}i0&&(i0=!1,Zv(o));break;case 4:y=Ga,Ga=Nf(o.stateNode.containerInfo),fa(u,o),ha(o),Ga=y;break;case 12:fa(u,o),ha(o);break;case 13:fa(u,o),ha(o),o.child.flags&8192&&o.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(h0=Ct()),y&4&&(y=o.updateQueue,y!==null&&(o.updateQueue=null,o0(o,y)));break;case 22:A=o.memoizedState!==null;var ne=g!==null&&g.memoizedState!==null,ve=Ki,Ne=Gn;if(Ki=ve||A,Gn=Ne||ne,fa(u,o),Gn=Ne,Ki=ve,ha(o),y&8192)e:for(u=o.stateNode,u._visibility=A?u._visibility&-2:u._visibility|1,A&&(g===null||ne||Ki||Gn||Is(o)),g=null,u=o;;){if(u.tag===5||u.tag===26){if(g===null){ne=g=u;try{if(T=ne.stateNode,A)P=T.style,typeof P.setProperty=="function"?P.setProperty("display","none","important"):P.display="none";else{j=ne.stateNode;var Oe=ne.memoizedProps.style,ye=Oe!=null&&Oe.hasOwnProperty("display")?Oe.display:null;j.style.display=ye==null||typeof ye=="boolean"?"":(""+ye).trim()}}catch(we){dn(ne,ne.return,we)}}}else if(u.tag===6){if(g===null){ne=u;try{ne.stateNode.nodeValue=A?"":ne.memoizedProps}catch(we){dn(ne,ne.return,we)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===o)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break e;for(;u.sibling===null;){if(u.return===null||u.return===o)break e;g===u&&(g=null),u=u.return}g===u&&(g=null),u.sibling.return=u.return,u=u.sibling}y&4&&(y=o.updateQueue,y!==null&&(g=y.retryQueue,g!==null&&(y.retryQueue=null,o0(o,g))));break;case 19:fa(u,o),ha(o),y&4&&(y=o.updateQueue,y!==null&&(o.updateQueue=null,o0(o,y)));break;case 30:break;case 21:break;default:fa(u,o),ha(o)}}function ha(o){var u=o.flags;if(u&2){try{for(var g,y=o.return;y!==null;){if(Vv(y)){g=y;break}y=y.return}if(g==null)throw Error(n(160));switch(g.tag){case 27:var A=g.stateNode,T=r0(o);mf(o,T,A);break;case 5:var P=g.stateNode;g.flags&32&&(er(P,""),g.flags&=-33);var j=r0(o);mf(o,j,P);break;case 3:case 4:var ne=g.stateNode.containerInfo,ve=r0(o);a0(o,ve,ne);break;default:throw Error(n(161))}}catch(Ne){dn(o,o.return,Ne)}o.flags&=-3}u&4096&&(o.flags&=-4097)}function Zv(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var u=o;Zv(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),o=o.sibling}}function Oo(o,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)jv(o,u.alternate,u),u=u.sibling}function Is(o){for(o=o.child;o!==null;){var u=o;switch(u.tag){case 0:case 11:case 14:case 15:Mo(4,u,u.return),Is(u);break;case 1:di(u,u.return);var g=u.stateNode;typeof g.componentWillUnmount=="function"&&zv(u,u.return,g),Is(u);break;case 27:Gl(u.stateNode);case 26:case 5:di(u,u.return),Is(u);break;case 22:u.memoizedState===null&&Is(u);break;case 30:Is(u);break;default:Is(u)}o=o.sibling}}function Bo(o,u,g){for(g=g&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var y=u.alternate,A=o,T=u,P=T.flags;switch(T.tag){case 0:case 11:case 15:Bo(A,T,g),Bl(4,T);break;case 1:if(Bo(A,T,g),y=T,A=y.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch(ve){dn(y,y.return,ve)}if(y=T,A=y.updateQueue,A!==null){var j=y.stateNode;try{var ne=A.shared.hiddenCallbacks;if(ne!==null)for(A.shared.hiddenCallbacks=null,A=0;A<ne.length;A++)Sg(ne[A],j)}catch(ve){dn(y,y.return,ve)}}g&&P&64&&Uv(T),kl(T,T.return);break;case 27:Wv(T);case 26:case 5:Bo(A,T,g),g&&y===null&&P&4&&Hv(T),kl(T,T.return);break;case 12:Bo(A,T,g);break;case 13:Bo(A,T,g),g&&P&4&&qv(A,T);break;case 22:T.memoizedState===null&&Bo(A,T,g),kl(T,T.return);break;case 30:break;default:Bo(A,T,g)}u=u.sibling}}function s0(o,u){var g=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),o=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(o=u.memoizedState.cachePool.pool),o!==g&&(o!=null&&o.refCount++,g!=null&&bl(g))}function u0(o,u){o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&bl(o))}function pi(o,u,g,y){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Qv(o,u,g,y),u=u.sibling}function Qv(o,u,g,y){var A=u.flags;switch(u.tag){case 0:case 11:case 15:pi(o,u,g,y),A&2048&&Bl(9,u);break;case 1:pi(o,u,g,y);break;case 3:pi(o,u,g,y),A&2048&&(o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&bl(o)));break;case 12:if(A&2048){pi(o,u,g,y),o=u.stateNode;try{var T=u.memoizedProps,P=T.id,j=T.onPostCommit;typeof j=="function"&&j(P,u.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(ne){dn(u,u.return,ne)}}else pi(o,u,g,y);break;case 13:pi(o,u,g,y);break;case 23:break;case 22:T=u.stateNode,P=u.alternate,u.memoizedState!==null?T._visibility&2?pi(o,u,g,y):Ll(o,u):T._visibility&2?pi(o,u,g,y):(T._visibility|=2,bu(o,u,g,y,(u.subtreeFlags&10256)!==0)),A&2048&&s0(P,u);break;case 24:pi(o,u,g,y),A&2048&&u0(u.alternate,u);break;default:pi(o,u,g,y)}}function bu(o,u,g,y,A){for(A=A&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var T=o,P=u,j=g,ne=y,ve=P.flags;switch(P.tag){case 0:case 11:case 15:bu(T,P,j,ne,A),Bl(8,P);break;case 23:break;case 22:var Ne=P.stateNode;P.memoizedState!==null?Ne._visibility&2?bu(T,P,j,ne,A):Ll(T,P):(Ne._visibility|=2,bu(T,P,j,ne,A)),A&&ve&2048&&s0(P.alternate,P);break;case 24:bu(T,P,j,ne,A),A&&ve&2048&&u0(P.alternate,P);break;default:bu(T,P,j,ne,A)}u=u.sibling}}function Ll(o,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var g=o,y=u,A=y.flags;switch(y.tag){case 22:Ll(g,y),A&2048&&s0(y.alternate,y);break;case 24:Ll(g,y),A&2048&&u0(y.alternate,y);break;default:Ll(g,y)}u=u.sibling}}var Fl=8192;function wu(o){if(o.subtreeFlags&Fl)for(o=o.child;o!==null;)Jv(o),o=o.sibling}function Jv(o){switch(o.tag){case 26:wu(o),o.flags&Fl&&o.memoizedState!==null&&TE(Ga,o.memoizedState,o.memoizedProps);break;case 5:wu(o);break;case 3:case 4:var u=Ga;Ga=Nf(o.stateNode.containerInfo),wu(o),Ga=u;break;case 22:o.memoizedState===null&&(u=o.alternate,u!==null&&u.memoizedState!==null?(u=Fl,Fl=16777216,wu(o),Fl=u):wu(o));break;default:wu(o)}}function $v(o){var u=o.alternate;if(u!==null&&(o=u.child,o!==null)){u.child=null;do u=o.sibling,o.sibling=null,o=u;while(o!==null)}}function Pl(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var g=0;g<u.length;g++){var y=u[g];vr=y,tm(y,o)}$v(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)em(o),o=o.sibling}function em(o){switch(o.tag){case 0:case 11:case 15:Pl(o),o.flags&2048&&Mo(9,o,o.return);break;case 3:Pl(o);break;case 12:Pl(o);break;case 22:var u=o.stateNode;o.memoizedState!==null&&u._visibility&2&&(o.return===null||o.return.tag!==13)?(u._visibility&=-3,xf(o)):Pl(o);break;default:Pl(o)}}function xf(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var g=0;g<u.length;g++){var y=u[g];vr=y,tm(y,o)}$v(o)}for(o=o.child;o!==null;){switch(u=o,u.tag){case 0:case 11:case 15:Mo(8,u,u.return),xf(u);break;case 22:g=u.stateNode,g._visibility&2&&(g._visibility&=-3,xf(u));break;default:xf(u)}o=o.sibling}}function tm(o,u){for(;vr!==null;){var g=vr;switch(g.tag){case 0:case 11:case 15:Mo(8,g,u);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var y=g.memoizedState.cachePool.pool;y!=null&&y.refCount++}break;case 24:bl(g.memoizedState.cache)}if(y=g.child,y!==null)y.return=g,vr=y;else e:for(g=o;vr!==null;){y=vr;var A=y.sibling,T=y.return;if(Xv(y),y===g){vr=null;break e}if(A!==null){A.return=T,vr=A;break e}vr=T}}}var Ww={getCacheForType:function(o){var u=Or(rr),g=u.data.get(o);return g===void 0&&(g=o(),u.data.set(o,g)),g}},Gw=typeof WeakMap=="function"?WeakMap:Map,rn=0,gn=null,Dt=null,Pt=0,an=0,da=null,ko=!1,Eu=!1,l0=!1,Qi=0,Bn=0,Lo=0,Rs=0,c0=0,Oa=0,Cu=0,Ul=null,ea=null,f0=!1,h0=0,yf=1/0,bf=null,Fo=null,Cr=0,Po=null,Au=null,Su=0,d0=0,p0=null,nm=null,zl=0,g0=null;function pa(){if((rn&2)!==0&&Pt!==0)return Pt&-Pt;if(te.T!==null){var o=hu;return o!==0?o:E0()}return Oi()}function rm(){Oa===0&&(Oa=(Pt&536870912)===0||qt?Ys():536870912);var o=Ma.current;return o!==null&&(o.flags|=32),Oa}function ga(o,u,g){(o===gn&&(an===2||an===9)||o.cancelPendingCommit!==null)&&(_u(o,0),Uo(o,Pt,Oa,!1)),oa(o,g),((rn&2)===0||o!==gn)&&(o===gn&&((rn&2)===0&&(Rs|=g),Bn===4&&Uo(o,Pt,Oa,!1)),gi(o))}function am(o,u,g){if((rn&6)!==0)throw Error(n(327));var y=!g&&(u&124)===0&&(u&o.expiredLanes)===0||un(o,u),A=y?Yw(o,u):x0(o,u,!0),T=y;do{if(A===0){Eu&&!y&&Uo(o,u,0,!1);break}else{if(g=o.current.alternate,T&&!jw(g)){A=x0(o,u,!1),T=!1;continue}if(A===2){if(T=u,o.errorRecoveryDisabledLanes&T)var P=0;else P=o.pendingLanes&-536870913,P=P!==0?P:P&536870912?536870912:0;if(P!==0){u=P;e:{var j=o;A=Ul;var ne=j.current.memoizedState.isDehydrated;if(ne&&(_u(j,P).flags|=256),P=x0(j,P,!1),P!==2){if(l0&&!ne){j.errorRecoveryDisabledLanes|=T,Rs|=T,A=4;break e}T=ea,ea=A,T!==null&&(ea===null?ea=T:ea.push.apply(ea,T))}A=P}if(T=!1,A!==2)continue}}if(A===1){_u(o,0),Uo(o,u,0,!0);break}e:{switch(y=o,T=A,T){case 0:case 1:throw Error(n(345));case 4:if((u&4194048)!==u)break;case 6:Uo(y,u,Oa,!ko);break e;case 2:ea=null;break;case 3:case 5:break;default:throw Error(n(329))}if((u&62914560)===u&&(A=h0+300-Ct(),10<A)){if(Uo(y,u,Oa,!ko),Vt(y,0,!0)!==0)break e;y.timeoutHandle=Om(im.bind(null,y,g,ea,bf,f0,u,Oa,Rs,Cu,ko,T,2,-0,0),A);break e}im(y,g,ea,bf,f0,u,Oa,Rs,Cu,ko,T,0,-0,0)}}break}while(!0);gi(o)}function im(o,u,g,y,A,T,P,j,ne,ve,Ne,Oe,ye,we){if(o.timeoutHandle=-1,Oe=u.subtreeFlags,(Oe&8192||(Oe&16785408)===16785408)&&(Yl={stylesheets:null,count:0,unsuspend:_E},Jv(u),Oe=IE(),Oe!==null)){o.cancelPendingCommit=Oe(hm.bind(null,o,u,T,g,y,A,P,j,ne,Ne,1,ye,we)),Uo(o,T,P,!ve);return}hm(o,u,T,g,y,A,P,j,ne)}function jw(o){for(var u=o;;){var g=u.tag;if((g===0||g===11||g===15)&&u.flags&16384&&(g=u.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var y=0;y<g.length;y++){var A=g[y],T=A.getSnapshot;A=A.value;try{if(!v(T(),A))return!1}catch{return!1}}if(g=u.child,u.subtreeFlags&16384&&g!==null)g.return=u,u=g;else{if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Uo(o,u,g,y){u&=~c0,u&=~Rs,o.suspendedLanes|=u,o.pingedLanes&=~u,y&&(o.warmLanes|=u),y=o.expirationTimes;for(var A=u;0<A;){var T=31-Ht(A),P=1<<T;y[T]=-1,A&=~P}g!==0&&ol(o,g,u)}function wf(){return(rn&6)===0?(Hl(0),!1):!0}function v0(){if(Dt!==null){if(an===0)var o=Dt.return;else o=Dt,Wi=Cs=null,Od(o),xu=null,Dl=0,o=Dt;for(;o!==null;)Pv(o.alternate,o),o=o.return;Dt=null}}function _u(o,u){var g=o.timeoutHandle;g!==-1&&(o.timeoutHandle=-1,lE(g)),g=o.cancelPendingCommit,g!==null&&(o.cancelPendingCommit=null,g()),v0(),gn=o,Dt=g=zi(o.current,null),Pt=u,an=0,da=null,ko=!1,Eu=un(o,u),l0=!1,Cu=Oa=c0=Rs=Lo=Bn=0,ea=Ul=null,f0=!1,(u&8)!==0&&(u|=u&32);var y=o.entangledLanes;if(y!==0)for(o=o.entanglements,y&=u;0<y;){var A=31-Ht(y),T=1<<A;u|=o[A],y&=~T}return Qi=u,Vc(),g}function om(o,u){_t=null,te.H=uf,u===El||u===Qc?(u=Cg(),an=3):u===bg?(u=Cg(),an=4):an=u===Av?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,da=u,Dt===null&&(Bn=1,df(o,Ia(u,o.current)))}function sm(){var o=te.H;return te.H=uf,o===null?uf:o}function um(){var o=te.A;return te.A=Ww,o}function m0(){Bn=4,ko||(Pt&4194048)!==Pt&&Ma.current!==null||(Eu=!0),(Lo&134217727)===0&&(Rs&134217727)===0||gn===null||Uo(gn,Pt,Oa,!1)}function x0(o,u,g){var y=rn;rn|=2;var A=sm(),T=um();(gn!==o||Pt!==u)&&(bf=null,_u(o,u)),u=!1;var P=Bn;e:do try{if(an!==0&&Dt!==null){var j=Dt,ne=da;switch(an){case 8:v0(),P=6;break e;case 3:case 2:case 9:case 6:Ma.current===null&&(u=!0);var ve=an;if(an=0,da=null,Tu(o,j,ne,ve),g&&Eu){P=0;break e}break;default:ve=an,an=0,da=null,Tu(o,j,ne,ve)}}Xw(),P=Bn;break}catch(Ne){om(o,Ne)}while(!0);return u&&o.shellSuspendCounter++,Wi=Cs=null,rn=y,te.H=A,te.A=T,Dt===null&&(gn=null,Pt=0,Vc()),P}function Xw(){for(;Dt!==null;)lm(Dt)}function Yw(o,u){var g=rn;rn|=2;var y=sm(),A=um();gn!==o||Pt!==u?(bf=null,yf=Ct()+500,_u(o,u)):Eu=un(o,u);e:do try{if(an!==0&&Dt!==null){u=Dt;var T=da;t:switch(an){case 1:an=0,da=null,Tu(o,u,T,1);break;case 2:case 9:if(wg(T)){an=0,da=null,cm(u);break}u=function(){an!==2&&an!==9||gn!==o||(an=7),gi(o)},T.then(u,u);break e;case 3:an=7;break e;case 4:an=5;break e;case 7:wg(T)?(an=0,da=null,cm(u)):(an=0,da=null,Tu(o,u,T,7));break;case 5:var P=null;switch(Dt.tag){case 26:P=Dt.memoizedState;case 5:case 27:var j=Dt;if(!P||jm(P)){an=0,da=null;var ne=j.sibling;if(ne!==null)Dt=ne;else{var ve=j.return;ve!==null?(Dt=ve,Ef(ve)):Dt=null}break t}}an=0,da=null,Tu(o,u,T,5);break;case 6:an=0,da=null,Tu(o,u,T,6);break;case 8:v0(),Bn=6;break e;default:throw Error(n(462))}}qw();break}catch(Ne){om(o,Ne)}while(!0);return Wi=Cs=null,te.H=y,te.A=A,rn=g,Dt!==null?0:(gn=null,Pt=0,Vc(),Bn)}function qw(){for(;Dt!==null&&!Bt();)lm(Dt)}function lm(o){var u=Lv(o.alternate,o,Qi);o.memoizedProps=o.pendingProps,u===null?Ef(o):Dt=u}function cm(o){var u=o,g=u.alternate;switch(u.tag){case 15:case 0:u=Nv(g,u,u.pendingProps,u.type,void 0,Pt);break;case 11:u=Nv(g,u,u.pendingProps,u.type.render,u.ref,Pt);break;case 5:Od(u);default:Pv(g,u),u=Dt=fg(u,Qi),u=Lv(g,u,Qi)}o.memoizedProps=o.pendingProps,u===null?Ef(o):Dt=u}function Tu(o,u,g,y){Wi=Cs=null,Od(u),xu=null,Dl=0;var A=u.return;try{if(Fw(o,A,u,g,Pt)){Bn=1,df(o,Ia(g,o.current)),Dt=null;return}}catch(T){if(A!==null)throw Dt=A,T;Bn=1,df(o,Ia(g,o.current)),Dt=null;return}u.flags&32768?(qt||y===1?o=!0:Eu||(Pt&536870912)!==0?o=!1:(ko=o=!0,(y===2||y===9||y===3||y===6)&&(y=Ma.current,y!==null&&y.tag===13&&(y.flags|=16384))),fm(u,o)):Ef(u)}function Ef(o){var u=o;do{if((u.flags&32768)!==0){fm(u,ko);return}o=u.return;var g=Uw(u.alternate,u,Qi);if(g!==null){Dt=g;return}if(u=u.sibling,u!==null){Dt=u;return}Dt=u=o}while(u!==null);Bn===0&&(Bn=5)}function fm(o,u){do{var g=zw(o.alternate,o);if(g!==null){g.flags&=32767,Dt=g;return}if(g=o.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!u&&(o=o.sibling,o!==null)){Dt=o;return}Dt=o=g}while(o!==null);Bn=6,Dt=null}function hm(o,u,g,y,A,T,P,j,ne){o.cancelPendingCommit=null;do Cf();while(Cr!==0);if((rn&6)!==0)throw Error(n(327));if(u!==null){if(u===o.current)throw Error(n(177));if(T=u.lanes|u.childLanes,T|=ud,Dc(o,g,T,P,j,ne),o===gn&&(Dt=gn=null,Pt=0),Au=u,Po=o,Su=g,d0=T,p0=A,nm=y,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,Jw(We,function(){return mm(),null})):(o.callbackNode=null,o.callbackPriority=0),y=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||y){y=te.T,te.T=null,A=re.p,re.p=2,P=rn,rn|=4;try{Hw(o,u,g)}finally{rn=P,re.p=A,te.T=y}}Cr=1,dm(),pm(),gm()}}function dm(){if(Cr===1){Cr=0;var o=Po,u=Au,g=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||g){g=te.T,te.T=null;var y=re.p;re.p=2;var A=rn;rn|=4;try{Kv(u,o);var T=N0,P=I(o.containerInfo),j=T.focusedElem,ne=T.selectionRange;if(P!==j&&j&&j.ownerDocument&&_(j.ownerDocument.documentElement,j)){if(ne!==null&&O(j)){var ve=ne.start,Ne=ne.end;if(Ne===void 0&&(Ne=ve),"selectionStart"in j)j.selectionStart=ve,j.selectionEnd=Math.min(Ne,j.value.length);else{var Oe=j.ownerDocument||document,ye=Oe&&Oe.defaultView||window;if(ye.getSelection){var we=ye.getSelection(),dt=j.textContent.length,lt=Math.min(ne.start,dt),fn=ne.end===void 0?lt:Math.min(ne.end,dt);!we.extend&&lt>fn&&(P=fn,fn=lt,lt=P);var ce=E(j,lt),ue=E(j,fn);if(ce&&ue&&(we.rangeCount!==1||we.anchorNode!==ce.node||we.anchorOffset!==ce.offset||we.focusNode!==ue.node||we.focusOffset!==ue.offset)){var ge=Oe.createRange();ge.setStart(ce.node,ce.offset),we.removeAllRanges(),lt>fn?(we.addRange(ge),we.extend(ue.node,ue.offset)):(ge.setEnd(ue.node,ue.offset),we.addRange(ge))}}}}for(Oe=[],we=j;we=we.parentNode;)we.nodeType===1&&Oe.push({element:we,left:we.scrollLeft,top:we.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<Oe.length;j++){var Me=Oe[j];Me.element.scrollLeft=Me.left,Me.element.scrollTop=Me.top}}kf=!!R0,N0=R0=null}finally{rn=A,re.p=y,te.T=g}}o.current=u,Cr=2}}function pm(){if(Cr===2){Cr=0;var o=Po,u=Au,g=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||g){g=te.T,te.T=null;var y=re.p;re.p=2;var A=rn;rn|=4;try{jv(o,u.alternate,u)}finally{rn=A,re.p=y,te.T=g}}Cr=3}}function gm(){if(Cr===4||Cr===3){Cr=0,Xt();var o=Po,u=Au,g=Su,y=nm;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?Cr=5:(Cr=0,Au=Po=null,vm(o,o.pendingLanes));var A=o.pendingLanes;if(A===0&&(Fo=null),Xn(g),u=u.stateNode,Cn&&typeof Cn.onCommitFiberRoot=="function")try{Cn.onCommitFiberRoot(Pn,u,void 0,(u.current.flags&128)===128)}catch{}if(y!==null){u=te.T,A=re.p,re.p=2,te.T=null;try{for(var T=o.onRecoverableError,P=0;P<y.length;P++){var j=y[P];T(j.value,{componentStack:j.stack})}}finally{te.T=u,re.p=A}}(Su&3)!==0&&Cf(),gi(o),A=o.pendingLanes,(g&4194090)!==0&&(A&42)!==0?o===g0?zl++:(zl=0,g0=o):zl=0,Hl(0)}}function vm(o,u){(o.pooledCacheLanes&=u)===0&&(u=o.pooledCache,u!=null&&(o.pooledCache=null,bl(u)))}function Cf(o){return dm(),pm(),gm(),mm()}function mm(){if(Cr!==5)return!1;var o=Po,u=d0;d0=0;var g=Xn(Su),y=te.T,A=re.p;try{re.p=32>g?32:g,te.T=null,g=p0,p0=null;var T=Po,P=Su;if(Cr=0,Au=Po=null,Su=0,(rn&6)!==0)throw Error(n(331));var j=rn;if(rn|=4,em(T.current),Qv(T,T.current,P,g),rn=j,Hl(0,!1),Cn&&typeof Cn.onPostCommitFiberRoot=="function")try{Cn.onPostCommitFiberRoot(Pn,T)}catch{}return!0}finally{re.p=A,te.T=y,vm(o,u)}}function xm(o,u,g){u=Ia(g,u),u=Yd(o.stateNode,u,2),o=Io(o,u,2),o!==null&&(oa(o,2),gi(o))}function dn(o,u,g){if(o.tag===3)xm(o,o,g);else for(;u!==null;){if(u.tag===3){xm(u,o,g);break}else if(u.tag===1){var y=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Fo===null||!Fo.has(y))){o=Ia(g,o),g=Ev(2),y=Io(u,g,2),y!==null&&(Cv(g,y,u,o),oa(y,2),gi(y));break}}u=u.return}}function y0(o,u,g){var y=o.pingCache;if(y===null){y=o.pingCache=new Gw;var A=new Set;y.set(u,A)}else A=y.get(u),A===void 0&&(A=new Set,y.set(u,A));A.has(g)||(l0=!0,A.add(g),o=Kw.bind(null,o,u,g),u.then(o,o))}function Kw(o,u,g){var y=o.pingCache;y!==null&&y.delete(u),o.pingedLanes|=o.suspendedLanes&g,o.warmLanes&=~g,gn===o&&(Pt&g)===g&&(Bn===4||Bn===3&&(Pt&62914560)===Pt&&300>Ct()-h0?(rn&2)===0&&_u(o,0):c0|=g,Cu===Pt&&(Cu=0)),gi(o)}function ym(o,u){u===0&&(u=il()),o=uu(o,u),o!==null&&(oa(o,u),gi(o))}function Zw(o){var u=o.memoizedState,g=0;u!==null&&(g=u.retryLane),ym(o,g)}function Qw(o,u){var g=0;switch(o.tag){case 13:var y=o.stateNode,A=o.memoizedState;A!==null&&(g=A.retryLane);break;case 19:y=o.stateNode;break;case 22:y=o.stateNode._retryCache;break;default:throw Error(n(314))}y!==null&&y.delete(u),ym(o,g)}function Jw(o,u){return Ye(o,u)}var Af=null,Iu=null,b0=!1,Sf=!1,w0=!1,Ns=0;function gi(o){o!==Iu&&o.next===null&&(Iu===null?Af=Iu=o:Iu=Iu.next=o),Sf=!0,b0||(b0=!0,eE())}function Hl(o,u){if(!w0&&Sf){w0=!0;do for(var g=!1,y=Af;y!==null;){if(o!==0){var A=y.pendingLanes;if(A===0)var T=0;else{var P=y.suspendedLanes,j=y.pingedLanes;T=(1<<31-Ht(42|o)+1)-1,T&=A&~(P&~j),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(g=!0,Cm(y,T))}else T=Pt,T=Vt(y,y===gn?T:0,y.cancelPendingCommit!==null||y.timeoutHandle!==-1),(T&3)===0||un(y,T)||(g=!0,Cm(y,T));y=y.next}while(g);w0=!1}}function $w(){bm()}function bm(){Sf=b0=!1;var o=0;Ns!==0&&(uE()&&(o=Ns),Ns=0);for(var u=Ct(),g=null,y=Af;y!==null;){var A=y.next,T=wm(y,u);T===0?(y.next=null,g===null?Af=A:g.next=A,A===null&&(Iu=g)):(g=y,(o!==0||(T&3)!==0)&&(Sf=!0)),y=A}Hl(o)}function wm(o,u){for(var g=o.suspendedLanes,y=o.pingedLanes,A=o.expirationTimes,T=o.pendingLanes&-62914561;0<T;){var P=31-Ht(T),j=1<<P,ne=A[P];ne===-1?((j&g)===0||(j&y)!==0)&&(A[P]=os(j,u)):ne<=u&&(o.expiredLanes|=j),T&=~j}if(u=gn,g=Pt,g=Vt(o,o===u?g:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),y=o.callbackNode,g===0||o===u&&(an===2||an===9)||o.cancelPendingCommit!==null)return y!==null&&y!==null&&zt(y),o.callbackNode=null,o.callbackPriority=0;if((g&3)===0||un(o,g)){if(u=g&-g,u===o.callbackPriority)return u;switch(y!==null&&zt(y),Xn(g)){case 2:case 8:g=Yr;break;case 32:g=We;break;case 268435456:g=Vr;break;default:g=We}return y=Em.bind(null,o),g=Ye(g,y),o.callbackPriority=u,o.callbackNode=g,u}return y!==null&&y!==null&&zt(y),o.callbackPriority=2,o.callbackNode=null,2}function Em(o,u){if(Cr!==0&&Cr!==5)return o.callbackNode=null,o.callbackPriority=0,null;var g=o.callbackNode;if(Cf()&&o.callbackNode!==g)return null;var y=Pt;return y=Vt(o,o===gn?y:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),y===0?null:(am(o,y,u),wm(o,Ct()),o.callbackNode!=null&&o.callbackNode===g?Em.bind(null,o):null)}function Cm(o,u){if(Cf())return null;am(o,u,!0)}function eE(){cE(function(){(rn&6)!==0?Ye(ct,$w):bm()})}function E0(){return Ns===0&&(Ns=Ys()),Ns}function Am(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:$s(""+o)}function Sm(o,u){var g=u.ownerDocument.createElement("input");return g.name=u.name,g.value=u.value,o.id&&g.setAttribute("form",o.id),u.parentNode.insertBefore(g,u),o=new FormData(o),g.parentNode.removeChild(g),o}function tE(o,u,g,y,A){if(u==="submit"&&g&&g.stateNode===A){var T=Am((A[Nn]||null).action),P=y.submitter;P&&(u=(u=P[Nn]||null)?Am(u.formAction):P.getAttribute("formAction"),u!==null&&(T=u,P=null));var j=new si("action","action",null,y,A);o.push({event:j,listeners:[{instance:null,listener:function(){if(y.defaultPrevented){if(Ns!==0){var ne=P?Sm(A,P):new FormData(A);Vd(g,{pending:!0,data:ne,method:A.method,action:T},null,ne)}}else typeof T=="function"&&(j.preventDefault(),ne=P?Sm(A,P):new FormData(A),Vd(g,{pending:!0,data:ne,method:A.method,action:T},T,ne))},currentTarget:A}]})}}for(var C0=0;C0<ci.length;C0++){var A0=ci[C0],nE=A0.toLowerCase(),rE=A0[0].toUpperCase()+A0.slice(1);la(nE,"on"+rE)}la(gt,"onAnimationEnd"),la(wr,"onAnimationIteration"),la(Qr,"onAnimationStart"),la("dblclick","onDoubleClick"),la("focusin","onFocus"),la("focusout","onBlur"),la(Dr,"onTransitionRun"),la(nn,"onTransitionStart"),la(nr,"onTransitionCancel"),la(Mr,"onTransitionEnd"),Dn("onMouseEnter",["mouseout","mouseover"]),Dn("onMouseLeave",["mouseout","mouseover"]),Dn("onPointerEnter",["pointerout","pointerover"]),Dn("onPointerLeave",["pointerout","pointerover"]),pr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),pr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),pr("onBeforeInput",["compositionend","keypress","textInput","paste"]),pr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),pr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),pr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vl));function _m(o,u){u=(u&4)!==0;for(var g=0;g<o.length;g++){var y=o[g],A=y.event;y=y.listeners;e:{var T=void 0;if(u)for(var P=y.length-1;0<=P;P--){var j=y[P],ne=j.instance,ve=j.currentTarget;if(j=j.listener,ne!==T&&A.isPropagationStopped())break e;T=j,A.currentTarget=ve;try{T(A)}catch(Ne){hf(Ne)}A.currentTarget=null,T=ne}else for(P=0;P<y.length;P++){if(j=y[P],ne=j.instance,ve=j.currentTarget,j=j.listener,ne!==T&&A.isPropagationStopped())break e;T=j,A.currentTarget=ve;try{T(A)}catch(Ne){hf(Ne)}A.currentTarget=null,T=ne}}}}function Mt(o,u){var g=u[dr];g===void 0&&(g=u[dr]=new Set);var y=o+"__bubble";g.has(y)||(Tm(u,o,2,!1),g.add(y))}function S0(o,u,g){var y=0;u&&(y|=4),Tm(g,o,y,u)}var _f="_reactListening"+Math.random().toString(36).slice(2);function _0(o){if(!o[_f]){o[_f]=!0,Mc.forEach(function(g){g!=="selectionchange"&&(aE.has(g)||S0(g,!1,o),S0(g,!0,o))});var u=o.nodeType===9?o:o.ownerDocument;u===null||u[_f]||(u[_f]=!0,S0("selectionchange",!1,u))}}function Tm(o,u,g,y){switch(Qm(u)){case 2:var A=DE;break;case 8:A=ME;break;default:A=z0}g=A.bind(null,u,g,o),A=void 0,!mt||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(A=!0),y?A!==void 0?o.addEventListener(u,g,{capture:!0,passive:A}):o.addEventListener(u,g,!0):A!==void 0?o.addEventListener(u,g,{passive:A}):o.addEventListener(u,g,!1)}function T0(o,u,g,y,A){var T=y;if((u&1)===0&&(u&2)===0&&y!==null)e:for(;;){if(y===null)return;var P=y.tag;if(P===3||P===4){var j=y.stateNode.containerInfo;if(j===A)break;if(P===4)for(P=y.return;P!==null;){var ne=P.tag;if((ne===3||ne===4)&&P.stateNode.containerInfo===A)return;P=P.return}for(;j!==null;){if(P=Un(j),P===null)return;if(ne=P.tag,ne===5||ne===6||ne===26||ne===27){y=T=P;continue e}j=j.parentNode}}y=y.return}Ha(function(){var ve=T,Ne=po(g),Oe=[];e:{var ye=Ui.get(o);if(ye!==void 0){var we=si,dt=o;switch(o){case"keypress":if(eu(g)===0)break e;case"keydown":case"keyup":we=cl;break;case"focusin":dt="focus",we=xo;break;case"focusout":dt="blur",we=xo;break;case"beforeblur":case"afterblur":we=xo;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=Lc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=Qt;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=tn;break;case gt:case wr:case Qr:we=ed;break;case Mr:we=ad;break;case"scroll":case"scrollend":we=Rr;break;case"wheel":we=Fi;break;case"copy":case"cut":case"paste":we=bt;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=ps;break;case"toggle":case"beforetoggle":we=id}var lt=(u&4)!==0,fn=!lt&&(o==="scroll"||o==="scrollend"),ce=lt?ye!==null?ye+"Capture":null:ye;lt=[];for(var ue=ve,ge;ue!==null;){var Me=ue;if(ge=Me.stateNode,Me=Me.tag,Me!==5&&Me!==26&&Me!==27||ge===null||ce===null||(Me=ot(ue,ce),Me!=null&&lt.push(Wl(ue,Me,ge))),fn)break;ue=ue.return}0<lt.length&&(ye=new we(ye,dt,null,g,Ne),Oe.push({event:ye,listeners:lt}))}}if((u&7)===0){e:{if(ye=o==="mouseover"||o==="pointerover",we=o==="mouseout"||o==="pointerout",ye&&g!==ls&&(dt=g.relatedTarget||g.fromElement)&&(Un(dt)||dt[Ja]))break e;if((we||ye)&&(ye=Ne.window===Ne?Ne:(ye=Ne.ownerDocument)?ye.defaultView||ye.parentWindow:window,we?(dt=g.relatedTarget||g.toElement,we=ve,dt=dt?Un(dt):null,dt!==null&&(fn=i(dt),lt=dt.tag,dt!==fn||lt!==5&&lt!==27&&lt!==6)&&(dt=null)):(we=null,dt=ve),we!==dt)){if(lt=Lc,Me="onMouseLeave",ce="onMouseEnter",ue="mouse",(o==="pointerout"||o==="pointerover")&&(lt=ps,Me="onPointerLeave",ce="onPointerEnter",ue="pointer"),fn=we==null?ye:$a(we),ge=dt==null?ye:$a(dt),ye=new lt(Me,ue+"leave",we,g,Ne),ye.target=fn,ye.relatedTarget=ge,Me=null,Un(Ne)===ve&&(lt=new lt(ce,ue+"enter",dt,g,Ne),lt.target=ge,lt.relatedTarget=fn,Me=lt),fn=Me,we&&dt)t:{for(lt=we,ce=dt,ue=0,ge=lt;ge;ge=Ru(ge))ue++;for(ge=0,Me=ce;Me;Me=Ru(Me))ge++;for(;0<ue-ge;)lt=Ru(lt),ue--;for(;0<ge-ue;)ce=Ru(ce),ge--;for(;ue--;){if(lt===ce||ce!==null&&lt===ce.alternate)break t;lt=Ru(lt),ce=Ru(ce)}lt=null}else lt=null;we!==null&&Im(Oe,ye,we,lt,!1),dt!==null&&fn!==null&&Im(Oe,fn,dt,lt,!0)}}e:{if(ye=ve?$a(ve):window,we=ye.nodeName&&ye.nodeName.toLowerCase(),we==="select"||we==="input"&&ye.type==="file")var Ke=zc;else if(ms(ye))if(pl)Ke=l;else{Ke=U;var Tt=ou}else we=ye.nodeName,!we||we.toLowerCase()!=="input"||ye.type!=="checkbox"&&ye.type!=="radio"?ve&&rt(ve.elementType)&&(Ke=zc):Ke=s;if(Ke&&(Ke=Ke(o,ve))){jr(Oe,Ke,g,Ne);break e}Tt&&Tt(o,ye,ve),o==="focusout"&&ve&&ye.type==="number"&&ve.memoizedProps.value!=null&&pe(ye,"number",ye.value)}switch(Tt=ve?$a(ve):window,o){case"focusin":(ms(Tt)||Tt.contentEditable==="true")&&(V=Tt,Q=ve,ae=null);break;case"focusout":ae=Q=V=null;break;case"mousedown":se=!0;break;case"contextmenu":case"mouseup":case"dragend":se=!1,de(Oe,g,Ne);break;case"selectionchange":if(z)break;case"keydown":case"keyup":de(Oe,g,Ne)}var at;if(gs)e:{switch(o){case"compositionstart":var ft="onCompositionStart";break e;case"compositionend":ft="onCompositionEnd";break e;case"compositionupdate":ft="onCompositionUpdate";break e}ft=void 0}else wo?Pi(o,g)&&(ft="onCompositionEnd"):o==="keydown"&&g.keyCode===229&&(ft="onCompositionStart");ft&&(hl&&g.locale!=="ko"&&(wo||ft!=="onCompositionStart"?ft==="onCompositionEnd"&&wo&&(at=ai()):(ri=Ne,cs="value"in ri?ri.value:ri.textContent,wo=!0)),Tt=Tf(ve,ft),0<Tt.length&&(ft=new hs(ft,o,null,g,Ne),Oe.push({event:ft,listeners:Tt}),at?ft.data=at:(at=au(g),at!==null&&(ft.data=at)))),(at=fl?vs(o,g):od(o,g))&&(ft=Tf(ve,"onBeforeInput"),0<ft.length&&(Tt=new hs("onBeforeInput","beforeinput",null,g,Ne),Oe.push({event:Tt,listeners:ft}),Tt.data=at)),tE(Oe,o,ve,g,Ne)}_m(Oe,u)})}function Wl(o,u,g){return{instance:o,listener:u,currentTarget:g}}function Tf(o,u){for(var g=u+"Capture",y=[];o!==null;){var A=o,T=A.stateNode;if(A=A.tag,A!==5&&A!==26&&A!==27||T===null||(A=ot(o,g),A!=null&&y.unshift(Wl(o,A,T)),A=ot(o,u),A!=null&&y.push(Wl(o,A,T))),o.tag===3)return y;o=o.return}return[]}function Ru(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function Im(o,u,g,y,A){for(var T=u._reactName,P=[];g!==null&&g!==y;){var j=g,ne=j.alternate,ve=j.stateNode;if(j=j.tag,ne!==null&&ne===y)break;j!==5&&j!==26&&j!==27||ve===null||(ne=ve,A?(ve=ot(g,T),ve!=null&&P.unshift(Wl(g,ve,ne))):A||(ve=ot(g,T),ve!=null&&P.push(Wl(g,ve,ne)))),g=g.return}P.length!==0&&o.push({event:u,listeners:P})}var iE=/\r\n?/g,oE=/\u0000|\uFFFD/g;function Rm(o){return(typeof o=="string"?o:""+o).replace(iE,`
`).replace(oE,"")}function Nm(o,u){return u=Rm(u),Rm(o)===u}function If(){}function cn(o,u,g,y,A,T){switch(g){case"children":typeof y=="string"?u==="body"||u==="textarea"&&y===""||er(o,y):(typeof y=="number"||typeof y=="bigint")&&u!=="body"&&er(o,""+y);break;case"className":Ks(o,"class",y);break;case"tabIndex":Ks(o,"tabindex",y);break;case"dir":case"role":case"viewBox":case"width":case"height":Ks(o,g,y);break;case"style":Gr(o,y,T);break;case"data":if(u!=="object"){Ks(o,"data",y);break}case"src":case"href":if(y===""&&(u!=="a"||g!=="href")){o.removeAttribute(g);break}if(y==null||typeof y=="function"||typeof y=="symbol"||typeof y=="boolean"){o.removeAttribute(g);break}y=$s(""+y),o.setAttribute(g,y);break;case"action":case"formAction":if(typeof y=="function"){o.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(g==="formAction"?(u!=="input"&&cn(o,u,"name",A.name,A,null),cn(o,u,"formEncType",A.formEncType,A,null),cn(o,u,"formMethod",A.formMethod,A,null),cn(o,u,"formTarget",A.formTarget,A,null)):(cn(o,u,"encType",A.encType,A,null),cn(o,u,"method",A.method,A,null),cn(o,u,"target",A.target,A,null)));if(y==null||typeof y=="symbol"||typeof y=="boolean"){o.removeAttribute(g);break}y=$s(""+y),o.setAttribute(g,y);break;case"onClick":y!=null&&(o.onclick=If);break;case"onScroll":y!=null&&Mt("scroll",o);break;case"onScrollEnd":y!=null&&Mt("scrollend",o);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(n(61));if(g=y.__html,g!=null){if(A.children!=null)throw Error(n(60));o.innerHTML=g}}break;case"multiple":o.multiple=y&&typeof y!="function"&&typeof y!="symbol";break;case"muted":o.muted=y&&typeof y!="function"&&typeof y!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(y==null||typeof y=="function"||typeof y=="boolean"||typeof y=="symbol"){o.removeAttribute("xlink:href");break}g=$s(""+y),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":y!=null&&typeof y!="function"&&typeof y!="symbol"?o.setAttribute(g,""+y):o.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":y&&typeof y!="function"&&typeof y!="symbol"?o.setAttribute(g,""):o.removeAttribute(g);break;case"capture":case"download":y===!0?o.setAttribute(g,""):y!==!1&&y!=null&&typeof y!="function"&&typeof y!="symbol"?o.setAttribute(g,y):o.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":y!=null&&typeof y!="function"&&typeof y!="symbol"&&!isNaN(y)&&1<=y?o.setAttribute(g,y):o.removeAttribute(g);break;case"rowSpan":case"start":y==null||typeof y=="function"||typeof y=="symbol"||isNaN(y)?o.removeAttribute(g):o.setAttribute(g,y);break;case"popover":Mt("beforetoggle",o),Mt("toggle",o),Be(o,"popover",y);break;case"xlinkActuate":Wt(o,"http://www.w3.org/1999/xlink","xlink:actuate",y);break;case"xlinkArcrole":Wt(o,"http://www.w3.org/1999/xlink","xlink:arcrole",y);break;case"xlinkRole":Wt(o,"http://www.w3.org/1999/xlink","xlink:role",y);break;case"xlinkShow":Wt(o,"http://www.w3.org/1999/xlink","xlink:show",y);break;case"xlinkTitle":Wt(o,"http://www.w3.org/1999/xlink","xlink:title",y);break;case"xlinkType":Wt(o,"http://www.w3.org/1999/xlink","xlink:type",y);break;case"xmlBase":Wt(o,"http://www.w3.org/XML/1998/namespace","xml:base",y);break;case"xmlLang":Wt(o,"http://www.w3.org/XML/1998/namespace","xml:lang",y);break;case"xmlSpace":Wt(o,"http://www.w3.org/XML/1998/namespace","xml:space",y);break;case"is":Be(o,"is",y);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=mn.get(g)||g,Be(o,g,y))}}function I0(o,u,g,y,A,T){switch(g){case"style":Gr(o,y,T);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(n(61));if(g=y.__html,g!=null){if(A.children!=null)throw Error(n(60));o.innerHTML=g}}break;case"children":typeof y=="string"?er(o,y):(typeof y=="number"||typeof y=="bigint")&&er(o,""+y);break;case"onScroll":y!=null&&Mt("scroll",o);break;case"onScrollEnd":y!=null&&Mt("scrollend",o);break;case"onClick":y!=null&&(o.onclick=If);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Oc.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(A=g.endsWith("Capture"),u=g.slice(2,A?g.length-7:void 0),T=o[Nn]||null,T=T!=null?T[g]:null,typeof T=="function"&&o.removeEventListener(u,T,A),typeof y=="function")){typeof T!="function"&&T!==null&&(g in o?o[g]=null:o.hasAttribute(g)&&o.removeAttribute(g)),o.addEventListener(u,y,A);break e}g in o?o[g]=y:y===!0?o.setAttribute(g,""):Be(o,g,y)}}}function Ar(o,u,g){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Mt("error",o),Mt("load",o);var y=!1,A=!1,T;for(T in g)if(g.hasOwnProperty(T)){var P=g[T];if(P!=null)switch(T){case"src":y=!0;break;case"srcSet":A=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:cn(o,u,T,P,g,null)}}A&&cn(o,u,"srcSet",g.srcSet,g,null),y&&cn(o,u,"src",g.src,g,null);return;case"input":Mt("invalid",o);var j=T=P=A=null,ne=null,ve=null;for(y in g)if(g.hasOwnProperty(y)){var Ne=g[y];if(Ne!=null)switch(y){case"name":A=Ne;break;case"type":P=Ne;break;case"checked":ne=Ne;break;case"defaultChecked":ve=Ne;break;case"value":T=Ne;break;case"defaultValue":j=Ne;break;case"children":case"dangerouslySetInnerHTML":if(Ne!=null)throw Error(n(137,u));break;default:cn(o,u,y,Ne,g,null)}}$n(o,T,j,ne,ve,P,A,!1),Qs(o);return;case"select":Mt("invalid",o),y=P=T=null;for(A in g)if(g.hasOwnProperty(A)&&(j=g[A],j!=null))switch(A){case"value":T=j;break;case"defaultValue":P=j;break;case"multiple":y=j;default:cn(o,u,A,j,g,null)}u=T,g=P,o.multiple=!!y,u!=null?K(o,!!y,u,!1):g!=null&&K(o,!!y,g,!0);return;case"textarea":Mt("invalid",o),T=A=y=null;for(P in g)if(g.hasOwnProperty(P)&&(j=g[P],j!=null))switch(P){case"value":y=j;break;case"defaultValue":A=j;break;case"children":T=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(n(91));break;default:cn(o,u,P,j,g,null)}zn(o,y,A,T),Qs(o);return;case"option":for(ne in g)if(g.hasOwnProperty(ne)&&(y=g[ne],y!=null))switch(ne){case"selected":o.selected=y&&typeof y!="function"&&typeof y!="symbol";break;default:cn(o,u,ne,y,g,null)}return;case"dialog":Mt("beforetoggle",o),Mt("toggle",o),Mt("cancel",o),Mt("close",o);break;case"iframe":case"object":Mt("load",o);break;case"video":case"audio":for(y=0;y<Vl.length;y++)Mt(Vl[y],o);break;case"image":Mt("error",o),Mt("load",o);break;case"details":Mt("toggle",o);break;case"embed":case"source":case"link":Mt("error",o),Mt("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ve in g)if(g.hasOwnProperty(ve)&&(y=g[ve],y!=null))switch(ve){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:cn(o,u,ve,y,g,null)}return;default:if(rt(u)){for(Ne in g)g.hasOwnProperty(Ne)&&(y=g[Ne],y!==void 0&&I0(o,u,Ne,y,g,void 0));return}}for(j in g)g.hasOwnProperty(j)&&(y=g[j],y!=null&&cn(o,u,j,y,g,null))}function sE(o,u,g,y){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var A=null,T=null,P=null,j=null,ne=null,ve=null,Ne=null;for(we in g){var Oe=g[we];if(g.hasOwnProperty(we)&&Oe!=null)switch(we){case"checked":break;case"value":break;case"defaultValue":ne=Oe;default:y.hasOwnProperty(we)||cn(o,u,we,null,y,Oe)}}for(var ye in y){var we=y[ye];if(Oe=g[ye],y.hasOwnProperty(ye)&&(we!=null||Oe!=null))switch(ye){case"type":T=we;break;case"name":A=we;break;case"checked":ve=we;break;case"defaultChecked":Ne=we;break;case"value":P=we;break;case"defaultValue":j=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(n(137,u));break;default:we!==Oe&&cn(o,u,ye,we,y,Oe)}}Zt(o,P,j,ne,ve,Ne,T,A);return;case"select":we=P=j=ye=null;for(T in g)if(ne=g[T],g.hasOwnProperty(T)&&ne!=null)switch(T){case"value":break;case"multiple":we=ne;default:y.hasOwnProperty(T)||cn(o,u,T,null,y,ne)}for(A in y)if(T=y[A],ne=g[A],y.hasOwnProperty(A)&&(T!=null||ne!=null))switch(A){case"value":ye=T;break;case"defaultValue":j=T;break;case"multiple":P=T;default:T!==ne&&cn(o,u,A,T,y,ne)}u=j,g=P,y=we,ye!=null?K(o,!!g,ye,!1):!!y!=!!g&&(u!=null?K(o,!!g,u,!0):K(o,!!g,g?[]:"",!1));return;case"textarea":we=ye=null;for(j in g)if(A=g[j],g.hasOwnProperty(j)&&A!=null&&!y.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:cn(o,u,j,null,y,A)}for(P in y)if(A=y[P],T=g[P],y.hasOwnProperty(P)&&(A!=null||T!=null))switch(P){case"value":ye=A;break;case"defaultValue":we=A;break;case"children":break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(n(91));break;default:A!==T&&cn(o,u,P,A,y,T)}nt(o,ye,we);return;case"option":for(var dt in g)if(ye=g[dt],g.hasOwnProperty(dt)&&ye!=null&&!y.hasOwnProperty(dt))switch(dt){case"selected":o.selected=!1;break;default:cn(o,u,dt,null,y,ye)}for(ne in y)if(ye=y[ne],we=g[ne],y.hasOwnProperty(ne)&&ye!==we&&(ye!=null||we!=null))switch(ne){case"selected":o.selected=ye&&typeof ye!="function"&&typeof ye!="symbol";break;default:cn(o,u,ne,ye,y,we)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var lt in g)ye=g[lt],g.hasOwnProperty(lt)&&ye!=null&&!y.hasOwnProperty(lt)&&cn(o,u,lt,null,y,ye);for(ve in y)if(ye=y[ve],we=g[ve],y.hasOwnProperty(ve)&&ye!==we&&(ye!=null||we!=null))switch(ve){case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(n(137,u));break;default:cn(o,u,ve,ye,y,we)}return;default:if(rt(u)){for(var fn in g)ye=g[fn],g.hasOwnProperty(fn)&&ye!==void 0&&!y.hasOwnProperty(fn)&&I0(o,u,fn,void 0,y,ye);for(Ne in y)ye=y[Ne],we=g[Ne],!y.hasOwnProperty(Ne)||ye===we||ye===void 0&&we===void 0||I0(o,u,Ne,ye,y,we);return}}for(var ce in g)ye=g[ce],g.hasOwnProperty(ce)&&ye!=null&&!y.hasOwnProperty(ce)&&cn(o,u,ce,null,y,ye);for(Oe in y)ye=y[Oe],we=g[Oe],!y.hasOwnProperty(Oe)||ye===we||ye==null&&we==null||cn(o,u,Oe,ye,y,we)}var R0=null,N0=null;function Rf(o){return o.nodeType===9?o:o.ownerDocument}function Dm(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Mm(o,u){if(o===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&u==="foreignObject"?0:o}function D0(o,u){return o==="textarea"||o==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var M0=null;function uE(){var o=window.event;return o&&o.type==="popstate"?o===M0?!1:(M0=o,!0):(M0=null,!1)}var Om=typeof setTimeout=="function"?setTimeout:void 0,lE=typeof clearTimeout=="function"?clearTimeout:void 0,Bm=typeof Promise=="function"?Promise:void 0,cE=typeof queueMicrotask=="function"?queueMicrotask:typeof Bm<"u"?function(o){return Bm.resolve(null).then(o).catch(fE)}:Om;function fE(o){setTimeout(function(){throw o})}function zo(o){return o==="head"}function km(o,u){var g=u,y=0,A=0;do{var T=g.nextSibling;if(o.removeChild(g),T&&T.nodeType===8)if(g=T.data,g==="/$"){if(0<y&&8>y){g=y;var P=o.ownerDocument;if(g&1&&Gl(P.documentElement),g&2&&Gl(P.body),g&4)for(g=P.head,Gl(g),P=g.firstChild;P;){var j=P.nextSibling,ne=P.nodeName;P[_a]||ne==="SCRIPT"||ne==="STYLE"||ne==="LINK"&&P.rel.toLowerCase()==="stylesheet"||g.removeChild(P),P=j}}if(A===0){o.removeChild(T),Jl(u);return}A--}else g==="$"||g==="$?"||g==="$!"?A++:y=g.charCodeAt(0)-48;else y=0;g=T}while(g);Jl(u)}function O0(o){var u=o.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var g=u;switch(u=u.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":O0(g),us(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}o.removeChild(g)}}function hE(o,u,g,y){for(;o.nodeType===1;){var A=g;if(o.nodeName.toLowerCase()!==u.toLowerCase()){if(!y&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(y){if(!o[_a])switch(u){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(T=o.getAttribute("rel"),T==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(T!==A.rel||o.getAttribute("href")!==(A.href==null||A.href===""?null:A.href)||o.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin)||o.getAttribute("title")!==(A.title==null?null:A.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(T=o.getAttribute("src"),(T!==(A.src==null?null:A.src)||o.getAttribute("type")!==(A.type==null?null:A.type)||o.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin))&&T&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(u==="input"&&o.type==="hidden"){var T=A.name==null?null:""+A.name;if(A.type==="hidden"&&o.getAttribute("name")===T)return o}else return o;if(o=ja(o.nextSibling),o===null)break}return null}function dE(o,u,g){if(u==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!g||(o=ja(o.nextSibling),o===null))return null;return o}function B0(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function pE(o,u){var g=o.ownerDocument;if(o.data!=="$?"||g.readyState==="complete")u();else{var y=function(){u(),g.removeEventListener("DOMContentLoaded",y)};g.addEventListener("DOMContentLoaded",y),o._reactRetry=y}}function ja(o){for(;o!=null;o=o.nextSibling){var u=o.nodeType;if(u===1||u===3)break;if(u===8){if(u=o.data,u==="$"||u==="$!"||u==="$?"||u==="F!"||u==="F")break;if(u==="/$")return null}}return o}var k0=null;function Lm(o){o=o.previousSibling;for(var u=0;o;){if(o.nodeType===8){var g=o.data;if(g==="$"||g==="$!"||g==="$?"){if(u===0)return o;u--}else g==="/$"&&u++}o=o.previousSibling}return null}function Fm(o,u,g){switch(u=Rf(g),o){case"html":if(o=u.documentElement,!o)throw Error(n(452));return o;case"head":if(o=u.head,!o)throw Error(n(453));return o;case"body":if(o=u.body,!o)throw Error(n(454));return o;default:throw Error(n(451))}}function Gl(o){for(var u=o.attributes;u.length;)o.removeAttributeNode(u[0]);us(o)}var Ba=new Map,Pm=new Set;function Nf(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var Ji=re.d;re.d={f:gE,r:vE,D:mE,C:xE,L:yE,m:bE,X:EE,S:wE,M:CE};function gE(){var o=Ji.f(),u=wf();return o||u}function vE(o){var u=sa(o);u!==null&&u.tag===5&&u.type==="form"?av(u):Ji.r(o)}var Nu=typeof document>"u"?null:document;function Um(o,u,g){var y=Nu;if(y&&typeof u=="string"&&u){var A=Jn(u);A='link[rel="'+o+'"][href="'+A+'"]',typeof g=="string"&&(A+='[crossorigin="'+g+'"]'),Pm.has(A)||(Pm.add(A),o={rel:o,crossOrigin:g,href:u},y.querySelector(A)===null&&(u=y.createElement("link"),Ar(u,"link",o),en(u),y.head.appendChild(u)))}}function mE(o){Ji.D(o),Um("dns-prefetch",o,null)}function xE(o,u){Ji.C(o,u),Um("preconnect",o,u)}function yE(o,u,g){Ji.L(o,u,g);var y=Nu;if(y&&o&&u){var A='link[rel="preload"][as="'+Jn(u)+'"]';u==="image"&&g&&g.imageSrcSet?(A+='[imagesrcset="'+Jn(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(A+='[imagesizes="'+Jn(g.imageSizes)+'"]')):A+='[href="'+Jn(o)+'"]';var T=A;switch(u){case"style":T=Du(o);break;case"script":T=Mu(o)}Ba.has(T)||(o=x({rel:"preload",href:u==="image"&&g&&g.imageSrcSet?void 0:o,as:u},g),Ba.set(T,o),y.querySelector(A)!==null||u==="style"&&y.querySelector(jl(T))||u==="script"&&y.querySelector(Xl(T))||(u=y.createElement("link"),Ar(u,"link",o),en(u),y.head.appendChild(u)))}}function bE(o,u){Ji.m(o,u);var g=Nu;if(g&&o){var y=u&&typeof u.as=="string"?u.as:"script",A='link[rel="modulepreload"][as="'+Jn(y)+'"][href="'+Jn(o)+'"]',T=A;switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=Mu(o)}if(!Ba.has(T)&&(o=x({rel:"modulepreload",href:o},u),Ba.set(T,o),g.querySelector(A)===null)){switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(Xl(T)))return}y=g.createElement("link"),Ar(y,"link",o),en(y),g.head.appendChild(y)}}}function wE(o,u,g){Ji.S(o,u,g);var y=Nu;if(y&&o){var A=Ua(y).hoistableStyles,T=Du(o);u=u||"default";var P=A.get(T);if(!P){var j={loading:0,preload:null};if(P=y.querySelector(jl(T)))j.loading=5;else{o=x({rel:"stylesheet",href:o,"data-precedence":u},g),(g=Ba.get(T))&&L0(o,g);var ne=P=y.createElement("link");en(ne),Ar(ne,"link",o),ne._p=new Promise(function(ve,Ne){ne.onload=ve,ne.onerror=Ne}),ne.addEventListener("load",function(){j.loading|=1}),ne.addEventListener("error",function(){j.loading|=2}),j.loading|=4,Df(P,u,y)}P={type:"stylesheet",instance:P,count:1,state:j},A.set(T,P)}}}function EE(o,u){Ji.X(o,u);var g=Nu;if(g&&o){var y=Ua(g).hoistableScripts,A=Mu(o),T=y.get(A);T||(T=g.querySelector(Xl(A)),T||(o=x({src:o,async:!0},u),(u=Ba.get(A))&&F0(o,u),T=g.createElement("script"),en(T),Ar(T,"link",o),g.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},y.set(A,T))}}function CE(o,u){Ji.M(o,u);var g=Nu;if(g&&o){var y=Ua(g).hoistableScripts,A=Mu(o),T=y.get(A);T||(T=g.querySelector(Xl(A)),T||(o=x({src:o,async:!0,type:"module"},u),(u=Ba.get(A))&&F0(o,u),T=g.createElement("script"),en(T),Ar(T,"link",o),g.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},y.set(A,T))}}function zm(o,u,g,y){var A=(A=Ie.current)?Nf(A):null;if(!A)throw Error(n(446));switch(o){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(u=Du(g.href),g=Ua(A).hoistableStyles,y=g.get(u),y||(y={type:"style",instance:null,count:0,state:null},g.set(u,y)),y):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){o=Du(g.href);var T=Ua(A).hoistableStyles,P=T.get(o);if(P||(A=A.ownerDocument||A,P={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(o,P),(T=A.querySelector(jl(o)))&&!T._p&&(P.instance=T,P.state.loading=5),Ba.has(o)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},Ba.set(o,g),T||AE(A,o,g,P.state))),u&&y===null)throw Error(n(528,""));return P}if(u&&y!==null)throw Error(n(529,""));return null;case"script":return u=g.async,g=g.src,typeof g=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=Mu(g),g=Ua(A).hoistableScripts,y=g.get(u),y||(y={type:"script",instance:null,count:0,state:null},g.set(u,y)),y):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,o))}}function Du(o){return'href="'+Jn(o)+'"'}function jl(o){return'link[rel="stylesheet"]['+o+"]"}function Hm(o){return x({},o,{"data-precedence":o.precedence,precedence:null})}function AE(o,u,g,y){o.querySelector('link[rel="preload"][as="style"]['+u+"]")?y.loading=1:(u=o.createElement("link"),y.preload=u,u.addEventListener("load",function(){return y.loading|=1}),u.addEventListener("error",function(){return y.loading|=2}),Ar(u,"link",g),en(u),o.head.appendChild(u))}function Mu(o){return'[src="'+Jn(o)+'"]'}function Xl(o){return"script[async]"+o}function Vm(o,u,g){if(u.count++,u.instance===null)switch(u.type){case"style":var y=o.querySelector('style[data-href~="'+Jn(g.href)+'"]');if(y)return u.instance=y,en(y),y;var A=x({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return y=(o.ownerDocument||o).createElement("style"),en(y),Ar(y,"style",A),Df(y,g.precedence,o),u.instance=y;case"stylesheet":A=Du(g.href);var T=o.querySelector(jl(A));if(T)return u.state.loading|=4,u.instance=T,en(T),T;y=Hm(g),(A=Ba.get(A))&&L0(y,A),T=(o.ownerDocument||o).createElement("link"),en(T);var P=T;return P._p=new Promise(function(j,ne){P.onload=j,P.onerror=ne}),Ar(T,"link",y),u.state.loading|=4,Df(T,g.precedence,o),u.instance=T;case"script":return T=Mu(g.src),(A=o.querySelector(Xl(T)))?(u.instance=A,en(A),A):(y=g,(A=Ba.get(T))&&(y=x({},g),F0(y,A)),o=o.ownerDocument||o,A=o.createElement("script"),en(A),Ar(A,"link",y),o.head.appendChild(A),u.instance=A);case"void":return null;default:throw Error(n(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(y=u.instance,u.state.loading|=4,Df(y,g.precedence,o));return u.instance}function Df(o,u,g){for(var y=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),A=y.length?y[y.length-1]:null,T=A,P=0;P<y.length;P++){var j=y[P];if(j.dataset.precedence===u)T=j;else if(T!==A)break}T?T.parentNode.insertBefore(o,T.nextSibling):(u=g.nodeType===9?g.head:g,u.insertBefore(o,u.firstChild))}function L0(o,u){o.crossOrigin==null&&(o.crossOrigin=u.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=u.referrerPolicy),o.title==null&&(o.title=u.title)}function F0(o,u){o.crossOrigin==null&&(o.crossOrigin=u.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=u.referrerPolicy),o.integrity==null&&(o.integrity=u.integrity)}var Mf=null;function Wm(o,u,g){if(Mf===null){var y=new Map,A=Mf=new Map;A.set(g,y)}else A=Mf,y=A.get(g),y||(y=new Map,A.set(g,y));if(y.has(o))return y;for(y.set(o,null),g=g.getElementsByTagName(o),A=0;A<g.length;A++){var T=g[A];if(!(T[_a]||T[hr]||o==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var P=T.getAttribute(u)||"";P=o+P;var j=y.get(P);j?j.push(T):y.set(P,[T])}}return y}function Gm(o,u,g){o=o.ownerDocument||o,o.head.insertBefore(g,u==="title"?o.querySelector("head > title"):null)}function SE(o,u,g){if(g===1||u.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return o=u.disabled,typeof u.precedence=="string"&&o==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function jm(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var Yl=null;function _E(){}function TE(o,u,g){if(Yl===null)throw Error(n(475));var y=Yl;if(u.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var A=Du(g.href),T=o.querySelector(jl(A));if(T){o=T._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(y.count++,y=Of.bind(y),o.then(y,y)),u.state.loading|=4,u.instance=T,en(T);return}T=o.ownerDocument||o,g=Hm(g),(A=Ba.get(A))&&L0(g,A),T=T.createElement("link"),en(T);var P=T;P._p=new Promise(function(j,ne){P.onload=j,P.onerror=ne}),Ar(T,"link",g),u.instance=T}y.stylesheets===null&&(y.stylesheets=new Map),y.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(y.count++,u=Of.bind(y),o.addEventListener("load",u),o.addEventListener("error",u))}}function IE(){if(Yl===null)throw Error(n(475));var o=Yl;return o.stylesheets&&o.count===0&&P0(o,o.stylesheets),0<o.count?function(u){var g=setTimeout(function(){if(o.stylesheets&&P0(o,o.stylesheets),o.unsuspend){var y=o.unsuspend;o.unsuspend=null,y()}},6e4);return o.unsuspend=u,function(){o.unsuspend=null,clearTimeout(g)}}:null}function Of(){if(this.count--,this.count===0){if(this.stylesheets)P0(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var Bf=null;function P0(o,u){o.stylesheets=null,o.unsuspend!==null&&(o.count++,Bf=new Map,u.forEach(RE,o),Bf=null,Of.call(o))}function RE(o,u){if(!(u.state.loading&4)){var g=Bf.get(o);if(g)var y=g.get(null);else{g=new Map,Bf.set(o,g);for(var A=o.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<A.length;T++){var P=A[T];(P.nodeName==="LINK"||P.getAttribute("media")!=="not all")&&(g.set(P.dataset.precedence,P),y=P)}y&&g.set(null,y)}A=u.instance,P=A.getAttribute("data-precedence"),T=g.get(P)||y,T===y&&g.set(null,A),g.set(P,A),this.count++,y=Of.bind(this),A.addEventListener("load",y),A.addEventListener("error",y),T?T.parentNode.insertBefore(A,T.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(A,o.firstChild)),u.state.loading|=4}}var ql={$$typeof:k,Provider:null,Consumer:null,_currentValue:he,_currentValue2:he,_threadCount:0};function NE(o,u,g,y,A,T,P,j){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Lt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lt(0),this.hiddenUpdates=Lt(null),this.identifierPrefix=y,this.onUncaughtError=A,this.onCaughtError=T,this.onRecoverableError=P,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=j,this.incompleteTransitions=new Map}function Xm(o,u,g,y,A,T,P,j,ne,ve,Ne,Oe){return o=new NE(o,u,g,P,j,ne,ve,Oe),u=1,T===!0&&(u|=24),T=ca(3,null,null,u),o.current=T,T.stateNode=o,u=yd(),u.refCount++,o.pooledCache=u,u.refCount++,T.memoizedState={element:y,isDehydrated:g,cache:u},Cd(T),o}function Ym(o){return o?(o=lu,o):lu}function qm(o,u,g,y,A,T){A=Ym(A),y.context===null?y.context=A:y.pendingContext=A,y=To(u),y.payload={element:g},T=T===void 0?null:T,T!==null&&(y.callback=T),g=Io(o,y,u),g!==null&&(ga(g,o,u),Al(g,o,u))}function Km(o,u){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var g=o.retryLane;o.retryLane=g!==0&&g<u?g:u}}function U0(o,u){Km(o,u),(o=o.alternate)&&Km(o,u)}function Zm(o){if(o.tag===13){var u=uu(o,67108864);u!==null&&ga(u,o,67108864),U0(o,67108864)}}var kf=!0;function DE(o,u,g,y){var A=te.T;te.T=null;var T=re.p;try{re.p=2,z0(o,u,g,y)}finally{re.p=T,te.T=A}}function ME(o,u,g,y){var A=te.T;te.T=null;var T=re.p;try{re.p=8,z0(o,u,g,y)}finally{re.p=T,te.T=A}}function z0(o,u,g,y){if(kf){var A=H0(y);if(A===null)T0(o,u,y,Lf,g),Jm(o,y);else if(BE(A,o,u,g,y))y.stopPropagation();else if(Jm(o,y),u&4&&-1<OE.indexOf(o)){for(;A!==null;){var T=sa(A);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var P=Yt(T.pendingLanes);if(P!==0){var j=T;for(j.pendingLanes|=2,j.entangledLanes|=2;P;){var ne=1<<31-Ht(P);j.entanglements[1]|=ne,P&=~ne}gi(T),(rn&6)===0&&(yf=Ct()+500,Hl(0))}}break;case 13:j=uu(T,2),j!==null&&ga(j,T,2),wf(),U0(T,2)}if(T=H0(y),T===null&&T0(o,u,y,Lf,g),T===A)break;A=T}A!==null&&y.stopPropagation()}else T0(o,u,y,null,g)}}function H0(o){return o=po(o),V0(o)}var Lf=null;function V0(o){if(Lf=null,o=Un(o),o!==null){var u=i(o);if(u===null)o=null;else{var g=u.tag;if(g===13){if(o=c(u),o!==null)return o;o=null}else if(g===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;o=null}else u!==o&&(o=null)}}return Lf=o,null}function Qm(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(At()){case ct:return 2;case Yr:return 8;case We:case Hr:return 32;case Vr:return 268435456;default:return 32}default:return 32}}var W0=!1,Ho=null,Vo=null,Wo=null,Kl=new Map,Zl=new Map,Go=[],OE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Jm(o,u){switch(o){case"focusin":case"focusout":Ho=null;break;case"dragenter":case"dragleave":Vo=null;break;case"mouseover":case"mouseout":Wo=null;break;case"pointerover":case"pointerout":Kl.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zl.delete(u.pointerId)}}function Ql(o,u,g,y,A,T){return o===null||o.nativeEvent!==T?(o={blockedOn:u,domEventName:g,eventSystemFlags:y,nativeEvent:T,targetContainers:[A]},u!==null&&(u=sa(u),u!==null&&Zm(u)),o):(o.eventSystemFlags|=y,u=o.targetContainers,A!==null&&u.indexOf(A)===-1&&u.push(A),o)}function BE(o,u,g,y,A){switch(u){case"focusin":return Ho=Ql(Ho,o,u,g,y,A),!0;case"dragenter":return Vo=Ql(Vo,o,u,g,y,A),!0;case"mouseover":return Wo=Ql(Wo,o,u,g,y,A),!0;case"pointerover":var T=A.pointerId;return Kl.set(T,Ql(Kl.get(T)||null,o,u,g,y,A)),!0;case"gotpointercapture":return T=A.pointerId,Zl.set(T,Ql(Zl.get(T)||null,o,u,g,y,A)),!0}return!1}function $m(o){var u=Un(o.target);if(u!==null){var g=i(u);if(g!==null){if(u=g.tag,u===13){if(u=c(g),u!==null){o.blockedOn=u,qs(o.priority,function(){if(g.tag===13){var y=pa();y=ss(y);var A=uu(g,y);A!==null&&ga(A,g,y),U0(g,y)}});return}}else if(u===3&&g.stateNode.current.memoizedState.isDehydrated){o.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Ff(o){if(o.blockedOn!==null)return!1;for(var u=o.targetContainers;0<u.length;){var g=H0(o.nativeEvent);if(g===null){g=o.nativeEvent;var y=new g.constructor(g.type,g);ls=y,g.target.dispatchEvent(y),ls=null}else return u=sa(g),u!==null&&Zm(u),o.blockedOn=g,!1;u.shift()}return!0}function e2(o,u,g){Ff(o)&&g.delete(u)}function kE(){W0=!1,Ho!==null&&Ff(Ho)&&(Ho=null),Vo!==null&&Ff(Vo)&&(Vo=null),Wo!==null&&Ff(Wo)&&(Wo=null),Kl.forEach(e2),Zl.forEach(e2)}function Pf(o,u){o.blockedOn===u&&(o.blockedOn=null,W0||(W0=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,kE)))}var Uf=null;function t2(o){Uf!==o&&(Uf=o,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Uf===o&&(Uf=null);for(var u=0;u<o.length;u+=3){var g=o[u],y=o[u+1],A=o[u+2];if(typeof y!="function"){if(V0(y||g)===null)continue;break}var T=sa(g);T!==null&&(o.splice(u,3),u-=3,Vd(T,{pending:!0,data:A,method:g.method,action:y},y,A))}}))}function Jl(o){function u(ne){return Pf(ne,o)}Ho!==null&&Pf(Ho,o),Vo!==null&&Pf(Vo,o),Wo!==null&&Pf(Wo,o),Kl.forEach(u),Zl.forEach(u);for(var g=0;g<Go.length;g++){var y=Go[g];y.blockedOn===o&&(y.blockedOn=null)}for(;0<Go.length&&(g=Go[0],g.blockedOn===null);)$m(g),g.blockedOn===null&&Go.shift();if(g=(o.ownerDocument||o).$$reactFormReplay,g!=null)for(y=0;y<g.length;y+=3){var A=g[y],T=g[y+1],P=A[Nn]||null;if(typeof T=="function")P||t2(g);else if(P){var j=null;if(T&&T.hasAttribute("formAction")){if(A=T,P=T[Nn]||null)j=P.formAction;else if(V0(A)!==null)continue}else j=P.action;typeof j=="function"?g[y+1]=j:(g.splice(y,3),y-=3),t2(g)}}}function G0(o){this._internalRoot=o}zf.prototype.render=G0.prototype.render=function(o){var u=this._internalRoot;if(u===null)throw Error(n(409));var g=u.current,y=pa();qm(g,y,o,u,null,null)},zf.prototype.unmount=G0.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var u=o.containerInfo;qm(o.current,2,null,o,null,null),wf(),u[Ja]=null}};function zf(o){this._internalRoot=o}zf.prototype.unstable_scheduleHydration=function(o){if(o){var u=Oi();o={blockedOn:null,target:o,priority:u};for(var g=0;g<Go.length&&u!==0&&u<Go[g].priority;g++);Go.splice(g,0,o),g===0&&$m(o)}};var n2=t.version;if(n2!=="19.1.1")throw Error(n(527,n2,"19.1.1"));re.findDOMNode=function(o){var u=o._reactInternals;if(u===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=p(u),o=o!==null?d(o):null,o=o===null?null:o.stateNode,o};var LE={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hf.isDisabled&&Hf.supportsFiber)try{Pn=Hf.inject(LE),Cn=Hf}catch{}}return ec.createRoot=function(o,u){if(!a(o))throw Error(n(299));var g=!1,y="",A=xv,T=yv,P=bv,j=null;return u!=null&&(u.unstable_strictMode===!0&&(g=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(A=u.onUncaughtError),u.onCaughtError!==void 0&&(T=u.onCaughtError),u.onRecoverableError!==void 0&&(P=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(j=u.unstable_transitionCallbacks)),u=Xm(o,1,!1,null,null,g,y,A,T,P,j,null),o[Ja]=u.current,_0(o),new G0(u)},ec.hydrateRoot=function(o,u,g){if(!a(o))throw Error(n(299));var y=!1,A="",T=xv,P=yv,j=bv,ne=null,ve=null;return g!=null&&(g.unstable_strictMode===!0&&(y=!0),g.identifierPrefix!==void 0&&(A=g.identifierPrefix),g.onUncaughtError!==void 0&&(T=g.onUncaughtError),g.onCaughtError!==void 0&&(P=g.onCaughtError),g.onRecoverableError!==void 0&&(j=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(ne=g.unstable_transitionCallbacks),g.formState!==void 0&&(ve=g.formState)),u=Xm(o,1,!0,u,g??null,y,A,T,P,j,ne,ve),u.context=Ym(null),g=u.current,y=pa(),y=ss(y),A=To(y),A.callback=null,Io(g,A,y),g=y,u.current.lanes=g,oa(u,g),gi(u),o[Ja]=u.current,_0(o),new zf(u)},ec.version="19.1.1",ec}var h2;function KE(){if(h2)return Y0.exports;h2=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Y0.exports=qE(),Y0.exports}var ZE=KE();/**
 * react-router v7.9.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var d2="popstate";function QE(r={}){function t(n,a){let{pathname:i,search:c,hash:f}=n.location;return _p("",{pathname:i,search:c,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function e(n,a){return typeof a=="string"?a:cc(a)}return $E(t,e,null,r)}function In(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function _i(r,t){if(!r){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function JE(){return Math.random().toString(36).substring(2,10)}function p2(r,t){return{usr:r.state,key:r.key,idx:t}}function _p(r,t,e=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof t=="string"?el(t):t,state:e,key:t&&t.key||n||JE()}}function cc({pathname:r="/",search:t="",hash:e=""}){return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(r+=e.charAt(0)==="#"?e:"#"+e),r}function el(r){let t={};if(r){let e=r.indexOf("#");e>=0&&(t.hash=r.substring(e),r=r.substring(0,e));let n=r.indexOf("?");n>=0&&(t.search=r.substring(n),r=r.substring(0,n)),r&&(t.pathname=r)}return t}function $E(r,t,e,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,c=a.history,f="POP",p=null,d=x();d==null&&(d=0,c.replaceState({...c.state,idx:d},""));function x(){return(c.state||{idx:null}).idx}function w(){f="POP";let D=x(),M=D==null?null:D-d;d=D,p&&p({action:f,location:N.location,delta:M})}function C(D,M){f="PUSH";let B=_p(N.location,D,M);d=x()+1;let k=p2(B,d),L=N.createHref(B);try{c.pushState(k,"",L)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(L)}i&&p&&p({action:f,location:N.location,delta:1})}function S(D,M){f="REPLACE";let B=_p(N.location,D,M);d=x();let k=p2(B,d),L=N.createHref(B);c.replaceState(k,"",L),i&&p&&p({action:f,location:N.location,delta:0})}function R(D){return eC(D)}let N={get action(){return f},get location(){return r(a,c)},listen(D){if(p)throw new Error("A history only accepts one active listener");return a.addEventListener(d2,w),p=D,()=>{a.removeEventListener(d2,w),p=null}},createHref(D){return t(a,D)},createURL:R,encodeLocation(D){let M=R(D);return{pathname:M.pathname,search:M.search,hash:M.hash}},push:C,replace:S,go(D){return c.go(D)}};return N}function eC(r,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),In(e,"No window.location.(origin|href) available to create URL");let n=typeof r=="string"?r:cc(r);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=e+n),new URL(n,e)}function kx(r,t,e="/"){return tC(r,t,e,!1)}function tC(r,t,e,n){let a=typeof t=="string"?el(t):t,i=ao(a.pathname||"/",e);if(i==null)return null;let c=Lx(r);nC(c);let f=null;for(let p=0;f==null&&p<c.length;++p){let d=dC(i);f=fC(c[p],d,n)}return f}function Lx(r,t=[],e=[],n="",a=!1){let i=(c,f,p=a,d)=>{let x={relativePath:d===void 0?c.path||"":d,caseSensitive:c.caseSensitive===!0,childrenIndex:f,route:c};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(n)&&p)return;In(x.relativePath.startsWith(n),`Absolute route path "${x.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(n.length)}let w=ro([n,x.relativePath]),C=e.concat(x);c.children&&c.children.length>0&&(In(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${w}".`),Lx(c.children,t,C,w,p)),!(c.path==null&&!c.index)&&t.push({path:w,score:lC(w,c.index),routesMeta:C})};return r.forEach((c,f)=>{if(c.path===""||!c.path?.includes("?"))i(c,f);else for(let p of Fx(c.path))i(c,f,!0,p)}),t}function Fx(r){let t=r.split("/");if(t.length===0)return[];let[e,...n]=t,a=e.endsWith("?"),i=e.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let c=Fx(n.join("/")),f=[];return f.push(...c.map(p=>p===""?i:[i,p].join("/"))),a&&f.push(...c),f.map(p=>r.startsWith("/")&&p===""?"/":p)}function nC(r){r.sort((t,e)=>t.score!==e.score?e.score-t.score:cC(t.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}var rC=/^:[\w-]+$/,aC=3,iC=2,oC=1,sC=10,uC=-2,g2=r=>r==="*";function lC(r,t){let e=r.split("/"),n=e.length;return e.some(g2)&&(n+=uC),t&&(n+=iC),e.filter(a=>!g2(a)).reduce((a,i)=>a+(rC.test(i)?aC:i===""?oC:sC),n)}function cC(r,t){return r.length===t.length&&r.slice(0,-1).every((n,a)=>n===t[a])?r[r.length-1]-t[t.length-1]:0}function fC(r,t,e=!1){let{routesMeta:n}=r,a={},i="/",c=[];for(let f=0;f<n.length;++f){let p=n[f],d=f===n.length-1,x=i==="/"?t:t.slice(i.length)||"/",w=sh({path:p.relativePath,caseSensitive:p.caseSensitive,end:d},x),C=p.route;if(!w&&d&&e&&!n[n.length-1].route.index&&(w=sh({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},x)),!w)return null;Object.assign(a,w.params),c.push({params:a,pathname:ro([i,w.pathname]),pathnameBase:mC(ro([i,w.pathnameBase])),route:C}),w.pathnameBase!=="/"&&(i=ro([i,w.pathnameBase]))}return c}function sh(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[e,n]=hC(r.path,r.caseSensitive,r.end),a=t.match(e);if(!a)return null;let i=a[0],c=i.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:n.reduce((d,{paramName:x,isOptional:w},C)=>{if(x==="*"){let R=f[C]||"";c=i.slice(0,i.length-R.length).replace(/(.)\/+$/,"$1")}const S=f[C];return w&&!S?d[x]=void 0:d[x]=(S||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:c,pattern:r}}function hC(r,t=!1,e=!0){_i(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,f,p)=>(n.push({paramName:f,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(n.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function dC(r){try{return r.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return _i(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),r}}function ao(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,n=r.charAt(e);return n&&n!=="/"?null:r.slice(e)||"/"}function pC(r,t="/"){let{pathname:e,search:n="",hash:a=""}=typeof r=="string"?el(r):r;return{pathname:e?e.startsWith("/")?e:gC(e,t):t,search:xC(n),hash:yC(a)}}function gC(r,t){let e=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?e.length>1&&e.pop():a!=="."&&e.push(a)}),e.length>1?e.join("/"):"/"}function Q0(r,t,e,n){return`Cannot include a '${r}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function vC(r){return r.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function Px(r){let t=vC(r);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function Ux(r,t,e,n=!1){let a;typeof r=="string"?a=el(r):(a={...r},In(!a.pathname||!a.pathname.includes("?"),Q0("?","pathname","search",a)),In(!a.pathname||!a.pathname.includes("#"),Q0("#","pathname","hash",a)),In(!a.search||!a.search.includes("#"),Q0("#","search","hash",a)));let i=r===""||a.pathname==="",c=i?"/":a.pathname,f;if(c==null)f=e;else{let w=t.length-1;if(!n&&c.startsWith("..")){let C=c.split("/");for(;C[0]==="..";)C.shift(),w-=1;a.pathname=C.join("/")}f=w>=0?t[w]:"/"}let p=pC(a,f),d=c&&c!=="/"&&c.endsWith("/"),x=(i||c===".")&&e.endsWith("/");return!p.pathname.endsWith("/")&&(d||x)&&(p.pathname+="/"),p}var ro=r=>r.join("/").replace(/\/\/+/g,"/"),mC=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),xC=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,yC=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function bC(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var zx=["POST","PUT","PATCH","DELETE"];new Set(zx);var wC=["GET",...zx];new Set(wC);var tl=De.createContext(null);tl.displayName="DataRouter";var Oh=De.createContext(null);Oh.displayName="DataRouterState";De.createContext(!1);var Hx=De.createContext({isTransitioning:!1});Hx.displayName="ViewTransition";var EC=De.createContext(new Map);EC.displayName="Fetchers";var CC=De.createContext(null);CC.displayName="Await";var Ii=De.createContext(null);Ii.displayName="Navigation";var xc=De.createContext(null);xc.displayName="Location";var io=De.createContext({outlet:null,matches:[],isDataRoute:!1});io.displayName="Route";var e1=De.createContext(null);e1.displayName="RouteError";function AC(r,{relative:t}={}){In(yc(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:n}=De.useContext(Ii),{hash:a,pathname:i,search:c}=bc(r,{relative:t}),f=i;return e!=="/"&&(f=i==="/"?e:ro([e,i])),n.createHref({pathname:f,search:c,hash:a})}function yc(){return De.useContext(xc)!=null}function zs(){return In(yc(),"useLocation() may be used only in the context of a <Router> component."),De.useContext(xc).location}var Vx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Wx(r){De.useContext(Ii).static||De.useLayoutEffect(r)}function SC(){let{isDataRoute:r}=De.useContext(io);return r?PC():_C()}function _C(){In(yc(),"useNavigate() may be used only in the context of a <Router> component.");let r=De.useContext(tl),{basename:t,navigator:e}=De.useContext(Ii),{matches:n}=De.useContext(io),{pathname:a}=zs(),i=JSON.stringify(Px(n)),c=De.useRef(!1);return Wx(()=>{c.current=!0}),De.useCallback((p,d={})=>{if(_i(c.current,Vx),!c.current)return;if(typeof p=="number"){e.go(p);return}let x=Ux(p,JSON.parse(i),a,d.relative==="path");r==null&&t!=="/"&&(x.pathname=x.pathname==="/"?t:ro([t,x.pathname])),(d.replace?e.replace:e.push)(x,d.state,d)},[t,e,i,a,r])}De.createContext(null);function bc(r,{relative:t}={}){let{matches:e}=De.useContext(io),{pathname:n}=zs(),a=JSON.stringify(Px(e));return De.useMemo(()=>Ux(r,JSON.parse(a),n,t==="path"),[r,a,n,t])}function TC(r,t){return Gx(r,t)}function Gx(r,t,e,n,a){In(yc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=De.useContext(Ii),{matches:c}=De.useContext(io),f=c[c.length-1],p=f?f.params:{},d=f?f.pathname:"/",x=f?f.pathnameBase:"/",w=f&&f.route;{let B=w&&w.path||"";jx(d,!w||B.endsWith("*")||B.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${B}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${B}"> to <Route path="${B==="/"?"*":`${B}/*`}">.`)}let C=zs(),S;if(t){let B=typeof t=="string"?el(t):t;In(x==="/"||B.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${B.pathname}" was given in the \`location\` prop.`),S=B}else S=C;let R=S.pathname||"/",N=R;if(x!=="/"){let B=x.replace(/^\//,"").split("/");N="/"+R.replace(/^\//,"").split("/").slice(B.length).join("/")}let D=kx(r,{pathname:N});_i(w||D!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),_i(D==null||D[D.length-1].route.element!==void 0||D[D.length-1].route.Component!==void 0||D[D.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let M=MC(D&&D.map(B=>Object.assign({},B,{params:Object.assign({},p,B.params),pathname:ro([x,i.encodeLocation?i.encodeLocation(B.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:B.pathname]),pathnameBase:B.pathnameBase==="/"?x:ro([x,i.encodeLocation?i.encodeLocation(B.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:B.pathnameBase])})),c,e,n,a);return t&&M?De.createElement(xc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},M):M}function IC(){let r=FC(),t=bC(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),e=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},c=null;return console.error("Error handled by React Router default ErrorBoundary:",r),c=De.createElement(De.Fragment,null,De.createElement("p",null,"💿 Hey developer 👋"),De.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",De.createElement("code",{style:i},"ErrorBoundary")," or"," ",De.createElement("code",{style:i},"errorElement")," prop on your route.")),De.createElement(De.Fragment,null,De.createElement("h2",null,"Unexpected Application Error!"),De.createElement("h3",{style:{fontStyle:"italic"}},t),e?De.createElement("pre",{style:a},e):null,c)}var RC=De.createElement(IC,null),NC=class extends De.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){this.props.unstable_onError?this.props.unstable_onError(r,t):console.error("React Router caught the following error during render",r)}render(){return this.state.error!==void 0?De.createElement(io.Provider,{value:this.props.routeContext},De.createElement(e1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function DC({routeContext:r,match:t,children:e}){let n=De.useContext(tl);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),De.createElement(io.Provider,{value:r},e)}function MC(r,t=[],e=null,n=null,a=null){if(r==null){if(!e)return null;if(e.errors)r=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)r=e.matches;else return null}let i=r,c=e?.errors;if(c!=null){let d=i.findIndex(x=>x.route.id&&c?.[x.route.id]!==void 0);In(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),i=i.slice(0,Math.min(i.length,d+1))}let f=!1,p=-1;if(e)for(let d=0;d<i.length;d++){let x=i[d];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(p=d),x.route.id){let{loaderData:w,errors:C}=e,S=x.route.loader&&!w.hasOwnProperty(x.route.id)&&(!C||C[x.route.id]===void 0);if(x.route.lazy||S){f=!0,p>=0?i=i.slice(0,p+1):i=[i[0]];break}}}return i.reduceRight((d,x,w)=>{let C,S=!1,R=null,N=null;e&&(C=c&&x.route.id?c[x.route.id]:void 0,R=x.route.errorElement||RC,f&&(p<0&&w===0?(jx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),S=!0,N=null):p===w&&(S=!0,N=x.route.hydrateFallbackElement||null)));let D=t.concat(i.slice(0,w+1)),M=()=>{let B;return C?B=R:S?B=N:x.route.Component?B=De.createElement(x.route.Component,null):x.route.element?B=x.route.element:B=d,De.createElement(DC,{match:x,routeContext:{outlet:d,matches:D,isDataRoute:e!=null},children:B})};return e&&(x.route.ErrorBoundary||x.route.errorElement||w===0)?De.createElement(NC,{location:e.location,revalidation:e.revalidation,component:R,error:C,children:M(),routeContext:{outlet:null,matches:D,isDataRoute:!0},unstable_onError:n}):M()},null)}function t1(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function OC(r){let t=De.useContext(tl);return In(t,t1(r)),t}function BC(r){let t=De.useContext(Oh);return In(t,t1(r)),t}function kC(r){let t=De.useContext(io);return In(t,t1(r)),t}function n1(r){let t=kC(r),e=t.matches[t.matches.length-1];return In(e.route.id,`${r} can only be used on routes that contain a unique "id"`),e.route.id}function LC(){return n1("useRouteId")}function FC(){let r=De.useContext(e1),t=BC("useRouteError"),e=n1("useRouteError");return r!==void 0?r:t.errors?.[e]}function PC(){let{router:r}=OC("useNavigate"),t=n1("useNavigate"),e=De.useRef(!1);return Wx(()=>{e.current=!0}),De.useCallback(async(a,i={})=>{_i(e.current,Vx),e.current&&(typeof a=="number"?r.navigate(a):await r.navigate(a,{fromRouteId:t,...i}))},[r,t])}var v2={};function jx(r,t,e){!t&&!v2[r]&&(v2[r]=!0,_i(!1,e))}De.memo(UC);function UC({routes:r,future:t,state:e,unstable_onError:n}){return Gx(r,void 0,e,n,t)}function Tp(r){In(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function zC({basename:r="/",children:t=null,location:e,navigationType:n="POP",navigator:a,static:i=!1}){In(!yc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=r.replace(/^\/*/,"/"),f=De.useMemo(()=>({basename:c,navigator:a,static:i,future:{}}),[c,a,i]);typeof e=="string"&&(e=el(e));let{pathname:p="/",search:d="",hash:x="",state:w=null,key:C="default"}=e,S=De.useMemo(()=>{let R=ao(p,c);return R==null?null:{location:{pathname:R,search:d,hash:x,state:w,key:C},navigationType:n}},[c,p,d,x,w,C,n]);return _i(S!=null,`<Router basename="${c}"> is not able to match the URL "${p}${d}${x}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:De.createElement(Ii.Provider,{value:f},De.createElement(xc.Provider,{children:t,value:S}))}function HC({children:r,location:t}){return TC(Ip(r),t)}function Ip(r,t=[]){let e=[];return De.Children.forEach(r,(n,a)=>{if(!De.isValidElement(n))return;let i=[...t,a];if(n.type===De.Fragment){e.push.apply(e,Ip(n.props.children,i));return}In(n.type===Tp,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),In(!n.props.index||!n.props.children,"An index route cannot have child routes.");let c={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=Ip(n.props.children,i)),e.push(c)}),e}var ah="get",ih="application/x-www-form-urlencoded";function Bh(r){return r!=null&&typeof r.tagName=="string"}function VC(r){return Bh(r)&&r.tagName.toLowerCase()==="button"}function WC(r){return Bh(r)&&r.tagName.toLowerCase()==="form"}function GC(r){return Bh(r)&&r.tagName.toLowerCase()==="input"}function jC(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function XC(r,t){return r.button===0&&(!t||t==="_self")&&!jC(r)}var Wf=null;function YC(){if(Wf===null)try{new FormData(document.createElement("form"),0),Wf=!1}catch{Wf=!0}return Wf}var qC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function J0(r){return r!=null&&!qC.has(r)?(_i(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ih}"`),null):r}function KC(r,t){let e,n,a,i,c;if(WC(r)){let f=r.getAttribute("action");n=f?ao(f,t):null,e=r.getAttribute("method")||ah,a=J0(r.getAttribute("enctype"))||ih,i=new FormData(r)}else if(VC(r)||GC(r)&&(r.type==="submit"||r.type==="image")){let f=r.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=r.getAttribute("formaction")||f.getAttribute("action");if(n=p?ao(p,t):null,e=r.getAttribute("formmethod")||f.getAttribute("method")||ah,a=J0(r.getAttribute("formenctype"))||J0(f.getAttribute("enctype"))||ih,i=new FormData(f,r),!YC()){let{name:d,type:x,value:w}=r;if(x==="image"){let C=d?`${d}.`:"";i.append(`${C}x`,"0"),i.append(`${C}y`,"0")}else d&&i.append(d,w)}}else{if(Bh(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=ah,n=null,a=ih,c=r}return i&&a==="text/plain"&&(c=i,i=void 0),{action:n,method:e.toLowerCase(),encType:a,formData:i,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function r1(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function ZC(r,t,e){let n=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return n.pathname==="/"?n.pathname=`_root.${e}`:t&&ao(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${e}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${e}`,n}async function QC(r,t){if(r.id in t)return t[r.id];try{let e=await import(r.module);return t[r.id]=e,e}catch(e){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function JC(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function $C(r,t,e){let n=await Promise.all(r.map(async a=>{let i=t.routes[a.route.id];if(i){let c=await QC(i,e);return c.links?c.links():[]}return[]}));return r3(n.flat(1).filter(JC).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function m2(r,t,e,n,a,i){let c=(p,d)=>e[d]?p.route.id!==e[d].route.id:!0,f=(p,d)=>e[d].pathname!==p.pathname||e[d].route.path?.endsWith("*")&&e[d].params["*"]!==p.params["*"];return i==="assets"?t.filter((p,d)=>c(p,d)||f(p,d)):i==="data"?t.filter((p,d)=>{let x=n.routes[p.route.id];if(!x||!x.hasLoader)return!1;if(c(p,d)||f(p,d))return!0;if(p.route.shouldRevalidate){let w=p.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof w=="boolean")return w}return!0}):[]}function e3(r,t,{includeHydrateFallback:e}={}){return t3(r.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),e&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function t3(r){return[...new Set(r)]}function n3(r){let t={},e=Object.keys(r).sort();for(let n of e)t[n]=r[n];return t}function r3(r,t){let e=new Set;return new Set(t),r.reduce((n,a)=>{let i=JSON.stringify(n3(a));return e.has(i)||(e.add(i),n.push({key:i,link:a})),n},[])}function Xx(){let r=De.useContext(tl);return r1(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function a3(){let r=De.useContext(Oh);return r1(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var a1=De.createContext(void 0);a1.displayName="FrameworkContext";function Yx(){let r=De.useContext(a1);return r1(r,"You must render this element inside a <HydratedRouter> element"),r}function i3(r,t){let e=De.useContext(a1),[n,a]=De.useState(!1),[i,c]=De.useState(!1),{onFocus:f,onBlur:p,onMouseEnter:d,onMouseLeave:x,onTouchStart:w}=t,C=De.useRef(null);De.useEffect(()=>{if(r==="render"&&c(!0),r==="viewport"){let N=M=>{M.forEach(B=>{c(B.isIntersecting)})},D=new IntersectionObserver(N,{threshold:.5});return C.current&&D.observe(C.current),()=>{D.disconnect()}}},[r]),De.useEffect(()=>{if(n){let N=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(N)}}},[n]);let S=()=>{a(!0)},R=()=>{a(!1),c(!1)};return e?r!=="intent"?[i,C,{}]:[i,C,{onFocus:tc(f,S),onBlur:tc(p,R),onMouseEnter:tc(d,S),onMouseLeave:tc(x,R),onTouchStart:tc(w,S)}]:[!1,C,{}]}function tc(r,t){return e=>{r&&r(e),e.defaultPrevented||t(e)}}function o3({page:r,...t}){let{router:e}=Xx(),n=De.useMemo(()=>kx(e.routes,r,e.basename),[e.routes,r,e.basename]);return n?De.createElement(u3,{page:r,matches:n,...t}):null}function s3(r){let{manifest:t,routeModules:e}=Yx(),[n,a]=De.useState([]);return De.useEffect(()=>{let i=!1;return $C(r,t,e).then(c=>{i||a(c)}),()=>{i=!0}},[r,t,e]),n}function u3({page:r,matches:t,...e}){let n=zs(),{manifest:a,routeModules:i}=Yx(),{basename:c}=Xx(),{loaderData:f,matches:p}=a3(),d=De.useMemo(()=>m2(r,t,p,a,n,"data"),[r,t,p,a,n]),x=De.useMemo(()=>m2(r,t,p,a,n,"assets"),[r,t,p,a,n]),w=De.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let R=new Set,N=!1;if(t.forEach(M=>{let B=a.routes[M.route.id];!B||!B.hasLoader||(!d.some(k=>k.route.id===M.route.id)&&M.route.id in f&&i[M.route.id]?.shouldRevalidate||B.hasClientLoader?N=!0:R.add(M.route.id))}),R.size===0)return[];let D=ZC(r,c,"data");return N&&R.size>0&&D.searchParams.set("_routes",t.filter(M=>R.has(M.route.id)).map(M=>M.route.id).join(",")),[D.pathname+D.search]},[c,f,n,a,d,t,r,i]),C=De.useMemo(()=>e3(x,a),[x,a]),S=s3(x);return De.createElement(De.Fragment,null,w.map(R=>De.createElement("link",{key:R,rel:"prefetch",as:"fetch",href:R,...e})),C.map(R=>De.createElement("link",{key:R,rel:"modulepreload",href:R,...e})),S.map(({key:R,link:N})=>De.createElement("link",{key:R,nonce:e.nonce,...N})))}function l3(...r){return t=>{r.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var qx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{qx&&(window.__reactRouterVersion="7.9.3")}catch{}function c3({basename:r,children:t,window:e}){let n=De.useRef();n.current==null&&(n.current=QE({window:e,v5Compat:!0}));let a=n.current,[i,c]=De.useState({action:a.action,location:a.location}),f=De.useCallback(p=>{De.startTransition(()=>c(p))},[c]);return De.useLayoutEffect(()=>a.listen(f),[a,f]),De.createElement(zC,{basename:r,children:t,location:i.location,navigationType:i.action,navigator:a})}var Kx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zx=De.forwardRef(function({onClick:t,discover:e="render",prefetch:n="none",relative:a,reloadDocument:i,replace:c,state:f,target:p,to:d,preventScrollReset:x,viewTransition:w,...C},S){let{basename:R}=De.useContext(Ii),N=typeof d=="string"&&Kx.test(d),D,M=!1;if(typeof d=="string"&&N&&(D=d,qx))try{let H=new URL(window.location.href),Z=d.startsWith("//")?new URL(H.protocol+d):new URL(d),ie=ao(Z.pathname,R);Z.origin===H.origin&&ie!=null?d=ie+Z.search+Z.hash:M=!0}catch{_i(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let B=AC(d,{relative:a}),[k,L,F]=i3(n,C),W=p3(d,{replace:c,state:f,target:p,preventScrollReset:x,relative:a,viewTransition:w});function G(H){t&&t(H),H.defaultPrevented||W(H)}let q=De.createElement("a",{...C,...F,href:D||B,onClick:M||i?t:G,ref:l3(S,L),target:p,"data-discover":!N&&e==="render"?"true":void 0});return k&&!N?De.createElement(De.Fragment,null,q,De.createElement(o3,{page:B})):q});Zx.displayName="Link";var f3=De.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:n="",end:a=!1,style:i,to:c,viewTransition:f,children:p,...d},x){let w=bc(c,{relative:d.relative}),C=zs(),S=De.useContext(Oh),{navigator:R,basename:N}=De.useContext(Ii),D=S!=null&&y3(w)&&f===!0,M=R.encodeLocation?R.encodeLocation(w).pathname:w.pathname,B=C.pathname,k=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;e||(B=B.toLowerCase(),k=k?k.toLowerCase():null,M=M.toLowerCase()),k&&N&&(k=ao(k,N)||k);const L=M!=="/"&&M.endsWith("/")?M.length-1:M.length;let F=B===M||!a&&B.startsWith(M)&&B.charAt(L)==="/",W=k!=null&&(k===M||!a&&k.startsWith(M)&&k.charAt(M.length)==="/"),G={isActive:F,isPending:W,isTransitioning:D},q=F?t:void 0,H;typeof n=="function"?H=n(G):H=[n,F?"active":null,W?"pending":null,D?"transitioning":null].filter(Boolean).join(" ");let Z=typeof i=="function"?i(G):i;return De.createElement(Zx,{...d,"aria-current":q,className:H,ref:x,style:Z,to:c,viewTransition:f},typeof p=="function"?p(G):p)});f3.displayName="NavLink";var h3=De.forwardRef(({discover:r="render",fetcherKey:t,navigate:e,reloadDocument:n,replace:a,state:i,method:c=ah,action:f,onSubmit:p,relative:d,preventScrollReset:x,viewTransition:w,...C},S)=>{let R=m3(),N=x3(f,{relative:d}),D=c.toLowerCase()==="get"?"get":"post",M=typeof f=="string"&&Kx.test(f),B=k=>{if(p&&p(k),k.defaultPrevented)return;k.preventDefault();let L=k.nativeEvent.submitter,F=L?.getAttribute("formmethod")||c;R(L||k.currentTarget,{fetcherKey:t,method:F,navigate:e,replace:a,state:i,relative:d,preventScrollReset:x,viewTransition:w})};return De.createElement("form",{ref:S,method:D,action:N,onSubmit:n?p:B,...C,"data-discover":!M&&r==="render"?"true":void 0})});h3.displayName="Form";function d3(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Qx(r){let t=De.useContext(tl);return In(t,d3(r)),t}function p3(r,{target:t,replace:e,state:n,preventScrollReset:a,relative:i,viewTransition:c}={}){let f=SC(),p=zs(),d=bc(r,{relative:i});return De.useCallback(x=>{if(XC(x,t)){x.preventDefault();let w=e!==void 0?e:cc(p)===cc(d);f(r,{replace:w,state:n,preventScrollReset:a,relative:i,viewTransition:c})}},[p,f,d,e,n,t,r,a,i,c])}var g3=0,v3=()=>`__${String(++g3)}__`;function m3(){let{router:r}=Qx("useSubmit"),{basename:t}=De.useContext(Ii),e=LC();return De.useCallback(async(n,a={})=>{let{action:i,method:c,encType:f,formData:p,body:d}=KC(n,t);if(a.navigate===!1){let x=a.fetcherKey||v3();await r.fetch(x,e,a.action||i,{preventScrollReset:a.preventScrollReset,formData:p,body:d,formMethod:a.method||c,formEncType:a.encType||f,flushSync:a.flushSync})}else await r.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:p,body:d,formMethod:a.method||c,formEncType:a.encType||f,replace:a.replace,state:a.state,fromRouteId:e,flushSync:a.flushSync,viewTransition:a.viewTransition})},[r,t,e])}function x3(r,{relative:t}={}){let{basename:e}=De.useContext(Ii),n=De.useContext(io);In(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...bc(r||".",{relative:t})},c=zs();if(r==null){i.search=c.search;let f=new URLSearchParams(i.search),p=f.getAll("index");if(p.some(x=>x==="")){f.delete("index"),p.filter(w=>w).forEach(w=>f.append("index",w));let x=f.toString();i.search=x?`?${x}`:""}}return(!r||r===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(i.pathname=i.pathname==="/"?e:ro([e,i.pathname])),cc(i)}function y3(r,{relative:t}={}){let e=De.useContext(Hx);In(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Qx("useViewTransitionState"),a=bc(r,{relative:t});if(!e.isTransitioning)return!1;let i=ao(e.currentLocation.pathname,n)||e.currentLocation.pathname,c=ao(e.nextLocation.pathname,n)||e.nextLocation.pathname;return sh(a.pathname,c)!=null||sh(a.pathname,i)!=null}const b3=()=>Fn.jsx("div",{className:"p-4",children:Fn.jsx("h2",{className:"text-xl font-bold",children:"Teacher Dashboard"})});var qe;(function(r){r[r.QR_CODE=0]="QR_CODE",r[r.AZTEC=1]="AZTEC",r[r.CODABAR=2]="CODABAR",r[r.CODE_39=3]="CODE_39",r[r.CODE_93=4]="CODE_93",r[r.CODE_128=5]="CODE_128",r[r.DATA_MATRIX=6]="DATA_MATRIX",r[r.MAXICODE=7]="MAXICODE",r[r.ITF=8]="ITF",r[r.EAN_13=9]="EAN_13",r[r.EAN_8=10]="EAN_8",r[r.PDF_417=11]="PDF_417",r[r.RSS_14=12]="RSS_14",r[r.RSS_EXPANDED=13]="RSS_EXPANDED",r[r.UPC_A=14]="UPC_A",r[r.UPC_E=15]="UPC_E",r[r.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(qe||(qe={}));var x2=new Map([[qe.QR_CODE,"QR_CODE"],[qe.AZTEC,"AZTEC"],[qe.CODABAR,"CODABAR"],[qe.CODE_39,"CODE_39"],[qe.CODE_93,"CODE_93"],[qe.CODE_128,"CODE_128"],[qe.DATA_MATRIX,"DATA_MATRIX"],[qe.MAXICODE,"MAXICODE"],[qe.ITF,"ITF"],[qe.EAN_13,"EAN_13"],[qe.EAN_8,"EAN_8"],[qe.PDF_417,"PDF_417"],[qe.RSS_14,"RSS_14"],[qe.RSS_EXPANDED,"RSS_EXPANDED"],[qe.UPC_A,"UPC_A"],[qe.UPC_E,"UPC_E"],[qe.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),y2;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.URL=1]="URL"})(y2||(y2={}));function w3(r){return Object.values(qe).includes(r)}var es;(function(r){r[r.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",r[r.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(es||(es={}));var Xa=(function(){function r(){}return r.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",r.SCAN_DEFAULT_FPS=2,r.DEFAULT_DISABLE_FLIP=!1,r.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,r.DEFAULT_SUPPORTED_SCAN_TYPE=[es.SCAN_TYPE_CAMERA,es.SCAN_TYPE_FILE],r})(),Jx=(function(){function r(t,e){this.format=t,this.formatName=e}return r.prototype.toString=function(){return this.formatName},r.create=function(t){if(!x2.has(t))throw"".concat(t," not in html5QrcodeSupportedFormatsTextMap");return new r(t,x2.get(t))},r})(),b2=(function(){function r(){}return r.createFromText=function(t){var e={text:t};return{decodedText:t,result:e}},r.createFromQrcodeResult=function(t){return{decodedText:t.text,result:t}},r})(),Rp;(function(r){r[r.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",r[r.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",r[r.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Rp||(Rp={}));var $x=(function(){function r(){}return r.createFrom=function(t){return{errorMessage:t,type:Rp.UNKWOWN_ERROR}},r})(),ey=(function(){function r(t){this.verbose=t}return r.prototype.log=function(t){this.verbose&&console.log(t)},r.prototype.warn=function(t){this.verbose&&console.warn(t)},r.prototype.logError=function(t,e){(this.verbose||e===!0)&&console.error(t)},r.prototype.logErrors=function(t){if(t.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(t)},r})();function mi(r){return typeof r>"u"||r===null}function E3(r,t,e){return r>e?e:r<t?t:r}var Hu=(function(){function r(){}return r.codeParseError=function(t){return"QR code parse error, error = ".concat(t)},r.errorGettingUserMedia=function(t){return"Error getting userMedia, error = ".concat(t)},r.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},r.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},r.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},r.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},r.scannerPaused=function(){return"Scanner paused"},r})(),on=(function(){function r(){}return r.scanningStatus=function(){return"Scanning"},r.idleStatus=function(){return"Idle"},r.errorStatus=function(){return"Error"},r.permissionStatus=function(){return"Permission"},r.noCameraFoundErrorStatus=function(){return"No Cameras"},r.lastMatch=function(t){return"Last Match: ".concat(t)},r.codeScannerTitle=function(){return"Code Scanner"},r.cameraPermissionTitle=function(){return"Request Camera Permissions"},r.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},r.noCameraFound=function(){return"No camera found"},r.scanButtonStopScanningText=function(){return"Stop Scanning"},r.scanButtonStartScanningText=function(){return"Start Scanning"},r.torchOnButton=function(){return"Switch On Torch"},r.torchOffButton=function(){return"Switch Off Torch"},r.torchOnFailedMessage=function(){return"Failed to turn on torch"},r.torchOffFailedMessage=function(){return"Failed to turn off torch"},r.scanButtonScanningStarting=function(){return"Launching Camera..."},r.textIfCameraScanSelected=function(){return"Scan an Image File"},r.textIfFileScanSelected=function(){return"Scan using camera directly"},r.selectCamera=function(){return"Select Camera"},r.fileSelectionChooseImage=function(){return"Choose Image"},r.fileSelectionChooseAnother=function(){return"Choose Another"},r.fileSelectionNoImageSelected=function(){return"No image choosen"},r.anonymousCameraPrefix=function(){return"Anonymous Camera"},r.dragAndDropMessage=function(){return"Or drop an image to scan"},r.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},r.zoom=function(){return"zoom"},r.loadingImage=function(){return"Loading image..."},r.cameraScanAltText=function(){return"Camera based scan"},r.fileScanAltText=function(){return"Fule based scan"},r})(),w2=(function(){function r(){}return r.poweredBy=function(){return"Powered by "},r.reportIssues=function(){return"Report issues"},r})(),ty=(function(){function r(){}return r.isMediaStreamConstraintsValid=function(t,e){if(typeof t!="object"){var n=typeof t;return e.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(n,"."),!0),!1}for(var a=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],i=new Set(a),c=Object.keys(t),f=0,p=c;f<p.length;f++){var d=p[f];if(i.has(d))return e.logError("".concat(d," is not supported videoConstaints."),!0),!1}return!0},r})(),oc={exports:{}},C3=oc.exports,E2;function A3(){return E2||(E2=1,(function(r,t){(function(e,n){n(t)})(C3,(function(e){function n(U){return U==null}var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(U,s){U.__proto__=s}||function(U,s){for(var l in s)s.hasOwnProperty(l)&&(U[l]=s[l])};function i(U,s){a(U,s);function l(){this.constructor=U}U.prototype=s===null?Object.create(s):(l.prototype=s.prototype,new l)}function c(U,s){var l=Object.setPrototypeOf;l?l(U,s):U.__proto__=s}function f(U,s){s===void 0&&(s=U.constructor);var l=Error.captureStackTrace;l&&l(U,s)}var p=(function(U){i(s,U);function s(l){var h=this.constructor,v=U.call(this,l)||this;return Object.defineProperty(v,"name",{value:h.name,enumerable:!1}),c(v,h.prototype),f(v),v}return s})(Error);class d extends p{constructor(s=void 0){super(s),this.message=s}getKind(){return this.constructor.kind}}d.kind="Exception";class x extends d{}x.kind="ArgumentException";class w extends d{}w.kind="IllegalArgumentException";class C{constructor(s){if(this.binarizer=s,s===null)throw new w("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(s,l){return this.binarizer.getBlackRow(s,l)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(s,l,h,v){const m=this.binarizer.getLuminanceSource().crop(s,l,h,v);return new C(this.binarizer.createBinarizer(m))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const s=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new C(this.binarizer.createBinarizer(s))}rotateCounterClockwise45(){const s=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new C(this.binarizer.createBinarizer(s))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class S extends d{static getChecksumInstance(){return new S}}S.kind="ChecksumException";class R{constructor(s){this.source=s}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class N{static arraycopy(s,l,h,v,m){for(;m--;)h[v++]=s[l++]}static currentTimeMillis(){return Date.now()}}class D extends d{}D.kind="IndexOutOfBoundsException";class M extends D{constructor(s=void 0,l=void 0){super(l),this.index=s,this.message=l}}M.kind="ArrayIndexOutOfBoundsException";class B{static fill(s,l){for(let h=0,v=s.length;h<v;h++)s[h]=l}static fillWithin(s,l,h,v){B.rangeCheck(s.length,l,h);for(let m=l;m<h;m++)s[m]=v}static rangeCheck(s,l,h){if(l>h)throw new w("fromIndex("+l+") > toIndex("+h+")");if(l<0)throw new M(l);if(h>s)throw new M(h)}static asList(...s){return s}static create(s,l,h){return Array.from({length:s}).map(m=>Array.from({length:l}).fill(h))}static createInt32Array(s,l,h){return Array.from({length:s}).map(m=>Int32Array.from({length:l}).fill(h))}static equals(s,l){if(!s||!l||!s.length||!l.length||s.length!==l.length)return!1;for(let h=0,v=s.length;h<v;h++)if(s[h]!==l[h])return!1;return!0}static hashCode(s){if(s===null)return 0;let l=1;for(const h of s)l=31*l+h;return l}static fillUint8Array(s,l){for(let h=0;h!==s.length;h++)s[h]=l}static copyOf(s,l){return s.slice(0,l)}static copyOfUint8Array(s,l){if(s.length<=l){const h=new Uint8Array(l);return h.set(s),h}return s.slice(0,l)}static copyOfRange(s,l,h){const v=h-l,m=new Int32Array(v);return N.arraycopy(s,l,m,0,v),m}static binarySearch(s,l,h){h===void 0&&(h=B.numberComparator);let v=0,m=s.length-1;for(;v<=m;){const b=m+v>>1,E=h(l,s[b]);if(E>0)v=b+1;else if(E<0)m=b-1;else return b}return-v-1}static numberComparator(s,l){return s-l}}class k{static numberOfTrailingZeros(s){let l;if(s===0)return 32;let h=31;return l=s<<16,l!==0&&(h-=16,s=l),l=s<<8,l!==0&&(h-=8,s=l),l=s<<4,l!==0&&(h-=4,s=l),l=s<<2,l!==0&&(h-=2,s=l),h-(s<<1>>>31)}static numberOfLeadingZeros(s){if(s===0)return 32;let l=1;return s>>>16||(l+=16,s<<=16),s>>>24||(l+=8,s<<=8),s>>>28||(l+=4,s<<=4),s>>>30||(l+=2,s<<=2),l-=s>>>31,l}static toHexString(s){return s.toString(16)}static toBinaryString(s){return String(parseInt(String(s),2))}static bitCount(s){return s=s-(s>>>1&1431655765),s=(s&858993459)+(s>>>2&858993459),s=s+(s>>>4)&252645135,s=s+(s>>>8),s=s+(s>>>16),s&63}static truncDivision(s,l){return Math.trunc(s/l)}static parseInt(s,l=void 0){return parseInt(s,l)}}k.MIN_VALUE_32_BITS=-2147483648,k.MAX_VALUE=Number.MAX_SAFE_INTEGER;class L{constructor(s,l){s===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=s,l==null?this.bits=L.makeArray(s):this.bits=l)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(s){if(s>this.bits.length*32){const l=L.makeArray(s);N.arraycopy(this.bits,0,l,0,this.bits.length),this.bits=l}}get(s){return(this.bits[Math.floor(s/32)]&1<<(s&31))!==0}set(s){this.bits[Math.floor(s/32)]|=1<<(s&31)}flip(s){this.bits[Math.floor(s/32)]^=1<<(s&31)}getNextSet(s){const l=this.size;if(s>=l)return l;const h=this.bits;let v=Math.floor(s/32),m=h[v];m&=~((1<<(s&31))-1);const b=h.length;for(;m===0;){if(++v===b)return l;m=h[v]}const E=v*32+k.numberOfTrailingZeros(m);return E>l?l:E}getNextUnset(s){const l=this.size;if(s>=l)return l;const h=this.bits;let v=Math.floor(s/32),m=~h[v];m&=~((1<<(s&31))-1);const b=h.length;for(;m===0;){if(++v===b)return l;m=~h[v]}const E=v*32+k.numberOfTrailingZeros(m);return E>l?l:E}setBulk(s,l){this.bits[Math.floor(s/32)]=l}setRange(s,l){if(l<s||s<0||l>this.size)throw new w;if(l===s)return;l--;const h=Math.floor(s/32),v=Math.floor(l/32),m=this.bits;for(let b=h;b<=v;b++){const E=b>h?0:s&31,I=(2<<(b<v?31:l&31))-(1<<E);m[b]|=I}}clear(){const s=this.bits.length,l=this.bits;for(let h=0;h<s;h++)l[h]=0}isRange(s,l,h){if(l<s||s<0||l>this.size)throw new w;if(l===s)return!0;l--;const v=Math.floor(s/32),m=Math.floor(l/32),b=this.bits;for(let E=v;E<=m;E++){const _=E>v?0:s&31,O=(2<<(E<m?31:l&31))-(1<<_)&4294967295;if((b[E]&O)!==(h?O:0))return!1}return!0}appendBit(s){this.ensureCapacity(this.size+1),s&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(s,l){if(l<0||l>32)throw new w("Num bits must be between 0 and 32");this.ensureCapacity(this.size+l);for(let h=l;h>0;h--)this.appendBit((s>>h-1&1)===1)}appendBitArray(s){const l=s.size;this.ensureCapacity(this.size+l);for(let h=0;h<l;h++)this.appendBit(s.get(h))}xor(s){if(this.size!==s.size)throw new w("Sizes don't match");const l=this.bits;for(let h=0,v=l.length;h<v;h++)l[h]^=s.bits[h]}toBytes(s,l,h,v){for(let m=0;m<v;m++){let b=0;for(let E=0;E<8;E++)this.get(s)&&(b|=1<<7-E),s++;l[h+m]=b}}getBitArray(){return this.bits}reverse(){const s=new Int32Array(this.bits.length),l=Math.floor((this.size-1)/32),h=l+1,v=this.bits;for(let m=0;m<h;m++){let b=v[m];b=b>>1&1431655765|(b&1431655765)<<1,b=b>>2&858993459|(b&858993459)<<2,b=b>>4&252645135|(b&252645135)<<4,b=b>>8&16711935|(b&16711935)<<8,b=b>>16&65535|(b&65535)<<16,s[l-m]=b}if(this.size!==h*32){const m=h*32-this.size;let b=s[0]>>>m;for(let E=1;E<h;E++){const _=s[E];b|=_<<32-m,s[E-1]=b,b=_>>>m}s[h-1]=b}this.bits=s}static makeArray(s){return new Int32Array(Math.floor((s+31)/32))}equals(s){if(!(s instanceof L))return!1;const l=s;return this.size===l.size&&B.equals(this.bits,l.bits)}hashCode(){return 31*this.size+B.hashCode(this.bits)}toString(){let s="";for(let l=0,h=this.size;l<h;l++)(l&7)===0&&(s+=" "),s+=this.get(l)?"X":".";return s}clone(){return new L(this.size,this.bits.slice())}}var F;(function(U){U[U.OTHER=0]="OTHER",U[U.PURE_BARCODE=1]="PURE_BARCODE",U[U.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",U[U.TRY_HARDER=3]="TRY_HARDER",U[U.CHARACTER_SET=4]="CHARACTER_SET",U[U.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",U[U.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",U[U.ASSUME_GS1=7]="ASSUME_GS1",U[U.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",U[U.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",U[U.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(F||(F={}));var W=F;class G extends d{static getFormatInstance(){return new G}}G.kind="FormatException";var q;(function(U){U[U.Cp437=0]="Cp437",U[U.ISO8859_1=1]="ISO8859_1",U[U.ISO8859_2=2]="ISO8859_2",U[U.ISO8859_3=3]="ISO8859_3",U[U.ISO8859_4=4]="ISO8859_4",U[U.ISO8859_5=5]="ISO8859_5",U[U.ISO8859_6=6]="ISO8859_6",U[U.ISO8859_7=7]="ISO8859_7",U[U.ISO8859_8=8]="ISO8859_8",U[U.ISO8859_9=9]="ISO8859_9",U[U.ISO8859_10=10]="ISO8859_10",U[U.ISO8859_11=11]="ISO8859_11",U[U.ISO8859_13=12]="ISO8859_13",U[U.ISO8859_14=13]="ISO8859_14",U[U.ISO8859_15=14]="ISO8859_15",U[U.ISO8859_16=15]="ISO8859_16",U[U.SJIS=16]="SJIS",U[U.Cp1250=17]="Cp1250",U[U.Cp1251=18]="Cp1251",U[U.Cp1252=19]="Cp1252",U[U.Cp1256=20]="Cp1256",U[U.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",U[U.UTF8=22]="UTF8",U[U.ASCII=23]="ASCII",U[U.Big5=24]="Big5",U[U.GB18030=25]="GB18030",U[U.EUC_KR=26]="EUC_KR"})(q||(q={}));class H{constructor(s,l,h,...v){this.valueIdentifier=s,this.name=h,typeof l=="number"?this.values=Int32Array.from([l]):this.values=l,this.otherEncodingNames=v,H.VALUE_IDENTIFIER_TO_ECI.set(s,this),H.NAME_TO_ECI.set(h,this);const m=this.values;for(let b=0,E=m.length;b!==E;b++){const _=m[b];H.VALUES_TO_ECI.set(_,this)}for(const b of v)H.NAME_TO_ECI.set(b,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(s){if(s<0||s>=900)throw new G("incorect value");const l=H.VALUES_TO_ECI.get(s);if(l===void 0)throw new G("incorect value");return l}static getCharacterSetECIByName(s){const l=H.NAME_TO_ECI.get(s);if(l===void 0)throw new G("incorect value");return l}equals(s){if(!(s instanceof H))return!1;const l=s;return this.getName()===l.getName()}}H.VALUE_IDENTIFIER_TO_ECI=new Map,H.VALUES_TO_ECI=new Map,H.NAME_TO_ECI=new Map,H.Cp437=new H(q.Cp437,Int32Array.from([0,2]),"Cp437"),H.ISO8859_1=new H(q.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),H.ISO8859_2=new H(q.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),H.ISO8859_3=new H(q.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),H.ISO8859_4=new H(q.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),H.ISO8859_5=new H(q.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),H.ISO8859_6=new H(q.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),H.ISO8859_7=new H(q.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),H.ISO8859_8=new H(q.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),H.ISO8859_9=new H(q.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),H.ISO8859_10=new H(q.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),H.ISO8859_11=new H(q.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),H.ISO8859_13=new H(q.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),H.ISO8859_14=new H(q.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),H.ISO8859_15=new H(q.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),H.ISO8859_16=new H(q.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),H.SJIS=new H(q.SJIS,20,"SJIS","Shift_JIS"),H.Cp1250=new H(q.Cp1250,21,"Cp1250","windows-1250"),H.Cp1251=new H(q.Cp1251,22,"Cp1251","windows-1251"),H.Cp1252=new H(q.Cp1252,23,"Cp1252","windows-1252"),H.Cp1256=new H(q.Cp1256,24,"Cp1256","windows-1256"),H.UnicodeBigUnmarked=new H(q.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),H.UTF8=new H(q.UTF8,26,"UTF8","UTF-8"),H.ASCII=new H(q.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),H.Big5=new H(q.Big5,28,"Big5"),H.GB18030=new H(q.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),H.EUC_KR=new H(q.EUC_KR,30,"EUC_KR","EUC-KR");class Z extends d{}Z.kind="UnsupportedOperationException";class ie{static decode(s,l){const h=this.encodingName(l);return this.customDecoder?this.customDecoder(s,h):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(h)?this.decodeFallback(s,h):new TextDecoder(h).decode(s)}static shouldDecodeOnFallback(s){return!ie.isBrowser()&&s==="ISO-8859-1"}static encode(s,l){const h=this.encodingName(l);return this.customEncoder?this.customEncoder(s,h):typeof TextEncoder>"u"?this.encodeFallback(s):new TextEncoder().encode(s)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(s){return typeof s=="string"?s:s.getName()}static encodingCharacterSet(s){return s instanceof H?s:H.getCharacterSetECIByName(s)}static decodeFallback(s,l){const h=this.encodingCharacterSet(l);if(ie.isDecodeFallbackSupported(h)){let v="";for(let m=0,b=s.length;m<b;m++){let E=s[m].toString(16);E.length<2&&(E="0"+E),v+="%"+E}return decodeURIComponent(v)}if(h.equals(H.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(s.buffer));throw new Z(`Encoding ${this.encodingName(l)} not supported by fallback.`)}static isDecodeFallbackSupported(s){return s.equals(H.UTF8)||s.equals(H.ISO8859_1)||s.equals(H.ASCII)}static encodeFallback(s){const h=btoa(unescape(encodeURIComponent(s))).split(""),v=[];for(let m=0;m<h.length;m++)v.push(h[m].charCodeAt(0));return new Uint8Array(v)}}class ee{static castAsNonUtf8Char(s,l=null){const h=l?l.getName():this.ISO88591;return ie.decode(new Uint8Array([s]),h)}static guessEncoding(s,l){if(l!=null&&l.get(W.CHARACTER_SET)!==void 0)return l.get(W.CHARACTER_SET).toString();const h=s.length;let v=!0,m=!0,b=!0,E=0,_=0,I=0,O=0,z=0,V=0,Q=0,ae=0,se=0,de=0,be=0;const Pe=s.length>3&&s[0]===239&&s[1]===187&&s[2]===191;for(let Ue=0;Ue<h&&(v||m||b);Ue++){const Fe=s[Ue]&255;b&&(E>0?(Fe&128)===0?b=!1:E--:(Fe&128)!==0&&((Fe&64)===0?b=!1:(E++,(Fe&32)===0?_++:(E++,(Fe&16)===0?I++:(E++,(Fe&8)===0?O++:b=!1))))),v&&(Fe>127&&Fe<160?v=!1:Fe>159&&(Fe<192||Fe===215||Fe===247)&&be++),m&&(z>0?Fe<64||Fe===127||Fe>252?m=!1:z--:Fe===128||Fe===160||Fe>239?m=!1:Fe>160&&Fe<224?(V++,ae=0,Q++,Q>se&&(se=Q)):Fe>127?(z++,Q=0,ae++,ae>de&&(de=ae)):(Q=0,ae=0))}return b&&E>0&&(b=!1),m&&z>0&&(m=!1),b&&(Pe||_+I+O>0)?ee.UTF8:m&&(ee.ASSUME_SHIFT_JIS||se>=3||de>=3)?ee.SHIFT_JIS:v&&m?se===2&&V===2||be*10>=h?ee.SHIFT_JIS:ee.ISO88591:v?ee.ISO88591:m?ee.SHIFT_JIS:b?ee.UTF8:ee.PLATFORM_DEFAULT_ENCODING}static format(s,...l){let h=-1;function v(b,E,_,I,O,z){if(b==="%%")return"%";if(l[++h]===void 0)return;b=I?parseInt(I.substr(1)):void 0;let V=O?parseInt(O.substr(1)):void 0,Q;switch(z){case"s":Q=l[h];break;case"c":Q=l[h][0];break;case"f":Q=parseFloat(l[h]).toFixed(b);break;case"p":Q=parseFloat(l[h]).toPrecision(b);break;case"e":Q=parseFloat(l[h]).toExponential(b);break;case"x":Q=parseInt(l[h]).toString(V||16);break;case"d":Q=parseFloat(parseInt(l[h],V||10).toPrecision(b)).toFixed(0);break}Q=typeof Q=="object"?JSON.stringify(Q):(+Q).toString(V);let ae=parseInt(_),se=_&&_[0]+""=="0"?"0":" ";for(;Q.length<ae;)Q=E!==void 0?Q+se:se+Q;return Q}let m=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return s.replace(m,v)}static getBytes(s,l){return ie.encode(s,l)}static getCharCode(s,l=0){return s.charCodeAt(l)}static getCharAt(s){return String.fromCharCode(s)}}ee.SHIFT_JIS=H.SJIS.getName(),ee.GB2312="GB2312",ee.ISO88591=H.ISO8859_1.getName(),ee.EUC_JP="EUC_JP",ee.UTF8=H.UTF8.getName(),ee.PLATFORM_DEFAULT_ENCODING=ee.UTF8,ee.ASSUME_SHIFT_JIS=!1;class me{constructor(s=""){this.value=s}enableDecoding(s){return this.encoding=s,this}append(s){return typeof s=="string"?this.value+=s.toString():this.encoding?this.value+=ee.castAsNonUtf8Char(s,this.encoding):this.value+=String.fromCharCode(s),this}appendChars(s,l,h){for(let v=l;l<l+h;v++)this.append(s[v]);return this}length(){return this.value.length}charAt(s){return this.value.charAt(s)}deleteCharAt(s){this.value=this.value.substr(0,s)+this.value.substring(s+1)}setCharAt(s,l){this.value=this.value.substr(0,s)+l+this.value.substr(s+1)}substring(s,l){return this.value.substring(s,l)}setLengthToZero(){this.value=""}toString(){return this.value}insert(s,l){this.value=this.value.substr(0,s)+l+this.value.substr(s+l.length)}}class xe{constructor(s,l,h,v){if(this.width=s,this.height=l,this.rowSize=h,this.bits=v,l==null&&(l=s),this.height=l,s<1||l<1)throw new w("Both dimensions must be greater than 0");h==null&&(h=Math.floor((s+31)/32)),this.rowSize=h,v==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(s){const l=s.length,h=s[0].length,v=new xe(h,l);for(let m=0;m<l;m++){const b=s[m];for(let E=0;E<h;E++)b[E]&&v.set(E,m)}return v}static parseFromString(s,l,h){if(s===null)throw new w("stringRepresentation cannot be null");const v=new Array(s.length);let m=0,b=0,E=-1,_=0,I=0;for(;I<s.length;)if(s.charAt(I)===`
`||s.charAt(I)==="\r"){if(m>b){if(E===-1)E=m-b;else if(m-b!==E)throw new w("row lengths do not match");b=m,_++}I++}else if(s.substring(I,I+l.length)===l)I+=l.length,v[m]=!0,m++;else if(s.substring(I,I+h.length)===h)I+=h.length,v[m]=!1,m++;else throw new w("illegal character encountered: "+s.substring(I));if(m>b){if(E===-1)E=m-b;else if(m-b!==E)throw new w("row lengths do not match");_++}const O=new xe(E,_);for(let z=0;z<m;z++)v[z]&&O.set(Math.floor(z%E),Math.floor(z/E));return O}get(s,l){const h=l*this.rowSize+Math.floor(s/32);return(this.bits[h]>>>(s&31)&1)!==0}set(s,l){const h=l*this.rowSize+Math.floor(s/32);this.bits[h]|=1<<(s&31)&4294967295}unset(s,l){const h=l*this.rowSize+Math.floor(s/32);this.bits[h]&=~(1<<(s&31)&4294967295)}flip(s,l){const h=l*this.rowSize+Math.floor(s/32);this.bits[h]^=1<<(s&31)&4294967295}xor(s){if(this.width!==s.getWidth()||this.height!==s.getHeight()||this.rowSize!==s.getRowSize())throw new w("input matrix dimensions do not match");const l=new L(Math.floor(this.width/32)+1),h=this.rowSize,v=this.bits;for(let m=0,b=this.height;m<b;m++){const E=m*h,_=s.getRow(m,l).getBitArray();for(let I=0;I<h;I++)v[E+I]^=_[I]}}clear(){const s=this.bits,l=s.length;for(let h=0;h<l;h++)s[h]=0}setRegion(s,l,h,v){if(l<0||s<0)throw new w("Left and top must be nonnegative");if(v<1||h<1)throw new w("Height and width must be at least 1");const m=s+h,b=l+v;if(b>this.height||m>this.width)throw new w("The region must fit inside the matrix");const E=this.rowSize,_=this.bits;for(let I=l;I<b;I++){const O=I*E;for(let z=s;z<m;z++)_[O+Math.floor(z/32)]|=1<<(z&31)&4294967295}}getRow(s,l){l==null||l.getSize()<this.width?l=new L(this.width):l.clear();const h=this.rowSize,v=this.bits,m=s*h;for(let b=0;b<h;b++)l.setBulk(b*32,v[m+b]);return l}setRow(s,l){N.arraycopy(l.getBitArray(),0,this.bits,s*this.rowSize,this.rowSize)}rotate180(){const s=this.getWidth(),l=this.getHeight();let h=new L(s),v=new L(s);for(let m=0,b=Math.floor((l+1)/2);m<b;m++)h=this.getRow(m,h),v=this.getRow(l-1-m,v),h.reverse(),v.reverse(),this.setRow(m,v),this.setRow(l-1-m,h)}getEnclosingRectangle(){const s=this.width,l=this.height,h=this.rowSize,v=this.bits;let m=s,b=l,E=-1,_=-1;for(let I=0;I<l;I++)for(let O=0;O<h;O++){const z=v[I*h+O];if(z!==0){if(I<b&&(b=I),I>_&&(_=I),O*32<m){let V=0;for(;(z<<31-V&4294967295)===0;)V++;O*32+V<m&&(m=O*32+V)}if(O*32+31>E){let V=31;for(;!(z>>>V);)V--;O*32+V>E&&(E=O*32+V)}}}return E<m||_<b?null:Int32Array.from([m,b,E-m+1,_-b+1])}getTopLeftOnBit(){const s=this.rowSize,l=this.bits;let h=0;for(;h<l.length&&l[h]===0;)h++;if(h===l.length)return null;const v=h/s;let m=h%s*32;const b=l[h];let E=0;for(;(b<<31-E&4294967295)===0;)E++;return m+=E,Int32Array.from([m,v])}getBottomRightOnBit(){const s=this.rowSize,l=this.bits;let h=l.length-1;for(;h>=0&&l[h]===0;)h--;if(h<0)return null;const v=Math.floor(h/s);let m=Math.floor(h%s)*32;const b=l[h];let E=31;for(;!(b>>>E);)E--;return m+=E,Int32Array.from([m,v])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(s){if(!(s instanceof xe))return!1;const l=s;return this.width===l.width&&this.height===l.height&&this.rowSize===l.rowSize&&B.equals(this.bits,l.bits)}hashCode(){let s=this.width;return s=31*s+this.width,s=31*s+this.height,s=31*s+this.rowSize,s=31*s+B.hashCode(this.bits),s}toString(s="X ",l="  ",h=`
`){return this.buildToString(s,l,h)}buildToString(s,l,h){let v=new me;for(let m=0,b=this.height;m<b;m++){for(let E=0,_=this.width;E<_;E++)v.append(this.get(E,m)?s:l);v.append(h)}return v.toString()}clone(){return new xe(this.width,this.height,this.rowSize,this.bits.slice())}}class $ extends d{static getNotFoundInstance(){return new $}}$.kind="NotFoundException";class te extends R{constructor(s){super(s),this.luminances=te.EMPTY,this.buckets=new Int32Array(te.LUMINANCE_BUCKETS)}getBlackRow(s,l){const h=this.getLuminanceSource(),v=h.getWidth();l==null||l.getSize()<v?l=new L(v):l.clear(),this.initArrays(v);const m=h.getRow(s,this.luminances),b=this.buckets;for(let _=0;_<v;_++)b[(m[_]&255)>>te.LUMINANCE_SHIFT]++;const E=te.estimateBlackPoint(b);if(v<3)for(let _=0;_<v;_++)(m[_]&255)<E&&l.set(_);else{let _=m[0]&255,I=m[1]&255;for(let O=1;O<v-1;O++){const z=m[O+1]&255;(I*4-_-z)/2<E&&l.set(O),_=I,I=z}}return l}getBlackMatrix(){const s=this.getLuminanceSource(),l=s.getWidth(),h=s.getHeight(),v=new xe(l,h);this.initArrays(l);const m=this.buckets;for(let _=1;_<5;_++){const I=Math.floor(h*_/5),O=s.getRow(I,this.luminances),z=Math.floor(l*4/5);for(let V=Math.floor(l/5);V<z;V++){const Q=O[V]&255;m[Q>>te.LUMINANCE_SHIFT]++}}const b=te.estimateBlackPoint(m),E=s.getMatrix();for(let _=0;_<h;_++){const I=_*l;for(let O=0;O<l;O++)(E[I+O]&255)<b&&v.set(O,_)}return v}createBinarizer(s){return new te(s)}initArrays(s){this.luminances.length<s&&(this.luminances=new Uint8ClampedArray(s));const l=this.buckets;for(let h=0;h<te.LUMINANCE_BUCKETS;h++)l[h]=0}static estimateBlackPoint(s){const l=s.length;let h=0,v=0,m=0;for(let O=0;O<l;O++)s[O]>m&&(v=O,m=s[O]),s[O]>h&&(h=s[O]);let b=0,E=0;for(let O=0;O<l;O++){const z=O-v,V=s[O]*z*z;V>E&&(b=O,E=V)}if(v>b){const O=v;v=b,b=O}if(b-v<=l/16)throw new $;let _=b-1,I=-1;for(let O=b-1;O>v;O--){const z=O-v,V=z*z*(b-O)*(h-s[O]);V>I&&(_=O,I=V)}return _<<te.LUMINANCE_SHIFT}}te.LUMINANCE_BITS=5,te.LUMINANCE_SHIFT=8-te.LUMINANCE_BITS,te.LUMINANCE_BUCKETS=1<<te.LUMINANCE_BITS,te.EMPTY=Uint8ClampedArray.from([0]);class re extends te{constructor(s){super(s),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const s=this.getLuminanceSource(),l=s.getWidth(),h=s.getHeight();if(l>=re.MINIMUM_DIMENSION&&h>=re.MINIMUM_DIMENSION){const v=s.getMatrix();let m=l>>re.BLOCK_SIZE_POWER;(l&re.BLOCK_SIZE_MASK)!==0&&m++;let b=h>>re.BLOCK_SIZE_POWER;(h&re.BLOCK_SIZE_MASK)!==0&&b++;const E=re.calculateBlackPoints(v,m,b,l,h),_=new xe(l,h);re.calculateThresholdForBlock(v,m,b,l,h,E,_),this.matrix=_}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(s){return new re(s)}static calculateThresholdForBlock(s,l,h,v,m,b,E){const _=m-re.BLOCK_SIZE,I=v-re.BLOCK_SIZE;for(let O=0;O<h;O++){let z=O<<re.BLOCK_SIZE_POWER;z>_&&(z=_);const V=re.cap(O,2,h-3);for(let Q=0;Q<l;Q++){let ae=Q<<re.BLOCK_SIZE_POWER;ae>I&&(ae=I);const se=re.cap(Q,2,l-3);let de=0;for(let Pe=-2;Pe<=2;Pe++){const Ue=b[V+Pe];de+=Ue[se-2]+Ue[se-1]+Ue[se]+Ue[se+1]+Ue[se+2]}const be=de/25;re.thresholdBlock(s,ae,z,be,v,E)}}}static cap(s,l,h){return s<l?l:s>h?h:s}static thresholdBlock(s,l,h,v,m,b){for(let E=0,_=h*m+l;E<re.BLOCK_SIZE;E++,_+=m)for(let I=0;I<re.BLOCK_SIZE;I++)(s[_+I]&255)<=v&&b.set(l+I,h+E)}static calculateBlackPoints(s,l,h,v,m){const b=m-re.BLOCK_SIZE,E=v-re.BLOCK_SIZE,_=new Array(h);for(let I=0;I<h;I++){_[I]=new Int32Array(l);let O=I<<re.BLOCK_SIZE_POWER;O>b&&(O=b);for(let z=0;z<l;z++){let V=z<<re.BLOCK_SIZE_POWER;V>E&&(V=E);let Q=0,ae=255,se=0;for(let be=0,Pe=O*v+V;be<re.BLOCK_SIZE;be++,Pe+=v){for(let Ue=0;Ue<re.BLOCK_SIZE;Ue++){const Fe=s[Pe+Ue]&255;Q+=Fe,Fe<ae&&(ae=Fe),Fe>se&&(se=Fe)}if(se-ae>re.MIN_DYNAMIC_RANGE)for(be++,Pe+=v;be<re.BLOCK_SIZE;be++,Pe+=v)for(let Ue=0;Ue<re.BLOCK_SIZE;Ue++)Q+=s[Pe+Ue]&255}let de=Q>>re.BLOCK_SIZE_POWER*2;if(se-ae<=re.MIN_DYNAMIC_RANGE&&(de=ae/2,I>0&&z>0)){const be=(_[I-1][z]+2*_[I][z-1]+_[I-1][z-1])/4;ae<be&&(de=be)}_[I][z]=de}}return _}}re.BLOCK_SIZE_POWER=3,re.BLOCK_SIZE=1<<re.BLOCK_SIZE_POWER,re.BLOCK_SIZE_MASK=re.BLOCK_SIZE-1,re.MINIMUM_DIMENSION=re.BLOCK_SIZE*5,re.MIN_DYNAMIC_RANGE=24;class he{constructor(s,l){this.width=s,this.height=l}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(s,l,h,v){throw new Z("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Z("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Z("This luminance source does not support rotation by 45 degrees.")}toString(){const s=new Uint8ClampedArray(this.width);let l=new me;for(let h=0;h<this.height;h++){const v=this.getRow(h,s);for(let m=0;m<this.width;m++){const b=v[m]&255;let E;b<64?E="#":b<128?E="+":b<192?E=".":E=" ",l.append(E)}l.append(`
`)}return l.toString()}}class Se extends he{constructor(s){super(s.getWidth(),s.getHeight()),this.delegate=s}getRow(s,l){const h=this.delegate.getRow(s,l),v=this.getWidth();for(let m=0;m<v;m++)h[m]=255-(h[m]&255);return h}getMatrix(){const s=this.delegate.getMatrix(),l=this.getWidth()*this.getHeight(),h=new Uint8ClampedArray(l);for(let v=0;v<l;v++)h[v]=255-(s[v]&255);return h}isCropSupported(){return this.delegate.isCropSupported()}crop(s,l,h,v){return new Se(this.delegate.crop(s,l,h,v))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new Se(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new Se(this.delegate.rotateCounterClockwise45())}}class Y extends he{constructor(s){super(s.width,s.height),this.canvas=s,this.tempCanvasElement=null,this.buffer=Y.makeBufferFromCanvasImageData(s)}static makeBufferFromCanvasImageData(s){const l=s.getContext("2d").getImageData(0,0,s.width,s.height);return Y.toGrayscaleBuffer(l.data,s.width,s.height)}static toGrayscaleBuffer(s,l,h){const v=new Uint8ClampedArray(l*h);for(let m=0,b=0,E=s.length;m<E;m+=4,b++){let _;if(s[m+3]===0)_=255;else{const O=s[m],z=s[m+1],V=s[m+2];_=306*O+601*z+117*V+512>>10}v[b]=_}return v}getRow(s,l){if(s<0||s>=this.getHeight())throw new w("Requested row is outside the image: "+s);const h=this.getWidth(),v=s*h;return l===null?l=this.buffer.slice(v,v+h):(l.length<h&&(l=new Uint8ClampedArray(h)),l.set(this.buffer.slice(v,v+h))),l}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(s,l,h,v){return super.crop(s,l,h,v),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const s=this.canvas.ownerDocument.createElement("canvas");s.width=this.canvas.width,s.height=this.canvas.height,this.tempCanvasElement=s}return this.tempCanvasElement}rotate(s){const l=this.getTempCanvasElement(),h=l.getContext("2d"),v=s*Y.DEGREE_TO_RADIANS,m=this.canvas.width,b=this.canvas.height,E=Math.ceil(Math.abs(Math.cos(v))*m+Math.abs(Math.sin(v))*b),_=Math.ceil(Math.abs(Math.sin(v))*m+Math.abs(Math.cos(v))*b);return l.width=E,l.height=_,h.translate(E/2,_/2),h.rotate(v),h.drawImage(this.canvas,m/-2,b/-2),this.buffer=Y.makeBufferFromCanvasImageData(l),this}invert(){return new Se(this)}}Y.DEGREE_TO_RADIANS=Math.PI/180;class fe{constructor(s,l,h){this.deviceId=s,this.label=l,this.kind="videoinput",this.groupId=h||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Ae=(globalThis||Vf||self||window||void 0)&&(globalThis||Vf||self||window||void 0).__awaiter||function(U,s,l,h){function v(m){return m instanceof l?m:new l(function(b){b(m)})}return new(l||(l=Promise))(function(m,b){function E(O){try{I(h.next(O))}catch(z){b(z)}}function _(O){try{I(h.throw(O))}catch(z){b(z)}}function I(O){O.done?m(O.value):v(O.value).then(E,_)}I((h=h.apply(U,s||[])).next())})};class Te{constructor(s,l=500,h){this.reader=s,this.timeBetweenScansMillis=l,this._hints=h,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(s){this._timeBetweenDecodingAttempts=s<0?0:s}set hints(s){this._hints=s||null}get hints(){return this._hints}listVideoInputDevices(){return Ae(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const s=yield navigator.mediaDevices.enumerateDevices(),l=[];for(const h of s){const v=h.kind==="video"?"videoinput":h.kind;if(v!=="videoinput")continue;const m=h.deviceId||h.id,b=h.label||`Video device ${l.length+1}`,E=h.groupId,_={deviceId:m,label:b,kind:v,groupId:E};l.push(_)}return l})}getVideoInputDevices(){return Ae(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(l=>new fe(l.deviceId,l.label))})}findDeviceById(s){return Ae(this,void 0,void 0,function*(){const l=yield this.listVideoInputDevices();return l?l.find(h=>h.deviceId===s):null})}decodeFromInputVideoDevice(s,l){return Ae(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(s,l)})}decodeOnceFromVideoDevice(s,l){return Ae(this,void 0,void 0,function*(){this.reset();let h;s?h={deviceId:{exact:s}}:h={facingMode:"environment"};const v={video:h};return yield this.decodeOnceFromConstraints(v,l)})}decodeOnceFromConstraints(s,l){return Ae(this,void 0,void 0,function*(){const h=yield navigator.mediaDevices.getUserMedia(s);return yield this.decodeOnceFromStream(h,l)})}decodeOnceFromStream(s,l){return Ae(this,void 0,void 0,function*(){this.reset();const h=yield this.attachStreamToVideo(s,l);return yield this.decodeOnce(h)})}decodeFromInputVideoDeviceContinuously(s,l,h){return Ae(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(s,l,h)})}decodeFromVideoDevice(s,l,h){return Ae(this,void 0,void 0,function*(){let v;s?v={deviceId:{exact:s}}:v={facingMode:"environment"};const m={video:v};return yield this.decodeFromConstraints(m,l,h)})}decodeFromConstraints(s,l,h){return Ae(this,void 0,void 0,function*(){const v=yield navigator.mediaDevices.getUserMedia(s);return yield this.decodeFromStream(v,l,h)})}decodeFromStream(s,l,h){return Ae(this,void 0,void 0,function*(){this.reset();const v=yield this.attachStreamToVideo(s,l);return yield this.decodeContinuously(v,h)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(s,l){return Ae(this,void 0,void 0,function*(){const h=this.prepareVideoElement(l);return this.addVideoSource(h,s),this.videoElement=h,this.stream=s,yield this.playVideoOnLoadAsync(h),h})}playVideoOnLoadAsync(s){return new Promise((l,h)=>this.playVideoOnLoad(s,()=>l()))}playVideoOnLoad(s,l){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(s),s.addEventListener("ended",this.videoEndedListener),s.addEventListener("canplay",this.videoCanPlayListener),s.addEventListener("playing",l),this.tryPlayVideo(s)}isVideoPlaying(s){return s.currentTime>0&&!s.paused&&!s.ended&&s.readyState>2}tryPlayVideo(s){return Ae(this,void 0,void 0,function*(){if(this.isVideoPlaying(s)){console.warn("Trying to play video that is already playing.");return}try{yield s.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(s,l){const h=document.getElementById(s);if(!h)throw new x(`element with id '${s}' not found`);if(h.nodeName.toLowerCase()!==l.toLowerCase())throw new x(`element with id '${s}' must be an ${l} element`);return h}decodeFromImage(s,l){if(!s&&!l)throw new x("either imageElement with a src set or an url must be provided");return l&&!s?this.decodeFromImageUrl(l):this.decodeFromImageElement(s)}decodeFromVideo(s,l){if(!s&&!l)throw new x("Either an element with a src set or an URL must be provided");return l&&!s?this.decodeFromVideoUrl(l):this.decodeFromVideoElement(s)}decodeFromVideoContinuously(s,l,h){if(s===void 0&&l===void 0)throw new x("Either an element with a src set or an URL must be provided");return l&&!s?this.decodeFromVideoUrlContinuously(l,h):this.decodeFromVideoElementContinuously(s,h)}decodeFromImageElement(s){if(!s)throw new x("An image element must be provided.");this.reset();const l=this.prepareImageElement(s);this.imageElement=l;let h;return this.isImageLoaded(l)?h=this.decodeOnce(l,!1,!0):h=this._decodeOnLoadImage(l),h}decodeFromVideoElement(s){const l=this._decodeFromVideoElementSetup(s);return this._decodeOnLoadVideo(l)}decodeFromVideoElementContinuously(s,l){const h=this._decodeFromVideoElementSetup(s);return this._decodeOnLoadVideoContinuously(h,l)}_decodeFromVideoElementSetup(s){if(!s)throw new x("A video element must be provided.");this.reset();const l=this.prepareVideoElement(s);return this.videoElement=l,l}decodeFromImageUrl(s){if(!s)throw new x("An URL must be provided.");this.reset();const l=this.prepareImageElement();this.imageElement=l;const h=this._decodeOnLoadImage(l);return l.src=s,h}decodeFromVideoUrl(s){if(!s)throw new x("An URL must be provided.");this.reset();const l=this.prepareVideoElement(),h=this.decodeFromVideoElement(l);return l.src=s,h}decodeFromVideoUrlContinuously(s,l){if(!s)throw new x("An URL must be provided.");this.reset();const h=this.prepareVideoElement(),v=this.decodeFromVideoElementContinuously(h,l);return h.src=s,v}_decodeOnLoadImage(s){return new Promise((l,h)=>{this.imageLoadedListener=()=>this.decodeOnce(s,!1,!0).then(l,h),s.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(s){return Ae(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(s),yield this.decodeOnce(s)})}_decodeOnLoadVideoContinuously(s,l){return Ae(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(s),this.decodeContinuously(s,l)})}isImageLoaded(s){return!(!s.complete||s.naturalWidth===0)}prepareImageElement(s){let l;return typeof s>"u"&&(l=document.createElement("img"),l.width=200,l.height=200),typeof s=="string"&&(l=this.getMediaElement(s,"img")),s instanceof HTMLImageElement&&(l=s),l}prepareVideoElement(s){let l;return!s&&typeof document<"u"&&(l=document.createElement("video"),l.width=200,l.height=200),typeof s=="string"&&(l=this.getMediaElement(s,"video")),s instanceof HTMLVideoElement&&(l=s),l.setAttribute("autoplay","true"),l.setAttribute("muted","true"),l.setAttribute("playsinline","true"),l}decodeOnce(s,l=!0,h=!0){this._stopAsyncDecode=!1;const v=(m,b)=>{if(this._stopAsyncDecode){b(new $("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const E=this.decode(s);m(E)}catch(E){const _=l&&E instanceof $,O=(E instanceof S||E instanceof G)&&h;if(_||O)return setTimeout(v,this._timeBetweenDecodingAttempts,m,b);b(E)}};return new Promise((m,b)=>v(m,b))}decodeContinuously(s,l){this._stopContinuousDecode=!1;const h=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const v=this.decode(s);l(v,null),setTimeout(h,this.timeBetweenScansMillis)}catch(v){l(null,v);const m=v instanceof S||v instanceof G,b=v instanceof $;(m||b)&&setTimeout(h,this._timeBetweenDecodingAttempts)}};h()}decode(s){const l=this.createBinaryBitmap(s);return this.decodeBitmap(l)}_isHTMLVideoElement(s){return s.videoWidth!==0}drawFrameOnCanvas(s,l,h){l||(l={sx:0,sy:0,sWidth:s.videoWidth,sHeight:s.videoHeight,dx:0,dy:0,dWidth:s.videoWidth,dHeight:s.videoHeight}),h||(h=this.captureCanvasContext),h.drawImage(s,l.sx,l.sy,l.sWidth,l.sHeight,l.dx,l.dy,l.dWidth,l.dHeight)}drawImageOnCanvas(s,l,h=this.captureCanvasContext){l||(l={sx:0,sy:0,sWidth:s.naturalWidth,sHeight:s.naturalHeight,dx:0,dy:0,dWidth:s.naturalWidth,dHeight:s.naturalHeight}),h||(h=this.captureCanvasContext),h.drawImage(s,l.sx,l.sy,l.sWidth,l.sHeight,l.dx,l.dy,l.dWidth,l.dHeight)}createBinaryBitmap(s){this.getCaptureCanvasContext(s),this._isHTMLVideoElement(s)?this.drawFrameOnCanvas(s):this.drawImageOnCanvas(s);const l=this.getCaptureCanvas(s),h=new Y(l),v=new re(h);return new C(v)}getCaptureCanvasContext(s){if(!this.captureCanvasContext){const h=this.getCaptureCanvas(s).getContext("2d");this.captureCanvasContext=h}return this.captureCanvasContext}getCaptureCanvas(s){if(!this.captureCanvas){const l=this.createCaptureCanvas(s);this.captureCanvas=l}return this.captureCanvas}decodeBitmap(s){return this.reader.decode(s,this._hints)}createCaptureCanvas(s){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const l=document.createElement("canvas");let h,v;return typeof s<"u"&&(s instanceof HTMLVideoElement?(h=s.videoWidth,v=s.videoHeight):s instanceof HTMLImageElement&&(h=s.naturalWidth||s.width,v=s.naturalHeight||s.height)),l.style.width=h+"px",l.style.height=v+"px",l.width=h,l.height=v,l}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(s=>s.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(s,l){try{s.srcObject=l}catch{s.src=URL.createObjectURL(l)}}cleanVideoSource(s){try{s.srcObject=null}catch{s.src=""}this.videoElement.removeAttribute("src")}}class Le{constructor(s,l,h=l==null?0:8*l.length,v,m,b=N.currentTimeMillis()){this.text=s,this.rawBytes=l,this.numBits=h,this.resultPoints=v,this.format=m,this.timestamp=b,this.text=s,this.rawBytes=l,h==null?this.numBits=l==null?0:8*l.length:this.numBits=h,this.resultPoints=v,this.format=m,this.resultMetadata=null,b==null?this.timestamp=N.currentTimeMillis():this.timestamp=b}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(s,l){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(s,l)}putAllMetadata(s){s!==null&&(this.resultMetadata===null?this.resultMetadata=s:this.resultMetadata=new Map(s))}addResultPoints(s){const l=this.resultPoints;if(l===null)this.resultPoints=s;else if(s!==null&&s.length>0){const h=new Array(l.length+s.length);N.arraycopy(l,0,h,0,l.length),N.arraycopy(s,0,h,l.length,s.length),this.resultPoints=h}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Ve;(function(U){U[U.AZTEC=0]="AZTEC",U[U.CODABAR=1]="CODABAR",U[U.CODE_39=2]="CODE_39",U[U.CODE_93=3]="CODE_93",U[U.CODE_128=4]="CODE_128",U[U.DATA_MATRIX=5]="DATA_MATRIX",U[U.EAN_8=6]="EAN_8",U[U.EAN_13=7]="EAN_13",U[U.ITF=8]="ITF",U[U.MAXICODE=9]="MAXICODE",U[U.PDF_417=10]="PDF_417",U[U.QR_CODE=11]="QR_CODE",U[U.RSS_14=12]="RSS_14",U[U.RSS_EXPANDED=13]="RSS_EXPANDED",U[U.UPC_A=14]="UPC_A",U[U.UPC_E=15]="UPC_E",U[U.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ve||(Ve={}));var Ie=Ve,ut;(function(U){U[U.OTHER=0]="OTHER",U[U.ORIENTATION=1]="ORIENTATION",U[U.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",U[U.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",U[U.ISSUE_NUMBER=4]="ISSUE_NUMBER",U[U.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",U[U.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",U[U.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",U[U.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",U[U.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",U[U.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(ut||(ut={}));var He=ut;class ht{constructor(s,l,h,v,m=-1,b=-1){this.rawBytes=s,this.text=l,this.byteSegments=h,this.ecLevel=v,this.structuredAppendSequenceNumber=m,this.structuredAppendParity=b,this.numBits=s==null?0:8*s.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(s){this.numBits=s}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(s){this.errorsCorrected=s}getErasures(){return this.erasures}setErasures(s){this.erasures=s}getOther(){return this.other}setOther(s){this.other=s}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class jt{exp(s){return this.expTable[s]}log(s){if(s===0)throw new w;return this.logTable[s]}static addOrSubtract(s,l){return s^l}}class it{constructor(s,l){if(l.length===0)throw new w;this.field=s;const h=l.length;if(h>1&&l[0]===0){let v=1;for(;v<h&&l[v]===0;)v++;v===h?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(h-v),N.arraycopy(l,v,this.coefficients,0,this.coefficients.length))}else this.coefficients=l}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(s){return this.coefficients[this.coefficients.length-1-s]}evaluateAt(s){if(s===0)return this.getCoefficient(0);const l=this.coefficients;let h;if(s===1){h=0;for(let b=0,E=l.length;b!==E;b++){const _=l[b];h=jt.addOrSubtract(h,_)}return h}h=l[0];const v=l.length,m=this.field;for(let b=1;b<v;b++)h=jt.addOrSubtract(m.multiply(s,h),l[b]);return h}addOrSubtract(s){if(!this.field.equals(s.field))throw new w("GenericGFPolys do not have same GenericGF field");if(this.isZero())return s;if(s.isZero())return this;let l=this.coefficients,h=s.coefficients;if(l.length>h.length){const b=l;l=h,h=b}let v=new Int32Array(h.length);const m=h.length-l.length;N.arraycopy(h,0,v,0,m);for(let b=m;b<h.length;b++)v[b]=jt.addOrSubtract(l[b-m],h[b]);return new it(this.field,v)}multiply(s){if(!this.field.equals(s.field))throw new w("GenericGFPolys do not have same GenericGF field");if(this.isZero()||s.isZero())return this.field.getZero();const l=this.coefficients,h=l.length,v=s.coefficients,m=v.length,b=new Int32Array(h+m-1),E=this.field;for(let _=0;_<h;_++){const I=l[_];for(let O=0;O<m;O++)b[_+O]=jt.addOrSubtract(b[_+O],E.multiply(I,v[O]))}return new it(E,b)}multiplyScalar(s){if(s===0)return this.field.getZero();if(s===1)return this;const l=this.coefficients.length,h=this.field,v=new Int32Array(l),m=this.coefficients;for(let b=0;b<l;b++)v[b]=h.multiply(m[b],s);return new it(h,v)}multiplyByMonomial(s,l){if(s<0)throw new w;if(l===0)return this.field.getZero();const h=this.coefficients,v=h.length,m=new Int32Array(v+s),b=this.field;for(let E=0;E<v;E++)m[E]=b.multiply(h[E],l);return new it(b,m)}divide(s){if(!this.field.equals(s.field))throw new w("GenericGFPolys do not have same GenericGF field");if(s.isZero())throw new w("Divide by 0");const l=this.field;let h=l.getZero(),v=this;const m=s.getCoefficient(s.getDegree()),b=l.inverse(m);for(;v.getDegree()>=s.getDegree()&&!v.isZero();){const E=v.getDegree()-s.getDegree(),_=l.multiply(v.getCoefficient(v.getDegree()),b),I=s.multiplyByMonomial(E,_),O=l.buildMonomial(E,_);h=h.addOrSubtract(O),v=v.addOrSubtract(I)}return[h,v]}toString(){let s="";for(let l=this.getDegree();l>=0;l--){let h=this.getCoefficient(l);if(h!==0){if(h<0?(s+=" - ",h=-h):s.length>0&&(s+=" + "),l===0||h!==1){const v=this.field.log(h);v===0?s+="1":v===1?s+="a":(s+="a^",s+=v)}l!==0&&(l===1?s+="x":(s+="x^",s+=l))}}return s}}class Rt extends d{}Rt.kind="ArithmeticException";class Ye extends jt{constructor(s,l,h){super(),this.primitive=s,this.size=l,this.generatorBase=h;const v=new Int32Array(l);let m=1;for(let E=0;E<l;E++)v[E]=m,m*=2,m>=l&&(m^=s,m&=l-1);this.expTable=v;const b=new Int32Array(l);for(let E=0;E<l-1;E++)b[v[E]]=E;this.logTable=b,this.zero=new it(this,Int32Array.from([0])),this.one=new it(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(s,l){if(s<0)throw new w;if(l===0)return this.zero;const h=new Int32Array(s+1);return h[0]=l,new it(this,h)}inverse(s){if(s===0)throw new Rt;return this.expTable[this.size-this.logTable[s]-1]}multiply(s,l){return s===0||l===0?0:this.expTable[(this.logTable[s]+this.logTable[l])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+k.toHexString(this.primitive)+","+this.size+")"}equals(s){return s===this}}Ye.AZTEC_DATA_12=new Ye(4201,4096,1),Ye.AZTEC_DATA_10=new Ye(1033,1024,1),Ye.AZTEC_DATA_6=new Ye(67,64,1),Ye.AZTEC_PARAM=new Ye(19,16,1),Ye.QR_CODE_FIELD_256=new Ye(285,256,0),Ye.DATA_MATRIX_FIELD_256=new Ye(301,256,1),Ye.AZTEC_DATA_8=Ye.DATA_MATRIX_FIELD_256,Ye.MAXICODE_FIELD_64=Ye.AZTEC_DATA_6;class zt extends d{}zt.kind="ReedSolomonException";class Bt extends d{}Bt.kind="IllegalStateException";class Xt{constructor(s){this.field=s}decode(s,l){const h=this.field,v=new it(h,s),m=new Int32Array(l);let b=!0;for(let Q=0;Q<l;Q++){const ae=v.evaluateAt(h.exp(Q+h.getGeneratorBase()));m[m.length-1-Q]=ae,ae!==0&&(b=!1)}if(b)return;const E=new it(h,m),_=this.runEuclideanAlgorithm(h.buildMonomial(l,1),E,l),I=_[0],O=_[1],z=this.findErrorLocations(I),V=this.findErrorMagnitudes(O,z);for(let Q=0;Q<z.length;Q++){const ae=s.length-1-h.log(z[Q]);if(ae<0)throw new zt("Bad error location");s[ae]=Ye.addOrSubtract(s[ae],V[Q])}}runEuclideanAlgorithm(s,l,h){if(s.getDegree()<l.getDegree()){const Q=s;s=l,l=Q}const v=this.field;let m=s,b=l,E=v.getZero(),_=v.getOne();for(;b.getDegree()>=(h/2|0);){let Q=m,ae=E;if(m=b,E=_,m.isZero())throw new zt("r_{i-1} was zero");b=Q;let se=v.getZero();const de=m.getCoefficient(m.getDegree()),be=v.inverse(de);for(;b.getDegree()>=m.getDegree()&&!b.isZero();){const Pe=b.getDegree()-m.getDegree(),Ue=v.multiply(b.getCoefficient(b.getDegree()),be);se=se.addOrSubtract(v.buildMonomial(Pe,Ue)),b=b.addOrSubtract(m.multiplyByMonomial(Pe,Ue))}if(_=se.multiply(E).addOrSubtract(ae),b.getDegree()>=m.getDegree())throw new Bt("Division algorithm failed to reduce polynomial?")}const I=_.getCoefficient(0);if(I===0)throw new zt("sigmaTilde(0) was zero");const O=v.inverse(I),z=_.multiplyScalar(O),V=b.multiplyScalar(O);return[z,V]}findErrorLocations(s){const l=s.getDegree();if(l===1)return Int32Array.from([s.getCoefficient(1)]);const h=new Int32Array(l);let v=0;const m=this.field;for(let b=1;b<m.getSize()&&v<l;b++)s.evaluateAt(b)===0&&(h[v]=m.inverse(b),v++);if(v!==l)throw new zt("Error locator degree does not match number of roots");return h}findErrorMagnitudes(s,l){const h=l.length,v=new Int32Array(h),m=this.field;for(let b=0;b<h;b++){const E=m.inverse(l[b]);let _=1;for(let I=0;I<h;I++)if(b!==I){const O=m.multiply(l[I],E),z=(O&1)===0?O|1:O&-2;_=m.multiply(_,z)}v[b]=m.multiply(s.evaluateAt(E),m.inverse(_)),m.getGeneratorBase()!==0&&(v[b]=m.multiply(v[b],E))}return v}}var Ct;(function(U){U[U.UPPER=0]="UPPER",U[U.LOWER=1]="LOWER",U[U.MIXED=2]="MIXED",U[U.DIGIT=3]="DIGIT",U[U.PUNCT=4]="PUNCT",U[U.BINARY=5]="BINARY"})(Ct||(Ct={}));class At{decode(s){this.ddata=s;let l=s.getBits(),h=this.extractBits(l),v=this.correctBits(h),m=At.convertBoolArrayToByteArray(v),b=At.getEncodedData(v),E=new ht(m,b,null,null);return E.setNumBits(v.length),E}static highLevelDecode(s){return this.getEncodedData(s)}static getEncodedData(s){let l=s.length,h=Ct.UPPER,v=Ct.UPPER,m="",b=0;for(;b<l;)if(v===Ct.BINARY){if(l-b<5)break;let E=At.readCode(s,b,5);if(b+=5,E===0){if(l-b<11)break;E=At.readCode(s,b,11)+31,b+=11}for(let _=0;_<E;_++){if(l-b<8){b=l;break}const I=At.readCode(s,b,8);m+=ee.castAsNonUtf8Char(I),b+=8}v=h}else{let E=v===Ct.DIGIT?4:5;if(l-b<E)break;let _=At.readCode(s,b,E);b+=E;let I=At.getCharacter(v,_);I.startsWith("CTRL_")?(h=v,v=At.getTable(I.charAt(5)),I.charAt(6)==="L"&&(h=v)):(m+=I,v=h)}return m}static getTable(s){switch(s){case"L":return Ct.LOWER;case"P":return Ct.PUNCT;case"M":return Ct.MIXED;case"D":return Ct.DIGIT;case"B":return Ct.BINARY;case"U":default:return Ct.UPPER}}static getCharacter(s,l){switch(s){case Ct.UPPER:return At.UPPER_TABLE[l];case Ct.LOWER:return At.LOWER_TABLE[l];case Ct.MIXED:return At.MIXED_TABLE[l];case Ct.PUNCT:return At.PUNCT_TABLE[l];case Ct.DIGIT:return At.DIGIT_TABLE[l];default:throw new Bt("Bad table")}}correctBits(s){let l,h;this.ddata.getNbLayers()<=2?(h=6,l=Ye.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(h=8,l=Ye.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(h=10,l=Ye.AZTEC_DATA_10):(h=12,l=Ye.AZTEC_DATA_12);let v=this.ddata.getNbDatablocks(),m=s.length/h;if(m<v)throw new G;let b=s.length%h,E=new Int32Array(m);for(let V=0;V<m;V++,b+=h)E[V]=At.readCode(s,b,h);try{new Xt(l).decode(E,m-v)}catch(V){throw new G(V)}let _=(1<<h)-1,I=0;for(let V=0;V<v;V++){let Q=E[V];if(Q===0||Q===_)throw new G;(Q===1||Q===_-1)&&I++}let O=new Array(v*h-I),z=0;for(let V=0;V<v;V++){let Q=E[V];if(Q===1||Q===_-1)O.fill(Q>1,z,z+h-1),z+=h-1;else for(let ae=h-1;ae>=0;--ae)O[z++]=(Q&1<<ae)!==0}return O}extractBits(s){let l=this.ddata.isCompact(),h=this.ddata.getNbLayers(),v=(l?11:14)+h*4,m=new Int32Array(v),b=new Array(this.totalBitsInLayer(h,l));if(l)for(let E=0;E<m.length;E++)m[E]=E;else{let E=v+1+2*k.truncDivision(k.truncDivision(v,2)-1,15),_=v/2,I=k.truncDivision(E,2);for(let O=0;O<_;O++){let z=O+k.truncDivision(O,15);m[_-O-1]=I-z-1,m[_+O]=I+z+1}}for(let E=0,_=0;E<h;E++){let I=(h-E)*4+(l?9:12),O=E*2,z=v-1-O;for(let V=0;V<I;V++){let Q=V*2;for(let ae=0;ae<2;ae++)b[_+Q+ae]=s.get(m[O+ae],m[O+V]),b[_+2*I+Q+ae]=s.get(m[O+V],m[z-ae]),b[_+4*I+Q+ae]=s.get(m[z-ae],m[z-V]),b[_+6*I+Q+ae]=s.get(m[z-V],m[O+ae])}_+=I*8}return b}static readCode(s,l,h){let v=0;for(let m=l;m<l+h;m++)v<<=1,s[m]&&(v|=1);return v}static readByte(s,l){let h=s.length-l;return h>=8?At.readCode(s,l,8):At.readCode(s,l,h)<<8-h}static convertBoolArrayToByteArray(s){let l=new Uint8Array((s.length+7)/8);for(let h=0;h<l.length;h++)l[h]=At.readByte(s,8*h);return l}totalBitsInLayer(s,l){return((l?88:112)+16*s)*s}}At.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],At.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],At.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],At.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],At.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class ct{constructor(){}static round(s){return s===NaN?0:s<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:s>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:s+(s<0?-.5:.5)|0}static distance(s,l,h,v){const m=s-h,b=l-v;return Math.sqrt(m*m+b*b)}static sum(s){let l=0;for(let h=0,v=s.length;h!==v;h++){const m=s[h];l+=m}return l}}class Yr{static floatToIntBits(s){return s}}Yr.MAX_VALUE=Number.MAX_SAFE_INTEGER;class We{constructor(s,l){this.x=s,this.y=l}getX(){return this.x}getY(){return this.y}equals(s){if(s instanceof We){const l=s;return this.x===l.x&&this.y===l.y}return!1}hashCode(){return 31*Yr.floatToIntBits(this.x)+Yr.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(s){const l=this.distance(s[0],s[1]),h=this.distance(s[1],s[2]),v=this.distance(s[0],s[2]);let m,b,E;if(h>=l&&h>=v?(b=s[0],m=s[1],E=s[2]):v>=h&&v>=l?(b=s[1],m=s[0],E=s[2]):(b=s[2],m=s[0],E=s[1]),this.crossProductZ(m,b,E)<0){const _=m;m=E,E=_}s[0]=m,s[1]=b,s[2]=E}static distance(s,l){return ct.distance(s.x,s.y,l.x,l.y)}static crossProductZ(s,l,h){const v=l.x,m=l.y;return(h.x-v)*(s.y-m)-(h.y-m)*(s.x-v)}}class Hr{constructor(s,l){this.bits=s,this.points=l}getBits(){return this.bits}getPoints(){return this.points}}class Vr extends Hr{constructor(s,l,h,v,m){super(s,l),this.compact=h,this.nbDatablocks=v,this.nbLayers=m}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class fr{constructor(s,l,h,v){this.image=s,this.height=s.getHeight(),this.width=s.getWidth(),l==null&&(l=fr.INIT_SIZE),h==null&&(h=s.getWidth()/2|0),v==null&&(v=s.getHeight()/2|0);const m=l/2|0;if(this.leftInit=h-m,this.rightInit=h+m,this.upInit=v-m,this.downInit=v+m,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new $}detect(){let s=this.leftInit,l=this.rightInit,h=this.upInit,v=this.downInit,m=!1,b=!0,E=!1,_=!1,I=!1,O=!1,z=!1;const V=this.width,Q=this.height;for(;b;){b=!1;let ae=!0;for(;(ae||!_)&&l<V;)ae=this.containsBlackPoint(h,v,l,!1),ae?(l++,b=!0,_=!0):_||l++;if(l>=V){m=!0;break}let se=!0;for(;(se||!I)&&v<Q;)se=this.containsBlackPoint(s,l,v,!0),se?(v++,b=!0,I=!0):I||v++;if(v>=Q){m=!0;break}let de=!0;for(;(de||!O)&&s>=0;)de=this.containsBlackPoint(h,v,s,!1),de?(s--,b=!0,O=!0):O||s--;if(s<0){m=!0;break}let be=!0;for(;(be||!z)&&h>=0;)be=this.containsBlackPoint(s,l,h,!0),be?(h--,b=!0,z=!0):z||h--;if(h<0){m=!0;break}b&&(E=!0)}if(!m&&E){const ae=l-s;let se=null;for(let Ue=1;se===null&&Ue<ae;Ue++)se=this.getBlackPointOnSegment(s,v-Ue,s+Ue,v);if(se==null)throw new $;let de=null;for(let Ue=1;de===null&&Ue<ae;Ue++)de=this.getBlackPointOnSegment(s,h+Ue,s+Ue,h);if(de==null)throw new $;let be=null;for(let Ue=1;be===null&&Ue<ae;Ue++)be=this.getBlackPointOnSegment(l,h+Ue,l-Ue,h);if(be==null)throw new $;let Pe=null;for(let Ue=1;Pe===null&&Ue<ae;Ue++)Pe=this.getBlackPointOnSegment(l,v-Ue,l-Ue,v);if(Pe==null)throw new $;return this.centerEdges(Pe,se,be,de)}else throw new $}getBlackPointOnSegment(s,l,h,v){const m=ct.round(ct.distance(s,l,h,v)),b=(h-s)/m,E=(v-l)/m,_=this.image;for(let I=0;I<m;I++){const O=ct.round(s+I*b),z=ct.round(l+I*E);if(_.get(O,z))return new We(O,z)}return null}centerEdges(s,l,h,v){const m=s.getX(),b=s.getY(),E=l.getX(),_=l.getY(),I=h.getX(),O=h.getY(),z=v.getX(),V=v.getY(),Q=fr.CORR;return m<this.width/2?[new We(z-Q,V+Q),new We(E+Q,_+Q),new We(I-Q,O-Q),new We(m+Q,b-Q)]:[new We(z+Q,V+Q),new We(E+Q,_-Q),new We(I-Q,O+Q),new We(m-Q,b-Q)]}containsBlackPoint(s,l,h,v){const m=this.image;if(v){for(let b=s;b<=l;b++)if(m.get(b,h))return!0}else for(let b=s;b<=l;b++)if(m.get(h,b))return!0;return!1}}fr.INIT_SIZE=10,fr.CORR=1;class Wr{static checkAndNudgePoints(s,l){const h=s.getWidth(),v=s.getHeight();let m=!0;for(let b=0;b<l.length&&m;b+=2){const E=Math.floor(l[b]),_=Math.floor(l[b+1]);if(E<-1||E>h||_<-1||_>v)throw new $;m=!1,E===-1?(l[b]=0,m=!0):E===h&&(l[b]=h-1,m=!0),_===-1?(l[b+1]=0,m=!0):_===v&&(l[b+1]=v-1,m=!0)}m=!0;for(let b=l.length-2;b>=0&&m;b-=2){const E=Math.floor(l[b]),_=Math.floor(l[b+1]);if(E<-1||E>h||_<-1||_>v)throw new $;m=!1,E===-1?(l[b]=0,m=!0):E===h&&(l[b]=h-1,m=!0),_===-1?(l[b+1]=0,m=!0):_===v&&(l[b+1]=v-1,m=!0)}}}class Pn{constructor(s,l,h,v,m,b,E,_,I){this.a11=s,this.a21=l,this.a31=h,this.a12=v,this.a22=m,this.a32=b,this.a13=E,this.a23=_,this.a33=I}static quadrilateralToQuadrilateral(s,l,h,v,m,b,E,_,I,O,z,V,Q,ae,se,de){const be=Pn.quadrilateralToSquare(s,l,h,v,m,b,E,_);return Pn.squareToQuadrilateral(I,O,z,V,Q,ae,se,de).times(be)}transformPoints(s){const l=s.length,h=this.a11,v=this.a12,m=this.a13,b=this.a21,E=this.a22,_=this.a23,I=this.a31,O=this.a32,z=this.a33;for(let V=0;V<l;V+=2){const Q=s[V],ae=s[V+1],se=m*Q+_*ae+z;s[V]=(h*Q+b*ae+I)/se,s[V+1]=(v*Q+E*ae+O)/se}}transformPointsWithValues(s,l){const h=this.a11,v=this.a12,m=this.a13,b=this.a21,E=this.a22,_=this.a23,I=this.a31,O=this.a32,z=this.a33,V=s.length;for(let Q=0;Q<V;Q++){const ae=s[Q],se=l[Q],de=m*ae+_*se+z;s[Q]=(h*ae+b*se+I)/de,l[Q]=(v*ae+E*se+O)/de}}static squareToQuadrilateral(s,l,h,v,m,b,E,_){const I=s-h+m-E,O=l-v+b-_;if(I===0&&O===0)return new Pn(h-s,m-h,s,v-l,b-v,l,0,0,1);{const z=h-m,V=E-m,Q=v-b,ae=_-b,se=z*ae-V*Q,de=(I*ae-V*O)/se,be=(z*O-I*Q)/se;return new Pn(h-s+de*h,E-s+be*E,s,v-l+de*v,_-l+be*_,l,de,be,1)}}static quadrilateralToSquare(s,l,h,v,m,b,E,_){return Pn.squareToQuadrilateral(s,l,h,v,m,b,E,_).buildAdjoint()}buildAdjoint(){return new Pn(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(s){return new Pn(this.a11*s.a11+this.a21*s.a12+this.a31*s.a13,this.a11*s.a21+this.a21*s.a22+this.a31*s.a23,this.a11*s.a31+this.a21*s.a32+this.a31*s.a33,this.a12*s.a11+this.a22*s.a12+this.a32*s.a13,this.a12*s.a21+this.a22*s.a22+this.a32*s.a23,this.a12*s.a31+this.a22*s.a32+this.a32*s.a33,this.a13*s.a11+this.a23*s.a12+this.a33*s.a13,this.a13*s.a21+this.a23*s.a22+this.a33*s.a23,this.a13*s.a31+this.a23*s.a32+this.a33*s.a33)}}class Cn extends Wr{sampleGrid(s,l,h,v,m,b,E,_,I,O,z,V,Q,ae,se,de,be,Pe,Ue){const Fe=Pn.quadrilateralToQuadrilateral(v,m,b,E,_,I,O,z,V,Q,ae,se,de,be,Pe,Ue);return this.sampleGridWithTransform(s,l,h,Fe)}sampleGridWithTransform(s,l,h,v){if(l<=0||h<=0)throw new $;const m=new xe(l,h),b=new Float32Array(2*l);for(let E=0;E<h;E++){const _=b.length,I=E+.5;for(let O=0;O<_;O+=2)b[O]=O/2+.5,b[O+1]=I;v.transformPoints(b),Wr.checkAndNudgePoints(s,b);try{for(let O=0;O<_;O+=2)s.get(Math.floor(b[O]),Math.floor(b[O+1]))&&m.set(O/2,E)}catch{throw new $}}return m}}class sn{static setGridSampler(s){sn.gridSampler=s}static getInstance(){return sn.gridSampler}}sn.gridSampler=new Cn;class Ht{constructor(s,l){this.x=s,this.y=l}toResultPoint(){return new We(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Xs{constructor(s){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=s}detect(){return this.detectMirror(!1)}detectMirror(s){let l=this.getMatrixCenter(),h=this.getBullsEyeCorners(l);if(s){let b=h[0];h[0]=h[2],h[2]=b}this.extractParameters(h);let v=this.sampleGrid(this.image,h[this.shift%4],h[(this.shift+1)%4],h[(this.shift+2)%4],h[(this.shift+3)%4]),m=this.getMatrixCornerPoints(h);return new Vr(v,m,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(s){if(!this.isValidPoint(s[0])||!this.isValidPoint(s[1])||!this.isValidPoint(s[2])||!this.isValidPoint(s[3]))throw new $;let l=2*this.nbCenterLayers,h=new Int32Array([this.sampleLine(s[0],s[1],l),this.sampleLine(s[1],s[2],l),this.sampleLine(s[2],s[3],l),this.sampleLine(s[3],s[0],l)]);this.shift=this.getRotation(h,l);let v=0;for(let b=0;b<4;b++){let E=h[(this.shift+b)%4];this.compact?(v<<=7,v+=E>>1&127):(v<<=10,v+=(E>>2&992)+(E>>1&31))}let m=this.getCorrectedParameterData(v,this.compact);this.compact?(this.nbLayers=(m>>6)+1,this.nbDataBlocks=(m&63)+1):(this.nbLayers=(m>>11)+1,this.nbDataBlocks=(m&2047)+1)}getRotation(s,l){let h=0;s.forEach((v,m,b)=>{let E=(v>>l-2<<1)+(v&1);h=(h<<3)+E}),h=((h&1)<<11)+(h>>1);for(let v=0;v<4;v++)if(k.bitCount(h^this.EXPECTED_CORNER_BITS[v])<=2)return v;throw new $}getCorrectedParameterData(s,l){let h,v;l?(h=7,v=2):(h=10,v=4);let m=h-v,b=new Int32Array(h);for(let _=h-1;_>=0;--_)b[_]=s&15,s>>=4;try{new Xt(Ye.AZTEC_PARAM).decode(b,m)}catch{throw new $}let E=0;for(let _=0;_<v;_++)E=(E<<4)+b[_];return E}getBullsEyeCorners(s){let l=s,h=s,v=s,m=s,b=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let z=this.getFirstDifferent(l,b,1,-1),V=this.getFirstDifferent(h,b,1,1),Q=this.getFirstDifferent(v,b,-1,1),ae=this.getFirstDifferent(m,b,-1,-1);if(this.nbCenterLayers>2){let se=this.distancePoint(ae,z)*this.nbCenterLayers/(this.distancePoint(m,l)*(this.nbCenterLayers+2));if(se<.75||se>1.25||!this.isWhiteOrBlackRectangle(z,V,Q,ae))break}l=z,h=V,v=Q,m=ae,b=!b}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new $;this.compact=this.nbCenterLayers===5;let E=new We(l.getX()+.5,l.getY()-.5),_=new We(h.getX()+.5,h.getY()+.5),I=new We(v.getX()-.5,v.getY()+.5),O=new We(m.getX()-.5,m.getY()-.5);return this.expandSquare([E,_,I,O],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let s,l,h,v;try{let E=new fr(this.image).detect();s=E[0],l=E[1],h=E[2],v=E[3]}catch{let _=this.image.getWidth()/2,I=this.image.getHeight()/2;s=this.getFirstDifferent(new Ht(_+7,I-7),!1,1,-1).toResultPoint(),l=this.getFirstDifferent(new Ht(_+7,I+7),!1,1,1).toResultPoint(),h=this.getFirstDifferent(new Ht(_-7,I+7),!1,-1,1).toResultPoint(),v=this.getFirstDifferent(new Ht(_-7,I-7),!1,-1,-1).toResultPoint()}let m=ct.round((s.getX()+v.getX()+l.getX()+h.getX())/4),b=ct.round((s.getY()+v.getY()+l.getY()+h.getY())/4);try{let E=new fr(this.image,15,m,b).detect();s=E[0],l=E[1],h=E[2],v=E[3]}catch{s=this.getFirstDifferent(new Ht(m+7,b-7),!1,1,-1).toResultPoint(),l=this.getFirstDifferent(new Ht(m+7,b+7),!1,1,1).toResultPoint(),h=this.getFirstDifferent(new Ht(m-7,b+7),!1,-1,1).toResultPoint(),v=this.getFirstDifferent(new Ht(m-7,b-7),!1,-1,-1).toResultPoint()}return m=ct.round((s.getX()+v.getX()+l.getX()+h.getX())/4),b=ct.round((s.getY()+v.getY()+l.getY()+h.getY())/4),new Ht(m,b)}getMatrixCornerPoints(s){return this.expandSquare(s,2*this.nbCenterLayers,this.getDimension())}sampleGrid(s,l,h,v,m){let b=sn.getInstance(),E=this.getDimension(),_=E/2-this.nbCenterLayers,I=E/2+this.nbCenterLayers;return b.sampleGrid(s,E,E,_,_,I,_,I,I,_,I,l.getX(),l.getY(),h.getX(),h.getY(),v.getX(),v.getY(),m.getX(),m.getY())}sampleLine(s,l,h){let v=0,m=this.distanceResultPoint(s,l),b=m/h,E=s.getX(),_=s.getY(),I=b*(l.getX()-s.getX())/m,O=b*(l.getY()-s.getY())/m;for(let z=0;z<h;z++)this.image.get(ct.round(E+z*I),ct.round(_+z*O))&&(v|=1<<h-z-1);return v}isWhiteOrBlackRectangle(s,l,h,v){let m=3;s=new Ht(s.getX()-m,s.getY()+m),l=new Ht(l.getX()-m,l.getY()-m),h=new Ht(h.getX()+m,h.getY()-m),v=new Ht(v.getX()+m,v.getY()+m);let b=this.getColor(v,s);if(b===0)return!1;let E=this.getColor(s,l);return E!==b||(E=this.getColor(l,h),E!==b)?!1:(E=this.getColor(h,v),E===b)}getColor(s,l){let h=this.distancePoint(s,l),v=(l.getX()-s.getX())/h,m=(l.getY()-s.getY())/h,b=0,E=s.getX(),_=s.getY(),I=this.image.get(s.getX(),s.getY()),O=Math.ceil(h);for(let V=0;V<O;V++)E+=v,_+=m,this.image.get(ct.round(E),ct.round(_))!==I&&b++;let z=b/h;return z>.1&&z<.9?0:z<=.1===I?1:-1}getFirstDifferent(s,l,h,v){let m=s.getX()+h,b=s.getY()+v;for(;this.isValid(m,b)&&this.image.get(m,b)===l;)m+=h,b+=v;for(m-=h,b-=v;this.isValid(m,b)&&this.image.get(m,b)===l;)m+=h;for(m-=h;this.isValid(m,b)&&this.image.get(m,b)===l;)b+=v;return b-=v,new Ht(m,b)}expandSquare(s,l,h){let v=h/(2*l),m=s[0].getX()-s[2].getX(),b=s[0].getY()-s[2].getY(),E=(s[0].getX()+s[2].getX())/2,_=(s[0].getY()+s[2].getY())/2,I=new We(E+v*m,_+v*b),O=new We(E-v*m,_-v*b);m=s[1].getX()-s[3].getX(),b=s[1].getY()-s[3].getY(),E=(s[1].getX()+s[3].getX())/2,_=(s[1].getY()+s[3].getY())/2;let z=new We(E+v*m,_+v*b),V=new We(E-v*m,_-v*b);return[I,z,O,V]}isValid(s,l){return s>=0&&s<this.image.getWidth()&&l>0&&l<this.image.getHeight()}isValidPoint(s){let l=ct.round(s.getX()),h=ct.round(s.getY());return this.isValid(l,h)}distancePoint(s,l){return ct.distance(s.getX(),s.getY(),l.getX(),l.getY())}distanceResultPoint(s,l){return ct.distance(s.getX(),s.getY(),l.getX(),l.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(k.truncDivision(this.nbLayers-4,8)+1)+15}}class ho{decode(s,l=null){let h=null,v=new Xs(s.getBlackMatrix()),m=null,b=null;try{let O=v.detectMirror(!1);m=O.getPoints(),this.reportFoundResultPoints(l,m),b=new At().decode(O)}catch(O){h=O}if(b==null)try{let O=v.detectMirror(!0);m=O.getPoints(),this.reportFoundResultPoints(l,m),b=new At().decode(O)}catch(O){throw h??O}let E=new Le(b.getText(),b.getRawBytes(),b.getNumBits(),m,Ie.AZTEC,N.currentTimeMillis()),_=b.getByteSegments();_!=null&&E.putMetadata(He.BYTE_SEGMENTS,_);let I=b.getECLevel();return I!=null&&E.putMetadata(He.ERROR_CORRECTION_LEVEL,I),E}reportFoundResultPoints(s,l){if(s!=null){let h=s.get(W.NEED_RESULT_POINT_CALLBACK);h!=null&&l.forEach((v,m,b)=>{h.foundPossibleResultPoint(v)})}}reset(){}}class al extends Te{constructor(s=500){super(new ho,s)}}class $t{decode(s,l){try{return this.doDecode(s,l)}catch{if(l&&l.get(W.TRY_HARDER)===!0&&s.isRotateSupported()){const m=s.rotateCounterClockwise(),b=this.doDecode(m,l),E=b.getResultMetadata();let _=270;E!==null&&E.get(He.ORIENTATION)===!0&&(_=_+E.get(He.ORIENTATION)%360),b.putMetadata(He.ORIENTATION,_);const I=b.getResultPoints();if(I!==null){const O=m.getHeight();for(let z=0;z<I.length;z++)I[z]=new We(O-I[z].getY()-1,I[z].getX())}return b}else throw new $}}reset(){}doDecode(s,l){const h=s.getWidth(),v=s.getHeight();let m=new L(h);const b=l&&l.get(W.TRY_HARDER)===!0,E=Math.max(1,v>>(b?8:5));let _;b?_=v:_=15;const I=Math.trunc(v/2);for(let O=0;O<_;O++){const z=Math.trunc((O+1)/2),V=(O&1)===0,Q=I+E*(V?z:-z);if(Q<0||Q>=v)break;try{m=s.getBlackRow(Q,m)}catch{continue}for(let ae=0;ae<2;ae++){if(ae===1&&(m.reverse(),l&&l.get(W.NEED_RESULT_POINT_CALLBACK)===!0)){const se=new Map;l.forEach((de,be)=>se.set(be,de)),se.delete(W.NEED_RESULT_POINT_CALLBACK),l=se}try{const se=this.decodeRow(Q,m,l);if(ae===1){se.putMetadata(He.ORIENTATION,180);const de=se.getResultPoints();de!==null&&(de[0]=new We(h-de[0].getX()-1,de[0].getY()),de[1]=new We(h-de[1].getX()-1,de[1].getY()))}return se}catch{}}}throw new $}static recordPattern(s,l,h){const v=h.length;for(let I=0;I<v;I++)h[I]=0;const m=s.getSize();if(l>=m)throw new $;let b=!s.get(l),E=0,_=l;for(;_<m;){if(s.get(_)!==b)h[E]++;else{if(++E===v)break;h[E]=1,b=!b}_++}if(!(E===v||E===v-1&&_===m))throw new $}static recordPatternInReverse(s,l,h){let v=h.length,m=s.get(l);for(;l>0&&v>=0;)s.get(--l)!==m&&(v--,m=!m);if(v>=0)throw new $;$t.recordPattern(s,l+1,h)}static patternMatchVariance(s,l,h){const v=s.length;let m=0,b=0;for(let I=0;I<v;I++)m+=s[I],b+=l[I];if(m<b)return Number.POSITIVE_INFINITY;const E=m/b;h*=E;let _=0;for(let I=0;I<v;I++){const O=s[I],z=l[I]*E,V=O>z?O-z:z-O;if(V>h)return Number.POSITIVE_INFINITY;_+=V}return _/m}}class ze extends $t{static findStartPattern(s){const l=s.getSize(),h=s.getNextSet(0);let v=0,m=Int32Array.from([0,0,0,0,0,0]),b=h,E=!1;const _=6;for(let I=h;I<l;I++)if(s.get(I)!==E)m[v]++;else{if(v===_-1){let O=ze.MAX_AVG_VARIANCE,z=-1;for(let V=ze.CODE_START_A;V<=ze.CODE_START_C;V++){const Q=$t.patternMatchVariance(m,ze.CODE_PATTERNS[V],ze.MAX_INDIVIDUAL_VARIANCE);Q<O&&(O=Q,z=V)}if(z>=0&&s.isRange(Math.max(0,b-(I-b)/2),b,!1))return Int32Array.from([b,I,z]);b+=m[0]+m[1],m=m.slice(2,m.length-1),m[v-1]=0,m[v]=0,v--}else v++;m[v]=1,E=!E}throw new $}static decodeCode(s,l,h){$t.recordPattern(s,h,l);let v=ze.MAX_AVG_VARIANCE,m=-1;for(let b=0;b<ze.CODE_PATTERNS.length;b++){const E=ze.CODE_PATTERNS[b],_=this.patternMatchVariance(l,E,ze.MAX_INDIVIDUAL_VARIANCE);_<v&&(v=_,m=b)}if(m>=0)return m;throw new $}decodeRow(s,l,h){const v=h&&h.get(W.ASSUME_GS1)===!0,m=ze.findStartPattern(l),b=m[2];let E=0;const _=new Uint8Array(20);_[E++]=b;let I;switch(b){case ze.CODE_START_A:I=ze.CODE_CODE_A;break;case ze.CODE_START_B:I=ze.CODE_CODE_B;break;case ze.CODE_START_C:I=ze.CODE_CODE_C;break;default:throw new G}let O=!1,z=!1,V="",Q=m[0],ae=m[1];const se=Int32Array.from([0,0,0,0,0,0]);let de=0,be=0,Pe=b,Ue=0,Fe=!0,xt=!1,gt=!1;for(;!O;){const ci=z;switch(z=!1,de=be,be=ze.decodeCode(l,se,ae),_[E++]=be,be!==ze.CODE_STOP&&(Fe=!0),be!==ze.CODE_STOP&&(Ue++,Pe+=Ue*be),Q=ae,ae+=se.reduce((la,Hc)=>la+Hc,0),be){case ze.CODE_START_A:case ze.CODE_START_B:case ze.CODE_START_C:throw new G}switch(I){case ze.CODE_CODE_A:if(be<64)gt===xt?V+=String.fromCharCode(32+be):V+=String.fromCharCode(32+be+128),gt=!1;else if(be<96)gt===xt?V+=String.fromCharCode(be-64):V+=String.fromCharCode(be+64),gt=!1;else switch(be!==ze.CODE_STOP&&(Fe=!1),be){case ze.CODE_FNC_1:v&&(V.length===0?V+="]C1":V+="");break;case ze.CODE_FNC_2:case ze.CODE_FNC_3:break;case ze.CODE_FNC_4_A:!xt&&gt?(xt=!0,gt=!1):xt&&gt?(xt=!1,gt=!1):gt=!0;break;case ze.CODE_SHIFT:z=!0,I=ze.CODE_CODE_B;break;case ze.CODE_CODE_B:I=ze.CODE_CODE_B;break;case ze.CODE_CODE_C:I=ze.CODE_CODE_C;break;case ze.CODE_STOP:O=!0;break}break;case ze.CODE_CODE_B:if(be<96)gt===xt?V+=String.fromCharCode(32+be):V+=String.fromCharCode(32+be+128),gt=!1;else switch(be!==ze.CODE_STOP&&(Fe=!1),be){case ze.CODE_FNC_1:v&&(V.length===0?V+="]C1":V+="");break;case ze.CODE_FNC_2:case ze.CODE_FNC_3:break;case ze.CODE_FNC_4_B:!xt&&gt?(xt=!0,gt=!1):xt&&gt?(xt=!1,gt=!1):gt=!0;break;case ze.CODE_SHIFT:z=!0,I=ze.CODE_CODE_A;break;case ze.CODE_CODE_A:I=ze.CODE_CODE_A;break;case ze.CODE_CODE_C:I=ze.CODE_CODE_C;break;case ze.CODE_STOP:O=!0;break}break;case ze.CODE_CODE_C:if(be<100)be<10&&(V+="0"),V+=be;else switch(be!==ze.CODE_STOP&&(Fe=!1),be){case ze.CODE_FNC_1:v&&(V.length===0?V+="]C1":V+="");break;case ze.CODE_CODE_A:I=ze.CODE_CODE_A;break;case ze.CODE_CODE_B:I=ze.CODE_CODE_B;break;case ze.CODE_STOP:O=!0;break}break}ci&&(I=I===ze.CODE_CODE_A?ze.CODE_CODE_B:ze.CODE_CODE_A)}const wr=ae-Q;if(ae=l.getNextUnset(ae),!l.isRange(ae,Math.min(l.getSize(),ae+(ae-Q)/2),!1))throw new $;if(Pe-=Ue*de,Pe%103!==de)throw new S;const Qr=V.length;if(Qr===0)throw new $;Qr>0&&Fe&&(I===ze.CODE_CODE_C?V=V.substring(0,Qr-2):V=V.substring(0,Qr-1));const Dr=(m[1]+m[0])/2,nn=Q+wr/2,nr=_.length,Mr=new Uint8Array(nr);for(let ci=0;ci<nr;ci++)Mr[ci]=_[ci];const Ui=[new We(Dr,s),new We(nn,s)];return new Le(V,Mr,0,Ui,Ie.CODE_128,new Date().getTime())}}ze.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],ze.MAX_AVG_VARIANCE=.25,ze.MAX_INDIVIDUAL_VARIANCE=.7,ze.CODE_SHIFT=98,ze.CODE_CODE_C=99,ze.CODE_CODE_B=100,ze.CODE_CODE_A=101,ze.CODE_FNC_1=102,ze.CODE_FNC_2=97,ze.CODE_FNC_3=96,ze.CODE_FNC_4_A=101,ze.CODE_FNC_4_B=100,ze.CODE_START_A=103,ze.CODE_START_B=104,ze.CODE_START_C=105,ze.CODE_STOP=106;class Yt extends $t{constructor(s=!1,l=!1){super(),this.usingCheckDigit=s,this.extendedMode=l,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(s,l,h){let v=this.counters;v.fill(0),this.decodeRowResult="";let m=Yt.findAsteriskPattern(l,v),b=l.getNextSet(m[1]),E=l.getSize(),_,I;do{Yt.recordPattern(l,b,v);let se=Yt.toNarrowWidePattern(v);if(se<0)throw new $;_=Yt.patternToChar(se),this.decodeRowResult+=_,I=b;for(let de of v)b+=de;b=l.getNextSet(b)}while(_!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let O=0;for(let se of v)O+=se;let z=b-I-O;if(b!==E&&z*2<O)throw new $;if(this.usingCheckDigit){let se=this.decodeRowResult.length-1,de=0;for(let be=0;be<se;be++)de+=Yt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(be));if(this.decodeRowResult.charAt(se)!==Yt.ALPHABET_STRING.charAt(de%43))throw new S;this.decodeRowResult=this.decodeRowResult.substring(0,se)}if(this.decodeRowResult.length===0)throw new $;let V;this.extendedMode?V=Yt.decodeExtended(this.decodeRowResult):V=this.decodeRowResult;let Q=(m[1]+m[0])/2,ae=I+O/2;return new Le(V,null,0,[new We(Q,s),new We(ae,s)],Ie.CODE_39,new Date().getTime())}static findAsteriskPattern(s,l){let h=s.getSize(),v=s.getNextSet(0),m=0,b=v,E=!1,_=l.length;for(let I=v;I<h;I++)if(s.get(I)!==E)l[m]++;else{if(m===_-1){if(this.toNarrowWidePattern(l)===Yt.ASTERISK_ENCODING&&s.isRange(Math.max(0,b-Math.floor((I-b)/2)),b,!1))return[b,I];b+=l[0]+l[1],l.copyWithin(0,2,2+m-1),l[m-1]=0,l[m]=0,m--}else m++;l[m]=1,E=!E}throw new $}static toNarrowWidePattern(s){let l=s.length,h=0,v;do{let m=2147483647;for(let _ of s)_<m&&_>h&&(m=_);h=m,v=0;let b=0,E=0;for(let _=0;_<l;_++){let I=s[_];I>h&&(E|=1<<l-1-_,v++,b+=I)}if(v===3){for(let _=0;_<l&&v>0;_++){let I=s[_];if(I>h&&(v--,I*2>=b))return-1}return E}}while(v>3);return-1}static patternToChar(s){for(let l=0;l<Yt.CHARACTER_ENCODINGS.length;l++)if(Yt.CHARACTER_ENCODINGS[l]===s)return Yt.ALPHABET_STRING.charAt(l);if(s===Yt.ASTERISK_ENCODING)return"*";throw new $}static decodeExtended(s){let l=s.length,h="";for(let v=0;v<l;v++){let m=s.charAt(v);if(m==="+"||m==="$"||m==="%"||m==="/"){let b=s.charAt(v+1),E="\0";switch(m){case"+":if(b>="A"&&b<="Z")E=String.fromCharCode(b.charCodeAt(0)+32);else throw new G;break;case"$":if(b>="A"&&b<="Z")E=String.fromCharCode(b.charCodeAt(0)-64);else throw new G;break;case"%":if(b>="A"&&b<="E")E=String.fromCharCode(b.charCodeAt(0)-38);else if(b>="F"&&b<="J")E=String.fromCharCode(b.charCodeAt(0)-11);else if(b>="K"&&b<="O")E=String.fromCharCode(b.charCodeAt(0)+16);else if(b>="P"&&b<="T")E=String.fromCharCode(b.charCodeAt(0)+43);else if(b==="U")E="\0";else if(b==="V")E="@";else if(b==="W")E="`";else if(b==="X"||b==="Y"||b==="Z")E="";else throw new G;break;case"/":if(b>="A"&&b<="O")E=String.fromCharCode(b.charCodeAt(0)-32);else if(b==="Z")E=":";else throw new G;break}h+=E,v++}else h+=m}return h}}Yt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Yt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Yt.ASTERISK_ENCODING=148;class Vt extends $t{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(s,l,h){let v=this.decodeStart(l),m=this.decodeEnd(l),b=new me;Vt.decodeMiddle(l,v[1],m[0],b);let E=b.toString(),_=null;h!=null&&(_=h.get(W.ALLOWED_LENGTHS)),_==null&&(_=Vt.DEFAULT_ALLOWED_LENGTHS);let I=E.length,O=!1,z=0;for(let ae of _){if(I===ae){O=!0;break}ae>z&&(z=ae)}if(!O&&I>z&&(O=!0),!O)throw new G;const V=[new We(v[1],s),new We(m[0],s)];return new Le(E,null,0,V,Ie.ITF,new Date().getTime())}static decodeMiddle(s,l,h,v){let m=new Int32Array(10),b=new Int32Array(5),E=new Int32Array(5);for(m.fill(0),b.fill(0),E.fill(0);l<h;){$t.recordPattern(s,l,m);for(let I=0;I<5;I++){let O=2*I;b[I]=m[O],E[I]=m[O+1]}let _=Vt.decodeDigit(b);v.append(_.toString()),_=this.decodeDigit(E),v.append(_.toString()),m.forEach(function(I){l+=I})}}decodeStart(s){let l=Vt.skipWhiteSpace(s),h=Vt.findGuardPattern(s,l,Vt.START_PATTERN);return this.narrowLineWidth=(h[1]-h[0])/4,this.validateQuietZone(s,h[0]),h}validateQuietZone(s,l){let h=this.narrowLineWidth*10;h=h<l?h:l;for(let v=l-1;h>0&&v>=0&&!s.get(v);v--)h--;if(h!==0)throw new $}static skipWhiteSpace(s){const l=s.getSize(),h=s.getNextSet(0);if(h===l)throw new $;return h}decodeEnd(s){s.reverse();try{let l=Vt.skipWhiteSpace(s),h;try{h=Vt.findGuardPattern(s,l,Vt.END_PATTERN_REVERSED[0])}catch(m){m instanceof $&&(h=Vt.findGuardPattern(s,l,Vt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(s,h[0]);let v=h[0];return h[0]=s.getSize()-h[1],h[1]=s.getSize()-v,h}finally{s.reverse()}}static findGuardPattern(s,l,h){let v=h.length,m=new Int32Array(v),b=s.getSize(),E=!1,_=0,I=l;m.fill(0);for(let O=l;O<b;O++)if(s.get(O)!==E)m[_]++;else{if(_===v-1){if($t.patternMatchVariance(m,h,Vt.MAX_INDIVIDUAL_VARIANCE)<Vt.MAX_AVG_VARIANCE)return[I,O];I+=m[0]+m[1],N.arraycopy(m,2,m,0,_-1),m[_-1]=0,m[_]=0,_--}else _++;m[_]=1,E=!E}throw new $}static decodeDigit(s){let l=Vt.MAX_AVG_VARIANCE,h=-1,v=Vt.PATTERNS.length;for(let m=0;m<v;m++){let b=Vt.PATTERNS[m],E=$t.patternMatchVariance(s,b,Vt.MAX_INDIVIDUAL_VARIANCE);E<l?(l=E,h=m):E===l&&(h=-1)}if(h>=0)return h%10;throw new $}}Vt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Vt.MAX_AVG_VARIANCE=.38,Vt.MAX_INDIVIDUAL_VARIANCE=.5,Vt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Vt.START_PATTERN=Int32Array.from([1,1,1,1]),Vt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class un extends $t{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(s){let l=!1,h,v=0,m=Int32Array.from([0,0,0]);for(;!l;){m=Int32Array.from([0,0,0]),h=un.findGuardPattern(s,v,!1,this.START_END_PATTERN,m);let b=h[0];v=h[1];let E=b-(v-b);E>=0&&(l=s.isRange(E,b,!1))}return h}static checkChecksum(s){return un.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let l=s.length;if(l===0)return!1;let h=parseInt(s.charAt(l-1),10);return un.getStandardUPCEANChecksum(s.substring(0,l-1))===h}static getStandardUPCEANChecksum(s){let l=s.length,h=0;for(let v=l-1;v>=0;v-=2){let m=s.charAt(v).charCodeAt(0)-48;if(m<0||m>9)throw new G;h+=m}h*=3;for(let v=l-2;v>=0;v-=2){let m=s.charAt(v).charCodeAt(0)-48;if(m<0||m>9)throw new G;h+=m}return(1e3-h)%10}static decodeEnd(s,l){return un.findGuardPattern(s,l,!1,un.START_END_PATTERN,new Int32Array(un.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(s,l,h,v){return this.findGuardPattern(s,l,h,v,new Int32Array(v.length))}static findGuardPattern(s,l,h,v,m){let b=s.getSize();l=h?s.getNextUnset(l):s.getNextSet(l);let E=0,_=l,I=v.length,O=h;for(let z=l;z<b;z++)if(s.get(z)!==O)m[E]++;else{if(E===I-1){if($t.patternMatchVariance(m,v,un.MAX_INDIVIDUAL_VARIANCE)<un.MAX_AVG_VARIANCE)return Int32Array.from([_,z]);_+=m[0]+m[1];let V=m.slice(2,m.length-1);for(let Q=0;Q<E-1;Q++)m[Q]=V[Q];m[E-1]=0,m[E]=0,E--}else E++;m[E]=1,O=!O}throw new $}static decodeDigit(s,l,h,v){this.recordPattern(s,h,l);let m=this.MAX_AVG_VARIANCE,b=-1,E=v.length;for(let _=0;_<E;_++){let I=v[_],O=$t.patternMatchVariance(l,I,un.MAX_INDIVIDUAL_VARIANCE);O<m&&(m=O,b=_)}if(b>=0)return b;throw new $}}un.MAX_AVG_VARIANCE=.48,un.MAX_INDIVIDUAL_VARIANCE=.7,un.START_END_PATTERN=Int32Array.from([1,1,1]),un.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),un.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),un.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class os{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(s,l,h){let v=this.decodeRowStringBuffer,m=this.decodeMiddle(l,h,v),b=v.toString(),E=os.parseExtensionString(b),_=[new We((h[0]+h[1])/2,s),new We(m,s)],I=new Le(b,null,0,_,Ie.UPC_EAN_EXTENSION,new Date().getTime());return E!=null&&I.putAllMetadata(E),I}decodeMiddle(s,l,h){let v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let m=s.getSize(),b=l[1],E=0;for(let I=0;I<5&&b<m;I++){let O=un.decodeDigit(s,v,b,un.L_AND_G_PATTERNS);h+=String.fromCharCode(48+O%10);for(let z of v)b+=z;O>=10&&(E|=1<<4-I),I!==4&&(b=s.getNextSet(b),b=s.getNextUnset(b))}if(h.length!==5)throw new $;let _=this.determineCheckDigit(E);if(os.extensionChecksum(h.toString())!==_)throw new $;return b}static extensionChecksum(s){let l=s.length,h=0;for(let v=l-2;v>=0;v-=2)h+=s.charAt(v).charCodeAt(0)-48;h*=3;for(let v=l-1;v>=0;v-=2)h+=s.charAt(v).charCodeAt(0)-48;return h*=3,h%10}determineCheckDigit(s){for(let l=0;l<10;l++)if(s===this.CHECK_DIGIT_ENCODINGS[l])return l;throw new $}static parseExtensionString(s){if(s.length!==5)return null;let l=os.parseExtension5String(s);return l==null?null:new Map([[He.SUGGESTED_PRICE,l]])}static parseExtension5String(s){let l;switch(s.charAt(0)){case"0":l="£";break;case"5":l="$";break;case"9":switch(s){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}l="";break;default:l="";break}let h=parseInt(s.substring(1)),v=(h/100).toString(),m=h%100,b=m<10?"0"+m:m.toString();return l+v+"."+b}}class Ys{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(s,l,h){let v=this.decodeRowStringBuffer,m=this.decodeMiddle(l,h,v),b=v.toString(),E=Ys.parseExtensionString(b),_=[new We((h[0]+h[1])/2,s),new We(m,s)],I=new Le(b,null,0,_,Ie.UPC_EAN_EXTENSION,new Date().getTime());return E!=null&&I.putAllMetadata(E),I}decodeMiddle(s,l,h){let v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let m=s.getSize(),b=l[1],E=0;for(let _=0;_<2&&b<m;_++){let I=un.decodeDigit(s,v,b,un.L_AND_G_PATTERNS);h+=String.fromCharCode(48+I%10);for(let O of v)b+=O;I>=10&&(E|=1<<1-_),_!==1&&(b=s.getNextSet(b),b=s.getNextUnset(b))}if(h.length!==2)throw new $;if(parseInt(h.toString())%4!==E)throw new $;return b}static parseExtensionString(s){return s.length!==2?null:new Map([[He.ISSUE_NUMBER,parseInt(s)]])}}class il{static decodeRow(s,l,h){let v=un.findGuardPattern(l,h,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new os().decodeRow(s,l,v)}catch{return new Ys().decodeRow(s,l,v)}}}il.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Lt extends un{constructor(){super(),this.decodeRowStringBuffer="",Lt.L_AND_G_PATTERNS=Lt.L_PATTERNS.map(s=>Int32Array.from(s));for(let s=10;s<20;s++){let l=Lt.L_PATTERNS[s-10],h=new Int32Array(l.length);for(let v=0;v<l.length;v++)h[v]=l[l.length-v-1];Lt.L_AND_G_PATTERNS[s]=h}}decodeRow(s,l,h){let v=Lt.findStartGuardPattern(l),m=h==null?null:h.get(W.NEED_RESULT_POINT_CALLBACK);if(m!=null){const Fe=new We((v[0]+v[1])/2,s);m.foundPossibleResultPoint(Fe)}let b=this.decodeMiddle(l,v,this.decodeRowStringBuffer),E=b.rowOffset,_=b.resultString;if(m!=null){const Fe=new We(E,s);m.foundPossibleResultPoint(Fe)}let I=this.decodeEnd(l,E);if(m!=null){const Fe=new We((I[0]+I[1])/2,s);m.foundPossibleResultPoint(Fe)}let O=I[1],z=O+(O-I[0]);if(z>=l.getSize()||!l.isRange(O,z,!1))throw new $;let V=_.toString();if(V.length<8)throw new G;if(!Lt.checkChecksum(V))throw new S;let Q=(v[1]+v[0])/2,ae=(I[1]+I[0])/2,se=this.getBarcodeFormat(),de=[new We(Q,s),new We(ae,s)],be=new Le(V,null,0,de,se,new Date().getTime()),Pe=0;try{let Fe=il.decodeRow(s,l,I[1]);be.putMetadata(He.UPC_EAN_EXTENSION,Fe.getText()),be.putAllMetadata(Fe.getResultMetadata()),be.addResultPoints(Fe.getResultPoints()),Pe=Fe.getText().length}catch{}let Ue=h==null?null:h.get(W.ALLOWED_EAN_EXTENSIONS);if(Ue!=null){let Fe=!1;for(let xt in Ue)if(Pe.toString()===xt){Fe=!0;break}if(!Fe)throw new $}return be}decodeEnd(s,l){return Lt.findGuardPattern(s,l,!1,Lt.START_END_PATTERN,new Int32Array(Lt.START_END_PATTERN.length).fill(0))}static checkChecksum(s){return Lt.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let l=s.length;if(l===0)return!1;let h=parseInt(s.charAt(l-1),10);return Lt.getStandardUPCEANChecksum(s.substring(0,l-1))===h}static getStandardUPCEANChecksum(s){let l=s.length,h=0;for(let v=l-1;v>=0;v-=2){let m=s.charAt(v).charCodeAt(0)-48;if(m<0||m>9)throw new G;h+=m}h*=3;for(let v=l-2;v>=0;v-=2){let m=s.charAt(v).charCodeAt(0)-48;if(m<0||m>9)throw new G;h+=m}return(1e3-h)%10}}class oa extends Lt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(s,l,h){let v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let m=s.getSize(),b=l[1],E=0;for(let I=0;I<6&&b<m;I++){let O=Lt.decodeDigit(s,v,b,Lt.L_AND_G_PATTERNS);h+=String.fromCharCode(48+O%10);for(let z of v)b+=z;O>=10&&(E|=1<<5-I)}h=oa.determineFirstDigit(h,E),b=Lt.findGuardPattern(s,b,!0,Lt.MIDDLE_PATTERN,new Int32Array(Lt.MIDDLE_PATTERN.length).fill(0))[1];for(let I=0;I<6&&b<m;I++){let O=Lt.decodeDigit(s,v,b,Lt.L_PATTERNS);h+=String.fromCharCode(48+O);for(let z of v)b+=z}return{rowOffset:b,resultString:h}}getBarcodeFormat(){return Ie.EAN_13}static determineFirstDigit(s,l){for(let h=0;h<10;h++)if(l===this.FIRST_DIGIT_ENCODINGS[h])return s=String.fromCharCode(48+h)+s,s;throw new $}}oa.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Dc extends Lt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(s,l,h){const v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let m=s.getSize(),b=l[1];for(let _=0;_<4&&b<m;_++){let I=Lt.decodeDigit(s,v,b,Lt.L_PATTERNS);h+=String.fromCharCode(48+I);for(let O of v)b+=O}b=Lt.findGuardPattern(s,b,!0,Lt.MIDDLE_PATTERN,new Int32Array(Lt.MIDDLE_PATTERN.length).fill(0))[1];for(let _=0;_<4&&b<m;_++){let I=Lt.decodeDigit(s,v,b,Lt.L_PATTERNS);h+=String.fromCharCode(48+I);for(let O of v)b+=O}return{rowOffset:b,resultString:h}}getBarcodeFormat(){return Ie.EAN_8}}class ol extends Lt{constructor(){super(...arguments),this.ean13Reader=new oa}getBarcodeFormat(){return Ie.UPC_A}decode(s,l){return this.maybeReturnResult(this.ean13Reader.decode(s))}decodeRow(s,l,h){return this.maybeReturnResult(this.ean13Reader.decodeRow(s,l,h))}decodeMiddle(s,l,h){return this.ean13Reader.decodeMiddle(s,l,h)}maybeReturnResult(s){let l=s.getText();if(l.charAt(0)==="0"){let h=new Le(l.substring(1),null,null,s.getResultPoints(),Ie.UPC_A);return s.getResultMetadata()!=null&&h.putAllMetadata(s.getResultMetadata()),h}else throw new $}reset(){this.ean13Reader.reset()}}class qr extends Lt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(s,l,h){const v=this.decodeMiddleCounters.map(I=>I);v[0]=0,v[1]=0,v[2]=0,v[3]=0;const m=s.getSize();let b=l[1],E=0;for(let I=0;I<6&&b<m;I++){const O=qr.decodeDigit(s,v,b,qr.L_AND_G_PATTERNS);h+=String.fromCharCode(48+O%10);for(let z of v)b+=z;O>=10&&(E|=1<<5-I)}let _=qr.determineNumSysAndCheckDigit(h,E);return{rowOffset:b,resultString:_}}decodeEnd(s,l){return qr.findGuardPatternWithoutCounters(s,l,!0,qr.MIDDLE_END_PATTERN)}checkChecksum(s){return Lt.checkChecksum(qr.convertUPCEtoUPCA(s))}static determineNumSysAndCheckDigit(s,l){for(let h=0;h<=1;h++)for(let v=0;v<10;v++)if(l===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[h][v]){let m=String.fromCharCode(48+h),b=String.fromCharCode(48+v);return m+s+b}throw $.getNotFoundInstance()}getBarcodeFormat(){return Ie.UPC_E}static convertUPCEtoUPCA(s){const l=s.slice(1,7).split("").map(m=>m.charCodeAt(0)),h=new me;h.append(s.charAt(0));let v=l[5];switch(v){case 0:case 1:case 2:h.appendChars(l,0,2),h.append(v),h.append("0000"),h.appendChars(l,2,3);break;case 3:h.appendChars(l,0,3),h.append("00000"),h.appendChars(l,3,2);break;case 4:h.appendChars(l,0,4),h.append("00000"),h.append(l[4]);break;default:h.appendChars(l,0,5),h.append("0000"),h.append(v);break}return s.length>=8&&h.append(s.charAt(7)),h.toString()}}qr.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),qr.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class ss extends $t{constructor(s){super();let l=s==null?null:s.get(W.POSSIBLE_FORMATS),h=[];n(l)?(h.push(new oa),h.push(new ol),h.push(new Dc),h.push(new qr)):(l.indexOf(Ie.EAN_13)>-1&&h.push(new oa),l.indexOf(Ie.UPC_A)>-1&&h.push(new ol),l.indexOf(Ie.EAN_8)>-1&&h.push(new Dc),l.indexOf(Ie.UPC_E)>-1&&h.push(new qr)),this.readers=h}decodeRow(s,l,h){for(let v of this.readers)try{const m=v.decodeRow(s,l,h),b=m.getBarcodeFormat()===Ie.EAN_13&&m.getText().charAt(0)==="0",E=h==null?null:h.get(W.POSSIBLE_FORMATS),_=E==null||E.includes(Ie.UPC_A);if(b&&_){const I=m.getRawBytes(),O=new Le(m.getText().substring(1),I,I?I.length:null,m.getResultPoints(),Ie.UPC_A);return O.putAllMetadata(m.getResultMetadata()),O}return m}catch{}throw new $}reset(){for(let s of this.readers)s.reset()}}class Xn extends $t{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(s,l){for(let h=0;h<l.length;h++)if($t.patternMatchVariance(s,l[h],Xn.MAX_INDIVIDUAL_VARIANCE)<Xn.MAX_AVG_VARIANCE)return h;throw new $}static count(s){return ct.sum(new Int32Array(s))}static increment(s,l){let h=0,v=l[0];for(let m=1;m<s.length;m++)l[m]>v&&(v=l[m],h=m);s[h]++}static decrement(s,l){let h=0,v=l[0];for(let m=1;m<s.length;m++)l[m]<v&&(v=l[m],h=m);s[h]--}static isFinderPattern(s){let l=s[0]+s[1],h=l+s[2]+s[3],v=l/h;if(v>=Xn.MIN_FINDER_PATTERN_RATIO&&v<=Xn.MAX_FINDER_PATTERN_RATIO){let m=Number.MAX_SAFE_INTEGER,b=Number.MIN_SAFE_INTEGER;for(let E of s)E>b&&(b=E),E<m&&(m=E);return b<10*m}return!1}}Xn.MAX_AVG_VARIANCE=.2,Xn.MAX_INDIVIDUAL_VARIANCE=.45,Xn.MIN_FINDER_PATTERN_RATIO=9.5/12,Xn.MAX_FINDER_PATTERN_RATIO=12.5/14;class Oi{constructor(s,l){this.value=s,this.checksumPortion=l}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(s){if(!(s instanceof Oi))return!1;const l=s;return this.value===l.value&&this.checksumPortion===l.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class qs{constructor(s,l,h,v,m){this.value=s,this.startEnd=l,this.value=s,this.startEnd=l,this.resultPoints=new Array,this.resultPoints.push(new We(h,m)),this.resultPoints.push(new We(v,m))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(s){if(!(s instanceof qs))return!1;const l=s;return this.value===l.value}hashCode(){return this.value}}class Qn{constructor(){}static getRSSvalue(s,l,h){let v=0;for(let _ of s)v+=_;let m=0,b=0,E=s.length;for(let _=0;_<E-1;_++){let I;for(I=1,b|=1<<_;I<s[_];I++,b&=~(1<<_)){let O=Qn.combins(v-I-1,E-_-2);if(h&&b===0&&v-I-(E-_-1)>=E-_-1&&(O-=Qn.combins(v-I-(E-_),E-_-2)),E-_-1>1){let z=0;for(let V=v-I-(E-_-2);V>l;V--)z+=Qn.combins(v-I-V-1,E-_-3);O-=z*(E-1-_)}else v-I>l&&O--;m+=O}v-=I}return m}static combins(s,l){let h,v;s-l>l?(v=l,h=s-l):(v=s-l,h=l);let m=1,b=1;for(let E=s;E>h;E--)m*=E,b<=v&&(m/=b,b++);for(;b<=v;)m/=b,b++;return m}}class hr{static buildBitArray(s){let l=s.length*2-1;s[s.length-1].getRightChar()==null&&(l-=1);let h=12*l,v=new L(h),m=0,E=s[0].getRightChar().getValue();for(let _=11;_>=0;--_)(E&1<<_)!=0&&v.set(m),m++;for(let _=1;_<s.length;++_){let I=s[_],O=I.getLeftChar().getValue();for(let z=11;z>=0;--z)(O&1<<z)!=0&&v.set(m),m++;if(I.getRightChar()!=null){let z=I.getRightChar().getValue();for(let V=11;V>=0;--V)(z&1<<V)!=0&&v.set(m),m++}}return v}}class Nn{constructor(s,l){l?this.decodedInformation=null:(this.finished=s,this.decodedInformation=l)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Ja{constructor(s){this.newPosition=s}getNewPosition(){return this.newPosition}}class dr extends Ja{constructor(s,l){super(s),this.value=l}getValue(){return this.value}isFNC1(){return this.value===dr.FNC1}}dr.FNC1="$";class Bi extends Ja{constructor(s,l,h){super(s),h?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=l}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Kr extends Ja{constructor(s,l,h){if(super(s),l<0||l>10||h<0||h>10)throw new G;this.firstDigit=l,this.secondDigit=h}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Kr.FNC1}isSecondDigitFNC1(){return this.secondDigit===Kr.FNC1}isAnyFNC1(){return this.firstDigit===Kr.FNC1||this.secondDigit===Kr.FNC1}}Kr.FNC1=10;class je{constructor(){}static parseFieldsInGeneralPurpose(s){if(!s)return null;if(s.length<2)throw new $;let l=s.substring(0,2);for(let m of je.TWO_DIGIT_DATA_LENGTH)if(m[0]===l)return m[1]===je.VARIABLE_LENGTH?je.processVariableAI(2,m[2],s):je.processFixedAI(2,m[1],s);if(s.length<3)throw new $;let h=s.substring(0,3);for(let m of je.THREE_DIGIT_DATA_LENGTH)if(m[0]===h)return m[1]===je.VARIABLE_LENGTH?je.processVariableAI(3,m[2],s):je.processFixedAI(3,m[1],s);for(let m of je.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(m[0]===h)return m[1]===je.VARIABLE_LENGTH?je.processVariableAI(4,m[2],s):je.processFixedAI(4,m[1],s);if(s.length<4)throw new $;let v=s.substring(0,4);for(let m of je.FOUR_DIGIT_DATA_LENGTH)if(m[0]===v)return m[1]===je.VARIABLE_LENGTH?je.processVariableAI(4,m[2],s):je.processFixedAI(4,m[1],s);throw new $}static processFixedAI(s,l,h){if(h.length<s)throw new $;let v=h.substring(0,s);if(h.length<s+l)throw new $;let m=h.substring(s,s+l),b=h.substring(s+l),E="("+v+")"+m,_=je.parseFieldsInGeneralPurpose(b);return _==null?E:E+_}static processVariableAI(s,l,h){let v=h.substring(0,s),m;h.length<s+l?m=h.length:m=s+l;let b=h.substring(s,m),E=h.substring(m),_="("+v+")"+b,I=je.parseFieldsInGeneralPurpose(E);return I==null?_:_+I}}je.VARIABLE_LENGTH=[],je.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",je.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",je.VARIABLE_LENGTH,20],["22",je.VARIABLE_LENGTH,29],["30",je.VARIABLE_LENGTH,8],["37",je.VARIABLE_LENGTH,8],["90",je.VARIABLE_LENGTH,30],["91",je.VARIABLE_LENGTH,30],["92",je.VARIABLE_LENGTH,30],["93",je.VARIABLE_LENGTH,30],["94",je.VARIABLE_LENGTH,30],["95",je.VARIABLE_LENGTH,30],["96",je.VARIABLE_LENGTH,30],["97",je.VARIABLE_LENGTH,3],["98",je.VARIABLE_LENGTH,30],["99",je.VARIABLE_LENGTH,30]],je.THREE_DIGIT_DATA_LENGTH=[["240",je.VARIABLE_LENGTH,30],["241",je.VARIABLE_LENGTH,30],["242",je.VARIABLE_LENGTH,6],["250",je.VARIABLE_LENGTH,30],["251",je.VARIABLE_LENGTH,30],["253",je.VARIABLE_LENGTH,17],["254",je.VARIABLE_LENGTH,20],["400",je.VARIABLE_LENGTH,30],["401",je.VARIABLE_LENGTH,30],["402",17],["403",je.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",je.VARIABLE_LENGTH,20],["421",je.VARIABLE_LENGTH,15],["422",3],["423",je.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],je.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",je.VARIABLE_LENGTH,15],["391",je.VARIABLE_LENGTH,18],["392",je.VARIABLE_LENGTH,15],["393",je.VARIABLE_LENGTH,18],["703",je.VARIABLE_LENGTH,30]],je.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",je.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",je.VARIABLE_LENGTH,20],["8003",je.VARIABLE_LENGTH,30],["8004",je.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",je.VARIABLE_LENGTH,30],["8008",je.VARIABLE_LENGTH,12],["8018",18],["8020",je.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",je.VARIABLE_LENGTH,70],["8200",je.VARIABLE_LENGTH,70]];class _a{constructor(s){this.buffer=new me,this.information=s}decodeAllCodes(s,l){let h=l,v=null;do{let m=this.decodeGeneralPurposeField(h,v),b=je.parseFieldsInGeneralPurpose(m.getNewString());if(b!=null&&s.append(b),m.isRemaining()?v=""+m.getRemainingValue():v=null,h===m.getNewPosition())break;h=m.getNewPosition()}while(!0);return s.toString()}isStillNumeric(s){if(s+7>this.information.getSize())return s+4<=this.information.getSize();for(let l=s;l<s+3;++l)if(this.information.get(l))return!0;return this.information.get(s+3)}decodeNumeric(s){if(s+7>this.information.getSize()){let m=this.extractNumericValueFromBitArray(s,4);return m===0?new Kr(this.information.getSize(),Kr.FNC1,Kr.FNC1):new Kr(this.information.getSize(),m-1,Kr.FNC1)}let l=this.extractNumericValueFromBitArray(s,7),h=(l-8)/11,v=(l-8)%11;return new Kr(s+7,h,v)}extractNumericValueFromBitArray(s,l){return _a.extractNumericValueFromBitArray(this.information,s,l)}static extractNumericValueFromBitArray(s,l,h){let v=0;for(let m=0;m<h;++m)s.get(l+m)&&(v|=1<<h-m-1);return v}decodeGeneralPurposeField(s,l){this.buffer.setLengthToZero(),l!=null&&this.buffer.append(l),this.current.setPosition(s);let h=this.parseBlocks();return h!=null&&h.isRemaining()?new Bi(this.current.getPosition(),this.buffer.toString(),h.getRemainingValue()):new Bi(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let s,l;do{let h=this.current.getPosition();if(this.current.isAlpha()?(l=this.parseAlphaBlock(),s=l.isFinished()):this.current.isIsoIec646()?(l=this.parseIsoIec646Block(),s=l.isFinished()):(l=this.parseNumericBlock(),s=l.isFinished()),!(h!==this.current.getPosition())&&!s)break}while(!s);return l.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let s=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFirstDigitFNC1()){let l;return s.isSecondDigitFNC1()?l=new Bi(this.current.getPosition(),this.buffer.toString()):l=new Bi(this.current.getPosition(),this.buffer.toString(),s.getSecondDigit()),new Nn(!0,l)}if(this.buffer.append(s.getFirstDigit()),s.isSecondDigitFNC1()){let l=new Bi(this.current.getPosition(),this.buffer.toString());return new Nn(!0,l)}this.buffer.append(s.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Nn(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let s=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFNC1()){let l=new Bi(this.current.getPosition(),this.buffer.toString());return new Nn(!0,l)}this.buffer.append(s.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Nn(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let s=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFNC1()){let l=new Bi(this.current.getPosition(),this.buffer.toString());return new Nn(!0,l)}this.buffer.append(s.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Nn(!1)}isStillIsoIec646(s){if(s+5>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(s,5);if(l>=5&&l<16)return!0;if(s+7>this.information.getSize())return!1;let h=this.extractNumericValueFromBitArray(s,7);if(h>=64&&h<116)return!0;if(s+8>this.information.getSize())return!1;let v=this.extractNumericValueFromBitArray(s,8);return v>=232&&v<253}decodeIsoIec646(s){let l=this.extractNumericValueFromBitArray(s,5);if(l===15)return new dr(s+5,dr.FNC1);if(l>=5&&l<15)return new dr(s+5,"0"+(l-5));let h=this.extractNumericValueFromBitArray(s,7);if(h>=64&&h<90)return new dr(s+7,""+(h+1));if(h>=90&&h<116)return new dr(s+7,""+(h+7));let v=this.extractNumericValueFromBitArray(s,8),m;switch(v){case 232:m="!";break;case 233:m='"';break;case 234:m="%";break;case 235:m="&";break;case 236:m="'";break;case 237:m="(";break;case 238:m=")";break;case 239:m="*";break;case 240:m="+";break;case 241:m=",";break;case 242:m="-";break;case 243:m=".";break;case 244:m="/";break;case 245:m=":";break;case 246:m=";";break;case 247:m="<";break;case 248:m="=";break;case 249:m=">";break;case 250:m="?";break;case 251:m="_";break;case 252:m=" ";break;default:throw new G}return new dr(s+8,m)}isStillAlpha(s){if(s+5>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(s,5);if(l>=5&&l<16)return!0;if(s+6>this.information.getSize())return!1;let h=this.extractNumericValueFromBitArray(s,6);return h>=16&&h<63}decodeAlphanumeric(s){let l=this.extractNumericValueFromBitArray(s,5);if(l===15)return new dr(s+5,dr.FNC1);if(l>=5&&l<15)return new dr(s+5,"0"+(l-5));let h=this.extractNumericValueFromBitArray(s,6);if(h>=32&&h<58)return new dr(s+6,""+(h+33));let v;switch(h){case 58:v="*";break;case 59:v=",";break;case 60:v="-";break;case 61:v=".";break;case 62:v="/";break;default:throw new Bt("Decoding invalid alphanumeric value: "+h)}return new dr(s+6,v)}isAlphaTo646ToAlphaLatch(s){if(s+1>this.information.getSize())return!1;for(let l=0;l<5&&l+s<this.information.getSize();++l)if(l===2){if(!this.information.get(s+2))return!1}else if(this.information.get(s+l))return!1;return!0}isAlphaOr646ToNumericLatch(s){if(s+3>this.information.getSize())return!1;for(let l=s;l<s+3;++l)if(this.information.get(l))return!1;return!0}isNumericToAlphaNumericLatch(s){if(s+1>this.information.getSize())return!1;for(let l=0;l<4&&l+s<this.information.getSize();++l)if(this.information.get(s+l))return!1;return!0}}class us{constructor(s){this.information=s,this.generalDecoder=new _a(s)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Un extends us{constructor(s){super(s)}encodeCompressedGtin(s,l){s.append("(01)");let h=s.length();s.append("9"),this.encodeCompressedGtinWithoutAI(s,l,h)}encodeCompressedGtinWithoutAI(s,l,h){for(let v=0;v<4;++v){let m=this.getGeneralDecoder().extractNumericValueFromBitArray(l+10*v,10);m/100===0&&s.append("0"),m/10===0&&s.append("0"),s.append(m)}Un.appendCheckDigit(s,h)}static appendCheckDigit(s,l){let h=0;for(let v=0;v<13;v++){let m=s.charAt(v+l).charCodeAt(0)-48;h+=(v&1)===0?3*m:m}h=10-h%10,h===10&&(h=0),s.append(h)}}Un.GTIN_SIZE=40;class sa extends Un{constructor(s){super(s)}parseInformation(){let s=new me;s.append("(01)");let l=s.length(),h=this.getGeneralDecoder().extractNumericValueFromBitArray(sa.HEADER_SIZE,4);return s.append(h),this.encodeCompressedGtinWithoutAI(s,sa.HEADER_SIZE+4,l),this.getGeneralDecoder().decodeAllCodes(s,sa.HEADER_SIZE+44)}}sa.HEADER_SIZE=4;class $a extends us{constructor(s){super(s)}parseInformation(){let s=new me;return this.getGeneralDecoder().decodeAllCodes(s,$a.HEADER_SIZE)}}$a.HEADER_SIZE=5;class Ua extends Un{constructor(s){super(s)}encodeCompressedWeight(s,l,h){let v=this.getGeneralDecoder().extractNumericValueFromBitArray(l,h);this.addWeightCode(s,v);let m=this.checkWeight(v),b=1e5;for(let E=0;E<5;++E)m/b===0&&s.append("0"),b/=10;s.append(m)}}class en extends Ua{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()!=en.HEADER_SIZE+Ua.GTIN_SIZE+en.WEIGHT_SIZE)throw new $;let s=new me;return this.encodeCompressedGtin(s,en.HEADER_SIZE),this.encodeCompressedWeight(s,en.HEADER_SIZE+Ua.GTIN_SIZE,en.WEIGHT_SIZE),s.toString()}}en.HEADER_SIZE=5,en.WEIGHT_SIZE=15;class Mc extends en{constructor(s){super(s)}addWeightCode(s,l){s.append("(3103)")}checkWeight(s){return s}}class Oc extends en{constructor(s){super(s)}addWeightCode(s,l){l<1e4?s.append("(3202)"):s.append("(3203)")}checkWeight(s){return s<1e4?s:s-1e4}}class pr extends Un{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()<pr.HEADER_SIZE+Un.GTIN_SIZE)throw new $;let s=new me;this.encodeCompressedGtin(s,pr.HEADER_SIZE);let l=this.getGeneralDecoder().extractNumericValueFromBitArray(pr.HEADER_SIZE+Un.GTIN_SIZE,pr.LAST_DIGIT_SIZE);s.append("(392"),s.append(l),s.append(")");let h=this.getGeneralDecoder().decodeGeneralPurposeField(pr.HEADER_SIZE+Un.GTIN_SIZE+pr.LAST_DIGIT_SIZE,null);return s.append(h.getNewString()),s.toString()}}pr.HEADER_SIZE=8,pr.LAST_DIGIT_SIZE=2;class Dn extends Un{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()<Dn.HEADER_SIZE+Un.GTIN_SIZE)throw new $;let s=new me;this.encodeCompressedGtin(s,Dn.HEADER_SIZE);let l=this.getGeneralDecoder().extractNumericValueFromBitArray(Dn.HEADER_SIZE+Un.GTIN_SIZE,Dn.LAST_DIGIT_SIZE);s.append("(393"),s.append(l),s.append(")");let h=this.getGeneralDecoder().extractNumericValueFromBitArray(Dn.HEADER_SIZE+Un.GTIN_SIZE+Dn.LAST_DIGIT_SIZE,Dn.FIRST_THREE_DIGITS_SIZE);h/100==0&&s.append("0"),h/10==0&&s.append("0"),s.append(h);let v=this.getGeneralDecoder().decodeGeneralPurposeField(Dn.HEADER_SIZE+Un.GTIN_SIZE+Dn.LAST_DIGIT_SIZE+Dn.FIRST_THREE_DIGITS_SIZE,null);return s.append(v.getNewString()),s.toString()}}Dn.HEADER_SIZE=8,Dn.LAST_DIGIT_SIZE=2,Dn.FIRST_THREE_DIGITS_SIZE=10;class pn extends Ua{constructor(s,l,h){super(s),this.dateCode=h,this.firstAIdigits=l}parseInformation(){if(this.getInformation().getSize()!=pn.HEADER_SIZE+pn.GTIN_SIZE+pn.WEIGHT_SIZE+pn.DATE_SIZE)throw new $;let s=new me;return this.encodeCompressedGtin(s,pn.HEADER_SIZE),this.encodeCompressedWeight(s,pn.HEADER_SIZE+pn.GTIN_SIZE,pn.WEIGHT_SIZE),this.encodeCompressedDate(s,pn.HEADER_SIZE+pn.GTIN_SIZE+pn.WEIGHT_SIZE),s.toString()}encodeCompressedDate(s,l){let h=this.getGeneralDecoder().extractNumericValueFromBitArray(l,pn.DATE_SIZE);if(h==38400)return;s.append("("),s.append(this.dateCode),s.append(")");let v=h%32;h/=32;let m=h%12+1;h/=12;let b=h;b/10==0&&s.append("0"),s.append(b),m/10==0&&s.append("0"),s.append(m),v/10==0&&s.append("0"),s.append(v)}addWeightCode(s,l){s.append("("),s.append(this.firstAIdigits),s.append(l/1e5),s.append(")")}checkWeight(s){return s%1e5}}pn.HEADER_SIZE=8,pn.WEIGHT_SIZE=20,pn.DATE_SIZE=16;function sl(U){try{if(U.get(1))return new sa(U);if(!U.get(2))return new $a(U);switch(_a.extractNumericValueFromBitArray(U,1,4)){case 4:return new Mc(U);case 5:return new Oc(U)}switch(_a.extractNumericValueFromBitArray(U,1,5)){case 12:return new pr(U);case 13:return new Dn(U)}switch(_a.extractNumericValueFromBitArray(U,1,7)){case 56:return new pn(U,"310","11");case 57:return new pn(U,"320","11");case 58:return new pn(U,"310","13");case 59:return new pn(U,"320","13");case 60:return new pn(U,"310","15");case 61:return new pn(U,"320","15");case 62:return new pn(U,"310","17");case 63:return new pn(U,"320","17")}}catch(s){throw console.log(s),new Bt("unknown decoder: "+U)}}class za{constructor(s,l,h,v){this.leftchar=s,this.rightchar=l,this.finderpattern=h,this.maybeLast=v}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(s,l){return s instanceof za?za.equalsOrNull(s.leftchar,l.leftchar)&&za.equalsOrNull(s.rightchar,l.rightchar)&&za.equalsOrNull(s.finderpattern,l.finderpattern):!1}static equalsOrNull(s,l){return s===null?l===null:za.equals(s,l)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class ul{constructor(s,l,h){this.pairs=s,this.rowNumber=l,this.wasReversed=h}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(s){return this.checkEqualitity(this,s)}toString(){return"{ "+this.pairs+" }"}equals(s,l){return s instanceof ul?this.checkEqualitity(s,l)&&s.wasReversed===l.wasReversed:!1}checkEqualitity(s,l){if(!s||!l)return;let h;return s.forEach((v,m)=>{l.forEach(b=>{v.getLeftChar().getValue()===b.getLeftChar().getValue()&&v.getRightChar().getValue()===b.getRightChar().getValue()&&v.getFinderPatter().getValue()===b.getFinderPatter().getValue()&&(h=!0)})}),h}}class Be extends Xn{constructor(s){super(...arguments),this.pairs=new Array(Be.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=s===!0}decodeRow(s,l,h){this.pairs.length=0,this.startFromEven=!1;try{return Be.constructResult(this.decodeRow2pairs(s,l))}catch(v){this.verbose&&console.log(v)}return this.pairs.length=0,this.startFromEven=!0,Be.constructResult(this.decodeRow2pairs(s,l))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(s,l){let h=!1;for(;!h;)try{this.pairs.push(this.retrieveNextPair(l,this.pairs,s))}catch(m){if(m instanceof $){if(!this.pairs.length)throw new $;h=!0}}if(this.checkChecksum())return this.pairs;let v;if(this.rows.length?v=!0:v=!1,this.storeRow(s,!1),v){let m=this.checkRowsBoolean(!1);if(m!=null||(m=this.checkRowsBoolean(!0),m!=null))return m}throw new $}checkRowsBoolean(s){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,s&&(this.rows=this.rows.reverse());let l=null;try{l=this.checkRows(new Array,0)}catch(h){this.verbose&&console.log(h)}return s&&(this.rows=this.rows.reverse()),l}checkRows(s,l){for(let h=l;h<this.rows.length;h++){let v=this.rows[h];this.pairs.length=0;for(let b of s)this.pairs.push(b.getPairs());if(this.pairs.push(v.getPairs()),!Be.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let m=new Array(s);m.push(v);try{return this.checkRows(m,h+1)}catch(b){this.verbose&&console.log(b)}}throw new $}static isValidSequence(s){for(let l of Be.FINDER_PATTERN_SEQUENCES){if(s.length>l.length)continue;let h=!0;for(let v=0;v<s.length;v++)if(s[v].getFinderPattern().getValue()!=l[v]){h=!1;break}if(h)return!0}return!1}storeRow(s,l){let h=0,v=!1,m=!1;for(;h<this.rows.length;){let b=this.rows[h];if(b.getRowNumber()>s){m=b.isEquivalent(this.pairs);break}v=b.isEquivalent(this.pairs),h++}m||v||Be.isPartialRow(this.pairs,this.rows)||(this.rows.push(h,new ul(this.pairs,s,l)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(s,l){for(let h of l)if(h.getPairs().length!==s.length){for(let v of h.getPairs())for(let m of s)if(za.equals(v,m))break}}static isPartialRow(s,l){for(let h of l){let v=!0;for(let m of s){let b=!1;for(let E of h.getPairs())if(m.equals(E)){b=!0;break}if(!b){v=!1;break}}if(v)return!0}return!1}getRows(){return this.rows}static constructResult(s){let l=hr.buildBitArray(s),v=sl(l).parseInformation(),m=s[0].getFinderPattern().getResultPoints(),b=s[s.length-1].getFinderPattern().getResultPoints(),E=[m[0],m[1],b[0],b[1]];return new Le(v,null,null,E,Ie.RSS_EXPANDED,null)}checkChecksum(){let s=this.pairs.get(0),l=s.getLeftChar(),h=s.getRightChar();if(h==null)return!1;let v=h.getChecksumPortion(),m=2;for(let E=1;E<this.pairs.size();++E){let _=this.pairs.get(E);v+=_.getLeftChar().getChecksumPortion(),m++;let I=_.getRightChar();I!=null&&(v+=I.getChecksumPortion(),m++)}return v%=211,211*(m-4)+v==l.getValue()}static getNextSecondBar(s,l){let h;return s.get(l)?(h=s.getNextUnset(l),h=s.getNextSet(h)):(h=s.getNextSet(l),h=s.getNextUnset(h)),h}retrieveNextPair(s,l,h){let v=l.length%2==0;this.startFromEven&&(v=!v);let m,b=!0,E=-1;do this.findNextPair(s,l,E),m=this.parseFoundFinderPattern(s,h,v),m==null?E=Be.getNextSecondBar(s,this.startEnd[0]):b=!1;while(b);let _=this.decodeDataCharacter(s,m,v,!0);if(!this.isEmptyPair(l)&&l[l.length-1].mustBeLast())throw new $;let I;try{I=this.decodeDataCharacter(s,m,v,!1)}catch(O){I=null,this.verbose&&console.log(O)}return new za(_,I,m,!0)}isEmptyPair(s){return s.length===0}findNextPair(s,l,h){let v=this.getDecodeFinderCounters();v[0]=0,v[1]=0,v[2]=0,v[3]=0;let m=s.getSize(),b;h>=0?b=h:this.isEmptyPair(l)?b=0:b=l[l.length-1].getFinderPattern().getStartEnd()[1];let E=l.length%2!=0;this.startFromEven&&(E=!E);let _=!1;for(;b<m&&(_=!s.get(b),!!_);)b++;let I=0,O=b;for(let z=b;z<m;z++)if(s.get(z)!=_)v[I]++;else{if(I==3){if(E&&Be.reverseCounters(v),Be.isFinderPattern(v)){this.startEnd[0]=O,this.startEnd[1]=z;return}E&&Be.reverseCounters(v),O+=v[0]+v[1],v[0]=v[2],v[1]=v[3],v[2]=0,v[3]=0,I--}else I++;v[I]=1,_=!_}throw new $}static reverseCounters(s){let l=s.length;for(let h=0;h<l/2;++h){let v=s[h];s[h]=s[l-h-1],s[l-h-1]=v}}parseFoundFinderPattern(s,l,h){let v,m,b;if(h){let I=this.startEnd[0]-1;for(;I>=0&&!s.get(I);)I--;I++,v=this.startEnd[0]-I,m=I,b=this.startEnd[1]}else m=this.startEnd[0],b=s.getNextUnset(this.startEnd[1]+1),v=b-this.startEnd[1];let E=this.getDecodeFinderCounters();N.arraycopy(E,0,E,1,E.length-1),E[0]=v;let _;try{_=this.parseFinderValue(E,Be.FINDER_PATTERNS)}catch{return null}return new qs(_,[m,b],m,b,l)}decodeDataCharacter(s,l,h,v){let m=this.getDataCharacterCounters();for(let nn=0;nn<m.length;nn++)m[nn]=0;if(v)Be.recordPatternInReverse(s,l.getStartEnd()[0],m);else{Be.recordPattern(s,l.getStartEnd()[1],m);for(let nn=0,nr=m.length-1;nn<nr;nn++,nr--){let Mr=m[nn];m[nn]=m[nr],m[nr]=Mr}}let b=17,E=ct.sum(new Int32Array(m))/b,_=(l.getStartEnd()[1]-l.getStartEnd()[0])/15;if(Math.abs(E-_)/_>.3)throw new $;let I=this.getOddCounts(),O=this.getEvenCounts(),z=this.getOddRoundingErrors(),V=this.getEvenRoundingErrors();for(let nn=0;nn<m.length;nn++){let nr=1*m[nn]/E,Mr=nr+.5;if(Mr<1){if(nr<.3)throw new $;Mr=1}else if(Mr>8){if(nr>8.7)throw new $;Mr=8}let Ui=nn/2;(nn&1)==0?(I[Ui]=Mr,z[Ui]=nr-Mr):(O[Ui]=Mr,V[Ui]=nr-Mr)}this.adjustOddEvenCounts(b);let Q=4*l.getValue()+(h?0:2)+(v?0:1)-1,ae=0,se=0;for(let nn=I.length-1;nn>=0;nn--){if(Be.isNotA1left(l,h,v)){let nr=Be.WEIGHTS[Q][2*nn];se+=I[nn]*nr}ae+=I[nn]}let de=0;for(let nn=O.length-1;nn>=0;nn--)if(Be.isNotA1left(l,h,v)){let nr=Be.WEIGHTS[Q][2*nn+1];de+=O[nn]*nr}let be=se+de;if((ae&1)!=0||ae>13||ae<4)throw new $;let Pe=(13-ae)/2,Ue=Be.SYMBOL_WIDEST[Pe],Fe=9-Ue,xt=Qn.getRSSvalue(I,Ue,!0),gt=Qn.getRSSvalue(O,Fe,!1),wr=Be.EVEN_TOTAL_SUBSET[Pe],Qr=Be.GSUM[Pe],Dr=xt*wr+gt+Qr;return new Oi(Dr,be)}static isNotA1left(s,l,h){return!(s.getValue()==0&&l&&h)}adjustOddEvenCounts(s){let l=ct.sum(new Int32Array(this.getOddCounts())),h=ct.sum(new Int32Array(this.getEvenCounts())),v=!1,m=!1;l>13?m=!0:l<4&&(v=!0);let b=!1,E=!1;h>13?E=!0:h<4&&(b=!0);let _=l+h-s,I=(l&1)==1,O=(h&1)==0;if(_==1)if(I){if(O)throw new $;m=!0}else{if(!O)throw new $;E=!0}else if(_==-1)if(I){if(O)throw new $;v=!0}else{if(!O)throw new $;b=!0}else if(_==0){if(I){if(!O)throw new $;l<h?(v=!0,E=!0):(m=!0,b=!0)}else if(O)throw new $}else throw new $;if(v){if(m)throw new $;Be.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(m&&Be.decrement(this.getOddCounts(),this.getOddRoundingErrors()),b){if(E)throw new $;Be.increment(this.getEvenCounts(),this.getOddRoundingErrors())}E&&Be.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Be.SYMBOL_WIDEST=[7,5,4,3,1],Be.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Be.GSUM=[0,348,1388,2948,3988],Be.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Be.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Be.FINDER_PAT_A=0,Be.FINDER_PAT_B=1,Be.FINDER_PAT_C=2,Be.FINDER_PAT_D=3,Be.FINDER_PAT_E=4,Be.FINDER_PAT_F=5,Be.FINDER_PATTERN_SEQUENCES=[[Be.FINDER_PAT_A,Be.FINDER_PAT_A],[Be.FINDER_PAT_A,Be.FINDER_PAT_B,Be.FINDER_PAT_B],[Be.FINDER_PAT_A,Be.FINDER_PAT_C,Be.FINDER_PAT_B,Be.FINDER_PAT_D],[Be.FINDER_PAT_A,Be.FINDER_PAT_E,Be.FINDER_PAT_B,Be.FINDER_PAT_D,Be.FINDER_PAT_C],[Be.FINDER_PAT_A,Be.FINDER_PAT_E,Be.FINDER_PAT_B,Be.FINDER_PAT_D,Be.FINDER_PAT_D,Be.FINDER_PAT_F],[Be.FINDER_PAT_A,Be.FINDER_PAT_E,Be.FINDER_PAT_B,Be.FINDER_PAT_D,Be.FINDER_PAT_E,Be.FINDER_PAT_F,Be.FINDER_PAT_F],[Be.FINDER_PAT_A,Be.FINDER_PAT_A,Be.FINDER_PAT_B,Be.FINDER_PAT_B,Be.FINDER_PAT_C,Be.FINDER_PAT_C,Be.FINDER_PAT_D,Be.FINDER_PAT_D],[Be.FINDER_PAT_A,Be.FINDER_PAT_A,Be.FINDER_PAT_B,Be.FINDER_PAT_B,Be.FINDER_PAT_C,Be.FINDER_PAT_C,Be.FINDER_PAT_D,Be.FINDER_PAT_E,Be.FINDER_PAT_E],[Be.FINDER_PAT_A,Be.FINDER_PAT_A,Be.FINDER_PAT_B,Be.FINDER_PAT_B,Be.FINDER_PAT_C,Be.FINDER_PAT_C,Be.FINDER_PAT_D,Be.FINDER_PAT_E,Be.FINDER_PAT_F,Be.FINDER_PAT_F],[Be.FINDER_PAT_A,Be.FINDER_PAT_A,Be.FINDER_PAT_B,Be.FINDER_PAT_B,Be.FINDER_PAT_C,Be.FINDER_PAT_D,Be.FINDER_PAT_D,Be.FINDER_PAT_E,Be.FINDER_PAT_E,Be.FINDER_PAT_F,Be.FINDER_PAT_F]],Be.MAX_PAIRS=11;class Ks extends Oi{constructor(s,l,h){super(s,l),this.count=0,this.finderPattern=h}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Wt extends Xn{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(s,l,h){const v=this.decodePair(l,!1,s,h);Wt.addOrTally(this.possibleLeftPairs,v),l.reverse();let m=this.decodePair(l,!0,s,h);Wt.addOrTally(this.possibleRightPairs,m),l.reverse();for(let b of this.possibleLeftPairs)if(b.getCount()>1){for(let E of this.possibleRightPairs)if(E.getCount()>1&&Wt.checkChecksum(b,E))return Wt.constructResult(b,E)}throw new $}static addOrTally(s,l){if(l==null)return;let h=!1;for(let v of s)if(v.getValue()===l.getValue()){v.incrementCount(),h=!0;break}h||s.push(l)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(s,l){let h=4537077*s.getValue()+l.getValue(),v=new String(h).toString(),m=new me;for(let I=13-v.length;I>0;I--)m.append("0");m.append(v);let b=0;for(let I=0;I<13;I++){let O=m.charAt(I).charCodeAt(0)-48;b+=(I&1)===0?3*O:O}b=10-b%10,b===10&&(b=0),m.append(b.toString());let E=s.getFinderPattern().getResultPoints(),_=l.getFinderPattern().getResultPoints();return new Le(m.toString(),null,0,[E[0],E[1],_[0],_[1]],Ie.RSS_14,new Date().getTime())}static checkChecksum(s,l){let h=(s.getChecksumPortion()+16*l.getChecksumPortion())%79,v=9*s.getFinderPattern().getValue()+l.getFinderPattern().getValue();return v>72&&v--,v>8&&v--,h===v}decodePair(s,l,h,v){try{let m=this.findFinderPattern(s,l),b=this.parseFoundFinderPattern(s,h,l,m),E=v==null?null:v.get(W.NEED_RESULT_POINT_CALLBACK);if(E!=null){let O=(m[0]+m[1])/2;l&&(O=s.getSize()-1-O),E.foundPossibleResultPoint(new We(O,h))}let _=this.decodeDataCharacter(s,b,!0),I=this.decodeDataCharacter(s,b,!1);return new Ks(1597*_.getValue()+I.getValue(),_.getChecksumPortion()+4*I.getChecksumPortion(),b)}catch{return null}}decodeDataCharacter(s,l,h){let v=this.getDataCharacterCounters();for(let de=0;de<v.length;de++)v[de]=0;if(h)$t.recordPatternInReverse(s,l.getStartEnd()[0],v);else{$t.recordPattern(s,l.getStartEnd()[1]+1,v);for(let de=0,be=v.length-1;de<be;de++,be--){let Pe=v[de];v[de]=v[be],v[be]=Pe}}let m=h?16:15,b=ct.sum(new Int32Array(v))/m,E=this.getOddCounts(),_=this.getEvenCounts(),I=this.getOddRoundingErrors(),O=this.getEvenRoundingErrors();for(let de=0;de<v.length;de++){let be=v[de]/b,Pe=Math.floor(be+.5);Pe<1?Pe=1:Pe>8&&(Pe=8);let Ue=Math.floor(de/2);(de&1)===0?(E[Ue]=Pe,I[Ue]=be-Pe):(_[Ue]=Pe,O[Ue]=be-Pe)}this.adjustOddEvenCounts(h,m);let z=0,V=0;for(let de=E.length-1;de>=0;de--)V*=9,V+=E[de],z+=E[de];let Q=0,ae=0;for(let de=_.length-1;de>=0;de--)Q*=9,Q+=_[de],ae+=_[de];let se=V+3*Q;if(h){if((z&1)!==0||z>12||z<4)throw new $;let de=(12-z)/2,be=Wt.OUTSIDE_ODD_WIDEST[de],Pe=9-be,Ue=Qn.getRSSvalue(E,be,!1),Fe=Qn.getRSSvalue(_,Pe,!0),xt=Wt.OUTSIDE_EVEN_TOTAL_SUBSET[de],gt=Wt.OUTSIDE_GSUM[de];return new Oi(Ue*xt+Fe+gt,se)}else{if((ae&1)!==0||ae>10||ae<4)throw new $;let de=(10-ae)/2,be=Wt.INSIDE_ODD_WIDEST[de],Pe=9-be,Ue=Qn.getRSSvalue(E,be,!0),Fe=Qn.getRSSvalue(_,Pe,!1),xt=Wt.INSIDE_ODD_TOTAL_SUBSET[de],gt=Wt.INSIDE_GSUM[de];return new Oi(Fe*xt+Ue+gt,se)}}findFinderPattern(s,l){let h=this.getDecodeFinderCounters();h[0]=0,h[1]=0,h[2]=0,h[3]=0;let v=s.getSize(),m=!1,b=0;for(;b<v&&(m=!s.get(b),l!==m);)b++;let E=0,_=b;for(let I=b;I<v;I++)if(s.get(I)!==m)h[E]++;else{if(E===3){if(Xn.isFinderPattern(h))return[_,I];_+=h[0]+h[1],h[0]=h[2],h[1]=h[3],h[2]=0,h[3]=0,E--}else E++;h[E]=1,m=!m}throw new $}parseFoundFinderPattern(s,l,h,v){let m=s.get(v[0]),b=v[0]-1;for(;b>=0&&m!==s.get(b);)b--;b++;const E=v[0]-b,_=this.getDecodeFinderCounters(),I=new Int32Array(_.length);N.arraycopy(_,0,I,1,_.length-1),I[0]=E;const O=this.parseFinderValue(I,Wt.FINDER_PATTERNS);let z=b,V=v[1];return h&&(z=s.getSize()-1-z,V=s.getSize()-1-V),new qs(O,[b,v[1]],z,V,l)}adjustOddEvenCounts(s,l){let h=ct.sum(new Int32Array(this.getOddCounts())),v=ct.sum(new Int32Array(this.getEvenCounts())),m=!1,b=!1,E=!1,_=!1;s?(h>12?b=!0:h<4&&(m=!0),v>12?_=!0:v<4&&(E=!0)):(h>11?b=!0:h<5&&(m=!0),v>10?_=!0:v<4&&(E=!0));let I=h+v-l,O=(h&1)===(s?1:0),z=(v&1)===1;if(I===1)if(O){if(z)throw new $;b=!0}else{if(!z)throw new $;_=!0}else if(I===-1)if(O){if(z)throw new $;m=!0}else{if(!z)throw new $;E=!0}else if(I===0){if(O){if(!z)throw new $;h<v?(m=!0,_=!0):(b=!0,E=!0)}else if(z)throw new $}else throw new $;if(m){if(b)throw new $;Xn.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(b&&Xn.decrement(this.getOddCounts(),this.getOddRoundingErrors()),E){if(_)throw new $;Xn.increment(this.getEvenCounts(),this.getOddRoundingErrors())}_&&Xn.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Wt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Wt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Wt.OUTSIDE_GSUM=[0,161,961,2015,2715],Wt.INSIDE_GSUM=[0,336,1036,1516],Wt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Wt.INSIDE_ODD_WIDEST=[2,4,6,8],Wt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class ei extends $t{constructor(s,l){super(),this.readers=[],this.verbose=l===!0;const h=s?s.get(W.POSSIBLE_FORMATS):null,v=s&&s.get(W.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;h?((h.includes(Ie.EAN_13)||h.includes(Ie.UPC_A)||h.includes(Ie.EAN_8)||h.includes(Ie.UPC_E))&&this.readers.push(new ss(s)),h.includes(Ie.CODE_39)&&this.readers.push(new Yt(v)),h.includes(Ie.CODE_128)&&this.readers.push(new ze),h.includes(Ie.ITF)&&this.readers.push(new Vt),h.includes(Ie.RSS_14)&&this.readers.push(new Wt),h.includes(Ie.RSS_EXPANDED)&&this.readers.push(new Be(this.verbose))):(this.readers.push(new ss(s)),this.readers.push(new Yt),this.readers.push(new ss(s)),this.readers.push(new ze),this.readers.push(new Vt),this.readers.push(new Wt),this.readers.push(new Be(this.verbose)))}decodeRow(s,l,h){for(let v=0;v<this.readers.length;v++)try{return this.readers[v].decodeRow(s,l,h)}catch{}throw new $}reset(){this.readers.forEach(s=>s.reset())}}class Bc extends Te{constructor(s=500,l){super(new ei(l),s,l)}}class Nt{constructor(s,l,h){this.ecCodewords=s,this.ecBlocks=[l],h&&this.ecBlocks.push(h)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Ft{constructor(s,l){this.count=s,this.dataCodewords=l}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class St{constructor(s,l,h,v,m,b){this.versionNumber=s,this.symbolSizeRows=l,this.symbolSizeColumns=h,this.dataRegionSizeRows=v,this.dataRegionSizeColumns=m,this.ecBlocks=b;let E=0;const _=b.getECCodewords(),I=b.getECBlocks();for(let O of I)E+=O.getCount()*(O.getDataCodewords()+_);this.totalCodewords=E}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(s,l){if((s&1)!==0||(l&1)!==0)throw new G;for(let h of St.VERSIONS)if(h.symbolSizeRows===s&&h.symbolSizeColumns===l)return h;throw new G}toString(){return""+this.versionNumber}static buildVersions(){return[new St(1,10,10,8,8,new Nt(5,new Ft(1,3))),new St(2,12,12,10,10,new Nt(7,new Ft(1,5))),new St(3,14,14,12,12,new Nt(10,new Ft(1,8))),new St(4,16,16,14,14,new Nt(12,new Ft(1,12))),new St(5,18,18,16,16,new Nt(14,new Ft(1,18))),new St(6,20,20,18,18,new Nt(18,new Ft(1,22))),new St(7,22,22,20,20,new Nt(20,new Ft(1,30))),new St(8,24,24,22,22,new Nt(24,new Ft(1,36))),new St(9,26,26,24,24,new Nt(28,new Ft(1,44))),new St(10,32,32,14,14,new Nt(36,new Ft(1,62))),new St(11,36,36,16,16,new Nt(42,new Ft(1,86))),new St(12,40,40,18,18,new Nt(48,new Ft(1,114))),new St(13,44,44,20,20,new Nt(56,new Ft(1,144))),new St(14,48,48,22,22,new Nt(68,new Ft(1,174))),new St(15,52,52,24,24,new Nt(42,new Ft(2,102))),new St(16,64,64,14,14,new Nt(56,new Ft(2,140))),new St(17,72,72,16,16,new Nt(36,new Ft(4,92))),new St(18,80,80,18,18,new Nt(48,new Ft(4,114))),new St(19,88,88,20,20,new Nt(56,new Ft(4,144))),new St(20,96,96,22,22,new Nt(68,new Ft(4,174))),new St(21,104,104,24,24,new Nt(56,new Ft(6,136))),new St(22,120,120,18,18,new Nt(68,new Ft(6,175))),new St(23,132,132,20,20,new Nt(62,new Ft(8,163))),new St(24,144,144,22,22,new Nt(62,new Ft(8,156),new Ft(2,155))),new St(25,8,18,6,16,new Nt(7,new Ft(1,5))),new St(26,8,32,6,14,new Nt(11,new Ft(1,10))),new St(27,12,26,10,24,new Nt(14,new Ft(1,16))),new St(28,12,36,10,16,new Nt(18,new Ft(1,22))),new St(29,16,36,14,16,new Nt(24,new Ft(1,32))),new St(30,16,48,14,22,new Nt(28,new Ft(1,49)))]}}St.VERSIONS=St.buildVersions();class ll{constructor(s){const l=s.getHeight();if(l<8||l>144||(l&1)!==0)throw new G;this.version=ll.readVersion(s),this.mappingBitMatrix=this.extractDataRegion(s),this.readMappingMatrix=new xe(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(s){const l=s.getHeight(),h=s.getWidth();return St.getVersionForDimensions(l,h)}readCodewords(){const s=new Int8Array(this.version.getTotalCodewords());let l=0,h=4,v=0;const m=this.mappingBitMatrix.getHeight(),b=this.mappingBitMatrix.getWidth();let E=!1,_=!1,I=!1,O=!1;do if(h===m&&v===0&&!E)s[l++]=this.readCorner1(m,b)&255,h-=2,v+=2,E=!0;else if(h===m-2&&v===0&&(b&3)!==0&&!_)s[l++]=this.readCorner2(m,b)&255,h-=2,v+=2,_=!0;else if(h===m+4&&v===2&&(b&7)===0&&!I)s[l++]=this.readCorner3(m,b)&255,h-=2,v+=2,I=!0;else if(h===m-2&&v===0&&(b&7)===4&&!O)s[l++]=this.readCorner4(m,b)&255,h-=2,v+=2,O=!0;else{do h<m&&v>=0&&!this.readMappingMatrix.get(v,h)&&(s[l++]=this.readUtah(h,v,m,b)&255),h-=2,v+=2;while(h>=0&&v<b);h+=1,v+=3;do h>=0&&v<b&&!this.readMappingMatrix.get(v,h)&&(s[l++]=this.readUtah(h,v,m,b)&255),h+=2,v-=2;while(h<m&&v>=0);h+=3,v+=1}while(h<m||v<b);if(l!==this.version.getTotalCodewords())throw new G;return s}readModule(s,l,h,v){return s<0&&(s+=h,l+=4-(h+4&7)),l<0&&(l+=v,s+=4-(v+4&7)),this.readMappingMatrix.set(l,s),this.mappingBitMatrix.get(l,s)}readUtah(s,l,h,v){let m=0;return this.readModule(s-2,l-2,h,v)&&(m|=1),m<<=1,this.readModule(s-2,l-1,h,v)&&(m|=1),m<<=1,this.readModule(s-1,l-2,h,v)&&(m|=1),m<<=1,this.readModule(s-1,l-1,h,v)&&(m|=1),m<<=1,this.readModule(s-1,l,h,v)&&(m|=1),m<<=1,this.readModule(s,l-2,h,v)&&(m|=1),m<<=1,this.readModule(s,l-1,h,v)&&(m|=1),m<<=1,this.readModule(s,l,h,v)&&(m|=1),m}readCorner1(s,l){let h=0;return this.readModule(s-1,0,s,l)&&(h|=1),h<<=1,this.readModule(s-1,1,s,l)&&(h|=1),h<<=1,this.readModule(s-1,2,s,l)&&(h|=1),h<<=1,this.readModule(0,l-2,s,l)&&(h|=1),h<<=1,this.readModule(0,l-1,s,l)&&(h|=1),h<<=1,this.readModule(1,l-1,s,l)&&(h|=1),h<<=1,this.readModule(2,l-1,s,l)&&(h|=1),h<<=1,this.readModule(3,l-1,s,l)&&(h|=1),h}readCorner2(s,l){let h=0;return this.readModule(s-3,0,s,l)&&(h|=1),h<<=1,this.readModule(s-2,0,s,l)&&(h|=1),h<<=1,this.readModule(s-1,0,s,l)&&(h|=1),h<<=1,this.readModule(0,l-4,s,l)&&(h|=1),h<<=1,this.readModule(0,l-3,s,l)&&(h|=1),h<<=1,this.readModule(0,l-2,s,l)&&(h|=1),h<<=1,this.readModule(0,l-1,s,l)&&(h|=1),h<<=1,this.readModule(1,l-1,s,l)&&(h|=1),h}readCorner3(s,l){let h=0;return this.readModule(s-1,0,s,l)&&(h|=1),h<<=1,this.readModule(s-1,l-1,s,l)&&(h|=1),h<<=1,this.readModule(0,l-3,s,l)&&(h|=1),h<<=1,this.readModule(0,l-2,s,l)&&(h|=1),h<<=1,this.readModule(0,l-1,s,l)&&(h|=1),h<<=1,this.readModule(1,l-3,s,l)&&(h|=1),h<<=1,this.readModule(1,l-2,s,l)&&(h|=1),h<<=1,this.readModule(1,l-1,s,l)&&(h|=1),h}readCorner4(s,l){let h=0;return this.readModule(s-3,0,s,l)&&(h|=1),h<<=1,this.readModule(s-2,0,s,l)&&(h|=1),h<<=1,this.readModule(s-1,0,s,l)&&(h|=1),h<<=1,this.readModule(0,l-2,s,l)&&(h|=1),h<<=1,this.readModule(0,l-1,s,l)&&(h|=1),h<<=1,this.readModule(1,l-1,s,l)&&(h|=1),h<<=1,this.readModule(2,l-1,s,l)&&(h|=1),h<<=1,this.readModule(3,l-1,s,l)&&(h|=1),h}extractDataRegion(s){const l=this.version.getSymbolSizeRows(),h=this.version.getSymbolSizeColumns();if(s.getHeight()!==l)throw new w("Dimension of bitMatrix must match the version size");const v=this.version.getDataRegionSizeRows(),m=this.version.getDataRegionSizeColumns(),b=l/v|0,E=h/m|0,_=b*v,I=E*m,O=new xe(I,_);for(let z=0;z<b;++z){const V=z*v;for(let Q=0;Q<E;++Q){const ae=Q*m;for(let se=0;se<v;++se){const de=z*(v+2)+1+se,be=V+se;for(let Pe=0;Pe<m;++Pe){const Ue=Q*(m+2)+1+Pe;if(s.get(Ue,de)){const Fe=ae+Pe;O.set(Fe,be)}}}}}return O}}class Zs{constructor(s,l){this.numDataCodewords=s,this.codewords=l}static getDataBlocks(s,l){const h=l.getECBlocks();let v=0;const m=h.getECBlocks();for(let se of m)v+=se.getCount();const b=new Array(v);let E=0;for(let se of m)for(let de=0;de<se.getCount();de++){const be=se.getDataCodewords(),Pe=h.getECCodewords()+be;b[E++]=new Zs(be,new Uint8Array(Pe))}const I=b[0].codewords.length-h.getECCodewords(),O=I-1;let z=0;for(let se=0;se<O;se++)for(let de=0;de<E;de++)b[de].codewords[se]=s[z++];const V=l.getVersionNumber()===24,Q=V?8:E;for(let se=0;se<Q;se++)b[se].codewords[I-1]=s[z++];const ae=b[0].codewords.length;for(let se=I;se<ae;se++)for(let de=0;de<E;de++){const be=V?(de+8)%E:de,Pe=V&&be>7?se-1:se;b[be].codewords[Pe]=s[z++]}if(z!==s.length)throw new w;return b}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Ir{constructor(s){this.bytes=s,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(s){if(s<1||s>32||s>this.available())throw new w(""+s);let l=0,h=this.bitOffset,v=this.byteOffset;const m=this.bytes;if(h>0){const b=8-h,E=s<b?s:b,_=b-E,I=255>>8-E<<_;l=(m[v]&I)>>_,s-=E,h+=E,h===8&&(h=0,v++)}if(s>0){for(;s>=8;)l=l<<8|m[v]&255,v++,s-=8;if(s>0){const b=8-s,E=255>>b<<b;l=l<<s|(m[v]&E)>>b,h+=s}}return this.bitOffset=h,this.byteOffset=v,l}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Mn;(function(U){U[U.PAD_ENCODE=0]="PAD_ENCODE",U[U.ASCII_ENCODE=1]="ASCII_ENCODE",U[U.C40_ENCODE=2]="C40_ENCODE",U[U.TEXT_ENCODE=3]="TEXT_ENCODE",U[U.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",U[U.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",U[U.BASE256_ENCODE=6]="BASE256_ENCODE"})(Mn||(Mn={}));class ti{static decode(s){const l=new Ir(s),h=new me,v=new me,m=new Array;let b=Mn.ASCII_ENCODE;do if(b===Mn.ASCII_ENCODE)b=this.decodeAsciiSegment(l,h,v);else{switch(b){case Mn.C40_ENCODE:this.decodeC40Segment(l,h);break;case Mn.TEXT_ENCODE:this.decodeTextSegment(l,h);break;case Mn.ANSIX12_ENCODE:this.decodeAnsiX12Segment(l,h);break;case Mn.EDIFACT_ENCODE:this.decodeEdifactSegment(l,h);break;case Mn.BASE256_ENCODE:this.decodeBase256Segment(l,h,m);break;default:throw new G}b=Mn.ASCII_ENCODE}while(b!==Mn.PAD_ENCODE&&l.available()>0);return v.length()>0&&h.append(v.toString()),new ht(s,h.toString(),m.length===0?null:m,null)}static decodeAsciiSegment(s,l,h){let v=!1;do{let m=s.readBits(8);if(m===0)throw new G;if(m<=128)return v&&(m+=128),l.append(String.fromCharCode(m-1)),Mn.ASCII_ENCODE;if(m===129)return Mn.PAD_ENCODE;if(m<=229){const b=m-130;b<10&&l.append("0"),l.append(""+b)}else switch(m){case 230:return Mn.C40_ENCODE;case 231:return Mn.BASE256_ENCODE;case 232:l.append("");break;case 233:case 234:break;case 235:v=!0;break;case 236:l.append("[)>05"),h.insert(0,"");break;case 237:l.append("[)>06"),h.insert(0,"");break;case 238:return Mn.ANSIX12_ENCODE;case 239:return Mn.TEXT_ENCODE;case 240:return Mn.EDIFACT_ENCODE;case 241:break;default:if(m!==254||s.available()!==0)throw new G;break}}while(s.available()>0);return Mn.ASCII_ENCODE}static decodeC40Segment(s,l){let h=!1;const v=[];let m=0;do{if(s.available()===8)return;const b=s.readBits(8);if(b===254)return;this.parseTwoBytes(b,s.readBits(8),v);for(let E=0;E<3;E++){const _=v[E];switch(m){case 0:if(_<3)m=_+1;else if(_<this.C40_BASIC_SET_CHARS.length){const I=this.C40_BASIC_SET_CHARS[_];h?(l.append(String.fromCharCode(I.charCodeAt(0)+128)),h=!1):l.append(I)}else throw new G;break;case 1:h?(l.append(String.fromCharCode(_+128)),h=!1):l.append(String.fromCharCode(_)),m=0;break;case 2:if(_<this.C40_SHIFT2_SET_CHARS.length){const I=this.C40_SHIFT2_SET_CHARS[_];h?(l.append(String.fromCharCode(I.charCodeAt(0)+128)),h=!1):l.append(I)}else switch(_){case 27:l.append("");break;case 30:h=!0;break;default:throw new G}m=0;break;case 3:h?(l.append(String.fromCharCode(_+224)),h=!1):l.append(String.fromCharCode(_+96)),m=0;break;default:throw new G}}}while(s.available()>0)}static decodeTextSegment(s,l){let h=!1,v=[],m=0;do{if(s.available()===8)return;const b=s.readBits(8);if(b===254)return;this.parseTwoBytes(b,s.readBits(8),v);for(let E=0;E<3;E++){const _=v[E];switch(m){case 0:if(_<3)m=_+1;else if(_<this.TEXT_BASIC_SET_CHARS.length){const I=this.TEXT_BASIC_SET_CHARS[_];h?(l.append(String.fromCharCode(I.charCodeAt(0)+128)),h=!1):l.append(I)}else throw new G;break;case 1:h?(l.append(String.fromCharCode(_+128)),h=!1):l.append(String.fromCharCode(_)),m=0;break;case 2:if(_<this.TEXT_SHIFT2_SET_CHARS.length){const I=this.TEXT_SHIFT2_SET_CHARS[_];h?(l.append(String.fromCharCode(I.charCodeAt(0)+128)),h=!1):l.append(I)}else switch(_){case 27:l.append("");break;case 30:h=!0;break;default:throw new G}m=0;break;case 3:if(_<this.TEXT_SHIFT3_SET_CHARS.length){const I=this.TEXT_SHIFT3_SET_CHARS[_];h?(l.append(String.fromCharCode(I.charCodeAt(0)+128)),h=!1):l.append(I),m=0}else throw new G;break;default:throw new G}}}while(s.available()>0)}static decodeAnsiX12Segment(s,l){const h=[];do{if(s.available()===8)return;const v=s.readBits(8);if(v===254)return;this.parseTwoBytes(v,s.readBits(8),h);for(let m=0;m<3;m++){const b=h[m];switch(b){case 0:l.append("\r");break;case 1:l.append("*");break;case 2:l.append(">");break;case 3:l.append(" ");break;default:if(b<14)l.append(String.fromCharCode(b+44));else if(b<40)l.append(String.fromCharCode(b+51));else throw new G;break}}}while(s.available()>0)}static parseTwoBytes(s,l,h){let v=(s<<8)+l-1,m=Math.floor(v/1600);h[0]=m,v-=m*1600,m=Math.floor(v/40),h[1]=m,h[2]=v-m*40}static decodeEdifactSegment(s,l){do{if(s.available()<=16)return;for(let h=0;h<4;h++){let v=s.readBits(6);if(v===31){const m=8-s.getBitOffset();m!==8&&s.readBits(m);return}(v&32)===0&&(v|=64),l.append(String.fromCharCode(v))}}while(s.available()>0)}static decodeBase256Segment(s,l,h){let v=1+s.getByteOffset();const m=this.unrandomize255State(s.readBits(8),v++);let b;if(m===0?b=s.available()/8|0:m<250?b=m:b=250*(m-249)+this.unrandomize255State(s.readBits(8),v++),b<0)throw new G;const E=new Uint8Array(b);for(let _=0;_<b;_++){if(s.available()<8)throw new G;E[_]=this.unrandomize255State(s.readBits(8),v++)}h.push(E);try{l.append(ie.decode(E,ee.ISO88591))}catch(_){throw new Bt("Platform does not support required encoding: "+_.message)}}static unrandomize255State(s,l){const h=149*l%255+1,v=s-h;return v>=0?v:v+256}}ti.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],ti.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],ti.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],ti.TEXT_SHIFT2_SET_CHARS=ti.C40_SHIFT2_SET_CHARS,ti.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Qs{constructor(){this.rsDecoder=new Xt(Ye.DATA_MATRIX_FIELD_256)}decode(s){const l=new ll(s),h=l.getVersion(),v=l.readCodewords(),m=Zs.getDataBlocks(v,h);let b=0;for(let I of m)b+=I.getNumDataCodewords();const E=new Uint8Array(b),_=m.length;for(let I=0;I<_;I++){const O=m[I],z=O.getCodewords(),V=O.getNumDataCodewords();this.correctErrors(z,V);for(let Q=0;Q<V;Q++)E[Q*_+I]=z[Q]}return ti.decode(E)}correctErrors(s,l){const h=new Int32Array(s);try{this.rsDecoder.decode(h,s.length-l)}catch{throw new S}for(let v=0;v<l;v++)s[v]=h[v]}}class bn{constructor(s){this.image=s,this.rectangleDetector=new fr(this.image)}detect(){const s=this.rectangleDetector.detect();let l=this.detectSolid1(s);if(l=this.detectSolid2(l),l[3]=this.correctTopRight(l),!l[3])throw new $;l=this.shiftToModuleCenter(l);const h=l[0],v=l[1],m=l[2],b=l[3];let E=this.transitionsBetween(h,b)+1,_=this.transitionsBetween(m,b)+1;(E&1)===1&&(E+=1),(_&1)===1&&(_+=1),4*E<7*_&&4*_<7*E&&(E=_=Math.max(E,_));let I=bn.sampleGrid(this.image,h,v,m,b,E,_);return new Hr(I,[h,v,m,b])}static shiftPoint(s,l,h){let v=(l.getX()-s.getX())/(h+1),m=(l.getY()-s.getY())/(h+1);return new We(s.getX()+v,s.getY()+m)}static moveAway(s,l,h){let v=s.getX(),m=s.getY();return v<l?v-=1:v+=1,m<h?m-=1:m+=1,new We(v,m)}detectSolid1(s){let l=s[0],h=s[1],v=s[3],m=s[2],b=this.transitionsBetween(l,h),E=this.transitionsBetween(h,v),_=this.transitionsBetween(v,m),I=this.transitionsBetween(m,l),O=b,z=[m,l,h,v];return O>E&&(O=E,z[0]=l,z[1]=h,z[2]=v,z[3]=m),O>_&&(O=_,z[0]=h,z[1]=v,z[2]=m,z[3]=l),O>I&&(z[0]=v,z[1]=m,z[2]=l,z[3]=h),z}detectSolid2(s){let l=s[0],h=s[1],v=s[2],m=s[3],b=this.transitionsBetween(l,m),E=bn.shiftPoint(h,v,(b+1)*4),_=bn.shiftPoint(v,h,(b+1)*4),I=this.transitionsBetween(E,l),O=this.transitionsBetween(_,m);return I<O?(s[0]=l,s[1]=h,s[2]=v,s[3]=m):(s[0]=h,s[1]=v,s[2]=m,s[3]=l),s}correctTopRight(s){let l=s[0],h=s[1],v=s[2],m=s[3],b=this.transitionsBetween(l,m),E=this.transitionsBetween(h,m),_=bn.shiftPoint(l,h,(E+1)*4),I=bn.shiftPoint(v,h,(b+1)*4);b=this.transitionsBetween(_,m),E=this.transitionsBetween(I,m);let O=new We(m.getX()+(v.getX()-h.getX())/(b+1),m.getY()+(v.getY()-h.getY())/(b+1)),z=new We(m.getX()+(l.getX()-h.getX())/(E+1),m.getY()+(l.getY()-h.getY())/(E+1));if(!this.isValid(O))return this.isValid(z)?z:null;if(!this.isValid(z))return O;let V=this.transitionsBetween(_,O)+this.transitionsBetween(I,O),Q=this.transitionsBetween(_,z)+this.transitionsBetween(I,z);return V>Q?O:z}shiftToModuleCenter(s){let l=s[0],h=s[1],v=s[2],m=s[3],b=this.transitionsBetween(l,m)+1,E=this.transitionsBetween(v,m)+1,_=bn.shiftPoint(l,h,E*4),I=bn.shiftPoint(v,h,b*4);b=this.transitionsBetween(_,m)+1,E=this.transitionsBetween(I,m)+1,(b&1)===1&&(b+=1),(E&1)===1&&(E+=1);let O=(l.getX()+h.getX()+v.getX()+m.getX())/4,z=(l.getY()+h.getY()+v.getY()+m.getY())/4;l=bn.moveAway(l,O,z),h=bn.moveAway(h,O,z),v=bn.moveAway(v,O,z),m=bn.moveAway(m,O,z);let V,Q;return _=bn.shiftPoint(l,h,E*4),_=bn.shiftPoint(_,m,b*4),V=bn.shiftPoint(h,l,E*4),V=bn.shiftPoint(V,v,b*4),I=bn.shiftPoint(v,m,E*4),I=bn.shiftPoint(I,h,b*4),Q=bn.shiftPoint(m,v,E*4),Q=bn.shiftPoint(Q,l,b*4),[_,V,I,Q]}isValid(s){return s.getX()>=0&&s.getX()<this.image.getWidth()&&s.getY()>0&&s.getY()<this.image.getHeight()}static sampleGrid(s,l,h,v,m,b,E){return sn.getInstance().sampleGrid(s,b,E,.5,.5,b-.5,.5,b-.5,E-.5,.5,E-.5,l.getX(),l.getY(),m.getX(),m.getY(),v.getX(),v.getY(),h.getX(),h.getY())}transitionsBetween(s,l){let h=Math.trunc(s.getX()),v=Math.trunc(s.getY()),m=Math.trunc(l.getX()),b=Math.trunc(l.getY()),E=Math.abs(b-v)>Math.abs(m-h);if(E){let se=h;h=v,v=se,se=m,m=b,b=se}let _=Math.abs(m-h),I=Math.abs(b-v),O=-_/2,z=v<b?1:-1,V=h<m?1:-1,Q=0,ae=this.image.get(E?v:h,E?h:v);for(let se=h,de=v;se!==m;se+=V){let be=this.image.get(E?de:se,E?se:de);if(be!==ae&&(Q++,ae=be),O+=I,O>0){if(de===b)break;de+=z,O-=_}}return Q}}class ua{constructor(){this.decoder=new Qs}decode(s,l=null){let h,v;if(l!=null&&l.has(W.PURE_BARCODE)){const I=ua.extractPureBits(s.getBlackMatrix());h=this.decoder.decode(I),v=ua.NO_POINTS}else{const I=new bn(s.getBlackMatrix()).detect();h=this.decoder.decode(I.getBits()),v=I.getPoints()}const m=h.getRawBytes(),b=new Le(h.getText(),m,8*m.length,v,Ie.DATA_MATRIX,N.currentTimeMillis()),E=h.getByteSegments();E!=null&&b.putMetadata(He.BYTE_SEGMENTS,E);const _=h.getECLevel();return _!=null&&b.putMetadata(He.ERROR_CORRECTION_LEVEL,_),b}reset(){}static extractPureBits(s){const l=s.getTopLeftOnBit(),h=s.getBottomRightOnBit();if(l==null||h==null)throw new $;const v=this.moduleSize(l,s);let m=l[1];const b=h[1];let E=l[0];const I=(h[0]-E+1)/v,O=(b-m+1)/v;if(I<=0||O<=0)throw new $;const z=v/2;m+=z,E+=z;const V=new xe(I,O);for(let Q=0;Q<O;Q++){const ae=m+Q*v;for(let se=0;se<I;se++)s.get(E+se*v,ae)&&V.set(se,Q)}return V}static moduleSize(s,l){const h=l.getWidth();let v=s[0];const m=s[1];for(;v<h&&l.get(v,m);)v++;if(v===h)throw new $;const b=v-s[0];if(b===0)throw new $;return b}}ua.NO_POINTS=[];class Qh extends Te{constructor(s=500){super(new ua,s)}}var Jn;(function(U){U[U.L=0]="L",U[U.M=1]="M",U[U.Q=2]="Q",U[U.H=3]="H"})(Jn||(Jn={}));class Zt{constructor(s,l,h){this.value=s,this.stringValue=l,this.bits=h,Zt.FOR_BITS.set(h,this),Zt.FOR_VALUE.set(s,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(s){switch(s){case"L":return Zt.L;case"M":return Zt.M;case"Q":return Zt.Q;case"H":return Zt.H;default:throw new x(s+"not available")}}toString(){return this.stringValue}equals(s){if(!(s instanceof Zt))return!1;const l=s;return this.value===l.value}static forBits(s){if(s<0||s>=Zt.FOR_BITS.size)throw new w;return Zt.FOR_BITS.get(s)}}Zt.FOR_BITS=new Map,Zt.FOR_VALUE=new Map,Zt.L=new Zt(Jn.L,"L",1),Zt.M=new Zt(Jn.M,"M",0),Zt.Q=new Zt(Jn.Q,"Q",3),Zt.H=new Zt(Jn.H,"H",2);class $n{constructor(s){this.errorCorrectionLevel=Zt.forBits(s>>3&3),this.dataMask=s&7}static numBitsDiffering(s,l){return k.bitCount(s^l)}static decodeFormatInformation(s,l){const h=$n.doDecodeFormatInformation(s,l);return h!==null?h:$n.doDecodeFormatInformation(s^$n.FORMAT_INFO_MASK_QR,l^$n.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(s,l){let h=Number.MAX_SAFE_INTEGER,v=0;for(const m of $n.FORMAT_INFO_DECODE_LOOKUP){const b=m[0];if(b===s||b===l)return new $n(m[1]);let E=$n.numBitsDiffering(s,b);E<h&&(v=m[1],h=E),s!==l&&(E=$n.numBitsDiffering(l,b),E<h&&(v=m[1],h=E))}return h<=3?new $n(v):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(s){if(!(s instanceof $n))return!1;const l=s;return this.errorCorrectionLevel===l.errorCorrectionLevel&&this.dataMask===l.dataMask}}$n.FORMAT_INFO_MASK_QR=21522,$n.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class pe{constructor(s,...l){this.ecCodewordsPerBlock=s,this.ecBlocks=l}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let s=0;const l=this.ecBlocks;for(const h of l)s+=h.getCount();return s}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class K{constructor(s,l){this.count=s,this.dataCodewords=l}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class nt{constructor(s,l,...h){this.versionNumber=s,this.alignmentPatternCenters=l,this.ecBlocks=h;let v=0;const m=h[0].getECCodewordsPerBlock(),b=h[0].getECBlocks();for(const E of b)v+=E.getCount()*(E.getDataCodewords()+m);this.totalCodewords=v}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(s){return this.ecBlocks[s.getValue()]}static getProvisionalVersionForDimension(s){if(s%4!==1)throw new G;try{return this.getVersionForNumber((s-17)/4)}catch{throw new G}}static getVersionForNumber(s){if(s<1||s>40)throw new w;return nt.VERSIONS[s-1]}static decodeVersionInformation(s){let l=Number.MAX_SAFE_INTEGER,h=0;for(let v=0;v<nt.VERSION_DECODE_INFO.length;v++){const m=nt.VERSION_DECODE_INFO[v];if(m===s)return nt.getVersionForNumber(v+7);const b=$n.numBitsDiffering(s,m);b<l&&(h=v+7,l=b)}return l<=3?nt.getVersionForNumber(h):null}buildFunctionPattern(){const s=this.getDimensionForVersion(),l=new xe(s);l.setRegion(0,0,9,9),l.setRegion(s-8,0,8,9),l.setRegion(0,s-8,9,8);const h=this.alignmentPatternCenters.length;for(let v=0;v<h;v++){const m=this.alignmentPatternCenters[v]-2;for(let b=0;b<h;b++)v===0&&(b===0||b===h-1)||v===h-1&&b===0||l.setRegion(this.alignmentPatternCenters[b]-2,m,5,5)}return l.setRegion(6,9,1,s-17),l.setRegion(9,6,s-17,1),this.versionNumber>6&&(l.setRegion(s-11,0,3,6),l.setRegion(0,s-11,6,3)),l}toString(){return""+this.versionNumber}}nt.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),nt.VERSIONS=[new nt(1,new Int32Array(0),new pe(7,new K(1,19)),new pe(10,new K(1,16)),new pe(13,new K(1,13)),new pe(17,new K(1,9))),new nt(2,Int32Array.from([6,18]),new pe(10,new K(1,34)),new pe(16,new K(1,28)),new pe(22,new K(1,22)),new pe(28,new K(1,16))),new nt(3,Int32Array.from([6,22]),new pe(15,new K(1,55)),new pe(26,new K(1,44)),new pe(18,new K(2,17)),new pe(22,new K(2,13))),new nt(4,Int32Array.from([6,26]),new pe(20,new K(1,80)),new pe(18,new K(2,32)),new pe(26,new K(2,24)),new pe(16,new K(4,9))),new nt(5,Int32Array.from([6,30]),new pe(26,new K(1,108)),new pe(24,new K(2,43)),new pe(18,new K(2,15),new K(2,16)),new pe(22,new K(2,11),new K(2,12))),new nt(6,Int32Array.from([6,34]),new pe(18,new K(2,68)),new pe(16,new K(4,27)),new pe(24,new K(4,19)),new pe(28,new K(4,15))),new nt(7,Int32Array.from([6,22,38]),new pe(20,new K(2,78)),new pe(18,new K(4,31)),new pe(18,new K(2,14),new K(4,15)),new pe(26,new K(4,13),new K(1,14))),new nt(8,Int32Array.from([6,24,42]),new pe(24,new K(2,97)),new pe(22,new K(2,38),new K(2,39)),new pe(22,new K(4,18),new K(2,19)),new pe(26,new K(4,14),new K(2,15))),new nt(9,Int32Array.from([6,26,46]),new pe(30,new K(2,116)),new pe(22,new K(3,36),new K(2,37)),new pe(20,new K(4,16),new K(4,17)),new pe(24,new K(4,12),new K(4,13))),new nt(10,Int32Array.from([6,28,50]),new pe(18,new K(2,68),new K(2,69)),new pe(26,new K(4,43),new K(1,44)),new pe(24,new K(6,19),new K(2,20)),new pe(28,new K(6,15),new K(2,16))),new nt(11,Int32Array.from([6,30,54]),new pe(20,new K(4,81)),new pe(30,new K(1,50),new K(4,51)),new pe(28,new K(4,22),new K(4,23)),new pe(24,new K(3,12),new K(8,13))),new nt(12,Int32Array.from([6,32,58]),new pe(24,new K(2,92),new K(2,93)),new pe(22,new K(6,36),new K(2,37)),new pe(26,new K(4,20),new K(6,21)),new pe(28,new K(7,14),new K(4,15))),new nt(13,Int32Array.from([6,34,62]),new pe(26,new K(4,107)),new pe(22,new K(8,37),new K(1,38)),new pe(24,new K(8,20),new K(4,21)),new pe(22,new K(12,11),new K(4,12))),new nt(14,Int32Array.from([6,26,46,66]),new pe(30,new K(3,115),new K(1,116)),new pe(24,new K(4,40),new K(5,41)),new pe(20,new K(11,16),new K(5,17)),new pe(24,new K(11,12),new K(5,13))),new nt(15,Int32Array.from([6,26,48,70]),new pe(22,new K(5,87),new K(1,88)),new pe(24,new K(5,41),new K(5,42)),new pe(30,new K(5,24),new K(7,25)),new pe(24,new K(11,12),new K(7,13))),new nt(16,Int32Array.from([6,26,50,74]),new pe(24,new K(5,98),new K(1,99)),new pe(28,new K(7,45),new K(3,46)),new pe(24,new K(15,19),new K(2,20)),new pe(30,new K(3,15),new K(13,16))),new nt(17,Int32Array.from([6,30,54,78]),new pe(28,new K(1,107),new K(5,108)),new pe(28,new K(10,46),new K(1,47)),new pe(28,new K(1,22),new K(15,23)),new pe(28,new K(2,14),new K(17,15))),new nt(18,Int32Array.from([6,30,56,82]),new pe(30,new K(5,120),new K(1,121)),new pe(26,new K(9,43),new K(4,44)),new pe(28,new K(17,22),new K(1,23)),new pe(28,new K(2,14),new K(19,15))),new nt(19,Int32Array.from([6,30,58,86]),new pe(28,new K(3,113),new K(4,114)),new pe(26,new K(3,44),new K(11,45)),new pe(26,new K(17,21),new K(4,22)),new pe(26,new K(9,13),new K(16,14))),new nt(20,Int32Array.from([6,34,62,90]),new pe(28,new K(3,107),new K(5,108)),new pe(26,new K(3,41),new K(13,42)),new pe(30,new K(15,24),new K(5,25)),new pe(28,new K(15,15),new K(10,16))),new nt(21,Int32Array.from([6,28,50,72,94]),new pe(28,new K(4,116),new K(4,117)),new pe(26,new K(17,42)),new pe(28,new K(17,22),new K(6,23)),new pe(30,new K(19,16),new K(6,17))),new nt(22,Int32Array.from([6,26,50,74,98]),new pe(28,new K(2,111),new K(7,112)),new pe(28,new K(17,46)),new pe(30,new K(7,24),new K(16,25)),new pe(24,new K(34,13))),new nt(23,Int32Array.from([6,30,54,78,102]),new pe(30,new K(4,121),new K(5,122)),new pe(28,new K(4,47),new K(14,48)),new pe(30,new K(11,24),new K(14,25)),new pe(30,new K(16,15),new K(14,16))),new nt(24,Int32Array.from([6,28,54,80,106]),new pe(30,new K(6,117),new K(4,118)),new pe(28,new K(6,45),new K(14,46)),new pe(30,new K(11,24),new K(16,25)),new pe(30,new K(30,16),new K(2,17))),new nt(25,Int32Array.from([6,32,58,84,110]),new pe(26,new K(8,106),new K(4,107)),new pe(28,new K(8,47),new K(13,48)),new pe(30,new K(7,24),new K(22,25)),new pe(30,new K(22,15),new K(13,16))),new nt(26,Int32Array.from([6,30,58,86,114]),new pe(28,new K(10,114),new K(2,115)),new pe(28,new K(19,46),new K(4,47)),new pe(28,new K(28,22),new K(6,23)),new pe(30,new K(33,16),new K(4,17))),new nt(27,Int32Array.from([6,34,62,90,118]),new pe(30,new K(8,122),new K(4,123)),new pe(28,new K(22,45),new K(3,46)),new pe(30,new K(8,23),new K(26,24)),new pe(30,new K(12,15),new K(28,16))),new nt(28,Int32Array.from([6,26,50,74,98,122]),new pe(30,new K(3,117),new K(10,118)),new pe(28,new K(3,45),new K(23,46)),new pe(30,new K(4,24),new K(31,25)),new pe(30,new K(11,15),new K(31,16))),new nt(29,Int32Array.from([6,30,54,78,102,126]),new pe(30,new K(7,116),new K(7,117)),new pe(28,new K(21,45),new K(7,46)),new pe(30,new K(1,23),new K(37,24)),new pe(30,new K(19,15),new K(26,16))),new nt(30,Int32Array.from([6,26,52,78,104,130]),new pe(30,new K(5,115),new K(10,116)),new pe(28,new K(19,47),new K(10,48)),new pe(30,new K(15,24),new K(25,25)),new pe(30,new K(23,15),new K(25,16))),new nt(31,Int32Array.from([6,30,56,82,108,134]),new pe(30,new K(13,115),new K(3,116)),new pe(28,new K(2,46),new K(29,47)),new pe(30,new K(42,24),new K(1,25)),new pe(30,new K(23,15),new K(28,16))),new nt(32,Int32Array.from([6,34,60,86,112,138]),new pe(30,new K(17,115)),new pe(28,new K(10,46),new K(23,47)),new pe(30,new K(10,24),new K(35,25)),new pe(30,new K(19,15),new K(35,16))),new nt(33,Int32Array.from([6,30,58,86,114,142]),new pe(30,new K(17,115),new K(1,116)),new pe(28,new K(14,46),new K(21,47)),new pe(30,new K(29,24),new K(19,25)),new pe(30,new K(11,15),new K(46,16))),new nt(34,Int32Array.from([6,34,62,90,118,146]),new pe(30,new K(13,115),new K(6,116)),new pe(28,new K(14,46),new K(23,47)),new pe(30,new K(44,24),new K(7,25)),new pe(30,new K(59,16),new K(1,17))),new nt(35,Int32Array.from([6,30,54,78,102,126,150]),new pe(30,new K(12,121),new K(7,122)),new pe(28,new K(12,47),new K(26,48)),new pe(30,new K(39,24),new K(14,25)),new pe(30,new K(22,15),new K(41,16))),new nt(36,Int32Array.from([6,24,50,76,102,128,154]),new pe(30,new K(6,121),new K(14,122)),new pe(28,new K(6,47),new K(34,48)),new pe(30,new K(46,24),new K(10,25)),new pe(30,new K(2,15),new K(64,16))),new nt(37,Int32Array.from([6,28,54,80,106,132,158]),new pe(30,new K(17,122),new K(4,123)),new pe(28,new K(29,46),new K(14,47)),new pe(30,new K(49,24),new K(10,25)),new pe(30,new K(24,15),new K(46,16))),new nt(38,Int32Array.from([6,32,58,84,110,136,162]),new pe(30,new K(4,122),new K(18,123)),new pe(28,new K(13,46),new K(32,47)),new pe(30,new K(48,24),new K(14,25)),new pe(30,new K(42,15),new K(32,16))),new nt(39,Int32Array.from([6,26,54,82,110,138,166]),new pe(30,new K(20,117),new K(4,118)),new pe(28,new K(40,47),new K(7,48)),new pe(30,new K(43,24),new K(22,25)),new pe(30,new K(10,15),new K(67,16))),new nt(40,Int32Array.from([6,30,58,86,114,142,170]),new pe(30,new K(19,118),new K(6,119)),new pe(28,new K(18,47),new K(31,48)),new pe(30,new K(34,24),new K(34,25)),new pe(30,new K(20,15),new K(61,16)))];var zn;(function(U){U[U.DATA_MASK_000=0]="DATA_MASK_000",U[U.DATA_MASK_001=1]="DATA_MASK_001",U[U.DATA_MASK_010=2]="DATA_MASK_010",U[U.DATA_MASK_011=3]="DATA_MASK_011",U[U.DATA_MASK_100=4]="DATA_MASK_100",U[U.DATA_MASK_101=5]="DATA_MASK_101",U[U.DATA_MASK_110=6]="DATA_MASK_110",U[U.DATA_MASK_111=7]="DATA_MASK_111"})(zn||(zn={}));class er{constructor(s,l){this.value=s,this.isMasked=l}unmaskBitMatrix(s,l){for(let h=0;h<l;h++)for(let v=0;v<l;v++)this.isMasked(h,v)&&s.flip(v,h)}}er.values=new Map([[zn.DATA_MASK_000,new er(zn.DATA_MASK_000,(U,s)=>(U+s&1)===0)],[zn.DATA_MASK_001,new er(zn.DATA_MASK_001,(U,s)=>(U&1)===0)],[zn.DATA_MASK_010,new er(zn.DATA_MASK_010,(U,s)=>s%3===0)],[zn.DATA_MASK_011,new er(zn.DATA_MASK_011,(U,s)=>(U+s)%3===0)],[zn.DATA_MASK_100,new er(zn.DATA_MASK_100,(U,s)=>(Math.floor(U/2)+Math.floor(s/3)&1)===0)],[zn.DATA_MASK_101,new er(zn.DATA_MASK_101,(U,s)=>U*s%6===0)],[zn.DATA_MASK_110,new er(zn.DATA_MASK_110,(U,s)=>U*s%6<3)],[zn.DATA_MASK_111,new er(zn.DATA_MASK_111,(U,s)=>(U+s+U*s%3&1)===0)]]);class Jh{constructor(s){const l=s.getHeight();if(l<21||(l&3)!==1)throw new G;this.bitMatrix=s}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let s=0;for(let m=0;m<6;m++)s=this.copyBit(m,8,s);s=this.copyBit(7,8,s),s=this.copyBit(8,8,s),s=this.copyBit(8,7,s);for(let m=5;m>=0;m--)s=this.copyBit(8,m,s);const l=this.bitMatrix.getHeight();let h=0;const v=l-7;for(let m=l-1;m>=v;m--)h=this.copyBit(8,m,h);for(let m=l-8;m<l;m++)h=this.copyBit(m,8,h);if(this.parsedFormatInfo=$n.decodeFormatInformation(s,h),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new G}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const s=this.bitMatrix.getHeight(),l=Math.floor((s-17)/4);if(l<=6)return nt.getVersionForNumber(l);let h=0;const v=s-11;for(let b=5;b>=0;b--)for(let E=s-9;E>=v;E--)h=this.copyBit(E,b,h);let m=nt.decodeVersionInformation(h);if(m!==null&&m.getDimensionForVersion()===s)return this.parsedVersion=m,m;h=0;for(let b=5;b>=0;b--)for(let E=s-9;E>=v;E--)h=this.copyBit(b,E,h);if(m=nt.decodeVersionInformation(h),m!==null&&m.getDimensionForVersion()===s)return this.parsedVersion=m,m;throw new G}copyBit(s,l,h){return(this.isMirror?this.bitMatrix.get(l,s):this.bitMatrix.get(s,l))?h<<1|1:h<<1}readCodewords(){const s=this.readFormatInformation(),l=this.readVersion(),h=er.values.get(s.getDataMask()),v=this.bitMatrix.getHeight();h.unmaskBitMatrix(this.bitMatrix,v);const m=l.buildFunctionPattern();let b=!0;const E=new Uint8Array(l.getTotalCodewords());let _=0,I=0,O=0;for(let z=v-1;z>0;z-=2){z===6&&z--;for(let V=0;V<v;V++){const Q=b?v-1-V:V;for(let ae=0;ae<2;ae++)m.get(z-ae,Q)||(O++,I<<=1,this.bitMatrix.get(z-ae,Q)&&(I|=1),O===8&&(E[_++]=I,O=0,I=0))}b=!b}if(_!==l.getTotalCodewords())throw new G;return E}remask(){if(this.parsedFormatInfo===null)return;const s=er.values[this.parsedFormatInfo.getDataMask()],l=this.bitMatrix.getHeight();s.unmaskBitMatrix(this.bitMatrix,l)}setMirror(s){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=s}mirror(){const s=this.bitMatrix;for(let l=0,h=s.getWidth();l<h;l++)for(let v=l+1,m=s.getHeight();v<m;v++)s.get(l,v)!==s.get(v,l)&&(s.flip(v,l),s.flip(l,v))}}class Js{constructor(s,l){this.numDataCodewords=s,this.codewords=l}static getDataBlocks(s,l,h){if(s.length!==l.getTotalCodewords())throw new w;const v=l.getECBlocksForLevel(h);let m=0;const b=v.getECBlocks();for(const ae of b)m+=ae.getCount();const E=new Array(m);let _=0;for(const ae of b)for(let se=0;se<ae.getCount();se++){const de=ae.getDataCodewords(),be=v.getECCodewordsPerBlock()+de;E[_++]=new Js(de,new Uint8Array(be))}const I=E[0].codewords.length;let O=E.length-1;for(;O>=0&&E[O].codewords.length!==I;)O--;O++;const z=I-v.getECCodewordsPerBlock();let V=0;for(let ae=0;ae<z;ae++)for(let se=0;se<_;se++)E[se].codewords[ae]=s[V++];for(let ae=O;ae<_;ae++)E[ae].codewords[z]=s[V++];const Q=E[0].codewords.length;for(let ae=z;ae<Q;ae++)for(let se=0;se<_;se++){const de=se<O?ae:ae+1;E[se].codewords[de]=s[V++]}return E}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Gr;(function(U){U[U.TERMINATOR=0]="TERMINATOR",U[U.NUMERIC=1]="NUMERIC",U[U.ALPHANUMERIC=2]="ALPHANUMERIC",U[U.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",U[U.BYTE=4]="BYTE",U[U.ECI=5]="ECI",U[U.KANJI=6]="KANJI",U[U.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",U[U.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",U[U.HANZI=9]="HANZI"})(Gr||(Gr={}));class rt{constructor(s,l,h,v){this.value=s,this.stringValue=l,this.characterCountBitsForVersions=h,this.bits=v,rt.FOR_BITS.set(v,this),rt.FOR_VALUE.set(s,this)}static forBits(s){const l=rt.FOR_BITS.get(s);if(l===void 0)throw new w;return l}getCharacterCountBits(s){const l=s.getVersionNumber();let h;return l<=9?h=0:l<=26?h=1:h=2,this.characterCountBitsForVersions[h]}getValue(){return this.value}getBits(){return this.bits}equals(s){if(!(s instanceof rt))return!1;const l=s;return this.value===l.value}toString(){return this.stringValue}}rt.FOR_BITS=new Map,rt.FOR_VALUE=new Map,rt.TERMINATOR=new rt(Gr.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),rt.NUMERIC=new rt(Gr.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),rt.ALPHANUMERIC=new rt(Gr.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),rt.STRUCTURED_APPEND=new rt(Gr.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),rt.BYTE=new rt(Gr.BYTE,"BYTE",Int32Array.from([8,16,16]),4),rt.ECI=new rt(Gr.ECI,"ECI",Int32Array.from([0,0,0]),7),rt.KANJI=new rt(Gr.KANJI,"KANJI",Int32Array.from([8,10,12]),8),rt.FNC1_FIRST_POSITION=new rt(Gr.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),rt.FNC1_SECOND_POSITION=new rt(Gr.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),rt.HANZI=new rt(Gr.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class mn{static decode(s,l,h,v){const m=new Ir(s);let b=new me;const E=new Array;let _=-1,I=-1;try{let O=null,z=!1,V;do{if(m.available()<4)V=rt.TERMINATOR;else{const Q=m.readBits(4);V=rt.forBits(Q)}switch(V){case rt.TERMINATOR:break;case rt.FNC1_FIRST_POSITION:case rt.FNC1_SECOND_POSITION:z=!0;break;case rt.STRUCTURED_APPEND:if(m.available()<16)throw new G;_=m.readBits(8),I=m.readBits(8);break;case rt.ECI:const Q=mn.parseECIValue(m);if(O=H.getCharacterSetECIByValue(Q),O===null)throw new G;break;case rt.HANZI:const ae=m.readBits(4),se=m.readBits(V.getCharacterCountBits(l));ae===mn.GB2312_SUBSET&&mn.decodeHanziSegment(m,b,se);break;default:const de=m.readBits(V.getCharacterCountBits(l));switch(V){case rt.NUMERIC:mn.decodeNumericSegment(m,b,de);break;case rt.ALPHANUMERIC:mn.decodeAlphanumericSegment(m,b,de,z);break;case rt.BYTE:mn.decodeByteSegment(m,b,de,O,E,v);break;case rt.KANJI:mn.decodeKanjiSegment(m,b,de);break;default:throw new G}break}}while(V!==rt.TERMINATOR)}catch{throw new G}return new ht(s,b.toString(),E.length===0?null:E,h===null?null:h.toString(),_,I)}static decodeHanziSegment(s,l,h){if(h*13>s.available())throw new G;const v=new Uint8Array(2*h);let m=0;for(;h>0;){const b=s.readBits(13);let E=b/96<<8&4294967295|b%96;E<959?E+=41377:E+=42657,v[m]=E>>8&255,v[m+1]=E&255,m+=2,h--}try{l.append(ie.decode(v,ee.GB2312))}catch(b){throw new G(b)}}static decodeKanjiSegment(s,l,h){if(h*13>s.available())throw new G;const v=new Uint8Array(2*h);let m=0;for(;h>0;){const b=s.readBits(13);let E=b/192<<8&4294967295|b%192;E<7936?E+=33088:E+=49472,v[m]=E>>8,v[m+1]=E,m+=2,h--}try{l.append(ie.decode(v,ee.SHIFT_JIS))}catch(b){throw new G(b)}}static decodeByteSegment(s,l,h,v,m,b){if(8*h>s.available())throw new G;const E=new Uint8Array(h);for(let I=0;I<h;I++)E[I]=s.readBits(8);let _;v===null?_=ee.guessEncoding(E,b):_=v.getName();try{l.append(ie.decode(E,_))}catch(I){throw new G(I)}m.push(E)}static toAlphaNumericChar(s){if(s>=mn.ALPHANUMERIC_CHARS.length)throw new G;return mn.ALPHANUMERIC_CHARS[s]}static decodeAlphanumericSegment(s,l,h,v){const m=l.length();for(;h>1;){if(s.available()<11)throw new G;const b=s.readBits(11);l.append(mn.toAlphaNumericChar(Math.floor(b/45))),l.append(mn.toAlphaNumericChar(b%45)),h-=2}if(h===1){if(s.available()<6)throw new G;l.append(mn.toAlphaNumericChar(s.readBits(6)))}if(v)for(let b=m;b<l.length();b++)l.charAt(b)==="%"&&(b<l.length()-1&&l.charAt(b+1)==="%"?l.deleteCharAt(b+1):l.setCharAt(b,""))}static decodeNumericSegment(s,l,h){for(;h>=3;){if(s.available()<10)throw new G;const v=s.readBits(10);if(v>=1e3)throw new G;l.append(mn.toAlphaNumericChar(Math.floor(v/100))),l.append(mn.toAlphaNumericChar(Math.floor(v/10)%10)),l.append(mn.toAlphaNumericChar(v%10)),h-=3}if(h===2){if(s.available()<7)throw new G;const v=s.readBits(7);if(v>=100)throw new G;l.append(mn.toAlphaNumericChar(Math.floor(v/10))),l.append(mn.toAlphaNumericChar(v%10))}else if(h===1){if(s.available()<4)throw new G;const v=s.readBits(4);if(v>=10)throw new G;l.append(mn.toAlphaNumericChar(v))}}static parseECIValue(s){const l=s.readBits(8);if((l&128)===0)return l&127;if((l&192)===128){const h=s.readBits(8);return(l&63)<<8&4294967295|h}if((l&224)===192){const h=s.readBits(16);return(l&31)<<16&4294967295|h}throw new G}}mn.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",mn.GB2312_SUBSET=1;class kc{constructor(s){this.mirrored=s}isMirrored(){return this.mirrored}applyMirroredCorrection(s){if(!this.mirrored||s===null||s.length<3)return;const l=s[0];s[0]=s[2],s[2]=l}}class $s{constructor(){this.rsDecoder=new Xt(Ye.QR_CODE_FIELD_256)}decodeBooleanArray(s,l){return this.decodeBitMatrix(xe.parseFromBooleanArray(s),l)}decodeBitMatrix(s,l){const h=new Jh(s);let v=null;try{return this.decodeBitMatrixParser(h,l)}catch(m){v=m}try{h.remask(),h.setMirror(!0),h.readVersion(),h.readFormatInformation(),h.mirror();const m=this.decodeBitMatrixParser(h,l);return m.setOther(new kc(!0)),m}catch(m){throw v!==null?v:m}}decodeBitMatrixParser(s,l){const h=s.readVersion(),v=s.readFormatInformation().getErrorCorrectionLevel(),m=s.readCodewords(),b=Js.getDataBlocks(m,h,v);let E=0;for(const O of b)E+=O.getNumDataCodewords();const _=new Uint8Array(E);let I=0;for(const O of b){const z=O.getCodewords(),V=O.getNumDataCodewords();this.correctErrors(z,V);for(let Q=0;Q<V;Q++)_[I++]=z[Q]}return mn.decode(_,h,v,l)}correctErrors(s,l){const h=new Int32Array(s);try{this.rsDecoder.decode(h,s.length-l)}catch{throw new S}for(let v=0;v<l;v++)s[v]=h[v]}}class ls extends We{constructor(s,l,h){super(s,l),this.estimatedModuleSize=h}aboutEquals(s,l,h){if(Math.abs(l-this.getY())<=s&&Math.abs(h-this.getX())<=s){const v=Math.abs(s-this.estimatedModuleSize);return v<=1||v<=this.estimatedModuleSize}return!1}combineEstimate(s,l,h){const v=(this.getX()+l)/2,m=(this.getY()+s)/2,b=(this.estimatedModuleSize+h)/2;return new ls(v,m,b)}}class po{constructor(s,l,h,v,m,b,E){this.image=s,this.startX=l,this.startY=h,this.width=v,this.height=m,this.moduleSize=b,this.resultPointCallback=E,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const s=this.startX,l=this.height,h=this.width,v=s+h,m=this.startY+l/2,b=new Int32Array(3),E=this.image;for(let _=0;_<l;_++){const I=m+((_&1)===0?Math.floor((_+1)/2):-Math.floor((_+1)/2));b[0]=0,b[1]=0,b[2]=0;let O=s;for(;O<v&&!E.get(O,I);)O++;let z=0;for(;O<v;){if(E.get(O,I))if(z===1)b[1]++;else if(z===2){if(this.foundPatternCross(b)){const V=this.handlePossibleCenter(b,I,O);if(V!==null)return V}b[0]=b[2],b[1]=1,b[2]=0,z=1}else b[++z]++;else z===1&&z++,b[z]++;O++}if(this.foundPatternCross(b)){const V=this.handlePossibleCenter(b,I,v);if(V!==null)return V}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new $}static centerFromEnd(s,l){return l-s[2]-s[1]/2}foundPatternCross(s){const l=this.moduleSize,h=l/2;for(let v=0;v<3;v++)if(Math.abs(l-s[v])>=h)return!1;return!0}crossCheckVertical(s,l,h,v){const m=this.image,b=m.getHeight(),E=this.crossCheckStateCount;E[0]=0,E[1]=0,E[2]=0;let _=s;for(;_>=0&&m.get(l,_)&&E[1]<=h;)E[1]++,_--;if(_<0||E[1]>h)return NaN;for(;_>=0&&!m.get(l,_)&&E[0]<=h;)E[0]++,_--;if(E[0]>h)return NaN;for(_=s+1;_<b&&m.get(l,_)&&E[1]<=h;)E[1]++,_++;if(_===b||E[1]>h)return NaN;for(;_<b&&!m.get(l,_)&&E[2]<=h;)E[2]++,_++;if(E[2]>h)return NaN;const I=E[0]+E[1]+E[2];return 5*Math.abs(I-v)>=2*v?NaN:this.foundPatternCross(E)?po.centerFromEnd(E,_):NaN}handlePossibleCenter(s,l,h){const v=s[0]+s[1]+s[2],m=po.centerFromEnd(s,h),b=this.crossCheckVertical(l,m,2*s[1],v);if(!isNaN(b)){const E=(s[0]+s[1]+s[2])/3;for(const I of this.possibleCenters)if(I.aboutEquals(E,b,m))return I.combineEstimate(b,m,E);const _=new ls(m,b,E);this.possibleCenters.push(_),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(_)}return null}}class ni extends We{constructor(s,l,h,v){super(s,l),this.estimatedModuleSize=h,this.count=v,v===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(s,l,h){if(Math.abs(l-this.getY())<=s&&Math.abs(h-this.getX())<=s){const v=Math.abs(s-this.estimatedModuleSize);return v<=1||v<=this.estimatedModuleSize}return!1}combineEstimate(s,l,h){const v=this.count+1,m=(this.count*this.getX()+l)/v,b=(this.count*this.getY()+s)/v,E=(this.count*this.estimatedModuleSize+h)/v;return new ni(m,b,E,v)}}class go{constructor(s){this.bottomLeft=s[0],this.topLeft=s[1],this.topRight=s[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Hn{constructor(s,l){this.image=s,this.resultPointCallback=l,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=l}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(s){const l=s!=null&&s.get(W.TRY_HARDER)!==void 0,h=s!=null&&s.get(W.PURE_BARCODE)!==void 0,v=this.image,m=v.getHeight(),b=v.getWidth();let E=Math.floor(3*m/(4*Hn.MAX_MODULES));(E<Hn.MIN_SKIP||l)&&(E=Hn.MIN_SKIP);let _=!1;const I=new Int32Array(5);for(let z=E-1;z<m&&!_;z+=E){I[0]=0,I[1]=0,I[2]=0,I[3]=0,I[4]=0;let V=0;for(let Q=0;Q<b;Q++)if(v.get(Q,z))(V&1)===1&&V++,I[V]++;else if((V&1)===0)if(V===4)if(Hn.foundPatternCross(I)){if(this.handlePossibleCenter(I,z,Q,h)===!0)if(E=2,this.hasSkipped===!0)_=this.haveMultiplyConfirmedCenters();else{const se=this.findRowSkip();se>I[2]&&(z+=se-I[2]-E,Q=b-1)}else{I[0]=I[2],I[1]=I[3],I[2]=I[4],I[3]=1,I[4]=0,V=3;continue}V=0,I[0]=0,I[1]=0,I[2]=0,I[3]=0,I[4]=0}else I[0]=I[2],I[1]=I[3],I[2]=I[4],I[3]=1,I[4]=0,V=3;else I[++V]++;else I[V]++;Hn.foundPatternCross(I)&&this.handlePossibleCenter(I,z,b,h)===!0&&(E=I[0],this.hasSkipped&&(_=this.haveMultiplyConfirmedCenters()))}const O=this.selectBestPatterns();return We.orderBestPatterns(O),new go(O)}static centerFromEnd(s,l){return l-s[4]-s[3]-s[2]/2}static foundPatternCross(s){let l=0;for(let m=0;m<5;m++){const b=s[m];if(b===0)return!1;l+=b}if(l<7)return!1;const h=l/7,v=h/2;return Math.abs(h-s[0])<v&&Math.abs(h-s[1])<v&&Math.abs(3*h-s[2])<3*v&&Math.abs(h-s[3])<v&&Math.abs(h-s[4])<v}getCrossCheckStateCount(){const s=this.crossCheckStateCount;return s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s}crossCheckDiagonal(s,l,h,v){const m=this.getCrossCheckStateCount();let b=0;const E=this.image;for(;s>=b&&l>=b&&E.get(l-b,s-b);)m[2]++,b++;if(s<b||l<b)return!1;for(;s>=b&&l>=b&&!E.get(l-b,s-b)&&m[1]<=h;)m[1]++,b++;if(s<b||l<b||m[1]>h)return!1;for(;s>=b&&l>=b&&E.get(l-b,s-b)&&m[0]<=h;)m[0]++,b++;if(m[0]>h)return!1;const _=E.getHeight(),I=E.getWidth();for(b=1;s+b<_&&l+b<I&&E.get(l+b,s+b);)m[2]++,b++;if(s+b>=_||l+b>=I)return!1;for(;s+b<_&&l+b<I&&!E.get(l+b,s+b)&&m[3]<h;)m[3]++,b++;if(s+b>=_||l+b>=I||m[3]>=h)return!1;for(;s+b<_&&l+b<I&&E.get(l+b,s+b)&&m[4]<h;)m[4]++,b++;if(m[4]>=h)return!1;const O=m[0]+m[1]+m[2]+m[3]+m[4];return Math.abs(O-v)<2*v&&Hn.foundPatternCross(m)}crossCheckVertical(s,l,h,v){const m=this.image,b=m.getHeight(),E=this.getCrossCheckStateCount();let _=s;for(;_>=0&&m.get(l,_);)E[2]++,_--;if(_<0)return NaN;for(;_>=0&&!m.get(l,_)&&E[1]<=h;)E[1]++,_--;if(_<0||E[1]>h)return NaN;for(;_>=0&&m.get(l,_)&&E[0]<=h;)E[0]++,_--;if(E[0]>h)return NaN;for(_=s+1;_<b&&m.get(l,_);)E[2]++,_++;if(_===b)return NaN;for(;_<b&&!m.get(l,_)&&E[3]<h;)E[3]++,_++;if(_===b||E[3]>=h)return NaN;for(;_<b&&m.get(l,_)&&E[4]<h;)E[4]++,_++;if(E[4]>=h)return NaN;const I=E[0]+E[1]+E[2]+E[3]+E[4];return 5*Math.abs(I-v)>=2*v?NaN:Hn.foundPatternCross(E)?Hn.centerFromEnd(E,_):NaN}crossCheckHorizontal(s,l,h,v){const m=this.image,b=m.getWidth(),E=this.getCrossCheckStateCount();let _=s;for(;_>=0&&m.get(_,l);)E[2]++,_--;if(_<0)return NaN;for(;_>=0&&!m.get(_,l)&&E[1]<=h;)E[1]++,_--;if(_<0||E[1]>h)return NaN;for(;_>=0&&m.get(_,l)&&E[0]<=h;)E[0]++,_--;if(E[0]>h)return NaN;for(_=s+1;_<b&&m.get(_,l);)E[2]++,_++;if(_===b)return NaN;for(;_<b&&!m.get(_,l)&&E[3]<h;)E[3]++,_++;if(_===b||E[3]>=h)return NaN;for(;_<b&&m.get(_,l)&&E[4]<h;)E[4]++,_++;if(E[4]>=h)return NaN;const I=E[0]+E[1]+E[2]+E[3]+E[4];return 5*Math.abs(I-v)>=v?NaN:Hn.foundPatternCross(E)?Hn.centerFromEnd(E,_):NaN}handlePossibleCenter(s,l,h,v){const m=s[0]+s[1]+s[2]+s[3]+s[4];let b=Hn.centerFromEnd(s,h),E=this.crossCheckVertical(l,Math.floor(b),s[2],m);if(!isNaN(E)&&(b=this.crossCheckHorizontal(Math.floor(b),Math.floor(E),s[2],m),!isNaN(b)&&(!v||this.crossCheckDiagonal(Math.floor(E),Math.floor(b),s[2],m)))){const _=m/7;let I=!1;const O=this.possibleCenters;for(let z=0,V=O.length;z<V;z++){const Q=O[z];if(Q.aboutEquals(_,E,b)){O[z]=Q.combineEstimate(E,b,_),I=!0;break}}if(!I){const z=new ni(b,E,_);O.push(z),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(z)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let l=null;for(const h of this.possibleCenters)if(h.getCount()>=Hn.CENTER_QUORUM)if(l==null)l=h;else return this.hasSkipped=!0,Math.floor((Math.abs(l.getX()-h.getX())-Math.abs(l.getY()-h.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let s=0,l=0;const h=this.possibleCenters.length;for(const b of this.possibleCenters)b.getCount()>=Hn.CENTER_QUORUM&&(s++,l+=b.getEstimatedModuleSize());if(s<3)return!1;const v=l/h;let m=0;for(const b of this.possibleCenters)m+=Math.abs(b.getEstimatedModuleSize()-v);return m<=.05*l}selectBestPatterns(){const s=this.possibleCenters.length;if(s<3)throw new $;const l=this.possibleCenters;let h;if(s>3){let v=0,m=0;for(const _ of this.possibleCenters){const I=_.getEstimatedModuleSize();v+=I,m+=I*I}h=v/s;let b=Math.sqrt(m/s-h*h);l.sort((_,I)=>{const O=Math.abs(I.getEstimatedModuleSize()-h),z=Math.abs(_.getEstimatedModuleSize()-h);return O<z?-1:O>z?1:0});const E=Math.max(.2*h,b);for(let _=0;_<l.length&&l.length>3;_++){const I=l[_];Math.abs(I.getEstimatedModuleSize()-h)>E&&(l.splice(_,1),_--)}}if(l.length>3){let v=0;for(const m of l)v+=m.getEstimatedModuleSize();h=v/l.length,l.sort((m,b)=>{if(b.getCount()===m.getCount()){const E=Math.abs(b.getEstimatedModuleSize()-h),_=Math.abs(m.getEstimatedModuleSize()-h);return E<_?1:E>_?-1:0}else return b.getCount()-m.getCount()}),l.splice(3)}return[l[0],l[1],l[2]]}}Hn.CENTER_QUORUM=2,Hn.MIN_SKIP=3,Hn.MAX_MODULES=57;class ki{constructor(s){this.image=s}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(s){this.resultPointCallback=s==null?null:s.get(W.NEED_RESULT_POINT_CALLBACK);const h=new Hn(this.image,this.resultPointCallback).find(s);return this.processFinderPatternInfo(h)}processFinderPatternInfo(s){const l=s.getTopLeft(),h=s.getTopRight(),v=s.getBottomLeft(),m=this.calculateModuleSize(l,h,v);if(m<1)throw new $("No pattern found in proccess finder.");const b=ki.computeDimension(l,h,v,m),E=nt.getProvisionalVersionForDimension(b),_=E.getDimensionForVersion()-7;let I=null;if(E.getAlignmentPatternCenters().length>0){const Q=h.getX()-l.getX()+v.getX(),ae=h.getY()-l.getY()+v.getY(),se=1-3/_,de=Math.floor(l.getX()+se*(Q-l.getX())),be=Math.floor(l.getY()+se*(ae-l.getY()));for(let Pe=4;Pe<=16;Pe<<=1)try{I=this.findAlignmentInRegion(m,de,be,Pe);break}catch(Ue){if(!(Ue instanceof $))throw Ue}}const O=ki.createTransform(l,h,v,I,b),z=ki.sampleGrid(this.image,O,b);let V;return I===null?V=[v,l,h]:V=[v,l,h,I],new Hr(z,V)}static createTransform(s,l,h,v,m){const b=m-3.5;let E,_,I,O;return v!==null?(E=v.getX(),_=v.getY(),I=b-3,O=I):(E=l.getX()-s.getX()+h.getX(),_=l.getY()-s.getY()+h.getY(),I=b,O=b),Pn.quadrilateralToQuadrilateral(3.5,3.5,b,3.5,I,O,3.5,b,s.getX(),s.getY(),l.getX(),l.getY(),E,_,h.getX(),h.getY())}static sampleGrid(s,l,h){return sn.getInstance().sampleGridWithTransform(s,h,h,l)}static computeDimension(s,l,h,v){const m=ct.round(We.distance(s,l)/v),b=ct.round(We.distance(s,h)/v);let E=Math.floor((m+b)/2)+7;switch(E&3){case 0:E++;break;case 2:E--;break;case 3:throw new $("Dimensions could be not found.")}return E}calculateModuleSize(s,l,h){return(this.calculateModuleSizeOneWay(s,l)+this.calculateModuleSizeOneWay(s,h))/2}calculateModuleSizeOneWay(s,l){const h=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(s.getX()),Math.floor(s.getY()),Math.floor(l.getX()),Math.floor(l.getY())),v=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(l.getX()),Math.floor(l.getY()),Math.floor(s.getX()),Math.floor(s.getY()));return isNaN(h)?v/7:isNaN(v)?h/7:(h+v)/14}sizeOfBlackWhiteBlackRunBothWays(s,l,h,v){let m=this.sizeOfBlackWhiteBlackRun(s,l,h,v),b=1,E=s-(h-s);E<0?(b=s/(s-E),E=0):E>=this.image.getWidth()&&(b=(this.image.getWidth()-1-s)/(E-s),E=this.image.getWidth()-1);let _=Math.floor(l-(v-l)*b);return b=1,_<0?(b=l/(l-_),_=0):_>=this.image.getHeight()&&(b=(this.image.getHeight()-1-l)/(_-l),_=this.image.getHeight()-1),E=Math.floor(s+(E-s)*b),m+=this.sizeOfBlackWhiteBlackRun(s,l,E,_),m-1}sizeOfBlackWhiteBlackRun(s,l,h,v){const m=Math.abs(v-l)>Math.abs(h-s);if(m){let Q=s;s=l,l=Q,Q=h,h=v,v=Q}const b=Math.abs(h-s),E=Math.abs(v-l);let _=-b/2;const I=s<h?1:-1,O=l<v?1:-1;let z=0;const V=h+I;for(let Q=s,ae=l;Q!==V;Q+=I){const se=m?ae:Q,de=m?Q:ae;if(z===1===this.image.get(se,de)){if(z===2)return ct.distance(Q,ae,s,l);z++}if(_+=E,_>0){if(ae===v)break;ae+=O,_-=b}}return z===2?ct.distance(h+I,v,s,l):NaN}findAlignmentInRegion(s,l,h,v){const m=Math.floor(v*s),b=Math.max(0,l-m),E=Math.min(this.image.getWidth()-1,l+m);if(E-b<s*3)throw new $("Alignment top exceeds estimated module size.");const _=Math.max(0,h-m),I=Math.min(this.image.getHeight()-1,h+m);if(I-_<s*3)throw new $("Alignment bottom exceeds estimated module size.");return new po(this.image,b,_,E-b,I-_,s,this.resultPointCallback).find()}}class Ha{constructor(){this.decoder=new $s}getDecoder(){return this.decoder}decode(s,l){let h,v;if(l!=null&&l.get(W.PURE_BARCODE)!==void 0){const _=Ha.extractPureBits(s.getBlackMatrix());h=this.decoder.decodeBitMatrix(_,l),v=Ha.NO_POINTS}else{const _=new ki(s.getBlackMatrix()).detect(l);h=this.decoder.decodeBitMatrix(_.getBits(),l),v=_.getPoints()}h.getOther()instanceof kc&&h.getOther().applyMirroredCorrection(v);const m=new Le(h.getText(),h.getRawBytes(),void 0,v,Ie.QR_CODE,void 0),b=h.getByteSegments();b!==null&&m.putMetadata(He.BYTE_SEGMENTS,b);const E=h.getECLevel();return E!==null&&m.putMetadata(He.ERROR_CORRECTION_LEVEL,E),h.hasStructuredAppend()&&(m.putMetadata(He.STRUCTURED_APPEND_SEQUENCE,h.getStructuredAppendSequenceNumber()),m.putMetadata(He.STRUCTURED_APPEND_PARITY,h.getStructuredAppendParity())),m}reset(){}static extractPureBits(s){const l=s.getTopLeftOnBit(),h=s.getBottomRightOnBit();if(l===null||h===null)throw new $;const v=this.moduleSize(l,s);let m=l[1],b=h[1],E=l[0],_=h[0];if(E>=_||m>=b)throw new $;if(b-m!==_-E&&(_=E+(b-m),_>=s.getWidth()))throw new $;const I=Math.round((_-E+1)/v),O=Math.round((b-m+1)/v);if(I<=0||O<=0)throw new $;if(O!==I)throw new $;const z=Math.floor(v/2);m+=z,E+=z;const V=E+Math.floor((I-1)*v)-_;if(V>0){if(V>z)throw new $;E-=V}const Q=m+Math.floor((O-1)*v)-b;if(Q>0){if(Q>z)throw new $;m-=Q}const ae=new xe(I,O);for(let se=0;se<O;se++){const de=m+Math.floor(se*v);for(let be=0;be<I;be++)s.get(E+Math.floor(be*v),de)&&ae.set(be,se)}return ae}static moduleSize(s,l){const h=l.getHeight(),v=l.getWidth();let m=s[0],b=s[1],E=!0,_=0;for(;m<v&&b<h;){if(E!==l.get(m,b)){if(++_===5)break;E=!E}m++,b++}if(m===v||b===h)throw new $;return(m-s[0])/7}}Ha.NO_POINTS=new Array;class ot{PDF417Common(){}static getBitCountSum(s){return ct.sum(s)}static toIntArray(s){if(s==null||!s.length)return ot.EMPTY_INT_ARRAY;const l=new Int32Array(s.length);let h=0;for(const v of s)l[h++]=v;return l}static getCodeword(s){const l=B.binarySearch(ot.SYMBOL_TABLE,s&262143);return l<0?-1:(ot.CODEWORD_TABLE[l]-1)%ot.NUMBER_OF_CODEWORDS}}ot.NUMBER_OF_CODEWORDS=929,ot.MAX_CODEWORDS_IN_BARCODE=ot.NUMBER_OF_CODEWORDS-1,ot.MIN_ROWS_IN_BARCODE=3,ot.MAX_ROWS_IN_BARCODE=90,ot.MODULES_IN_CODEWORD=17,ot.MODULES_IN_STOP_PATTERN=18,ot.BARS_IN_MODULE=8,ot.EMPTY_INT_ARRAY=new Int32Array([]),ot.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),ot.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Va{constructor(s,l){this.bits=s,this.points=l}getBits(){return this.bits}getPoints(){return this.points}}class mt{static detectMultiple(s,l,h){let v=s.getBlackMatrix(),m=mt.detect(h,v);return m.length||(v=v.clone(),v.rotate180(),m=mt.detect(h,v)),new Va(v,m)}static detect(s,l){const h=new Array;let v=0,m=0,b=!1;for(;v<l.getHeight();){const E=mt.findVertices(l,v,m);if(E[0]==null&&E[3]==null){if(!b)break;b=!1,m=0;for(const _ of h)_[1]!=null&&(v=Math.trunc(Math.max(v,_[1].getY()))),_[3]!=null&&(v=Math.max(v,Math.trunc(_[3].getY())));v+=mt.ROW_STEP;continue}if(b=!0,h.push(E),!s)break;E[2]!=null?(m=Math.trunc(E[2].getX()),v=Math.trunc(E[2].getY())):(m=Math.trunc(E[4].getX()),v=Math.trunc(E[4].getY()))}return h}static findVertices(s,l,h){const v=s.getHeight(),m=s.getWidth(),b=new Array(8);return mt.copyToResult(b,mt.findRowsWithPattern(s,v,m,l,h,mt.START_PATTERN),mt.INDEXES_START_PATTERN),b[4]!=null&&(h=Math.trunc(b[4].getX()),l=Math.trunc(b[4].getY())),mt.copyToResult(b,mt.findRowsWithPattern(s,v,m,l,h,mt.STOP_PATTERN),mt.INDEXES_STOP_PATTERN),b}static copyToResult(s,l,h){for(let v=0;v<h.length;v++)s[h[v]]=l[v]}static findRowsWithPattern(s,l,h,v,m,b){const E=new Array(4);let _=!1;const I=new Int32Array(b.length);for(;v<l;v+=mt.ROW_STEP){let z=mt.findGuardPattern(s,m,v,h,!1,b,I);if(z!=null){for(;v>0;){const V=mt.findGuardPattern(s,m,--v,h,!1,b,I);if(V!=null)z=V;else{v++;break}}E[0]=new We(z[0],v),E[1]=new We(z[1],v),_=!0;break}}let O=v+1;if(_){let z=0,V=Int32Array.from([Math.trunc(E[0].getX()),Math.trunc(E[1].getX())]);for(;O<l;O++){const Q=mt.findGuardPattern(s,V[0],O,h,!1,b,I);if(Q!=null&&Math.abs(V[0]-Q[0])<mt.MAX_PATTERN_DRIFT&&Math.abs(V[1]-Q[1])<mt.MAX_PATTERN_DRIFT)V=Q,z=0;else{if(z>mt.SKIPPED_ROW_COUNT_MAX)break;z++}}O-=z+1,E[2]=new We(V[0],O),E[3]=new We(V[1],O)}return O-v<mt.BARCODE_MIN_HEIGHT&&B.fill(E,null),E}static findGuardPattern(s,l,h,v,m,b,E){B.fillWithin(E,0,E.length,0);let _=l,I=0;for(;s.get(_,h)&&_>0&&I++<mt.MAX_PIXEL_DRIFT;)_--;let O=_,z=0,V=b.length;for(let Q=m;O<v;O++)if(s.get(O,h)!==Q)E[z]++;else{if(z===V-1){if(mt.patternMatchVariance(E,b,mt.MAX_INDIVIDUAL_VARIANCE)<mt.MAX_AVG_VARIANCE)return new Int32Array([_,O]);_+=E[0]+E[1],N.arraycopy(E,2,E,0,z-1),E[z-1]=0,E[z]=0,z--}else z++;E[z]=1,Q=!Q}return z===V-1&&mt.patternMatchVariance(E,b,mt.MAX_INDIVIDUAL_VARIANCE)<mt.MAX_AVG_VARIANCE?new Int32Array([_,O-1]):null}static patternMatchVariance(s,l,h){let v=s.length,m=0,b=0;for(let I=0;I<v;I++)m+=s[I],b+=l[I];if(m<b)return 1/0;let E=m/b;h*=E;let _=0;for(let I=0;I<v;I++){let O=s[I],z=l[I]*E,V=O>z?O-z:z-O;if(V>h)return 1/0;_+=V}return _/m}}mt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),mt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),mt.MAX_AVG_VARIANCE=.42,mt.MAX_INDIVIDUAL_VARIANCE=.8,mt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),mt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),mt.MAX_PIXEL_DRIFT=3,mt.MAX_PATTERN_DRIFT=5,mt.SKIPPED_ROW_COUNT_MAX=25,mt.ROW_STEP=5,mt.BARCODE_MIN_HEIGHT=10;class An{constructor(s,l){if(l.length===0)throw new w;this.field=s;let h=l.length;if(h>1&&l[0]===0){let v=1;for(;v<h&&l[v]===0;)v++;v===h?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(h-v),N.arraycopy(l,v,this.coefficients,0,this.coefficients.length))}else this.coefficients=l}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(s){return this.coefficients[this.coefficients.length-1-s]}evaluateAt(s){if(s===0)return this.getCoefficient(0);if(s===1){let v=0;for(let m of this.coefficients)v=this.field.add(v,m);return v}let l=this.coefficients[0],h=this.coefficients.length;for(let v=1;v<h;v++)l=this.field.add(this.field.multiply(s,l),this.coefficients[v]);return l}add(s){if(!this.field.equals(s.field))throw new w("ModulusPolys do not have same ModulusGF field");if(this.isZero())return s;if(s.isZero())return this;let l=this.coefficients,h=s.coefficients;if(l.length>h.length){let b=l;l=h,h=b}let v=new Int32Array(h.length),m=h.length-l.length;N.arraycopy(h,0,v,0,m);for(let b=m;b<h.length;b++)v[b]=this.field.add(l[b-m],h[b]);return new An(this.field,v)}subtract(s){if(!this.field.equals(s.field))throw new w("ModulusPolys do not have same ModulusGF field");return s.isZero()?this:this.add(s.negative())}multiply(s){return s instanceof An?this.multiplyOther(s):this.multiplyScalar(s)}multiplyOther(s){if(!this.field.equals(s.field))throw new w("ModulusPolys do not have same ModulusGF field");if(this.isZero()||s.isZero())return new An(this.field,new Int32Array([0]));let l=this.coefficients,h=l.length,v=s.coefficients,m=v.length,b=new Int32Array(h+m-1);for(let E=0;E<h;E++){let _=l[E];for(let I=0;I<m;I++)b[E+I]=this.field.add(b[E+I],this.field.multiply(_,v[I]))}return new An(this.field,b)}negative(){let s=this.coefficients.length,l=new Int32Array(s);for(let h=0;h<s;h++)l[h]=this.field.subtract(0,this.coefficients[h]);return new An(this.field,l)}multiplyScalar(s){if(s===0)return new An(this.field,new Int32Array([0]));if(s===1)return this;let l=this.coefficients.length,h=new Int32Array(l);for(let v=0;v<l;v++)h[v]=this.field.multiply(this.coefficients[v],s);return new An(this.field,h)}multiplyByMonomial(s,l){if(s<0)throw new w;if(l===0)return new An(this.field,new Int32Array([0]));let h=this.coefficients.length,v=new Int32Array(h+s);for(let m=0;m<h;m++)v[m]=this.field.multiply(this.coefficients[m],l);return new An(this.field,v)}toString(){let s=new me;for(let l=this.getDegree();l>=0;l--){let h=this.getCoefficient(l);h!==0&&(h<0?(s.append(" - "),h=-h):s.length()>0&&s.append(" + "),(l===0||h!==1)&&s.append(h),l!==0&&(l===1?s.append("x"):(s.append("x^"),s.append(l))))}return s.toString()}}class ri{add(s,l){return(s+l)%this.modulus}subtract(s,l){return(this.modulus+s-l)%this.modulus}exp(s){return this.expTable[s]}log(s){if(s===0)throw new w;return this.logTable[s]}inverse(s){if(s===0)throw new Rt;return this.expTable[this.modulus-this.logTable[s]-1]}multiply(s,l){return s===0||l===0?0:this.expTable[(this.logTable[s]+this.logTable[l])%(this.modulus-1)]}getSize(){return this.modulus}equals(s){return s===this}}class cs extends ri{constructor(s,l){super(),this.modulus=s,this.expTable=new Int32Array(s),this.logTable=new Int32Array(s);let h=1;for(let v=0;v<s;v++)this.expTable[v]=h,h=h*l%s;for(let v=0;v<s-1;v++)this.logTable[this.expTable[v]]=v;this.zero=new An(this,new Int32Array([0])),this.one=new An(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(s,l){if(s<0)throw new w;if(l===0)return this.zero;let h=new Int32Array(s+1);return h[0]=l,new An(this,h)}}cs.PDF417_GF=new cs(ot.NUMBER_OF_CODEWORDS,3);class fs{constructor(){this.field=cs.PDF417_GF}decode(s,l,h){let v=new An(this.field,s),m=new Int32Array(l),b=!1;for(let ae=l;ae>0;ae--){let se=v.evaluateAt(this.field.exp(ae));m[l-ae]=se,se!==0&&(b=!0)}if(!b)return 0;let E=this.field.getOne();if(h!=null)for(const ae of h){let se=this.field.exp(s.length-1-ae),de=new An(this.field,new Int32Array([this.field.subtract(0,se),1]));E=E.multiply(de)}let _=new An(this.field,m),I=this.runEuclideanAlgorithm(this.field.buildMonomial(l,1),_,l),O=I[0],z=I[1],V=this.findErrorLocations(O),Q=this.findErrorMagnitudes(z,O,V);for(let ae=0;ae<V.length;ae++){let se=s.length-1-this.field.log(V[ae]);if(se<0)throw S.getChecksumInstance();s[se]=this.field.subtract(s[se],Q[ae])}return V.length}runEuclideanAlgorithm(s,l,h){if(s.getDegree()<l.getDegree()){let V=s;s=l,l=V}let v=s,m=l,b=this.field.getZero(),E=this.field.getOne();for(;m.getDegree()>=Math.round(h/2);){let V=v,Q=b;if(v=m,b=E,v.isZero())throw S.getChecksumInstance();m=V;let ae=this.field.getZero(),se=v.getCoefficient(v.getDegree()),de=this.field.inverse(se);for(;m.getDegree()>=v.getDegree()&&!m.isZero();){let be=m.getDegree()-v.getDegree(),Pe=this.field.multiply(m.getCoefficient(m.getDegree()),de);ae=ae.add(this.field.buildMonomial(be,Pe)),m=m.subtract(v.multiplyByMonomial(be,Pe))}E=ae.multiply(b).subtract(Q).negative()}let _=E.getCoefficient(0);if(_===0)throw S.getChecksumInstance();let I=this.field.inverse(_),O=E.multiply(I),z=m.multiply(I);return[O,z]}findErrorLocations(s){let l=s.getDegree(),h=new Int32Array(l),v=0;for(let m=1;m<this.field.getSize()&&v<l;m++)s.evaluateAt(m)===0&&(h[v]=this.field.inverse(m),v++);if(v!==l)throw S.getChecksumInstance();return h}findErrorMagnitudes(s,l,h){let v=l.getDegree(),m=new Int32Array(v);for(let I=1;I<=v;I++)m[v-I]=this.field.multiply(I,l.getCoefficient(I));let b=new An(this.field,m),E=h.length,_=new Int32Array(E);for(let I=0;I<E;I++){let O=this.field.inverse(h[I]),z=this.field.subtract(0,s.evaluateAt(O)),V=this.field.inverse(b.evaluateAt(O));_[I]=this.field.multiply(z,V)}return _}}class ai{constructor(s,l,h,v,m){s instanceof ai?this.constructor_2(s):this.constructor_1(s,l,h,v,m)}constructor_1(s,l,h,v,m){const b=l==null||h==null,E=v==null||m==null;if(b&&E)throw new $;b?(l=new We(0,v.getY()),h=new We(0,m.getY())):E&&(v=new We(s.getWidth()-1,l.getY()),m=new We(s.getWidth()-1,h.getY())),this.image=s,this.topLeft=l,this.bottomLeft=h,this.topRight=v,this.bottomRight=m,this.minX=Math.trunc(Math.min(l.getX(),h.getX())),this.maxX=Math.trunc(Math.max(v.getX(),m.getX())),this.minY=Math.trunc(Math.min(l.getY(),v.getY())),this.maxY=Math.trunc(Math.max(h.getY(),m.getY()))}constructor_2(s){this.image=s.image,this.topLeft=s.getTopLeft(),this.bottomLeft=s.getBottomLeft(),this.topRight=s.getTopRight(),this.bottomRight=s.getBottomRight(),this.minX=s.getMinX(),this.maxX=s.getMaxX(),this.minY=s.getMinY(),this.maxY=s.getMaxY()}static merge(s,l){return s==null?l:l==null?s:new ai(s.image,s.topLeft,s.bottomLeft,l.topRight,l.bottomRight)}addMissingRows(s,l,h){let v=this.topLeft,m=this.bottomLeft,b=this.topRight,E=this.bottomRight;if(s>0){let _=h?this.topLeft:this.topRight,I=Math.trunc(_.getY()-s);I<0&&(I=0);let O=new We(_.getX(),I);h?v=O:b=O}if(l>0){let _=h?this.bottomLeft:this.bottomRight,I=Math.trunc(_.getY()+l);I>=this.image.getHeight()&&(I=this.image.getHeight()-1);let O=new We(_.getX(),I);h?m=O:E=O}return new ai(this.image,v,m,b,E)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class eu{constructor(s,l,h,v){this.columnCount=s,this.errorCorrectionLevel=v,this.rowCountUpperPart=l,this.rowCountLowerPart=h,this.rowCount=l+h}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class ii{constructor(){this.buffer=""}static form(s,l){let h=-1;function v(b,E,_,I,O,z){if(b==="%%")return"%";if(l[++h]===void 0)return;b=I?parseInt(I.substr(1)):void 0;let V=O?parseInt(O.substr(1)):void 0,Q;switch(z){case"s":Q=l[h];break;case"c":Q=l[h][0];break;case"f":Q=parseFloat(l[h]).toFixed(b);break;case"p":Q=parseFloat(l[h]).toPrecision(b);break;case"e":Q=parseFloat(l[h]).toExponential(b);break;case"x":Q=parseInt(l[h]).toString(V||16);break;case"d":Q=parseFloat(parseInt(l[h],V||10).toPrecision(b)).toFixed(0);break}Q=typeof Q=="object"?JSON.stringify(Q):(+Q).toString(V);let ae=parseInt(_),se=_&&_[0]+""=="0"?"0":" ";for(;Q.length<ae;)Q=E!==void 0?Q+se:se+Q;return Q}let m=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return s.replace(m,v)}format(s,...l){this.buffer+=ii.form(s,l)}toString(){return this.buffer}}class vo{constructor(s){this.boundingBox=new ai(s),this.codewords=new Array(s.getMaxY()-s.getMinY()+1)}getCodewordNearby(s){let l=this.getCodeword(s);if(l!=null)return l;for(let h=1;h<vo.MAX_NEARBY_DISTANCE;h++){let v=this.imageRowToCodewordIndex(s)-h;if(v>=0&&(l=this.codewords[v],l!=null)||(v=this.imageRowToCodewordIndex(s)+h,v<this.codewords.length&&(l=this.codewords[v],l!=null)))return l}return null}imageRowToCodewordIndex(s){return s-this.boundingBox.getMinY()}setCodeword(s,l){this.codewords[this.imageRowToCodewordIndex(s)]=l}getCodeword(s){return this.codewords[this.imageRowToCodewordIndex(s)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const s=new ii;let l=0;for(const h of this.codewords){if(h==null){s.format("%3d:    |   %n",l++);continue}s.format("%3d: %3d|%3d%n",l++,h.getRowNumber(),h.getValue())}return s.toString()}}vo.MAX_NEARBY_DISTANCE=5;class Yn{constructor(){this.values=new Map}setValue(s){s=Math.trunc(s);let l=this.values.get(s);l==null&&(l=0),l++,this.values.set(s,l)}getValue(){let s=-1,l=new Array;for(const[h,v]of this.values.entries()){const m={getKey:()=>h,getValue:()=>v};m.getValue()>s?(s=m.getValue(),l=[],l.push(m.getKey())):m.getValue()===s&&l.push(m.getKey())}return ot.toIntArray(l)}getConfidence(s){return this.values.get(s)}}class oi extends vo{constructor(s,l){super(s),this._isLeft=l}setRowNumbers(){for(let s of this.getCodewords())s?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(s){let l=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(l,s);let h=this.getBoundingBox(),v=this._isLeft?h.getTopLeft():h.getTopRight(),m=this._isLeft?h.getBottomLeft():h.getBottomRight(),b=this.imageRowToCodewordIndex(Math.trunc(v.getY())),E=this.imageRowToCodewordIndex(Math.trunc(m.getY())),_=-1,I=1,O=0;for(let z=b;z<E;z++){if(l[z]==null)continue;let V=l[z],Q=V.getRowNumber()-_;if(Q===0)O++;else if(Q===1)I=Math.max(I,O),O=1,_=V.getRowNumber();else if(Q<0||V.getRowNumber()>=s.getRowCount()||Q>z)l[z]=null;else{let ae;I>2?ae=(I-2)*Q:ae=Q;let se=ae>=z;for(let de=1;de<=ae&&!se;de++)se=l[z-de]!=null;se?l[z]=null:(_=V.getRowNumber(),O=1)}}}getRowHeights(){let s=this.getBarcodeMetadata();if(s==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(s);let l=new Int32Array(s.getRowCount());for(let h of this.getCodewords())if(h!=null){let v=h.getRowNumber();if(v>=l.length)continue;l[v]++}return l}adjustIncompleteIndicatorColumnRowNumbers(s){let l=this.getBoundingBox(),h=this._isLeft?l.getTopLeft():l.getTopRight(),v=this._isLeft?l.getBottomLeft():l.getBottomRight(),m=this.imageRowToCodewordIndex(Math.trunc(h.getY())),b=this.imageRowToCodewordIndex(Math.trunc(v.getY())),E=this.getCodewords(),_=-1;for(let I=m;I<b;I++){if(E[I]==null)continue;let O=E[I];O.setRowNumberAsRowIndicatorColumn();let z=O.getRowNumber()-_;z===0||(z===1?_=O.getRowNumber():O.getRowNumber()>=s.getRowCount()?E[I]=null:_=O.getRowNumber())}}getBarcodeMetadata(){let s=this.getCodewords(),l=new Yn,h=new Yn,v=new Yn,m=new Yn;for(let E of s){if(E==null)continue;E.setRowNumberAsRowIndicatorColumn();let _=E.getValue()%30,I=E.getRowNumber();switch(this._isLeft||(I+=2),I%3){case 0:h.setValue(_*3+1);break;case 1:m.setValue(_/3),v.setValue(_%3);break;case 2:l.setValue(_+1);break}}if(l.getValue().length===0||h.getValue().length===0||v.getValue().length===0||m.getValue().length===0||l.getValue()[0]<1||h.getValue()[0]+v.getValue()[0]<ot.MIN_ROWS_IN_BARCODE||h.getValue()[0]+v.getValue()[0]>ot.MAX_ROWS_IN_BARCODE)return null;let b=new eu(l.getValue()[0],h.getValue()[0],v.getValue()[0],m.getValue()[0]);return this.removeIncorrectCodewords(s,b),b}removeIncorrectCodewords(s,l){for(let h=0;h<s.length;h++){let v=s[h];if(s[h]==null)continue;let m=v.getValue()%30,b=v.getRowNumber();if(b>l.getRowCount()){s[h]=null;continue}switch(this._isLeft||(b+=2),b%3){case 0:m*3+1!==l.getRowCountUpperPart()&&(s[h]=null);break;case 1:(Math.trunc(m/3)!==l.getErrorCorrectionLevel()||m%3!==l.getRowCountLowerPart())&&(s[h]=null);break;case 2:m+1!==l.getColumnCount()&&(s[h]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class si{constructor(s,l){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=s,this.barcodeColumnCount=s.getColumnCount(),this.boundingBox=l,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let s=ot.MAX_CODEWORDS_IN_BARCODE,l;do l=s,s=this.adjustRowNumbersAndGetCount();while(s>0&&s<l);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(s){s?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let s=this.adjustRowNumbersByRow();if(s===0)return 0;for(let l=1;l<this.barcodeColumnCount+1;l++){let h=this.detectionResultColumns[l].getCodewords();for(let v=0;v<h.length;v++)h[v]!=null&&(h[v].hasValidRowNumber()||this.adjustRowNumbers(l,v,h))}return s}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let s=this.detectionResultColumns[0].getCodewords(),l=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let h=0;h<s.length;h++)if(s[h]!=null&&l[h]!=null&&s[h].getRowNumber()===l[h].getRowNumber())for(let v=1;v<=this.barcodeColumnCount;v++){let m=this.detectionResultColumns[v].getCodewords()[h];m!=null&&(m.setRowNumber(s[h].getRowNumber()),m.hasValidRowNumber()||(this.detectionResultColumns[v].getCodewords()[h]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let s=0,l=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let h=0;h<l.length;h++){if(l[h]==null)continue;let v=l[h].getRowNumber(),m=0;for(let b=this.barcodeColumnCount+1;b>0&&m<this.ADJUST_ROW_NUMBER_SKIP;b--){let E=this.detectionResultColumns[b].getCodewords()[h];E!=null&&(m=si.adjustRowNumberIfValid(v,m,E),E.hasValidRowNumber()||s++)}}return s}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let s=0,l=this.detectionResultColumns[0].getCodewords();for(let h=0;h<l.length;h++){if(l[h]==null)continue;let v=l[h].getRowNumber(),m=0;for(let b=1;b<this.barcodeColumnCount+1&&m<this.ADJUST_ROW_NUMBER_SKIP;b++){let E=this.detectionResultColumns[b].getCodewords()[h];E!=null&&(m=si.adjustRowNumberIfValid(v,m,E),E.hasValidRowNumber()||s++)}}return s}static adjustRowNumberIfValid(s,l,h){return h==null||h.hasValidRowNumber()||(h.isValidRowNumber(s)?(h.setRowNumber(s),l=0):++l),l}adjustRowNumbers(s,l,h){if(!this.detectionResultColumns[s-1])return;let v=h[l],m=this.detectionResultColumns[s-1].getCodewords(),b=m;this.detectionResultColumns[s+1]!=null&&(b=this.detectionResultColumns[s+1].getCodewords());let E=new Array(14);E[2]=m[l],E[3]=b[l],l>0&&(E[0]=h[l-1],E[4]=m[l-1],E[5]=b[l-1]),l>1&&(E[8]=h[l-2],E[10]=m[l-2],E[11]=b[l-2]),l<h.length-1&&(E[1]=h[l+1],E[6]=m[l+1],E[7]=b[l+1]),l<h.length-2&&(E[9]=h[l+2],E[12]=m[l+2],E[13]=b[l+2]);for(let _ of E)if(si.adjustRowNumber(v,_))return}static adjustRowNumber(s,l){return l==null?!1:l.hasValidRowNumber()&&l.getBucket()===s.getBucket()?(s.setRowNumber(l.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(s){this.boundingBox=s}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(s,l){this.detectionResultColumns[s]=l}getDetectionResultColumn(s){return this.detectionResultColumns[s]}toString(){let s=this.detectionResultColumns[0];s==null&&(s=this.detectionResultColumns[this.barcodeColumnCount+1]);let l=new ii;for(let h=0;h<s.getCodewords().length;h++){l.format("CW %3d:",h);for(let v=0;v<this.barcodeColumnCount+2;v++){if(this.detectionResultColumns[v]==null){l.format("    |   ");continue}let m=this.detectionResultColumns[v].getCodewords()[h];if(m==null){l.format("    |   ");continue}l.format(" %3d|%3d",m.getRowNumber(),m.getValue())}l.format("%n")}return l.toString()}}class Wa{constructor(s,l,h,v){this.rowNumber=Wa.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(s),this.endX=Math.trunc(l),this.bucket=Math.trunc(h),this.value=Math.trunc(v)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(s){return s!==Wa.BARCODE_ROW_UNKNOWN&&this.bucket===s%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(s){this.rowNumber=s}toString(){return this.rowNumber+"|"+this.value}}Wa.BARCODE_ROW_UNKNOWN=-1;class Rr{static initialize(){for(let s=0;s<ot.SYMBOL_TABLE.length;s++){let l=ot.SYMBOL_TABLE[s],h=l&1;for(let v=0;v<ot.BARS_IN_MODULE;v++){let m=0;for(;(l&1)===h;)m+=1,l>>=1;h=l&1,Rr.RATIOS_TABLE[s]||(Rr.RATIOS_TABLE[s]=new Array(ot.BARS_IN_MODULE)),Rr.RATIOS_TABLE[s][ot.BARS_IN_MODULE-v-1]=Math.fround(m/ot.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(s){let l=Rr.getDecodedCodewordValue(Rr.sampleBitCounts(s));return l!==-1?l:Rr.getClosestDecodedValue(s)}static sampleBitCounts(s){let l=ct.sum(s),h=new Int32Array(ot.BARS_IN_MODULE),v=0,m=0;for(let b=0;b<ot.MODULES_IN_CODEWORD;b++){let E=l/(2*ot.MODULES_IN_CODEWORD)+b*l/ot.MODULES_IN_CODEWORD;m+s[v]<=E&&(m+=s[v],v++),h[v]++}return h}static getDecodedCodewordValue(s){let l=Rr.getBitValue(s);return ot.getCodeword(l)===-1?-1:l}static getBitValue(s){let l=0;for(let h=0;h<s.length;h++)for(let v=0;v<s[h];v++)l=l<<1|(h%2===0?1:0);return Math.trunc(l)}static getClosestDecodedValue(s){let l=ct.sum(s),h=new Array(ot.BARS_IN_MODULE);if(l>1)for(let b=0;b<h.length;b++)h[b]=Math.fround(s[b]/l);let v=Yr.MAX_VALUE,m=-1;this.bSymbolTableReady||Rr.initialize();for(let b=0;b<Rr.RATIOS_TABLE.length;b++){let E=0,_=Rr.RATIOS_TABLE[b];for(let I=0;I<ot.BARS_IN_MODULE;I++){let O=Math.fround(_[I]-h[I]);if(E+=Math.fround(O*O),E>=v)break}E<v&&(v=E,m=ot.SYMBOL_TABLE[b])}return m}}Rr.bSymbolTableReady=!1,Rr.RATIOS_TABLE=new Array(ot.SYMBOL_TABLE.length).map(U=>new Array(ot.BARS_IN_MODULE));class tu{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(s){this.segmentIndex=s}getFileId(){return this.fileId}setFileId(s){this.fileId=s}getOptionalData(){return this.optionalData}setOptionalData(s){this.optionalData=s}isLastSegment(){return this.lastSegment}setLastSegment(s){this.lastSegment=s}getSegmentCount(){return this.segmentCount}setSegmentCount(s){this.segmentCount=s}getSender(){return this.sender||null}setSender(s){this.sender=s}getAddressee(){return this.addressee||null}setAddressee(s){this.addressee=s}getFileName(){return this.fileName}setFileName(s){this.fileName=s}getFileSize(){return this.fileSize}setFileSize(s){this.fileSize=s}getChecksum(){return this.checksum}setChecksum(s){this.checksum=s}getTimestamp(){return this.timestamp}setTimestamp(s){this.timestamp=s}}class nu{static parseLong(s,l=void 0){return parseInt(s,l)}}class mo extends d{}mo.kind="NullPointerException";class ru{writeBytes(s){this.writeBytesOffset(s,0,s.length)}writeBytesOffset(s,l,h){if(s==null)throw new mo;if(l<0||l>s.length||h<0||l+h>s.length||l+h<0)throw new D;if(h===0)return;for(let v=0;v<h;v++)this.write(s[l+v])}flush(){}close(){}}class Lc extends d{}class $h extends ru{constructor(s=32){if(super(),this.count=0,s<0)throw new w("Negative initial size: "+s);this.buf=new Uint8Array(s)}ensureCapacity(s){s-this.buf.length>0&&this.grow(s)}grow(s){let h=this.buf.length<<1;if(h-s<0&&(h=s),h<0){if(s<0)throw new Lc;h=k.MAX_VALUE}this.buf=B.copyOfUint8Array(this.buf,h)}write(s){this.ensureCapacity(this.count+1),this.buf[this.count]=s,this.count+=1}writeBytesOffset(s,l,h){if(l<0||l>s.length||h<0||l+h-s.length>0)throw new D;this.ensureCapacity(this.count+h),N.arraycopy(s,l,this.buf,this.count,h),this.count+=h}writeTo(s){s.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return B.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(s){return s?typeof s=="string"?this.toString_string(s):this.toString_number(s):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(s){return new String(this.buf).toString()}toString_number(s){return new String(this.buf).toString()}close(){}}var Qt;(function(U){U[U.ALPHA=0]="ALPHA",U[U.LOWER=1]="LOWER",U[U.MIXED=2]="MIXED",U[U.PUNCT=3]="PUNCT",U[U.ALPHA_SHIFT=4]="ALPHA_SHIFT",U[U.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Qt||(Qt={}));function Fc(){if(typeof window<"u")return window.BigInt||null;if(typeof Vf<"u")return Vf.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let xo;function ui(U){if(typeof xo>"u"&&(xo=Fc()),xo===null)throw new Error("BigInt is not supported!");return xo(U)}function ed(){let U=[];U[0]=ui(1);let s=ui(900);U[1]=s;for(let l=2;l<16;l++)U[l]=U[l-1]*s;return U}class Ce{static decode(s,l){let h=new me(""),v=H.ISO8859_1;h.enableDecoding(v);let m=1,b=s[m++],E=new tu;for(;m<s[0];){switch(b){case Ce.TEXT_COMPACTION_MODE_LATCH:m=Ce.textCompaction(s,m,h);break;case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:m=Ce.byteCompaction(b,s,v,m,h);break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h.append(s[m++]);break;case Ce.NUMERIC_COMPACTION_MODE_LATCH:m=Ce.numericCompaction(s,m,h);break;case Ce.ECI_CHARSET:H.getCharacterSetECIByValue(s[m++]);break;case Ce.ECI_GENERAL_PURPOSE:m+=2;break;case Ce.ECI_USER_DEFINED:m++;break;case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:m=Ce.decodeMacroBlock(s,m,E);break;case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:throw new G;default:m--,m=Ce.textCompaction(s,m,h);break}if(m<s.length)b=s[m++];else throw G.getFormatInstance()}if(h.length()===0)throw G.getFormatInstance();let _=new ht(null,h.toString(),null,l);return _.setOther(E),_}static decodeMacroBlock(s,l,h){if(l+Ce.NUMBER_OF_SEQUENCE_CODEWORDS>s[0])throw G.getFormatInstance();let v=new Int32Array(Ce.NUMBER_OF_SEQUENCE_CODEWORDS);for(let E=0;E<Ce.NUMBER_OF_SEQUENCE_CODEWORDS;E++,l++)v[E]=s[l];h.setSegmentIndex(k.parseInt(Ce.decodeBase900toBase10(v,Ce.NUMBER_OF_SEQUENCE_CODEWORDS)));let m=new me;l=Ce.textCompaction(s,l,m),h.setFileId(m.toString());let b=-1;for(s[l]===Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(b=l+1);l<s[0];)switch(s[l]){case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(l++,s[l]){case Ce.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let E=new me;l=Ce.textCompaction(s,l+1,E),h.setFileName(E.toString());break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let _=new me;l=Ce.textCompaction(s,l+1,_),h.setSender(_.toString());break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let I=new me;l=Ce.textCompaction(s,l+1,I),h.setAddressee(I.toString());break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let O=new me;l=Ce.numericCompaction(s,l+1,O),h.setSegmentCount(k.parseInt(O.toString()));break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let z=new me;l=Ce.numericCompaction(s,l+1,z),h.setTimestamp(nu.parseLong(z.toString()));break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let V=new me;l=Ce.numericCompaction(s,l+1,V),h.setChecksum(k.parseInt(V.toString()));break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let Q=new me;l=Ce.numericCompaction(s,l+1,Q),h.setFileSize(nu.parseLong(Q.toString()));break;default:throw G.getFormatInstance()}break;case Ce.MACRO_PDF417_TERMINATOR:l++,h.setLastSegment(!0);break;default:throw G.getFormatInstance()}if(b!==-1){let E=l-b;h.isLastSegment()&&E--,h.setOptionalData(B.copyOfRange(s,b,b+E))}return l}static textCompaction(s,l,h){let v=new Int32Array((s[0]-l)*2),m=new Int32Array((s[0]-l)*2),b=0,E=!1;for(;l<s[0]&&!E;){let _=s[l++];if(_<Ce.TEXT_COMPACTION_MODE_LATCH)v[b]=_/30,v[b+1]=_%30,b+=2;else switch(_){case Ce.TEXT_COMPACTION_MODE_LATCH:v[b++]=Ce.TEXT_COMPACTION_MODE_LATCH;break;case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:case Ce.NUMERIC_COMPACTION_MODE_LATCH:case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:l--,E=!0;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v[b]=Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,_=s[l++],m[b]=_,b++;break}}return Ce.decodeTextCompaction(v,m,b,h),l}static decodeTextCompaction(s,l,h,v){let m=Qt.ALPHA,b=Qt.ALPHA,E=0;for(;E<h;){let _=s[E],I="";switch(m){case Qt.ALPHA:if(_<26)I=String.fromCharCode(65+_);else switch(_){case 26:I=" ";break;case Ce.LL:m=Qt.LOWER;break;case Ce.ML:m=Qt.MIXED;break;case Ce.PS:b=m,m=Qt.PUNCT_SHIFT;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(l[E]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:m=Qt.ALPHA;break}break;case Qt.LOWER:if(_<26)I=String.fromCharCode(97+_);else switch(_){case 26:I=" ";break;case Ce.AS:b=m,m=Qt.ALPHA_SHIFT;break;case Ce.ML:m=Qt.MIXED;break;case Ce.PS:b=m,m=Qt.PUNCT_SHIFT;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(l[E]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:m=Qt.ALPHA;break}break;case Qt.MIXED:if(_<Ce.PL)I=Ce.MIXED_CHARS[_];else switch(_){case Ce.PL:m=Qt.PUNCT;break;case 26:I=" ";break;case Ce.LL:m=Qt.LOWER;break;case Ce.AL:m=Qt.ALPHA;break;case Ce.PS:b=m,m=Qt.PUNCT_SHIFT;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(l[E]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:m=Qt.ALPHA;break}break;case Qt.PUNCT:if(_<Ce.PAL)I=Ce.PUNCT_CHARS[_];else switch(_){case Ce.PAL:m=Qt.ALPHA;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(l[E]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:m=Qt.ALPHA;break}break;case Qt.ALPHA_SHIFT:if(m=b,_<26)I=String.fromCharCode(65+_);else switch(_){case 26:I=" ";break;case Ce.TEXT_COMPACTION_MODE_LATCH:m=Qt.ALPHA;break}break;case Qt.PUNCT_SHIFT:if(m=b,_<Ce.PAL)I=Ce.PUNCT_CHARS[_];else switch(_){case Ce.PAL:m=Qt.ALPHA;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(l[E]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:m=Qt.ALPHA;break}break}I!==""&&v.append(I),E++}}static byteCompaction(s,l,h,v,m){let b=new $h,E=0,_=0,I=!1;switch(s){case Ce.BYTE_COMPACTION_MODE_LATCH:let O=new Int32Array(6),z=l[v++];for(;v<l[0]&&!I;)switch(O[E++]=z,_=900*_+z,z=l[v++],z){case Ce.TEXT_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.NUMERIC_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:v--,I=!0;break;default:if(E%5===0&&E>0){for(let V=0;V<6;++V)b.write(Number(ui(_)>>ui(8*(5-V))));_=0,E=0}break}v===l[0]&&z<Ce.TEXT_COMPACTION_MODE_LATCH&&(O[E++]=z);for(let V=0;V<E;V++)b.write(O[V]);break;case Ce.BYTE_COMPACTION_MODE_LATCH_6:for(;v<l[0]&&!I;){let V=l[v++];if(V<Ce.TEXT_COMPACTION_MODE_LATCH)E++,_=900*_+V;else switch(V){case Ce.TEXT_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.NUMERIC_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:v--,I=!0;break}if(E%5===0&&E>0){for(let Q=0;Q<6;++Q)b.write(Number(ui(_)>>ui(8*(5-Q))));_=0,E=0}}break}return m.append(ie.decode(b.toByteArray(),h)),v}static numericCompaction(s,l,h){let v=0,m=!1,b=new Int32Array(Ce.MAX_NUMERIC_CODEWORDS);for(;l<s[0]&&!m;){let E=s[l++];if(l===s[0]&&(m=!0),E<Ce.TEXT_COMPACTION_MODE_LATCH)b[v]=E,v++;else switch(E){case Ce.TEXT_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:l--,m=!0;break}(v%Ce.MAX_NUMERIC_CODEWORDS===0||E===Ce.NUMERIC_COMPACTION_MODE_LATCH||m)&&v>0&&(h.append(Ce.decodeBase900toBase10(b,v)),v=0)}return l}static decodeBase900toBase10(s,l){let h=ui(0);for(let m=0;m<l;m++)h+=Ce.EXP900[l-m-1]*ui(s[m]);let v=h.toString();if(v.charAt(0)!=="1")throw new G;return v.substring(1)}}Ce.TEXT_COMPACTION_MODE_LATCH=900,Ce.BYTE_COMPACTION_MODE_LATCH=901,Ce.NUMERIC_COMPACTION_MODE_LATCH=902,Ce.BYTE_COMPACTION_MODE_LATCH_6=924,Ce.ECI_USER_DEFINED=925,Ce.ECI_GENERAL_PURPOSE=926,Ce.ECI_CHARSET=927,Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Ce.MACRO_PDF417_TERMINATOR=922,Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Ce.MAX_NUMERIC_CODEWORDS=15,Ce.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Ce.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Ce.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Ce.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Ce.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Ce.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Ce.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Ce.PL=25,Ce.LL=27,Ce.AS=27,Ce.ML=28,Ce.AL=28,Ce.PS=29,Ce.PAL=29,Ce.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,Ce.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",Ce.EXP900=Fc()?ed():[],Ce.NUMBER_OF_SEQUENCE_CODEWORDS=2;class bt{constructor(){}static decode(s,l,h,v,m,b,E){let _=new ai(s,l,h,v,m),I=null,O=null,z;for(let ae=!0;;ae=!1){if(l!=null&&(I=bt.getRowIndicatorColumn(s,_,l,!0,b,E)),v!=null&&(O=bt.getRowIndicatorColumn(s,_,v,!1,b,E)),z=bt.merge(I,O),z==null)throw $.getNotFoundInstance();let se=z.getBoundingBox();if(ae&&se!=null&&(se.getMinY()<_.getMinY()||se.getMaxY()>_.getMaxY()))_=se;else break}z.setBoundingBox(_);let V=z.getBarcodeColumnCount()+1;z.setDetectionResultColumn(0,I),z.setDetectionResultColumn(V,O);let Q=I!=null;for(let ae=1;ae<=V;ae++){let se=Q?ae:V-ae;if(z.getDetectionResultColumn(se)!==void 0)continue;let de;se===0||se===V?de=new oi(_,se===0):de=new vo(_),z.setDetectionResultColumn(se,de);let be=-1,Pe=be;for(let Ue=_.getMinY();Ue<=_.getMaxY();Ue++){if(be=bt.getStartColumn(z,se,Ue,Q),be<0||be>_.getMaxX()){if(Pe===-1)continue;be=Pe}let Fe=bt.detectCodeword(s,_.getMinX(),_.getMaxX(),Q,be,Ue,b,E);Fe!=null&&(de.setCodeword(Ue,Fe),Pe=be,b=Math.min(b,Fe.getWidth()),E=Math.max(E,Fe.getWidth()))}}return bt.createDecoderResult(z)}static merge(s,l){if(s==null&&l==null)return null;let h=bt.getBarcodeMetadata(s,l);if(h==null)return null;let v=ai.merge(bt.adjustBoundingBox(s),bt.adjustBoundingBox(l));return new si(h,v)}static adjustBoundingBox(s){if(s==null)return null;let l=s.getRowHeights();if(l==null)return null;let h=bt.getMax(l),v=0;for(let E of l)if(v+=h-E,E>0)break;let m=s.getCodewords();for(let E=0;v>0&&m[E]==null;E++)v--;let b=0;for(let E=l.length-1;E>=0&&(b+=h-l[E],!(l[E]>0));E--);for(let E=m.length-1;b>0&&m[E]==null;E--)b--;return s.getBoundingBox().addMissingRows(v,b,s.isLeft())}static getMax(s){let l=-1;for(let h of s)l=Math.max(l,h);return l}static getBarcodeMetadata(s,l){let h;if(s==null||(h=s.getBarcodeMetadata())==null)return l==null?null:l.getBarcodeMetadata();let v;return l==null||(v=l.getBarcodeMetadata())==null?h:h.getColumnCount()!==v.getColumnCount()&&h.getErrorCorrectionLevel()!==v.getErrorCorrectionLevel()&&h.getRowCount()!==v.getRowCount()?null:h}static getRowIndicatorColumn(s,l,h,v,m,b){let E=new oi(l,v);for(let _=0;_<2;_++){let I=_===0?1:-1,O=Math.trunc(Math.trunc(h.getX()));for(let z=Math.trunc(Math.trunc(h.getY()));z<=l.getMaxY()&&z>=l.getMinY();z+=I){let V=bt.detectCodeword(s,0,s.getWidth(),v,O,z,m,b);V!=null&&(E.setCodeword(z,V),v?O=V.getStartX():O=V.getEndX())}}return E}static adjustCodewordCount(s,l){let h=l[0][1],v=h.getValue(),m=s.getBarcodeColumnCount()*s.getBarcodeRowCount()-bt.getNumberOfECCodeWords(s.getBarcodeECLevel());if(v.length===0){if(m<1||m>ot.MAX_CODEWORDS_IN_BARCODE)throw $.getNotFoundInstance();h.setValue(m)}else v[0]!==m&&h.setValue(m)}static createDecoderResult(s){let l=bt.createBarcodeMatrix(s);bt.adjustCodewordCount(s,l);let h=new Array,v=new Int32Array(s.getBarcodeRowCount()*s.getBarcodeColumnCount()),m=[],b=new Array;for(let _=0;_<s.getBarcodeRowCount();_++)for(let I=0;I<s.getBarcodeColumnCount();I++){let O=l[_][I+1].getValue(),z=_*s.getBarcodeColumnCount()+I;O.length===0?h.push(z):O.length===1?v[z]=O[0]:(b.push(z),m.push(O))}let E=new Array(m.length);for(let _=0;_<E.length;_++)E[_]=m[_];return bt.createDecoderResultFromAmbiguousValues(s.getBarcodeECLevel(),v,ot.toIntArray(h),ot.toIntArray(b),E)}static createDecoderResultFromAmbiguousValues(s,l,h,v,m){let b=new Int32Array(v.length),E=100;for(;E-- >0;){for(let _=0;_<b.length;_++)l[v[_]]=m[_][b[_]];try{return bt.decodeCodewords(l,s,h)}catch(_){if(!(_ instanceof S))throw _}if(b.length===0)throw S.getChecksumInstance();for(let _=0;_<b.length;_++)if(b[_]<m[_].length-1){b[_]++;break}else if(b[_]=0,_===b.length-1)throw S.getChecksumInstance()}throw S.getChecksumInstance()}static createBarcodeMatrix(s){let l=Array.from({length:s.getBarcodeRowCount()},()=>new Array(s.getBarcodeColumnCount()+2));for(let v=0;v<l.length;v++)for(let m=0;m<l[v].length;m++)l[v][m]=new Yn;let h=0;for(let v of s.getDetectionResultColumns()){if(v!=null){for(let m of v.getCodewords())if(m!=null){let b=m.getRowNumber();if(b>=0){if(b>=l.length)continue;l[b][h].setValue(m.getValue())}}}h++}return l}static isValidBarcodeColumn(s,l){return l>=0&&l<=s.getBarcodeColumnCount()+1}static getStartColumn(s,l,h,v){let m=v?1:-1,b=null;if(bt.isValidBarcodeColumn(s,l-m)&&(b=s.getDetectionResultColumn(l-m).getCodeword(h)),b!=null)return v?b.getEndX():b.getStartX();if(b=s.getDetectionResultColumn(l).getCodewordNearby(h),b!=null)return v?b.getStartX():b.getEndX();if(bt.isValidBarcodeColumn(s,l-m)&&(b=s.getDetectionResultColumn(l-m).getCodewordNearby(h)),b!=null)return v?b.getEndX():b.getStartX();let E=0;for(;bt.isValidBarcodeColumn(s,l-m);){l-=m;for(let _ of s.getDetectionResultColumn(l).getCodewords())if(_!=null)return(v?_.getEndX():_.getStartX())+m*E*(_.getEndX()-_.getStartX());E++}return v?s.getBoundingBox().getMinX():s.getBoundingBox().getMaxX()}static detectCodeword(s,l,h,v,m,b,E,_){m=bt.adjustCodewordStartColumn(s,l,h,v,m,b);let I=bt.getModuleBitCount(s,l,h,v,m,b);if(I==null)return null;let O,z=ct.sum(I);if(v)O=m+z;else{for(let ae=0;ae<I.length/2;ae++){let se=I[ae];I[ae]=I[I.length-1-ae],I[I.length-1-ae]=se}O=m,m=O-z}if(!bt.checkCodewordSkew(z,E,_))return null;let V=Rr.getDecodedValue(I),Q=ot.getCodeword(V);return Q===-1?null:new Wa(m,O,bt.getCodewordBucketNumber(V),Q)}static getModuleBitCount(s,l,h,v,m,b){let E=m,_=new Int32Array(8),I=0,O=v?1:-1,z=v;for(;(v?E<h:E>=l)&&I<_.length;)s.get(E,b)===z?(_[I]++,E+=O):(I++,z=!z);return I===_.length||E===(v?h:l)&&I===_.length-1?_:null}static getNumberOfECCodeWords(s){return 2<<s}static adjustCodewordStartColumn(s,l,h,v,m,b){let E=m,_=v?-1:1;for(let I=0;I<2;I++){for(;(v?E>=l:E<h)&&v===s.get(E,b);){if(Math.abs(m-E)>bt.CODEWORD_SKEW_SIZE)return m;E+=_}_=-_,v=!v}return E}static checkCodewordSkew(s,l,h){return l-bt.CODEWORD_SKEW_SIZE<=s&&s<=h+bt.CODEWORD_SKEW_SIZE}static decodeCodewords(s,l,h){if(s.length===0)throw G.getFormatInstance();let v=1<<l+1,m=bt.correctErrors(s,h,v);bt.verifyCodewordCount(s,v);let b=Ce.decode(s,""+l);return b.setErrorsCorrected(m),b.setErasures(h.length),b}static correctErrors(s,l,h){if(l!=null&&l.length>h/2+bt.MAX_ERRORS||h<0||h>bt.MAX_EC_CODEWORDS)throw S.getChecksumInstance();return bt.errorCorrection.decode(s,h,l)}static verifyCodewordCount(s,l){if(s.length<4)throw G.getFormatInstance();let h=s[0];if(h>s.length)throw G.getFormatInstance();if(h===0)if(l<s.length)s[0]=s.length-l;else throw G.getFormatInstance()}static getBitCountForCodeword(s){let l=new Int32Array(8),h=0,v=l.length-1;for(;!((s&1)!==h&&(h=s&1,v--,v<0));)l[v]++,s>>=1;return l}static getCodewordBucketNumber(s){return s instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(s):this.getCodewordBucketNumber_number(s)}static getCodewordBucketNumber_number(s){return bt.getCodewordBucketNumber(bt.getBitCountForCodeword(s))}static getCodewordBucketNumber_Int32Array(s){return(s[0]-s[2]+s[4]-s[6]+9)%9}static toString(s){let l=new ii;for(let h=0;h<s.length;h++){l.format("Row %2d: ",h);for(let v=0;v<s[h].length;v++){let m=s[h][v];m.getValue().length===0?l.format("        ",null):l.format("%4d(%2d)",m.getValue()[0],m.getConfidence(m.getValue()[0]))}l.format("%n")}return l.toString()}}bt.CODEWORD_SKEW_SIZE=2,bt.MAX_ERRORS=3,bt.MAX_EC_CODEWORDS=512,bt.errorCorrection=new fs;class tr{decode(s,l=null){let h=tr.decode(s,l,!1);if(h==null||h.length===0||h[0]==null)throw $.getNotFoundInstance();return h[0]}decodeMultiple(s,l=null){try{return tr.decode(s,l,!0)}catch(h){throw h instanceof G||h instanceof S?$.getNotFoundInstance():h}}static decode(s,l,h){const v=new Array,m=mt.detectMultiple(s,l,h);for(const b of m.getPoints()){const E=bt.decode(m.getBits(),b[4],b[5],b[6],b[7],tr.getMinCodewordWidth(b),tr.getMaxCodewordWidth(b)),_=new Le(E.getText(),E.getRawBytes(),void 0,b,Ie.PDF_417);_.putMetadata(He.ERROR_CORRECTION_LEVEL,E.getECLevel());const I=E.getOther();I!=null&&_.putMetadata(He.PDF417_EXTRA_METADATA,I),v.push(_)}return v.map(b=>b)}static getMaxWidth(s,l){return s==null||l==null?0:Math.trunc(Math.abs(s.getX()-l.getX()))}static getMinWidth(s,l){return s==null||l==null?k.MAX_VALUE:Math.trunc(Math.abs(s.getX()-l.getX()))}static getMaxCodewordWidth(s){return Math.floor(Math.max(Math.max(tr.getMaxWidth(s[0],s[4]),tr.getMaxWidth(s[6],s[2])*ot.MODULES_IN_CODEWORD/ot.MODULES_IN_STOP_PATTERN),Math.max(tr.getMaxWidth(s[1],s[5]),tr.getMaxWidth(s[7],s[3])*ot.MODULES_IN_CODEWORD/ot.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(s){return Math.floor(Math.min(Math.min(tr.getMinWidth(s[0],s[4]),tr.getMinWidth(s[6],s[2])*ot.MODULES_IN_CODEWORD/ot.MODULES_IN_STOP_PATTERN),Math.min(tr.getMinWidth(s[1],s[5]),tr.getMinWidth(s[7],s[3])*ot.MODULES_IN_CODEWORD/ot.MODULES_IN_STOP_PATTERN)))}reset(){}}class hs extends d{}hs.kind="ReaderException";class Pc{constructor(s,l){this.verbose=s===!0,l&&this.setHints(l)}decode(s,l){return l&&this.setHints(l),this.decodeInternal(s)}decodeWithState(s){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(s)}setHints(s){this.hints=s;const l=!n(s)&&s.get(W.TRY_HARDER)===!0,h=n(s)?null:s.get(W.POSSIBLE_FORMATS),v=new Array;if(!n(h)){const m=h.some(b=>b===Ie.UPC_A||b===Ie.UPC_E||b===Ie.EAN_13||b===Ie.EAN_8||b===Ie.CODABAR||b===Ie.CODE_39||b===Ie.CODE_93||b===Ie.CODE_128||b===Ie.ITF||b===Ie.RSS_14||b===Ie.RSS_EXPANDED);m&&!l&&v.push(new ei(s,this.verbose)),h.includes(Ie.QR_CODE)&&v.push(new Ha),h.includes(Ie.DATA_MATRIX)&&v.push(new ua),h.includes(Ie.AZTEC)&&v.push(new ho),h.includes(Ie.PDF_417)&&v.push(new tr),m&&l&&v.push(new ei(s,this.verbose))}v.length===0&&(l||v.push(new ei(s,this.verbose)),v.push(new Ha),v.push(new ua),v.push(new ho),v.push(new tr),l&&v.push(new ei(s,this.verbose))),this.readers=v}reset(){if(this.readers!==null)for(const s of this.readers)s.reset()}decodeInternal(s){if(this.readers===null)throw new hs("No readers where selected, nothing can be read.");for(const l of this.readers)try{return l.decode(s,this.hints)}catch(h){if(h instanceof hs)continue}throw new $("No MultiFormat Readers were able to detect the code.")}}class td extends Te{constructor(s=null,l=500){const h=new Pc;h.setHints(s),super(h,l)}decodeBitmap(s){return this.reader.decodeWithState(s)}}class nd extends Te{constructor(s=500){super(new tr,s)}}class rd extends Te{constructor(s=500){super(new Ha,s)}}var ds;(function(U){U[U.ERROR_CORRECTION=0]="ERROR_CORRECTION",U[U.CHARACTER_SET=1]="CHARACTER_SET",U[U.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",U[U.MIN_SIZE=3]="MIN_SIZE",U[U.MAX_SIZE=4]="MAX_SIZE",U[U.MARGIN=5]="MARGIN",U[U.PDF417_COMPACT=6]="PDF417_COMPACT",U[U.PDF417_COMPACTION=7]="PDF417_COMPACTION",U[U.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",U[U.AZTEC_LAYERS=9]="AZTEC_LAYERS",U[U.QR_VERSION=10]="QR_VERSION"})(ds||(ds={}));var Vn=ds;class cl{constructor(s){this.field=s,this.cachedGenerators=[],this.cachedGenerators.push(new it(s,Int32Array.from([1])))}buildGenerator(s){const l=this.cachedGenerators;if(s>=l.length){let h=l[l.length-1];const v=this.field;for(let m=l.length;m<=s;m++){const b=h.multiply(new it(v,Int32Array.from([1,v.exp(m-1+v.getGeneratorBase())])));l.push(b),h=b}}return l[s]}encode(s,l){if(l===0)throw new w("No error correction bytes");const h=s.length-l;if(h<=0)throw new w("No data bytes provided");const v=this.buildGenerator(l),m=new Int32Array(h);N.arraycopy(s,0,m,0,h);let b=new it(this.field,m);b=b.multiplyByMonomial(l,1);const _=b.divide(v)[1].getCoefficients(),I=l-_.length;for(let O=0;O<I;O++)s[h+O]=0;N.arraycopy(_,0,s,h+I,_.length)}}class wn{constructor(){}static applyMaskPenaltyRule1(s){return wn.applyMaskPenaltyRule1Internal(s,!0)+wn.applyMaskPenaltyRule1Internal(s,!1)}static applyMaskPenaltyRule2(s){let l=0;const h=s.getArray(),v=s.getWidth(),m=s.getHeight();for(let b=0;b<m-1;b++){const E=h[b];for(let _=0;_<v-1;_++){const I=E[_];I===E[_+1]&&I===h[b+1][_]&&I===h[b+1][_+1]&&l++}}return wn.N2*l}static applyMaskPenaltyRule3(s){let l=0;const h=s.getArray(),v=s.getWidth(),m=s.getHeight();for(let b=0;b<m;b++)for(let E=0;E<v;E++){const _=h[b];E+6<v&&_[E]===1&&_[E+1]===0&&_[E+2]===1&&_[E+3]===1&&_[E+4]===1&&_[E+5]===0&&_[E+6]===1&&(wn.isWhiteHorizontal(_,E-4,E)||wn.isWhiteHorizontal(_,E+7,E+11))&&l++,b+6<m&&h[b][E]===1&&h[b+1][E]===0&&h[b+2][E]===1&&h[b+3][E]===1&&h[b+4][E]===1&&h[b+5][E]===0&&h[b+6][E]===1&&(wn.isWhiteVertical(h,E,b-4,b)||wn.isWhiteVertical(h,E,b+7,b+11))&&l++}return l*wn.N3}static isWhiteHorizontal(s,l,h){l=Math.max(l,0),h=Math.min(h,s.length);for(let v=l;v<h;v++)if(s[v]===1)return!1;return!0}static isWhiteVertical(s,l,h,v){h=Math.max(h,0),v=Math.min(v,s.length);for(let m=h;m<v;m++)if(s[m][l]===1)return!1;return!0}static applyMaskPenaltyRule4(s){let l=0;const h=s.getArray(),v=s.getWidth(),m=s.getHeight();for(let _=0;_<m;_++){const I=h[_];for(let O=0;O<v;O++)I[O]===1&&l++}const b=s.getHeight()*s.getWidth();return Math.floor(Math.abs(l*2-b)*10/b)*wn.N4}static getDataMaskBit(s,l,h){let v,m;switch(s){case 0:v=h+l&1;break;case 1:v=h&1;break;case 2:v=l%3;break;case 3:v=(h+l)%3;break;case 4:v=Math.floor(h/2)+Math.floor(l/3)&1;break;case 5:m=h*l,v=(m&1)+m%3;break;case 6:m=h*l,v=(m&1)+m%3&1;break;case 7:m=h*l,v=m%3+(h+l&1)&1;break;default:throw new w("Invalid mask pattern: "+s)}return v===0}static applyMaskPenaltyRule1Internal(s,l){let h=0;const v=l?s.getHeight():s.getWidth(),m=l?s.getWidth():s.getHeight(),b=s.getArray();for(let E=0;E<v;E++){let _=0,I=-1;for(let O=0;O<m;O++){const z=l?b[E][O]:b[O][E];z===I?_++:(_>=5&&(h+=wn.N1+(_-5)),_=1,I=z)}_>=5&&(h+=wn.N1+(_-5))}return h}}wn.N1=3,wn.N2=3,wn.N3=40,wn.N4=10;class ps{constructor(s,l){this.width=s,this.height=l;const h=new Array(l);for(let v=0;v!==l;v++)h[v]=new Uint8Array(s);this.bytes=h}getHeight(){return this.height}getWidth(){return this.width}get(s,l){return this.bytes[l][s]}getArray(){return this.bytes}setNumber(s,l,h){this.bytes[l][s]=h}setBoolean(s,l,h){this.bytes[l][s]=h?1:0}clear(s){for(const l of this.bytes)B.fill(l,s)}equals(s){if(!(s instanceof ps))return!1;const l=s;if(this.width!==l.width||this.height!==l.height)return!1;for(let h=0,v=this.height;h<v;++h){const m=this.bytes[h],b=l.bytes[h];for(let E=0,_=this.width;E<_;++E)if(m[E]!==b[E])return!1}return!0}toString(){const s=new me;for(let l=0,h=this.height;l<h;++l){const v=this.bytes[l];for(let m=0,b=this.width;m<b;++m)switch(v[m]){case 0:s.append(" 0");break;case 1:s.append(" 1");break;default:s.append("  ");break}s.append(`
`)}return s.toString()}}class Li{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const s=new me;return s.append(`<<
`),s.append(" mode: "),s.append(this.mode?this.mode.toString():"null"),s.append(`
 ecLevel: `),s.append(this.ecLevel?this.ecLevel.toString():"null"),s.append(`
 version: `),s.append(this.version?this.version.toString():"null"),s.append(`
 maskPattern: `),s.append(this.maskPattern.toString()),this.matrix?(s.append(`
 matrix:
`),s.append(this.matrix.toString())):s.append(`
 matrix: null
`),s.append(`>>
`),s.toString()}setMode(s){this.mode=s}setECLevel(s){this.ecLevel=s}setVersion(s){this.version=s}setMaskPattern(s){this.maskPattern=s}setMatrix(s){this.matrix=s}static isValidMaskPattern(s){return s>=0&&s<Li.NUM_MASK_PATTERNS}}Li.NUM_MASK_PATTERNS=8;class tn extends d{}tn.kind="WriterException";class st{constructor(){}static clearMatrix(s){s.clear(255)}static buildMatrix(s,l,h,v,m){st.clearMatrix(m),st.embedBasicPatterns(h,m),st.embedTypeInfo(l,v,m),st.maybeEmbedVersionInfo(h,m),st.embedDataBits(s,v,m)}static embedBasicPatterns(s,l){st.embedPositionDetectionPatternsAndSeparators(l),st.embedDarkDotAtLeftBottomCorner(l),st.maybeEmbedPositionAdjustmentPatterns(s,l),st.embedTimingPatterns(l)}static embedTypeInfo(s,l,h){const v=new L;st.makeTypeInfoBits(s,l,v);for(let m=0,b=v.getSize();m<b;++m){const E=v.get(v.getSize()-1-m),_=st.TYPE_INFO_COORDINATES[m],I=_[0],O=_[1];if(h.setBoolean(I,O,E),m<8){const z=h.getWidth()-m-1;h.setBoolean(z,8,E)}else{const V=h.getHeight()-7+(m-8);h.setBoolean(8,V,E)}}}static maybeEmbedVersionInfo(s,l){if(s.getVersionNumber()<7)return;const h=new L;st.makeVersionInfoBits(s,h);let v=17;for(let m=0;m<6;++m)for(let b=0;b<3;++b){const E=h.get(v);v--,l.setBoolean(m,l.getHeight()-11+b,E),l.setBoolean(l.getHeight()-11+b,m,E)}}static embedDataBits(s,l,h){let v=0,m=-1,b=h.getWidth()-1,E=h.getHeight()-1;for(;b>0;){for(b===6&&(b-=1);E>=0&&E<h.getHeight();){for(let _=0;_<2;++_){const I=b-_;if(!st.isEmpty(h.get(I,E)))continue;let O;v<s.getSize()?(O=s.get(v),++v):O=!1,l!==255&&wn.getDataMaskBit(l,I,E)&&(O=!O),h.setBoolean(I,E,O)}E+=m}m=-m,E+=m,b-=2}if(v!==s.getSize())throw new tn("Not all bits consumed: "+v+"/"+s.getSize())}static findMSBSet(s){return 32-k.numberOfLeadingZeros(s)}static calculateBCHCode(s,l){if(l===0)throw new w("0 polynomial");const h=st.findMSBSet(l);for(s<<=h-1;st.findMSBSet(s)>=h;)s^=l<<st.findMSBSet(s)-h;return s}static makeTypeInfoBits(s,l,h){if(!Li.isValidMaskPattern(l))throw new tn("Invalid mask pattern");const v=s.getBits()<<3|l;h.appendBits(v,5);const m=st.calculateBCHCode(v,st.TYPE_INFO_POLY);h.appendBits(m,10);const b=new L;if(b.appendBits(st.TYPE_INFO_MASK_PATTERN,15),h.xor(b),h.getSize()!==15)throw new tn("should not happen but we got: "+h.getSize())}static makeVersionInfoBits(s,l){l.appendBits(s.getVersionNumber(),6);const h=st.calculateBCHCode(s.getVersionNumber(),st.VERSION_INFO_POLY);if(l.appendBits(h,12),l.getSize()!==18)throw new tn("should not happen but we got: "+l.getSize())}static isEmpty(s){return s===255}static embedTimingPatterns(s){for(let l=8;l<s.getWidth()-8;++l){const h=(l+1)%2;st.isEmpty(s.get(l,6))&&s.setNumber(l,6,h),st.isEmpty(s.get(6,l))&&s.setNumber(6,l,h)}}static embedDarkDotAtLeftBottomCorner(s){if(s.get(8,s.getHeight()-8)===0)throw new tn;s.setNumber(8,s.getHeight()-8,1)}static embedHorizontalSeparationPattern(s,l,h){for(let v=0;v<8;++v){if(!st.isEmpty(h.get(s+v,l)))throw new tn;h.setNumber(s+v,l,0)}}static embedVerticalSeparationPattern(s,l,h){for(let v=0;v<7;++v){if(!st.isEmpty(h.get(s,l+v)))throw new tn;h.setNumber(s,l+v,0)}}static embedPositionAdjustmentPattern(s,l,h){for(let v=0;v<5;++v){const m=st.POSITION_ADJUSTMENT_PATTERN[v];for(let b=0;b<5;++b)h.setNumber(s+b,l+v,m[b])}}static embedPositionDetectionPattern(s,l,h){for(let v=0;v<7;++v){const m=st.POSITION_DETECTION_PATTERN[v];for(let b=0;b<7;++b)h.setNumber(s+b,l+v,m[b])}}static embedPositionDetectionPatternsAndSeparators(s){const l=st.POSITION_DETECTION_PATTERN[0].length;st.embedPositionDetectionPattern(0,0,s),st.embedPositionDetectionPattern(s.getWidth()-l,0,s),st.embedPositionDetectionPattern(0,s.getWidth()-l,s);const h=8;st.embedHorizontalSeparationPattern(0,h-1,s),st.embedHorizontalSeparationPattern(s.getWidth()-h,h-1,s),st.embedHorizontalSeparationPattern(0,s.getWidth()-h,s);const v=7;st.embedVerticalSeparationPattern(v,0,s),st.embedVerticalSeparationPattern(s.getHeight()-v-1,0,s),st.embedVerticalSeparationPattern(v,s.getHeight()-v,s)}static maybeEmbedPositionAdjustmentPatterns(s,l){if(s.getVersionNumber()<2)return;const h=s.getVersionNumber()-1,v=st.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[h];for(let m=0,b=v.length;m!==b;m++){const E=v[m];if(E>=0)for(let _=0;_!==b;_++){const I=v[_];I>=0&&st.isEmpty(l.get(I,E))&&st.embedPositionAdjustmentPattern(I-2,E-2,l)}}}}st.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),st.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),st.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),st.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),st.VERSION_INFO_POLY=7973,st.TYPE_INFO_POLY=1335,st.TYPE_INFO_MASK_PATTERN=21522;class ad{constructor(s,l){this.dataBytes=s,this.errorCorrectionBytes=l}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class hn{constructor(){}static calculateMaskPenalty(s){return wn.applyMaskPenaltyRule1(s)+wn.applyMaskPenaltyRule2(s)+wn.applyMaskPenaltyRule3(s)+wn.applyMaskPenaltyRule4(s)}static encode(s,l,h=null){let v=hn.DEFAULT_BYTE_MODE_ENCODING;const m=h!==null&&h.get(Vn.CHARACTER_SET)!==void 0;m&&(v=h.get(Vn.CHARACTER_SET).toString());const b=this.chooseMode(s,v),E=new L;if(b===rt.BYTE&&(m||hn.DEFAULT_BYTE_MODE_ENCODING!==v)){const Ue=H.getCharacterSetECIByName(v);Ue!==void 0&&this.appendECI(Ue,E)}this.appendModeInfo(b,E);const _=new L;this.appendBytes(s,b,_,v);let I;if(h!==null&&h.get(Vn.QR_VERSION)!==void 0){const Ue=Number.parseInt(h.get(Vn.QR_VERSION).toString(),10);I=nt.getVersionForNumber(Ue);const Fe=this.calculateBitsNeeded(b,E,_,I);if(!this.willFit(Fe,I,l))throw new tn("Data too big for requested version")}else I=this.recommendVersion(l,b,E,_);const O=new L;O.appendBitArray(E);const z=b===rt.BYTE?_.getSizeInBytes():s.length;this.appendLengthInfo(z,I,b,O),O.appendBitArray(_);const V=I.getECBlocksForLevel(l),Q=I.getTotalCodewords()-V.getTotalECCodewords();this.terminateBits(Q,O);const ae=this.interleaveWithECBytes(O,I.getTotalCodewords(),Q,V.getNumBlocks()),se=new Li;se.setECLevel(l),se.setMode(b),se.setVersion(I);const de=I.getDimensionForVersion(),be=new ps(de,de),Pe=this.chooseMaskPattern(ae,l,I,be);return se.setMaskPattern(Pe),st.buildMatrix(ae,l,I,Pe,be),se.setMatrix(be),se}static recommendVersion(s,l,h,v){const m=this.calculateBitsNeeded(l,h,v,nt.getVersionForNumber(1)),b=this.chooseVersion(m,s),E=this.calculateBitsNeeded(l,h,v,b);return this.chooseVersion(E,s)}static calculateBitsNeeded(s,l,h,v){return l.getSize()+s.getCharacterCountBits(v)+h.getSize()}static getAlphanumericCode(s){return s<hn.ALPHANUMERIC_TABLE.length?hn.ALPHANUMERIC_TABLE[s]:-1}static chooseMode(s,l=null){if(H.SJIS.getName()===l&&this.isOnlyDoubleByteKanji(s))return rt.KANJI;let h=!1,v=!1;for(let m=0,b=s.length;m<b;++m){const E=s.charAt(m);if(hn.isDigit(E))h=!0;else if(this.getAlphanumericCode(E.charCodeAt(0))!==-1)v=!0;else return rt.BYTE}return v?rt.ALPHANUMERIC:h?rt.NUMERIC:rt.BYTE}static isOnlyDoubleByteKanji(s){let l;try{l=ie.encode(s,H.SJIS)}catch{return!1}const h=l.length;if(h%2!==0)return!1;for(let v=0;v<h;v+=2){const m=l[v]&255;if((m<129||m>159)&&(m<224||m>235))return!1}return!0}static chooseMaskPattern(s,l,h,v){let m=Number.MAX_SAFE_INTEGER,b=-1;for(let E=0;E<Li.NUM_MASK_PATTERNS;E++){st.buildMatrix(s,l,h,E,v);let _=this.calculateMaskPenalty(v);_<m&&(m=_,b=E)}return b}static chooseVersion(s,l){for(let h=1;h<=40;h++){const v=nt.getVersionForNumber(h);if(hn.willFit(s,v,l))return v}throw new tn("Data too big")}static willFit(s,l,h){const v=l.getTotalCodewords(),b=l.getECBlocksForLevel(h).getTotalECCodewords(),E=v-b,_=(s+7)/8;return E>=_}static terminateBits(s,l){const h=s*8;if(l.getSize()>h)throw new tn("data bits cannot fit in the QR Code"+l.getSize()+" > "+h);for(let b=0;b<4&&l.getSize()<h;++b)l.appendBit(!1);const v=l.getSize()&7;if(v>0)for(let b=v;b<8;b++)l.appendBit(!1);const m=s-l.getSizeInBytes();for(let b=0;b<m;++b)l.appendBits((b&1)===0?236:17,8);if(l.getSize()!==h)throw new tn("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(s,l,h,v,m,b){if(v>=h)throw new tn("Block ID too large");const E=s%h,_=h-E,I=Math.floor(s/h),O=I+1,z=Math.floor(l/h),V=z+1,Q=I-z,ae=O-V;if(Q!==ae)throw new tn("EC bytes mismatch");if(h!==_+E)throw new tn("RS blocks mismatch");if(s!==(z+Q)*_+(V+ae)*E)throw new tn("Total bytes mismatch");v<_?(m[0]=z,b[0]=Q):(m[0]=V,b[0]=ae)}static interleaveWithECBytes(s,l,h,v){if(s.getSizeInBytes()!==h)throw new tn("Number of bits and data bytes does not match");let m=0,b=0,E=0;const _=new Array;for(let O=0;O<v;++O){const z=new Int32Array(1),V=new Int32Array(1);hn.getNumDataBytesAndNumECBytesForBlockID(l,h,v,O,z,V);const Q=z[0],ae=new Uint8Array(Q);s.toBytes(8*m,ae,0,Q);const se=hn.generateECBytes(ae,V[0]);_.push(new ad(ae,se)),b=Math.max(b,Q),E=Math.max(E,se.length),m+=z[0]}if(h!==m)throw new tn("Data bytes does not match offset");const I=new L;for(let O=0;O<b;++O)for(const z of _){const V=z.getDataBytes();O<V.length&&I.appendBits(V[O],8)}for(let O=0;O<E;++O)for(const z of _){const V=z.getErrorCorrectionBytes();O<V.length&&I.appendBits(V[O],8)}if(l!==I.getSizeInBytes())throw new tn("Interleaving error: "+l+" and "+I.getSizeInBytes()+" differ.");return I}static generateECBytes(s,l){const h=s.length,v=new Int32Array(h+l);for(let b=0;b<h;b++)v[b]=s[b]&255;new cl(Ye.QR_CODE_FIELD_256).encode(v,l);const m=new Uint8Array(l);for(let b=0;b<l;b++)m[b]=v[h+b];return m}static appendModeInfo(s,l){l.appendBits(s.getBits(),4)}static appendLengthInfo(s,l,h,v){const m=h.getCharacterCountBits(l);if(s>=1<<m)throw new tn(s+" is bigger than "+((1<<m)-1));v.appendBits(s,m)}static appendBytes(s,l,h,v){switch(l){case rt.NUMERIC:hn.appendNumericBytes(s,h);break;case rt.ALPHANUMERIC:hn.appendAlphanumericBytes(s,h);break;case rt.BYTE:hn.append8BitBytes(s,h,v);break;case rt.KANJI:hn.appendKanjiBytes(s,h);break;default:throw new tn("Invalid mode: "+l)}}static getDigit(s){return s.charCodeAt(0)-48}static isDigit(s){const l=hn.getDigit(s);return l>=0&&l<=9}static appendNumericBytes(s,l){const h=s.length;let v=0;for(;v<h;){const m=hn.getDigit(s.charAt(v));if(v+2<h){const b=hn.getDigit(s.charAt(v+1)),E=hn.getDigit(s.charAt(v+2));l.appendBits(m*100+b*10+E,10),v+=3}else if(v+1<h){const b=hn.getDigit(s.charAt(v+1));l.appendBits(m*10+b,7),v+=2}else l.appendBits(m,4),v++}}static appendAlphanumericBytes(s,l){const h=s.length;let v=0;for(;v<h;){const m=hn.getAlphanumericCode(s.charCodeAt(v));if(m===-1)throw new tn;if(v+1<h){const b=hn.getAlphanumericCode(s.charCodeAt(v+1));if(b===-1)throw new tn;l.appendBits(m*45+b,11),v+=2}else l.appendBits(m,6),v++}}static append8BitBytes(s,l,h){let v;try{v=ie.encode(s,h)}catch(m){throw new tn(m)}for(let m=0,b=v.length;m!==b;m++){const E=v[m];l.appendBits(E,8)}}static appendKanjiBytes(s,l){let h;try{h=ie.encode(s,H.SJIS)}catch(m){throw new tn(m)}const v=h.length;for(let m=0;m<v;m+=2){const b=h[m]&255,E=h[m+1]&255,_=b<<8&4294967295|E;let I=-1;if(_>=33088&&_<=40956?I=_-33088:_>=57408&&_<=60351&&(I=_-49472),I===-1)throw new tn("Invalid byte sequence");const O=(I>>8)*192+(I&255);l.appendBits(O,13)}}static appendECI(s,l){l.appendBits(rt.ECI.getBits(),4),l.appendBits(s.getValue(),8)}}hn.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),hn.DEFAULT_BYTE_MODE_ENCODING=H.UTF8.getName();class Fi{write(s,l,h,v=null){if(s.length===0)throw new w("Found empty contents");if(l<0||h<0)throw new w("Requested dimensions are too small: "+l+"x"+h);let m=Zt.L,b=Fi.QUIET_ZONE_SIZE;v!==null&&(v.get(Vn.ERROR_CORRECTION)!==void 0&&(m=Zt.fromString(v.get(Vn.ERROR_CORRECTION).toString())),v.get(Vn.MARGIN)!==void 0&&(b=Number.parseInt(v.get(Vn.MARGIN).toString(),10)));const E=hn.encode(s,m,v);return this.renderResult(E,l,h,b)}writeToDom(s,l,h,v,m=null){typeof s=="string"&&(s=document.querySelector(s));const b=this.write(l,h,v,m);s&&s.appendChild(b)}renderResult(s,l,h,v){const m=s.getMatrix();if(m===null)throw new Bt;const b=m.getWidth(),E=m.getHeight(),_=b+v*2,I=E+v*2,O=Math.max(l,_),z=Math.max(h,I),V=Math.min(Math.floor(O/_),Math.floor(z/I)),Q=Math.floor((O-b*V)/2),ae=Math.floor((z-E*V)/2),se=this.createSVGElement(O,z);for(let de=0,be=ae;de<E;de++,be+=V)for(let Pe=0,Ue=Q;Pe<b;Pe++,Ue+=V)if(m.get(Pe,de)===1){const Fe=this.createSvgRectElement(Ue,be,V,V);se.appendChild(Fe)}return se}createSVGElement(s,l){const h=document.createElementNS(Fi.SVG_NS,"svg");return h.setAttributeNS(null,"height",s.toString()),h.setAttributeNS(null,"width",l.toString()),h}createSvgRectElement(s,l,h,v){const m=document.createElementNS(Fi.SVG_NS,"rect");return m.setAttributeNS(null,"x",s.toString()),m.setAttributeNS(null,"y",l.toString()),m.setAttributeNS(null,"height",h.toString()),m.setAttributeNS(null,"width",v.toString()),m.setAttributeNS(null,"fill","#000000"),m}}Fi.QUIET_ZONE_SIZE=4,Fi.SVG_NS="http://www.w3.org/2000/svg";class yo{encode(s,l,h,v,m){if(s.length===0)throw new w("Found empty contents");if(l!==Ie.QR_CODE)throw new w("Can only encode QR_CODE, but got "+l);if(h<0||v<0)throw new w(`Requested dimensions are too small: ${h}x${v}`);let b=Zt.L,E=yo.QUIET_ZONE_SIZE;m!==null&&(m.get(Vn.ERROR_CORRECTION)!==void 0&&(b=Zt.fromString(m.get(Vn.ERROR_CORRECTION).toString())),m.get(Vn.MARGIN)!==void 0&&(E=Number.parseInt(m.get(Vn.MARGIN).toString(),10)));const _=hn.encode(s,b,m);return yo.renderResult(_,h,v,E)}static renderResult(s,l,h,v){const m=s.getMatrix();if(m===null)throw new Bt;const b=m.getWidth(),E=m.getHeight(),_=b+v*2,I=E+v*2,O=Math.max(l,_),z=Math.max(h,I),V=Math.min(Math.floor(O/_),Math.floor(z/I)),Q=Math.floor((O-b*V)/2),ae=Math.floor((z-E*V)/2),se=new xe(O,z);for(let de=0,be=ae;de<E;de++,be+=V)for(let Pe=0,Ue=Q;Pe<b;Pe++,Ue+=V)m.get(Pe,de)===1&&se.setRegion(Ue,be,V,V);return se}}yo.QUIET_ZONE_SIZE=4;class id{encode(s,l,h,v,m){let b;switch(l){case Ie.QR_CODE:b=new yo;break;default:throw new w("No encoder available for format "+l)}return b.encode(s,l,h,v,m)}}class Ta extends he{constructor(s,l,h,v,m,b,E,_){if(super(b,E),this.yuvData=s,this.dataWidth=l,this.dataHeight=h,this.left=v,this.top=m,v+b>l||m+E>h)throw new w("Crop rectangle does not fit within image data.");_&&this.reverseHorizontal(b,E)}getRow(s,l){if(s<0||s>=this.getHeight())throw new w("Requested row is outside the image: "+s);const h=this.getWidth();(l==null||l.length<h)&&(l=new Uint8ClampedArray(h));const v=(s+this.top)*this.dataWidth+this.left;return N.arraycopy(this.yuvData,v,l,0,h),l}getMatrix(){const s=this.getWidth(),l=this.getHeight();if(s===this.dataWidth&&l===this.dataHeight)return this.yuvData;const h=s*l,v=new Uint8ClampedArray(h);let m=this.top*this.dataWidth+this.left;if(s===this.dataWidth)return N.arraycopy(this.yuvData,m,v,0,h),v;for(let b=0;b<l;b++){const E=b*s;N.arraycopy(this.yuvData,m,v,E,s),m+=this.dataWidth}return v}isCropSupported(){return!0}crop(s,l,h,v){return new Ta(this.yuvData,this.dataWidth,this.dataHeight,this.left+s,this.top+l,h,v,!1)}renderThumbnail(){const s=this.getWidth()/Ta.THUMBNAIL_SCALE_FACTOR,l=this.getHeight()/Ta.THUMBNAIL_SCALE_FACTOR,h=new Int32Array(s*l),v=this.yuvData;let m=this.top*this.dataWidth+this.left;for(let b=0;b<l;b++){const E=b*s;for(let _=0;_<s;_++){const I=v[m+_*Ta.THUMBNAIL_SCALE_FACTOR]&255;h[E+_]=4278190080|I*65793}m+=this.dataWidth*Ta.THUMBNAIL_SCALE_FACTOR}return h}getThumbnailWidth(){return this.getWidth()/Ta.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Ta.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(s,l){const h=this.yuvData;for(let v=0,m=this.top*this.dataWidth+this.left;v<l;v++,m+=this.dataWidth){const b=m+s/2;for(let E=m,_=m+s-1;E<b;E++,_--){const I=h[E];h[E]=h[_],h[_]=I}}}invert(){return new Se(this)}}Ta.THUMBNAIL_SCALE_FACTOR=2;class gs extends he{constructor(s,l,h,v,m,b,E){if(super(l,h),this.dataWidth=v,this.dataHeight=m,this.left=b,this.top=E,s.BYTES_PER_ELEMENT===4){const _=l*h,I=new Uint8ClampedArray(_);for(let O=0;O<_;O++){const z=s[O],V=z>>16&255,Q=z>>7&510,ae=z&255;I[O]=(V+Q+ae)/4&255}this.luminances=I}else this.luminances=s;if(v===void 0&&(this.dataWidth=l),m===void 0&&(this.dataHeight=h),b===void 0&&(this.left=0),E===void 0&&(this.top=0),this.left+l>this.dataWidth||this.top+h>this.dataHeight)throw new w("Crop rectangle does not fit within image data.")}getRow(s,l){if(s<0||s>=this.getHeight())throw new w("Requested row is outside the image: "+s);const h=this.getWidth();(l==null||l.length<h)&&(l=new Uint8ClampedArray(h));const v=(s+this.top)*this.dataWidth+this.left;return N.arraycopy(this.luminances,v,l,0,h),l}getMatrix(){const s=this.getWidth(),l=this.getHeight();if(s===this.dataWidth&&l===this.dataHeight)return this.luminances;const h=s*l,v=new Uint8ClampedArray(h);let m=this.top*this.dataWidth+this.left;if(s===this.dataWidth)return N.arraycopy(this.luminances,m,v,0,h),v;for(let b=0;b<l;b++){const E=b*s;N.arraycopy(this.luminances,m,v,E,s),m+=this.dataWidth}return v}isCropSupported(){return!0}crop(s,l,h,v){return new gs(this.luminances,h,v,this.dataWidth,this.dataHeight,this.left+s,this.top+l)}invert(){return new Se(this)}}class bo extends H{static forName(s){return this.getCharacterSetECIByName(s)}}class fl{}fl.ISO_8859_1=H.ISO8859_1;class hl{isCompact(){return this.compact}setCompact(s){this.compact=s}getSize(){return this.size}setSize(s){this.size=s}getLayers(){return this.layers}setLayers(s){this.layers=s}getCodeWords(){return this.codeWords}setCodeWords(s){this.codeWords=s}getMatrix(){return this.matrix}setMatrix(s){this.matrix=s}}class dl{static singletonList(s){return[s]}static min(s,l){return s.sort(l)[0]}}class Uc{constructor(s){this.previous=s}getPrevious(){return this.previous}}class Pi extends Uc{constructor(s,l,h){super(s),this.value=l,this.bitCount=h}appendTo(s,l){s.appendBits(this.value,this.bitCount)}add(s,l){return new Pi(this,s,l)}addBinaryShift(s,l){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Pi(this,s,l)}toString(){let s=this.value&(1<<this.bitCount)-1;return s|=1<<this.bitCount,"<"+k.toBinaryString(s|1<<this.bitCount).substring(1)+">"}}class au extends Pi{constructor(s,l,h){super(s,0,0),this.binaryShiftStart=l,this.binaryShiftByteCount=h}appendTo(s,l){for(let h=0;h<this.binaryShiftByteCount;h++)(h===0||h===31&&this.binaryShiftByteCount<=62)&&(s.appendBits(31,5),this.binaryShiftByteCount>62?s.appendBits(this.binaryShiftByteCount-31,16):h===0?s.appendBits(Math.min(this.binaryShiftByteCount,31),5):s.appendBits(this.binaryShiftByteCount-31,5)),s.appendBits(l[this.binaryShiftStart+h],8)}addBinaryShift(s,l){return new au(this,s,l)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function wo(U,s,l){return new au(U,s,l)}function vs(U,s,l){return new Pi(U,s,l)}const od=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],li=0,ms=1,jr=2,Eo=3,Nr=4,sd=new Pi(null,0,0),Co=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function zc(U){for(let s of U)B.fill(s,-1);return U[li][Nr]=0,U[ms][Nr]=0,U[ms][li]=28,U[Eo][Nr]=0,U[jr][Nr]=0,U[jr][li]=15,U}const pl=zc(B.createInt32Array(6,6));class Zr{constructor(s,l,h,v){this.token=s,this.mode=l,this.binaryShiftByteCount=h,this.bitCount=v}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(s,l){let h=this.bitCount,v=this.token;if(s!==this.mode){let b=Co[this.mode][s];v=vs(v,b&65535,b>>16),h+=b>>16}let m=s===jr?4:5;return v=vs(v,l,m),new Zr(v,s,0,h+m)}shiftAndAppend(s,l){let h=this.token,v=this.mode===jr?4:5;return h=vs(h,pl[this.mode][s],v),h=vs(h,l,5),new Zr(h,this.mode,0,this.bitCount+v+5)}addBinaryShiftChar(s){let l=this.token,h=this.mode,v=this.bitCount;if(this.mode===Nr||this.mode===jr){let E=Co[h][li];l=vs(l,E&65535,E>>16),v+=E>>16,h=li}let m=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,b=new Zr(l,h,this.binaryShiftByteCount+1,v+m);return b.binaryShiftByteCount===2078&&(b=b.endBinaryShift(s+1)),b}endBinaryShift(s){if(this.binaryShiftByteCount===0)return this;let l=this.token;return l=wo(l,s-this.binaryShiftByteCount,this.binaryShiftByteCount),new Zr(l,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(s){let l=this.bitCount+(Co[this.mode][s.mode]>>16);return this.binaryShiftByteCount<s.binaryShiftByteCount?l+=Zr.calculateBinaryShiftCost(s)-Zr.calculateBinaryShiftCost(this):this.binaryShiftByteCount>s.binaryShiftByteCount&&s.binaryShiftByteCount>0&&(l+=10),l<=s.bitCount}toBitArray(s){let l=[];for(let v=this.endBinaryShift(s.length).token;v!==null;v=v.getPrevious())l.unshift(v);let h=new L;for(const v of l)v.appendTo(h,s);return h}toString(){return ee.format("%s bits=%d bytes=%d",od[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(s){return s.binaryShiftByteCount>62?21:s.binaryShiftByteCount>31?20:s.binaryShiftByteCount>0?10:0}}Zr.INITIAL_STATE=new Zr(sd,li,0,0);function gl(U){const s=ee.getCharCode(" "),l=ee.getCharCode("."),h=ee.getCharCode(",");U[li][s]=1;const v=ee.getCharCode("Z"),m=ee.getCharCode("A");for(let V=m;V<=v;V++)U[li][V]=V-m+2;U[ms][s]=1;const b=ee.getCharCode("z"),E=ee.getCharCode("a");for(let V=E;V<=b;V++)U[ms][V]=V-E+2;U[jr][s]=1;const _=ee.getCharCode("9"),I=ee.getCharCode("0");for(let V=I;V<=_;V++)U[jr][V]=V-I+2;U[jr][h]=12,U[jr][l]=13;const O=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let V=0;V<O.length;V++)U[Eo][ee.getCharCode(O[V])]=V;const z=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let V=0;V<z.length;V++)ee.getCharCode(z[V])>0&&(U[Nr][ee.getCharCode(z[V])]=V);return U}const iu=gl(B.createInt32Array(5,256));class Ao{constructor(s){this.text=s}encode(){const s=ee.getCharCode(" "),l=ee.getCharCode(`
`);let h=dl.singletonList(Zr.INITIAL_STATE);for(let m=0;m<this.text.length;m++){let b,E=m+1<this.text.length?this.text[m+1]:0;switch(this.text[m]){case ee.getCharCode("\r"):b=E===l?2:0;break;case ee.getCharCode("."):b=E===s?3:0;break;case ee.getCharCode(","):b=E===s?4:0;break;case ee.getCharCode(":"):b=E===s?5:0;break;default:b=0}b>0?(h=Ao.updateStateListForPair(h,m,b),m++):h=this.updateStateListForChar(h,m)}return dl.min(h,(m,b)=>m.getBitCount()-b.getBitCount()).toBitArray(this.text)}updateStateListForChar(s,l){const h=[];for(let v of s)this.updateStateForChar(v,l,h);return Ao.simplifyStates(h)}updateStateForChar(s,l,h){let v=this.text[l]&255,m=iu[s.getMode()][v]>0,b=null;for(let E=0;E<=Nr;E++){let _=iu[E][v];if(_>0){if(b==null&&(b=s.endBinaryShift(l)),!m||E===s.getMode()||E===jr){const I=b.latchAndAppend(E,_);h.push(I)}if(!m&&pl[s.getMode()][E]>=0){const I=b.shiftAndAppend(E,_);h.push(I)}}}if(s.getBinaryShiftByteCount()>0||iu[s.getMode()][v]===0){let E=s.addBinaryShiftChar(l);h.push(E)}}static updateStateListForPair(s,l,h){const v=[];for(let m of s)this.updateStateForPair(m,l,h,v);return this.simplifyStates(v)}static updateStateForPair(s,l,h,v){let m=s.endBinaryShift(l);if(v.push(m.latchAndAppend(Nr,h)),s.getMode()!==Nr&&v.push(m.shiftAndAppend(Nr,h)),h===3||h===4){let b=m.latchAndAppend(jr,16-h).latchAndAppend(jr,1);v.push(b)}if(s.getBinaryShiftByteCount()>0){let b=s.addBinaryShiftChar(l).addBinaryShiftChar(l+1);v.push(b)}}static simplifyStates(s){let l=[];for(const h of s){let v=!0;for(const m of l){if(m.isBetterThanOrEqualTo(h)){v=!1;break}h.isBetterThanOrEqualTo(m)&&(l=l.filter(b=>b!==m))}v&&l.push(h)}return l}}class kt{constructor(){}static encodeBytes(s){return kt.encode(s,kt.DEFAULT_EC_PERCENT,kt.DEFAULT_AZTEC_LAYERS)}static encode(s,l,h){let v=new Ao(s).encode(),m=k.truncDivision(v.getSize()*l,100)+11,b=v.getSize()+m,E,_,I,O,z;if(h!==kt.DEFAULT_AZTEC_LAYERS){if(E=h<0,_=Math.abs(h),_>(E?kt.MAX_NB_BITS_COMPACT:kt.MAX_NB_BITS))throw new w(ee.format("Illegal value %s for layers",h));I=kt.totalBitsInLayer(_,E),O=kt.WORD_SIZE[_];let Fe=I-I%O;if(z=kt.stuffBits(v,O),z.getSize()+m>Fe)throw new w("Data to large for user specified layer");if(E&&z.getSize()>O*64)throw new w("Data to large for user specified layer")}else{O=0,z=null;for(let Fe=0;;Fe++){if(Fe>kt.MAX_NB_BITS)throw new w("Data too large for an Aztec code");if(E=Fe<=3,_=E?Fe+1:Fe,I=kt.totalBitsInLayer(_,E),b>I)continue;(z==null||O!==kt.WORD_SIZE[_])&&(O=kt.WORD_SIZE[_],z=kt.stuffBits(v,O));let xt=I-I%O;if(!(E&&z.getSize()>O*64)&&z.getSize()+m<=xt)break}}let V=kt.generateCheckWords(z,I,O),Q=z.getSize()/O,ae=kt.generateModeMessage(E,_,Q),se=(E?11:14)+_*4,de=new Int32Array(se),be;if(E){be=se;for(let Fe=0;Fe<de.length;Fe++)de[Fe]=Fe}else{be=se+1+2*k.truncDivision(k.truncDivision(se,2)-1,15);let Fe=k.truncDivision(se,2),xt=k.truncDivision(be,2);for(let gt=0;gt<Fe;gt++){let wr=gt+k.truncDivision(gt,15);de[Fe-gt-1]=xt-wr-1,de[Fe+gt]=xt+wr+1}}let Pe=new xe(be);for(let Fe=0,xt=0;Fe<_;Fe++){let gt=(_-Fe)*4+(E?9:12);for(let wr=0;wr<gt;wr++){let Qr=wr*2;for(let Dr=0;Dr<2;Dr++)V.get(xt+Qr+Dr)&&Pe.set(de[Fe*2+Dr],de[Fe*2+wr]),V.get(xt+gt*2+Qr+Dr)&&Pe.set(de[Fe*2+wr],de[se-1-Fe*2-Dr]),V.get(xt+gt*4+Qr+Dr)&&Pe.set(de[se-1-Fe*2-Dr],de[se-1-Fe*2-wr]),V.get(xt+gt*6+Qr+Dr)&&Pe.set(de[se-1-Fe*2-wr],de[Fe*2+Dr])}xt+=gt*8}if(kt.drawModeMessage(Pe,E,be,ae),E)kt.drawBullsEye(Pe,k.truncDivision(be,2),5);else{kt.drawBullsEye(Pe,k.truncDivision(be,2),7);for(let Fe=0,xt=0;Fe<k.truncDivision(se,2)-1;Fe+=15,xt+=16)for(let gt=k.truncDivision(be,2)&1;gt<be;gt+=2)Pe.set(k.truncDivision(be,2)-xt,gt),Pe.set(k.truncDivision(be,2)+xt,gt),Pe.set(gt,k.truncDivision(be,2)-xt),Pe.set(gt,k.truncDivision(be,2)+xt)}let Ue=new hl;return Ue.setCompact(E),Ue.setSize(be),Ue.setLayers(_),Ue.setCodeWords(Q),Ue.setMatrix(Pe),Ue}static drawBullsEye(s,l,h){for(let v=0;v<h;v+=2)for(let m=l-v;m<=l+v;m++)s.set(m,l-v),s.set(m,l+v),s.set(l-v,m),s.set(l+v,m);s.set(l-h,l-h),s.set(l-h+1,l-h),s.set(l-h,l-h+1),s.set(l+h,l-h),s.set(l+h,l-h+1),s.set(l+h,l+h-1)}static generateModeMessage(s,l,h){let v=new L;return s?(v.appendBits(l-1,2),v.appendBits(h-1,6),v=kt.generateCheckWords(v,28,4)):(v.appendBits(l-1,5),v.appendBits(h-1,11),v=kt.generateCheckWords(v,40,4)),v}static drawModeMessage(s,l,h,v){let m=k.truncDivision(h,2);if(l)for(let b=0;b<7;b++){let E=m-3+b;v.get(b)&&s.set(E,m-5),v.get(b+7)&&s.set(m+5,E),v.get(20-b)&&s.set(E,m+5),v.get(27-b)&&s.set(m-5,E)}else for(let b=0;b<10;b++){let E=m-5+b+k.truncDivision(b,5);v.get(b)&&s.set(E,m-7),v.get(b+10)&&s.set(m+7,E),v.get(29-b)&&s.set(E,m+7),v.get(39-b)&&s.set(m-7,E)}}static generateCheckWords(s,l,h){let v=s.getSize()/h,m=new cl(kt.getGF(h)),b=k.truncDivision(l,h),E=kt.bitsToWords(s,h,b);m.encode(E,b-v);let _=l%h,I=new L;I.appendBits(0,_);for(const O of Array.from(E))I.appendBits(O,h);return I}static bitsToWords(s,l,h){let v=new Int32Array(h),m,b;for(m=0,b=s.getSize()/l;m<b;m++){let E=0;for(let _=0;_<l;_++)E|=s.get(m*l+_)?1<<l-_-1:0;v[m]=E}return v}static getGF(s){switch(s){case 4:return Ye.AZTEC_PARAM;case 6:return Ye.AZTEC_DATA_6;case 8:return Ye.AZTEC_DATA_8;case 10:return Ye.AZTEC_DATA_10;case 12:return Ye.AZTEC_DATA_12;default:throw new w("Unsupported word size "+s)}}static stuffBits(s,l){let h=new L,v=s.getSize(),m=(1<<l)-2;for(let b=0;b<v;b+=l){let E=0;for(let _=0;_<l;_++)(b+_>=v||s.get(b+_))&&(E|=1<<l-1-_);(E&m)===m?(h.appendBits(E&m,l),b--):(E&m)===0?(h.appendBits(E|1,l),b--):h.appendBits(E,l)}return h}static totalBitsInLayer(s,l){return((l?88:112)+16*s)*s}}kt.DEFAULT_EC_PERCENT=33,kt.DEFAULT_AZTEC_LAYERS=0,kt.MAX_NB_BITS=32,kt.MAX_NB_BITS_COMPACT=4,kt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class ou{encode(s,l,h,v){return this.encodeWithHints(s,l,h,v,null)}encodeWithHints(s,l,h,v,m){let b=fl.ISO_8859_1,E=kt.DEFAULT_EC_PERCENT,_=kt.DEFAULT_AZTEC_LAYERS;return m!=null&&(m.has(Vn.CHARACTER_SET)&&(b=bo.forName(m.get(Vn.CHARACTER_SET).toString())),m.has(Vn.ERROR_CORRECTION)&&(E=k.parseInt(m.get(Vn.ERROR_CORRECTION).toString())),m.has(Vn.AZTEC_LAYERS)&&(_=k.parseInt(m.get(Vn.AZTEC_LAYERS).toString()))),ou.encodeLayers(s,l,h,v,b,E,_)}static encodeLayers(s,l,h,v,m,b,E){if(l!==Ie.AZTEC)throw new w("Can only encode AZTEC, but got "+l);let _=kt.encode(ee.getBytes(s,m),b,E);return ou.renderResult(_,h,v)}static renderResult(s,l,h){let v=s.getMatrix();if(v==null)throw new Bt;let m=v.getWidth(),b=v.getHeight(),E=Math.max(l,m),_=Math.max(h,b),I=Math.min(E/m,_/b),O=(E-m*I)/2,z=(_-b*I)/2,V=new xe(E,_);for(let Q=0,ae=z;Q<b;Q++,ae+=I)for(let se=0,de=O;se<m;se++,de+=I)v.get(se,Q)&&V.setRegion(de,ae,I,I);return V}}e.AbstractExpandedDecoder=us,e.ArgumentException=x,e.ArithmeticException=Rt,e.AztecCode=hl,e.AztecCodeReader=ho,e.AztecCodeWriter=ou,e.AztecDecoder=At,e.AztecDetector=Xs,e.AztecDetectorResult=Vr,e.AztecEncoder=kt,e.AztecHighLevelEncoder=Ao,e.AztecPoint=Ht,e.BarcodeFormat=Ie,e.Binarizer=R,e.BinaryBitmap=C,e.BitArray=L,e.BitMatrix=xe,e.BitSource=Ir,e.BrowserAztecCodeReader=al,e.BrowserBarcodeReader=Bc,e.BrowserCodeReader=Te,e.BrowserDatamatrixCodeReader=Qh,e.BrowserMultiFormatReader=td,e.BrowserPDF417Reader=nd,e.BrowserQRCodeReader=rd,e.BrowserQRCodeSvgWriter=Fi,e.CharacterSetECI=H,e.ChecksumException=S,e.Code128Reader=ze,e.Code39Reader=Yt,e.DataMatrixDecodedBitStreamParser=ti,e.DataMatrixReader=ua,e.DecodeHintType=W,e.DecoderResult=ht,e.DefaultGridSampler=Cn,e.DetectorResult=Hr,e.EAN13Reader=oa,e.EncodeHintType=Vn,e.Exception=d,e.FormatException=G,e.GenericGF=Ye,e.GenericGFPoly=it,e.GlobalHistogramBinarizer=te,e.GridSampler=Wr,e.GridSamplerInstance=sn,e.HTMLCanvasElementLuminanceSource=Y,e.HybridBinarizer=re,e.ITFReader=Vt,e.IllegalArgumentException=w,e.IllegalStateException=Bt,e.InvertedLuminanceSource=Se,e.LuminanceSource=he,e.MathUtils=ct,e.MultiFormatOneDReader=ei,e.MultiFormatReader=Pc,e.MultiFormatWriter=id,e.NotFoundException=$,e.OneDReader=$t,e.PDF417DecodedBitStreamParser=Ce,e.PDF417DecoderErrorCorrection=fs,e.PDF417Reader=tr,e.PDF417ResultMetadata=tu,e.PerspectiveTransform=Pn,e.PlanarYUVLuminanceSource=Ta,e.QRCodeByteMatrix=ps,e.QRCodeDataMask=er,e.QRCodeDecodedBitStreamParser=mn,e.QRCodeDecoderErrorCorrectionLevel=Zt,e.QRCodeDecoderFormatInformation=$n,e.QRCodeEncoder=hn,e.QRCodeEncoderQRCode=Li,e.QRCodeMaskUtil=wn,e.QRCodeMatrixUtil=st,e.QRCodeMode=rt,e.QRCodeReader=Ha,e.QRCodeVersion=nt,e.QRCodeWriter=yo,e.RGBLuminanceSource=gs,e.RSS14Reader=Wt,e.RSSExpandedReader=Be,e.ReaderException=hs,e.ReedSolomonDecoder=Xt,e.ReedSolomonEncoder=cl,e.ReedSolomonException=zt,e.Result=Le,e.ResultMetadataType=He,e.ResultPoint=We,e.StringUtils=ee,e.UnsupportedOperationException=Z,e.VideoInputDevice=fe,e.WhiteRectangleDetector=fr,e.WriterException=tn,e.ZXingArrays=B,e.ZXingCharset=bo,e.ZXingInteger=k,e.ZXingStandardCharsets=fl,e.ZXingStringBuilder=me,e.ZXingStringEncoding=ie,e.ZXingSystem=N,e.createAbstractExpandedDecoder=sl,Object.defineProperty(e,"__esModule",{value:!0})}))})(oc,oc.exports)),oc.exports}var xn=A3();const S3=zE(xn),_3=UE({__proto__:null,default:S3},[xn]);var C2=(function(){function r(t,e,n){if(this.formatMap=new Map([[qe.QR_CODE,xn.BarcodeFormat.QR_CODE],[qe.AZTEC,xn.BarcodeFormat.AZTEC],[qe.CODABAR,xn.BarcodeFormat.CODABAR],[qe.CODE_39,xn.BarcodeFormat.CODE_39],[qe.CODE_93,xn.BarcodeFormat.CODE_93],[qe.CODE_128,xn.BarcodeFormat.CODE_128],[qe.DATA_MATRIX,xn.BarcodeFormat.DATA_MATRIX],[qe.MAXICODE,xn.BarcodeFormat.MAXICODE],[qe.ITF,xn.BarcodeFormat.ITF],[qe.EAN_13,xn.BarcodeFormat.EAN_13],[qe.EAN_8,xn.BarcodeFormat.EAN_8],[qe.PDF_417,xn.BarcodeFormat.PDF_417],[qe.RSS_14,xn.BarcodeFormat.RSS_14],[qe.RSS_EXPANDED,xn.BarcodeFormat.RSS_EXPANDED],[qe.UPC_A,xn.BarcodeFormat.UPC_A],[qe.UPC_E,xn.BarcodeFormat.UPC_E],[qe.UPC_EAN_EXTENSION,xn.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!_3)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=e,this.logger=n;var a=this.createZXingFormats(t),i=new Map;i.set(xn.DecodeHintType.POSSIBLE_FORMATS,a),i.set(xn.DecodeHintType.TRY_HARDER,!1),this.hints=i}return r.prototype.decodeAsync=function(t){var e=this;return new Promise(function(n,a){try{n(e.decode(t))}catch(i){a(i)}})},r.prototype.decode=function(t){var e=new xn.MultiFormatReader(this.verbose,this.hints),n=new xn.HTMLCanvasElementLuminanceSource(t),a=new xn.BinaryBitmap(new xn.HybridBinarizer(n)),i=e.decode(a);return{text:i.text,format:Jx.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}},r.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(e,n,a){t.set(e,n)}),t},r.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},r.prototype.createZXingFormats=function(t){for(var e=[],n=0,a=t;n<a.length;n++){var i=a[n];this.formatMap.has(i)?e.push(this.formatMap.get(i)):this.logger.logError("".concat(i," is not supported by")+"ZXingHtml5QrcodeShim")}return e},r.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},r})(),T3=function(r,t,e,n){function a(i){return i instanceof e?i:new e(function(c){c(i)})}return new(e||(e=Promise))(function(i,c){function f(x){try{d(n.next(x))}catch(w){c(w)}}function p(x){try{d(n.throw(x))}catch(w){c(w)}}function d(x){x.done?i(x.value):a(x.value).then(f,p)}d((n=n.apply(r,t||[])).next())})},I3=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(d){return function(x){return p([d,x])}}function p(d){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,d[0]&&(e=0)),e;)try{if(n=1,a&&(i=d[0]&2?a.return:d[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,d[1])).done)return i;switch(a=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,a=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){e.label=d[1];break}if(d[0]===6&&e.label<i[1]){e.label=i[1],i=d;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(d);break}i[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(r,e)}catch(x){d=[6,x],a=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},A2=(function(){function r(t,e,n){if(this.formatMap=new Map([[qe.QR_CODE,"qr_code"],[qe.AZTEC,"aztec"],[qe.CODABAR,"codabar"],[qe.CODE_39,"code_39"],[qe.CODE_93,"code_93"],[qe.CODE_128,"code_128"],[qe.DATA_MATRIX,"data_matrix"],[qe.ITF,"itf"],[qe.EAN_13,"ean_13"],[qe.EAN_8,"ean_8"],[qe.PDF_417,"pdf417"],[qe.UPC_A,"upc_a"],[qe.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!r.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=e,this.logger=n;var a=this.createBarcodeDetectorFormats(t);if(this.detector=new BarcodeDetector(a),!this.detector)throw"BarcodeDetector detector not supported"}return r.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var t=new BarcodeDetector({formats:["qr_code"]});return typeof t<"u"},r.prototype.decodeAsync=function(t){return T3(this,void 0,void 0,function(){var e,n;return I3(this,function(a){switch(a.label){case 0:return[4,this.detector.detect(t)];case 1:if(e=a.sent(),!e||e.length===0)throw"No barcode or QR code detected.";return n=this.selectLargestBarcode(e),[2,{text:n.rawValue,format:Jx.create(this.toHtml5QrcodeSupportedFormats(n.format)),debugData:this.createDebugData()}]}})})},r.prototype.selectLargestBarcode=function(t){for(var e=null,n=0,a=0,i=t;a<i.length;a++){var c=i[a],f=c.boundingBox.width*c.boundingBox.height;f>n&&(n=f,e=c)}if(!e)throw"No largest barcode found";return e},r.prototype.createBarcodeDetectorFormats=function(t){for(var e=[],n=0,a=t;n<a.length;n++){var i=a[n];this.formatMap.has(i)?e.push(this.formatMap.get(i)):this.logger.warn("".concat(i," is not supported by")+"BarcodeDetectorDelegate")}return{formats:e}},r.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},r.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(e,n,a){t.set(e,n)}),t},r.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},r})(),S2=function(r,t,e,n){function a(i){return i instanceof e?i:new e(function(c){c(i)})}return new(e||(e=Promise))(function(i,c){function f(x){try{d(n.next(x))}catch(w){c(w)}}function p(x){try{d(n.throw(x))}catch(w){c(w)}}function d(x){x.done?i(x.value):a(x.value).then(f,p)}d((n=n.apply(r,t||[])).next())})},_2=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(d){return function(x){return p([d,x])}}function p(d){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,d[0]&&(e=0)),e;)try{if(n=1,a&&(i=d[0]&2?a.return:d[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,d[1])).done)return i;switch(a=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,a=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){e.label=d[1];break}if(d[0]===6&&e.label<i[1]){e.label=i[1],i=d;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(d);break}i[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(r,e)}catch(x){d=[6,x],a=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},R3=(function(){function r(t,e,n,a){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=n,e&&A2.isSupported()?(this.primaryDecoder=new A2(t,n,a),this.secondaryDecoder=new C2(t,n,a)):this.primaryDecoder=new C2(t,n,a)}return r.prototype.decodeAsync=function(t){return S2(this,void 0,void 0,function(){var e;return _2(this,function(n){switch(n.label){case 0:e=performance.now(),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(t)];case 2:return[2,n.sent()];case 3:return this.possiblyLogPerformance(e),[7];case 4:return[2]}})})},r.prototype.decodeRobustlyAsync=function(t){return S2(this,void 0,void 0,function(){var e,n;return _2(this,function(a){switch(a.label){case 0:e=performance.now(),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(t)];case 2:return[2,a.sent()];case 3:if(n=a.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(t)];throw n;case 4:return this.possiblyLogPerformance(e),[7];case 5:return[2]}})})},r.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},r.prototype.possiblyLogPerformance=function(t){if(this.verbose){var e=performance.now()-t;this.executionResults.push(e),this.executions++,this.possiblyFlushPerformanceReport()}},r.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var t=0,e=0,n=this.executionResults;e<n.length;e++){var a=n[e];t+=a}var i=t/this.executionResults.length;console.log("".concat(i," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},r})(),i1=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),uh=function(r,t,e,n){function a(i){return i instanceof e?i:new e(function(c){c(i)})}return new(e||(e=Promise))(function(i,c){function f(x){try{d(n.next(x))}catch(w){c(w)}}function p(x){try{d(n.throw(x))}catch(w){c(w)}}function d(x){x.done?i(x.value):a(x.value).then(f,p)}d((n=n.apply(r,t||[])).next())})},lh=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(d){return function(x){return p([d,x])}}function p(d){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,d[0]&&(e=0)),e;)try{if(n=1,a&&(i=d[0]&2?a.return:d[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,d[1])).done)return i;switch(a=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,a=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){e.label=d[1];break}if(d[0]===6&&e.label<i[1]){e.label=i[1],i=d;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(d);break}i[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(r,e)}catch(x){d=[6,x],a=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},ny=(function(){function r(t,e){this.name=t,this.track=e}return r.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},r.prototype.apply=function(t){var e={};e[this.name]=t;var n={advanced:[e]};return this.track.applyConstraints(n)},r.prototype.value=function(){var t=this.track.getSettings();if(this.name in t){var e=t[this.name];return e}return null},r})(),N3=(function(r){i1(t,r);function t(e,n){return r.call(this,e,n)||this}return t.prototype.min=function(){return this.getCapabilities().min},t.prototype.max=function(){return this.getCapabilities().max},t.prototype.step=function(){return this.getCapabilities().step},t.prototype.apply=function(e){var n={};n[this.name]=e;var a={advanced:[n]};return this.track.applyConstraints(a)},t.prototype.getCapabilities=function(){this.failIfNotSupported();var e=this.track.getCapabilities(),n=e[this.name];return{min:n.min,max:n.max,step:n.step}},t.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},t})(ny),D3=(function(r){i1(t,r);function t(e){return r.call(this,"zoom",e)||this}return t})(N3),M3=(function(r){i1(t,r);function t(e){return r.call(this,"torch",e)||this}return t})(ny),O3=(function(){function r(t){this.track=t}return r.prototype.zoomFeature=function(){return new D3(this.track)},r.prototype.torchFeature=function(){return new M3(this.track)},r})(),B3=(function(){function r(t,e,n){this.isClosed=!1,this.parentElement=t,this.mediaStream=e,this.callbacks=n,this.surface=this.createVideoElement(this.parentElement.clientWidth),t.append(this.surface)}return r.prototype.createVideoElement=function(t){var e=document.createElement("video");return e.style.width="".concat(t,"px"),e.style.display="block",e.muted=!0,e.setAttribute("muted","true"),e.playsInline=!0,e},r.prototype.setupSurface=function(){var t=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var e=function(){var n=t.surface.clientWidth,a=t.surface.clientHeight;t.callbacks.onRenderSurfaceReady(n,a),t.surface.removeEventListener("playing",e)};this.surface.addEventListener("playing",e),this.surface.srcObject=this.mediaStream,this.surface.play()},r.create=function(t,e,n,a){return uh(this,void 0,void 0,function(){var i,c;return lh(this,function(f){switch(f.label){case 0:return i=new r(t,e,a),n.aspectRatio?(c={aspectRatio:n.aspectRatio},[4,i.getFirstTrackOrFail().applyConstraints(c)]):[3,2];case 1:f.sent(),f.label=2;case 2:return i.setupSurface(),[2,i]}})})},r.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},r.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},r.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},r.prototype.resume=function(t){this.failIfClosed();var e=this,n=function(){setTimeout(t,200),e.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.play()},r.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},r.prototype.getSurface=function(){return this.failIfClosed(),this.surface},r.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},r.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},r.prototype.applyVideoConstraints=function(t){return uh(this,void 0,void 0,function(){return lh(this,function(e){if("aspectRatio"in t)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(t)]})})},r.prototype.close=function(){if(this.isClosed)return Promise.resolve();var t=this;return new Promise(function(e,n){var a=t.mediaStream.getVideoTracks(),i=a.length,c=0;t.mediaStream.getVideoTracks().forEach(function(f){t.mediaStream.removeTrack(f),f.stop(),++c,c>=i&&(t.isClosed=!0,t.parentElement.removeChild(t.surface),e())})})},r.prototype.getCapabilities=function(){return new O3(this.getFirstTrackOrFail())},r})(),k3=(function(){function r(t){this.mediaStream=t}return r.prototype.render=function(t,e,n){return uh(this,void 0,void 0,function(){return lh(this,function(a){return[2,B3.create(t,this.mediaStream,e,n)]})})},r.create=function(t){return uh(this,void 0,void 0,function(){var e,n;return lh(this,function(a){switch(a.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return e={audio:!1,video:t},[4,navigator.mediaDevices.getUserMedia(e)];case 1:return n=a.sent(),[2,new r(n)]}})})},r})(),T2=function(r,t,e,n){function a(i){return i instanceof e?i:new e(function(c){c(i)})}return new(e||(e=Promise))(function(i,c){function f(x){try{d(n.next(x))}catch(w){c(w)}}function p(x){try{d(n.throw(x))}catch(w){c(w)}}function d(x){x.done?i(x.value):a(x.value).then(f,p)}d((n=n.apply(r,t||[])).next())})},I2=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(d){return function(x){return p([d,x])}}function p(d){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,d[0]&&(e=0)),e;)try{if(n=1,a&&(i=d[0]&2?a.return:d[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,d[1])).done)return i;switch(a=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,a=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){e.label=d[1];break}if(d[0]===6&&e.label<i[1]){e.label=i[1],i=d;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(d);break}i[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(r,e)}catch(x){d=[6,x],a=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},L3=(function(){function r(){}return r.failIfNotSupported=function(){return T2(this,void 0,void 0,function(){return I2(this,function(t){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new r]})})},r.prototype.create=function(t){return T2(this,void 0,void 0,function(){return I2(this,function(e){return[2,k3.create(t)]})})},r})(),F3=function(r,t,e,n){function a(i){return i instanceof e?i:new e(function(c){c(i)})}return new(e||(e=Promise))(function(i,c){function f(x){try{d(n.next(x))}catch(w){c(w)}}function p(x){try{d(n.throw(x))}catch(w){c(w)}}function d(x){x.done?i(x.value):a(x.value).then(f,p)}d((n=n.apply(r,t||[])).next())})},P3=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(d){return function(x){return p([d,x])}}function p(d){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,d[0]&&(e=0)),e;)try{if(n=1,a&&(i=d[0]&2?a.return:d[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,d[1])).done)return i;switch(a=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,a=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){e.label=d[1];break}if(d[0]===6&&e.label<i[1]){e.label=i[1],i=d;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(d);break}i[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(r,e)}catch(x){d=[6,x],a=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},U3=(function(){function r(){}return r.retrieve=function(){if(navigator.mediaDevices)return r.getCamerasFromMediaDevices();var t=MediaStreamTrack;return MediaStreamTrack&&t.getSources?r.getCamerasFromMediaStreamTrack():r.rejectWithError()},r.rejectWithError=function(){var t=Hu.unableToQuerySupportedDevices();return r.isHttpsOrLocalhost()||(t=Hu.insecureContextCameraQueryError()),Promise.reject(t)},r.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var t=location.host.split(":")[0];return t==="127.0.0.1"||t==="localhost"},r.getCamerasFromMediaDevices=function(){return F3(this,void 0,void 0,function(){var t,e,n,a,i,c,f;return P3(this,function(p){switch(p.label){case 0:return t=function(d){for(var x=d.getVideoTracks(),w=0,C=x;w<C.length;w++){var S=C[w];S.enabled=!1,S.stop(),d.removeTrack(S)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return e=p.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(n=p.sent(),a=[],i=0,c=n;i<c.length;i++)f=c[i],f.kind==="videoinput"&&a.push({id:f.deviceId,label:f.label});return t(e),[2,a]}})})},r.getCamerasFromMediaStreamTrack=function(){return new Promise(function(t,e){var n=function(i){for(var c=[],f=0,p=i;f<p.length;f++){var d=p[f];d.kind==="video"&&c.push({id:d.id,label:d.label})}t(c)},a=MediaStreamTrack;a.getSources(n)})},r})(),Ln;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.NOT_STARTED=1]="NOT_STARTED",r[r.SCANNING=2]="SCANNING",r[r.PAUSED=3]="PAUSED"})(Ln||(Ln={}));var z3=(function(){function r(){this.state=Ln.NOT_STARTED,this.onGoingTransactionNewState=Ln.UNKNOWN}return r.prototype.directTransition=function(t){this.failIfTransitionOngoing(),this.validateTransition(t),this.state=t},r.prototype.startTransition=function(t){return this.failIfTransitionOngoing(),this.validateTransition(t),this.onGoingTransactionNewState=t,this},r.prototype.execute=function(){if(this.onGoingTransactionNewState===Ln.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var t=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Ln.UNKNOWN,this.directTransition(t)},r.prototype.cancel=function(){if(this.onGoingTransactionNewState===Ln.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Ln.UNKNOWN},r.prototype.getState=function(){return this.state},r.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Ln.UNKNOWN)throw"Cannot transition to a new state, already under transition"},r.prototype.validateTransition=function(t){switch(this.state){case Ln.UNKNOWN:throw"Transition from unknown is not allowed";case Ln.NOT_STARTED:this.failIfNewStateIs(t,[Ln.PAUSED]);break;case Ln.SCANNING:break;case Ln.PAUSED:break}},r.prototype.failIfNewStateIs=function(t,e){for(var n=0,a=e;n<a.length;n++){var i=a[n];if(t===i)throw"Cannot transition from ".concat(this.state," to ").concat(t)}},r})(),H3=(function(){function r(t){this.stateManager=t}return r.prototype.startTransition=function(t){return this.stateManager.startTransition(t)},r.prototype.directTransition=function(t){this.stateManager.directTransition(t)},r.prototype.getState=function(){return this.stateManager.getState()},r.prototype.canScanFile=function(){return this.stateManager.getState()===Ln.NOT_STARTED},r.prototype.isScanning=function(){return this.stateManager.getState()!==Ln.NOT_STARTED},r.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Ln.SCANNING},r.prototype.isPaused=function(){return this.stateManager.getState()===Ln.PAUSED},r})(),V3=(function(){function r(){}return r.create=function(){return new H3(new z3)},r})(),W3=(function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}})(),va=(function(r){W3(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.DEFAULT_WIDTH=300,t.DEFAULT_WIDTH_OFFSET=2,t.FILE_SCAN_MIN_HEIGHT=300,t.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,t.MIN_QR_BOX_SIZE=50,t.SHADED_LEFT=1,t.SHADED_RIGHT=2,t.SHADED_TOP=3,t.SHADED_BOTTOM=4,t.SHADED_REGION_ELEMENT_ID="qr-shaded-region",t.VERBOSE=!1,t.BORDER_SHADER_DEFAULT_COLOR="#ffffff",t.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",t})(Xa),G3=(function(){function r(t,e){this.logger=e,this.fps=va.SCAN_DEFAULT_FPS,t?(t.fps&&(this.fps=t.fps),this.disableFlip=t.disableFlip===!0,this.qrbox=t.qrbox,this.aspectRatio=t.aspectRatio,this.videoConstraints=t.videoConstraints):this.disableFlip=va.DEFAULT_DISABLE_FLIP}return r.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?ty.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},r.prototype.isShadedBoxEnabled=function(){return!mi(this.qrbox)},r.create=function(t,e){return new r(t,e)},r})(),R2=(function(){function r(t,e){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.elementId=t,this.verbose=!1;var n;typeof e=="boolean"?this.verbose=e===!0:e&&(n=e,this.verbose=n.verbose===!0,n.experimentalFeatures),this.logger=new ey(this.verbose),this.qrcode=new R3(this.getSupportedFormats(e),this.getUseBarCodeDetectorIfSupported(n),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=V3.create()}return r.prototype.start=function(t,e,n,a){var i=this;if(!t)throw"cameraIdOrConfig is required";if(!n||typeof n!="function")throw"qrCodeSuccessCallback is required and should be a function.";var c;a?c=a:c=this.verbose?this.logger.log:function(){};var f=G3.create(e,this.logger);this.clearElement();var p=!1;f.videoConstraints&&(f.isMediaStreamConstraintsValid()?p=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var d=p,x=document.getElementById(this.elementId);x.clientWidth?x.clientWidth:va.DEFAULT_WIDTH,x.style.position="relative",this.shouldScan=!0,this.element=x;var w=this,C=this.stateManagerProxy.startTransition(Ln.SCANNING);return new Promise(function(S,R){var N=d?f.videoConstraints:w.createVideoConstraints(t);if(!N){C.cancel(),R("videoConstraints should be defined");return}var D={};(!d||f.aspectRatio)&&(D.aspectRatio=f.aspectRatio);var M={onRenderSurfaceReady:function(B,k){w.setupUi(B,k,f),w.isScanning=!0,w.foreverScan(f,n,c)}};L3.failIfNotSupported().then(function(B){B.create(N).then(function(k){return k.render(i.element,D,M).then(function(L){w.renderedCamera=L,C.execute(),S(null)}).catch(function(L){C.cancel(),R(L)})}).catch(function(k){C.cancel(),R(Hu.errorGettingUserMedia(k))})}).catch(function(B){C.cancel(),R(Hu.cameraStreamingNotSupported())})})},r.prototype.pause=function(t){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Ln.PAUSED),this.showPausedState(),(mi(t)||t!==!0)&&(t=!1),t&&this.renderedCamera&&this.renderedCamera.pause()},r.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var t=this,e=function(){t.stateManagerProxy.directTransition(Ln.SCANNING),t.hidePausedState()};if(!this.renderedCamera.isPaused()){e();return}this.renderedCamera.resume(function(){e()})},r.prototype.getState=function(){return this.stateManagerProxy.getState()},r.prototype.stop=function(){var t=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var e=this.stateManagerProxy.startTransition(Ln.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var n=function(){if(t.element){var i=document.getElementById(va.SHADED_REGION_ELEMENT_ID);i&&t.element.removeChild(i)}},a=this;return this.renderedCamera.close().then(function(){return a.renderedCamera=null,a.element&&(a.element.removeChild(a.canvasElement),a.canvasElement=null),n(),a.qrRegion&&(a.qrRegion=null),a.context&&(a.context=null),e.execute(),a.hidePausedState(),a.isScanning=!1,Promise.resolve()})},r.prototype.scanFile=function(t,e){return this.scanFileV2(t,e).then(function(n){return n.decodedText})},r.prototype.scanFileV2=function(t,e){var n=this;if(!t||!(t instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(mi(e)&&(e=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(a,i){n.possiblyCloseLastScanImageFile(),n.clearElement(),n.lastScanImageFile=URL.createObjectURL(t);var c=new Image;c.onload=function(){var f=c.width,p=c.height,d=document.getElementById(n.elementId),x=d.clientWidth?d.clientWidth:va.DEFAULT_WIDTH,w=Math.max(d.clientHeight?d.clientHeight:p,va.FILE_SCAN_MIN_HEIGHT),C=n.computeCanvasDrawConfig(f,p,x,w);if(e){var S=n.createCanvasElement(x,w,"qr-canvas-visible");S.style.display="inline-block",d.appendChild(S);var R=S.getContext("2d");if(!R)throw"Unable to get 2d context from canvas";R.canvas.width=x,R.canvas.height=w,R.drawImage(c,0,0,f,p,C.x,C.y,C.width,C.height)}var N=va.FILE_SCAN_HIDDEN_CANVAS_PADDING,D=Math.max(c.width,C.width),M=Math.max(c.height,C.height),B=D+2*N,k=M+2*N,L=n.createCanvasElement(B,k);d.appendChild(L);var F=L.getContext("2d");if(!F)throw"Unable to get 2d context from canvas";F.canvas.width=B,F.canvas.height=k,F.drawImage(c,0,0,f,p,N,N,D,M);try{n.qrcode.decodeRobustlyAsync(L).then(function(W){a(b2.createFromQrcodeResult(W))}).catch(i)}catch(W){i("QR code parse error, error = ".concat(W))}},c.onerror=i,c.onabort=i,c.onstalled=i,c.onsuspend=i,c.src=URL.createObjectURL(t)})},r.prototype.clear=function(){this.clearElement()},r.getCameras=function(){return U3.retrieve()},r.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},r.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},r.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},r.prototype.applyVideoConstraints=function(t){if(t){if(!ty.isMediaStreamConstraintsValid(t,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(t)},r.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},r.prototype.getSupportedFormats=function(t){var e=[qe.QR_CODE,qe.AZTEC,qe.CODABAR,qe.CODE_39,qe.CODE_93,qe.CODE_128,qe.DATA_MATRIX,qe.MAXICODE,qe.ITF,qe.EAN_13,qe.EAN_8,qe.PDF_417,qe.RSS_14,qe.RSS_EXPANDED,qe.UPC_A,qe.UPC_E,qe.UPC_EAN_EXTENSION];if(!t||typeof t=="boolean"||!t.formatsToSupport)return e;if(!Array.isArray(t.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(t.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var n=[],a=0,i=t.formatsToSupport;a<i.length;a++){var c=i[a];w3(c)?n.push(c):this.logger.warn("Invalid format: ".concat(c," passed in config, ignoring."))}if(n.length===0)throw"None of formatsToSupport match supported values.";return n},r.prototype.getUseBarCodeDetectorIfSupported=function(t){if(mi(t))return!0;if(!mi(t.useBarCodeDetectorIfSupported))return t.useBarCodeDetectorIfSupported!==!1;if(mi(t.experimentalFeatures))return!0;var e=t.experimentalFeatures;return mi(e.useBarCodeDetectorIfSupported)?!0:e.useBarCodeDetectorIfSupported!==!1},r.prototype.validateQrboxSize=function(t,e,n){var a=this,i=n.qrbox;this.validateQrboxConfig(i);var c=this.toQrdimensions(t,e,i),f=function(d){if(d<va.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(va.MIN_QR_BOX_SIZE,"px.")},p=function(d){return d>t&&(a.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),d=t),d};f(c.width),f(c.height),c.width=p(c.width)},r.prototype.validateQrboxConfig=function(t){if(typeof t!="number"&&typeof t!="function"&&(t.width===void 0||t.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},r.prototype.toQrdimensions=function(t,e,n){if(typeof n=="number")return{width:n,height:n};if(typeof n=="function")try{return n(t,e)}catch(a){throw new Error("qrbox config was passed as a function but it failed with unknown error"+a)}return n},r.prototype.setupUi=function(t,e,n){n.isShadedBoxEnabled()&&this.validateQrboxSize(t,e,n);var a=mi(n.qrbox)?{width:t,height:e}:n.qrbox;this.validateQrboxConfig(a);var i=this.toQrdimensions(t,e,a);i.height>e&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var c=n.isShadedBoxEnabled()&&i.height<=e,f={x:0,y:0,width:t,height:e},p=c?this.getShadedRegionBounds(t,e,i):f,d=this.createCanvasElement(p.width,p.height),x={willReadFrequently:!0},w=d.getContext("2d",x);w.canvas.width=p.width,w.canvas.height=p.height,this.element.append(d),c&&this.possiblyInsertShadingElement(this.element,t,e,i),this.createScannerPausedUiElement(this.element),this.qrRegion=p,this.context=w,this.canvasElement=d},r.prototype.createScannerPausedUiElement=function(t){var e=document.createElement("div");e.innerText=Hu.scannerPaused(),e.style.display="none",e.style.position="absolute",e.style.top="0px",e.style.zIndex="1",e.style.background="rgba(9, 9, 9, 0.46)",e.style.color="#FFECEC",e.style.textAlign="center",e.style.width="100%",t.appendChild(e),this.scannerPausedUiElement=e},r.prototype.scanContext=function(t,e){var n=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(a){return t(a.text,b2.createFromQrcodeResult(a)),n.possiblyUpdateShaders(!0),!0}).catch(function(a){n.possiblyUpdateShaders(!1);var i=Hu.codeParseError(a);return e(i,$x.createFrom(i)),!1})},r.prototype.foreverScan=function(t,e,n){var a=this;if(this.shouldScan&&this.renderedCamera){var i=this.renderedCamera.getSurface(),c=i.videoWidth/i.clientWidth,f=i.videoHeight/i.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var p=this.qrRegion.width*c,d=this.qrRegion.height*f,x=this.qrRegion.x*c,w=this.qrRegion.y*f;this.context.drawImage(i,x,w,p,d,0,0,this.qrRegion.width,this.qrRegion.height);var C=function(){a.foreverScanTimeout=setTimeout(function(){a.foreverScan(t,e,n)},a.getTimeoutFps(t.fps))};this.scanContext(e,n).then(function(S){!S&&t.disableFlip!==!0?(a.context.translate(a.context.canvas.width,0),a.context.scale(-1,1),a.scanContext(e,n).finally(function(){C()})):C()}).catch(function(S){a.logger.logError("Error happend while scanning context",S),C()})}},r.prototype.createVideoConstraints=function(t){if(typeof t=="string")return{deviceId:{exact:t}};if(typeof t=="object"){var e="facingMode",n="deviceId",a={user:!0,environment:!0},i="exact",c=function(R){if(R in a)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(R,"'")},f=Object.keys(t);if(f.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(f.length," keys");var p=Object.keys(t)[0];if(p!==e&&p!==n)throw"Only '".concat(e,"' and '").concat(n,"' ")+" are supported for 'cameraIdOrConfig'";if(p===e){var d=t.facingMode;if(typeof d=="string"){if(c(d))return{facingMode:d}}else if(typeof d=="object")if(i in d){if(c(d["".concat(i)]))return{facingMode:{exact:d["".concat(i)]}}}else throw"'facingMode' should be string or object with"+" ".concat(i," as key.");else{var x=typeof d;throw"Invalid type of 'facingMode' = ".concat(x)}}else{var w=t.deviceId;if(typeof w=="string")return{deviceId:w};if(typeof w=="object"){if(i in w)return{deviceId:{exact:w["".concat(i)]}};throw"'deviceId' should be string or object with"+" ".concat(i," as key.")}else{var C=typeof w;throw"Invalid type of 'deviceId' = ".concat(C)}}}var S=typeof t;throw"Invalid type of 'cameraIdOrConfig' = ".concat(S)},r.prototype.computeCanvasDrawConfig=function(t,e,n,a){if(t<=n&&e<=a){var i=(n-t)/2,c=(a-e)/2;return{x:i,y:c,width:t,height:e}}else{var f=t,p=e;return t>n&&(e=n/t*e,t=n),e>a&&(t=a/e*t,e=a),this.logger.log("Image downsampled from "+"".concat(f,"X").concat(p)+" to ".concat(t,"X").concat(e,".")),this.computeCanvasDrawConfig(t,e,n,a)}},r.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var t=document.getElementById(this.elementId);t&&(t.innerHTML="")},r.prototype.possiblyUpdateShaders=function(t){this.qrMatch!==t&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(e){e.style.backgroundColor=t?va.BORDER_SHADER_MATCH_COLOR:va.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=t)},r.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},r.prototype.createCanvasElement=function(t,e,n){var a=t,i=e,c=document.createElement("canvas");return c.style.width="".concat(a,"px"),c.style.height="".concat(i,"px"),c.style.display="none",c.id=mi(n)?"qr-canvas":n,c},r.prototype.getShadedRegionBounds=function(t,e,n){if(n.width>t||n.height>e)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(t-n.width)/2,y:(e-n.height)/2,width:n.width,height:n.height}},r.prototype.possiblyInsertShadingElement=function(t,e,n,a){if(!(e-a.width<1||n-a.height<1)){var i=document.createElement("div");i.style.position="absolute";var c=(e-a.width)/2,f=(n-a.height)/2;if(i.style.borderLeft="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderRight="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderTop="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderBottom="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),i.style.boxSizing="border-box",i.style.top="0px",i.style.bottom="0px",i.style.left="0px",i.style.right="0px",i.id="".concat(va.SHADED_REGION_ELEMENT_ID),e-a.width<11||n-a.height<11)this.hasBorderShaders=!1;else{var p=5,d=40;this.insertShaderBorders(i,d,p,-p,null,0,!0),this.insertShaderBorders(i,d,p,-p,null,0,!1),this.insertShaderBorders(i,d,p,null,-p,0,!0),this.insertShaderBorders(i,d,p,null,-p,0,!1),this.insertShaderBorders(i,p,d+p,-p,null,-p,!0),this.insertShaderBorders(i,p,d+p,null,-p,-p,!0),this.insertShaderBorders(i,p,d+p,-p,null,-p,!1),this.insertShaderBorders(i,p,d+p,null,-p,-p,!1),this.hasBorderShaders=!0}t.append(i)}},r.prototype.insertShaderBorders=function(t,e,n,a,i,c,f){var p=document.createElement("div");p.style.position="absolute",p.style.backgroundColor=va.BORDER_SHADER_DEFAULT_COLOR,p.style.width="".concat(e,"px"),p.style.height="".concat(n,"px"),a!==null&&(p.style.top="".concat(a,"px")),i!==null&&(p.style.bottom="".concat(i,"px")),f?p.style.left="".concat(c,"px"):p.style.right="".concat(c,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(p),t.appendChild(p)},r.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},r.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},r.prototype.getTimeoutFps=function(t){return 1e3/t},r})(),o1="data:image/svg+xml;base64,",j3=o1+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",X3=o1+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",N2=o1+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",Y3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",D2=(function(){function r(){}return r.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},r})(),q3=(function(){function r(){this.data=D2.createDefault();var t=localStorage.getItem(r.LOCAL_STORAGE_KEY);t?this.data=JSON.parse(t):this.reset()}return r.prototype.hasCameraPermissions=function(){return this.data.hasPermission},r.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},r.prototype.setHasPermission=function(t){this.data.hasPermission=t,this.flush()},r.prototype.setLastUsedCameraId=function(t){this.data.lastUsedCameraId=t,this.flush()},r.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},r.prototype.reset=function(){this.data=D2.createDefault(),this.flush()},r.prototype.flush=function(){localStorage.setItem(r.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},r.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",r})(),K3=(function(){function r(){this.infoDiv=document.createElement("div")}return r.prototype.renderInto=function(t){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=w2.poweredBy();var e=document.createElement("a");e.innerText="ScanApp",e.href="https://scanapp.org",e.target="new",e.style.color="white",this.infoDiv.appendChild(e);var n=document.createElement("br"),a=document.createElement("br");this.infoDiv.appendChild(n),this.infoDiv.appendChild(a);var i=document.createElement("a");i.innerText=w2.reportIssues(),i.href="https://github.com/mebjas/html5-qrcode/issues",i.target="new",i.style.color="white",this.infoDiv.appendChild(i),t.appendChild(this.infoDiv)},r.prototype.show=function(){this.infoDiv.style.display="block"},r.prototype.hide=function(){this.infoDiv.style.display="none"},r})(),Z3=(function(){function r(t,e){this.isShowingInfoIcon=!0,this.onTapIn=t,this.onTapOut=e,this.infoIcon=document.createElement("img")}return r.prototype.renderInto=function(t){var e=this;this.infoIcon.alt="Info icon",this.infoIcon.src=N2,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(n){return e.onHoverIn()},this.infoIcon.onmouseout=function(n){return e.onHoverOut()},this.infoIcon.onclick=function(n){return e.onClick()},t.appendChild(this.infoIcon)},r.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},r.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},r.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=Y3,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=N2,this.infoIcon.style.opacity="0.6")},r})(),Q3=(function(){function r(){var t=this;this.infoDiv=new K3,this.infoIcon=new Z3(function(){t.infoDiv.show()},function(){t.infoDiv.hide()})}return r.prototype.renderInto=function(t){this.infoDiv.renderInto(t),this.infoIcon.renderInto(t)},r})(),J3=function(r,t,e,n){function a(i){return i instanceof e?i:new e(function(c){c(i)})}return new(e||(e=Promise))(function(i,c){function f(x){try{d(n.next(x))}catch(w){c(w)}}function p(x){try{d(n.throw(x))}catch(w){c(w)}}function d(x){x.done?i(x.value):a(x.value).then(f,p)}d((n=n.apply(r,t||[])).next())})},$3=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(d){return function(x){return p([d,x])}}function p(d){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,d[0]&&(e=0)),e;)try{if(n=1,a&&(i=d[0]&2?a.return:d[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,d[1])).done)return i;switch(a=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,a=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){e.label=d[1];break}if(d[0]===6&&e.label<i[1]){e.label=i[1],i=d;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(d);break}i[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(r,e)}catch(x){d=[6,x],a=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},M2=(function(){function r(){}return r.hasPermissions=function(){return J3(this,void 0,void 0,function(){var t,e,n,a;return $3(this,function(i){switch(i.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(t=i.sent(),e=0,n=t;e<n.length;e++)if(a=n[e],a.kind==="videoinput"&&a.label)return[2,!0];return[2,!1]}})})},r})(),Xo=(function(){function r(t){this.supportedScanTypes=this.validateAndReturnScanTypes(t)}return r.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},r.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},r.prototype.isCameraScanRequired=function(){for(var t=0,e=this.supportedScanTypes;t<e.length;t++){var n=e[t];if(r.isCameraScanType(n))return!0}return!1},r.isCameraScanType=function(t){return t===es.SCAN_TYPE_CAMERA},r.isFileScanType=function(t){return t===es.SCAN_TYPE_FILE},r.prototype.validateAndReturnScanTypes=function(t){if(!t||t.length===0)return Xa.DEFAULT_SUPPORTED_SCAN_TYPE;var e=Xa.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(t.length>e)throw"Max ".concat(e," values expected for ")+"supportedScanTypes";for(var n=0,a=t;n<a.length;n++){var i=a[n];if(!Xa.DEFAULT_SUPPORTED_SCAN_TYPE.includes(i))throw"Unsupported scan type ".concat(i)}return t},r})(),ba=(function(){function r(){}return r.ALL_ELEMENT_CLASS="html5-qrcode-element",r.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",r.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",r.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",r.TORCH_BUTTON_ID="html5-qrcode-button-torch",r.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",r.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",r.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",r.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",r.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",r.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",r})(),no=(function(){function r(){}return r.createElement=function(t,e){var n=document.createElement(t);return n.id=e,n.classList.add(ba.ALL_ELEMENT_CLASS),t==="button"&&n.setAttribute("type","button"),n},r})(),ry=function(r,t,e,n){function a(i){return i instanceof e?i:new e(function(c){c(i)})}return new(e||(e=Promise))(function(i,c){function f(x){try{d(n.next(x))}catch(w){c(w)}}function p(x){try{d(n.throw(x))}catch(w){c(w)}}function d(x){x.done?i(x.value):a(x.value).then(f,p)}d((n=n.apply(r,t||[])).next())})},ay=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(d){return function(x){return p([d,x])}}function p(d){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,d[0]&&(e=0)),e;)try{if(n=1,a&&(i=d[0]&2?a.return:d[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,d[1])).done)return i;switch(a=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,a=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){e.label=d[1];break}if(d[0]===6&&e.label<i[1]){e.label=i[1],i=d;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(d);break}i[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(r,e)}catch(x){d=[6,x],a=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},O2=(function(){function r(t,e,n){this.isTorchOn=!1,this.torchCapability=t,this.buttonController=e,this.onTorchActionFailureCallback=n}return r.prototype.isTorchEnabled=function(){return this.isTorchOn},r.prototype.flipState=function(){return ry(this,void 0,void 0,function(){var t,e;return ay(this,function(n){switch(n.label){case 0:this.buttonController.disable(),t=!this.isTorchOn,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.torchCapability.apply(t)];case 2:return n.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),t),[3,4];case 3:return e=n.sent(),this.propagateFailure(t,e),this.buttonController.enable(),[3,4];case 4:return[2]}})})},r.prototype.updateUiBasedOnLatestSettings=function(t,e){t===e?(this.buttonController.setText(e?on.torchOffButton():on.torchOnButton()),this.isTorchOn=e):this.propagateFailure(e),this.buttonController.enable()},r.prototype.propagateFailure=function(t,e){var n=t?on.torchOnFailedMessage():on.torchOffFailedMessage();e&&(n+="; Error = "+e),this.onTorchActionFailureCallback(n)},r.prototype.reset=function(){this.isTorchOn=!1},r})(),eA=(function(){function r(t,e){this.onTorchActionFailureCallback=e,this.torchButton=no.createElement("button",ba.TORCH_BUTTON_ID),this.torchController=new O2(t,this,e)}return r.prototype.render=function(t,e){var n=this;this.torchButton.innerText=on.torchOnButton(),this.torchButton.style.display=e.display,this.torchButton.style.marginLeft=e.marginLeft;var a=this;this.torchButton.addEventListener("click",function(i){return ry(n,void 0,void 0,function(){return ay(this,function(c){switch(c.label){case 0:return[4,a.torchController.flipState()];case 1:return c.sent(),a.torchController.isTorchEnabled()?(a.torchButton.classList.remove(ba.TORCH_BUTTON_CLASS_TORCH_OFF),a.torchButton.classList.add(ba.TORCH_BUTTON_CLASS_TORCH_ON)):(a.torchButton.classList.remove(ba.TORCH_BUTTON_CLASS_TORCH_ON),a.torchButton.classList.add(ba.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),t.appendChild(this.torchButton)},r.prototype.updateTorchCapability=function(t){this.torchController=new O2(t,this,this.onTorchActionFailureCallback)},r.prototype.getTorchButton=function(){return this.torchButton},r.prototype.hide=function(){this.torchButton.style.display="none"},r.prototype.show=function(){this.torchButton.style.display="inline-block"},r.prototype.disable=function(){this.torchButton.disabled=!0},r.prototype.enable=function(){this.torchButton.disabled=!1},r.prototype.setText=function(t){this.torchButton.innerText=t},r.prototype.reset=function(){this.torchButton.innerText=on.torchOnButton(),this.torchController.reset()},r.create=function(t,e,n,a){var i=new r(e,a);return i.render(t,n),i},r})(),tA=(function(){function r(t,e,n){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=e?"block":"none",t.appendChild(this.fileBasedScanRegion);var a=document.createElement("label");a.setAttribute("for",this.getFileScanInputId()),a.style.display="inline-block",this.fileBasedScanRegion.appendChild(a),this.fileSelectionButton=no.createElement("button",ba.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(f){a.click()}),a.append(this.fileSelectionButton),this.fileScanInput=no.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",a.appendChild(this.fileScanInput);var i=this;this.fileScanInput.addEventListener("change",function(f){if(!(f==null||f.target==null)){var p=f.target;if(!(p.files&&p.files.length===0)){var d=p.files,x=d[0],w=x.name;i.setImageNameToButton(w),n(x)}}});var c=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(c),this.fileBasedScanRegion.addEventListener("dragenter",function(f){i.fileBasedScanRegion.style.border=i.fileBasedScanRegionActiveBorder(),f.stopPropagation(),f.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(f){i.fileBasedScanRegion.style.border=i.fileBasedScanRegionDefaultBorder(),f.stopPropagation(),f.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(f){i.fileBasedScanRegion.style.border=i.fileBasedScanRegionActiveBorder(),f.stopPropagation(),f.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(f){f.stopPropagation(),f.preventDefault(),i.fileBasedScanRegion.style.border=i.fileBasedScanRegionDefaultBorder();var p=f.dataTransfer;if(p){var d=p.files;if(!d||d.length===0)return;for(var x=!1,w=0;w<d.length;++w){var C=d.item(w);if(C){var S=/image.*/;if(C.type.match(S)){x=!0;var R=C.name;i.setImageNameToButton(R),n(C),c.innerText=on.dragAndDropMessage();break}}}x||(c.innerText=on.dragAndDropMessageOnlyImages())}})}return r.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},r.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},r.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},r.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},r.prototype.createFileBasedScanRegion=function(){var t=document.createElement("div");return t.style.textAlign="center",t.style.margin="auto",t.style.width="80%",t.style.maxWidth="600px",t.style.border=this.fileBasedScanRegionDefaultBorder(),t.style.padding="10px",t.style.marginBottom="10px",t},r.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},r.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},r.prototype.createDragAndDropMessage=function(){var t=document.createElement("div");return t.innerText=on.dragAndDropMessage(),t.style.fontWeight="400",t},r.prototype.setImageNameToButton=function(t){var e=20;if(t.length>e){var n=t.substring(0,8),a=t.length,i=t.substring(a-8,a);t="".concat(n,"....").concat(i)}var c=on.fileSelectionChooseAnother()+" - "+t;this.fileSelectionButton.innerText=c},r.prototype.setInitialValueToButton=function(){var t=on.fileSelectionChooseImage()+" - "+on.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=t},r.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},r.create=function(t,e,n){var a=new r(t,e,n);return a},r})(),nA=(function(){function r(t){this.selectElement=no.createElement("select",ba.CAMERA_SELECTION_SELECT_ID),this.cameras=t,this.options=[]}return r.prototype.render=function(t){var e=document.createElement("span");e.style.marginRight="10px";var n=this.cameras.length;if(n===0)throw new Error("No cameras found");if(n===1)e.style.display="none";else{var a=on.selectCamera();e.innerText="".concat(a," (").concat(this.cameras.length,")  ")}for(var i=1,c=0,f=this.cameras;c<f.length;c++){var p=f[c],d=p.id,x=p.label==null?d:p.label;(!x||x==="")&&(x=[on.anonymousCameraPrefix(),i++].join(" "));var w=document.createElement("option");w.value=d,w.innerText=x,this.options.push(w),this.selectElement.appendChild(w)}e.appendChild(this.selectElement),t.appendChild(e)},r.prototype.disable=function(){this.selectElement.disabled=!0},r.prototype.isDisabled=function(){return this.selectElement.disabled===!0},r.prototype.enable=function(){this.selectElement.disabled=!1},r.prototype.getValue=function(){return this.selectElement.value},r.prototype.hasValue=function(t){for(var e=0,n=this.options;e<n.length;e++){var a=n[e];if(a.value===t)return!0}return!1},r.prototype.setValue=function(t){if(!this.hasValue(t))throw new Error("".concat(t," is not present in the camera list."));this.selectElement.value=t},r.prototype.hasSingleItem=function(){return this.cameras.length===1},r.prototype.numCameras=function(){return this.cameras.length},r.create=function(t,e){var n=new r(e);return n.render(t),n},r})(),rA=(function(){function r(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=no.createElement("input",ba.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return r.prototype.render=function(t,e){this.zoomElementContainer.style.display=e?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",t.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var n=on.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(n),this.rangeText.style.marginRight="10px";var a=this;this.rangeInput.addEventListener("input",function(){return a.onValueChange()}),this.rangeInput.addEventListener("change",function(){return a.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},r.prototype.onValueChange=function(){var t=on.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(t),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},r.prototype.setValues=function(t,e,n,a){this.rangeInput.min=t.toString(),this.rangeInput.max=e.toString(),this.rangeInput.step=a.toString(),this.rangeInput.value=n.toString(),this.onValueChange()},r.prototype.show=function(){this.zoomElementContainer.style.display="block"},r.prototype.hide=function(){this.zoomElementContainer.style.display="none"},r.prototype.setOnCameraZoomValueChangeCallback=function(t){this.onChangeCallback=t},r.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},r.create=function(t,e){var n=new r;return n.render(t,e),n},r})(),ma;(function(r){r[r.STATUS_DEFAULT=0]="STATUS_DEFAULT",r[r.STATUS_SUCCESS=1]="STATUS_SUCCESS",r[r.STATUS_WARNING=2]="STATUS_WARNING",r[r.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(ma||(ma={}));function aA(r){return{fps:r.fps,qrbox:r.qrbox,aspectRatio:r.aspectRatio,disableFlip:r.disableFlip,videoConstraints:r.videoConstraints}}function iA(r,t){return{formatsToSupport:r.formatsToSupport,useBarCodeDetectorIfSupported:r.useBarCodeDetectorIfSupported,experimentalFeatures:r.experimentalFeatures,verbose:t}}var oA=(function(){function r(t,e,n){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=t,this.config=this.createConfig(e),this.verbose=n===!0,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.scanTypeSelector=new Xo(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new ey(this.verbose),this.persistedDataManager=new q3,e.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return r.prototype.render=function(t,e){var n=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(i,c){if(t)t(i,c);else{if(n.lastMatchFound===i)return;n.lastMatchFound=i,n.setHeaderMessage(on.lastMatch(i),ma.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(i,c){e&&e(i,c)};var a=document.getElementById(this.elementId);if(!a)throw"HTML Element with id=".concat(this.elementId," not found");a.innerHTML="",this.createBasicLayout(a),this.html5Qrcode=new R2(this.getScanRegionId(),iA(this.config,this.verbose))},r.prototype.pause=function(t){(mi(t)||t!==!0)&&(t=!1),this.getHtml5QrcodeOrFail().pause(t)},r.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},r.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},r.prototype.clear=function(){var t=this,e=function(){var n=document.getElementById(t.elementId);n&&(n.innerHTML="",t.resetBasicLayout(n))};return this.html5Qrcode?new Promise(function(n,a){if(!t.html5Qrcode){n();return}t.html5Qrcode.isScanning?t.html5Qrcode.stop().then(function(i){if(!t.html5Qrcode){n();return}t.html5Qrcode.clear(),e(),n()}).catch(function(i){t.verbose&&t.logger.logError("Unable to stop qrcode scanner",i),a(i)}):(t.html5Qrcode.clear(),e(),n())}):Promise.resolve()},r.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},r.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},r.prototype.applyVideoConstraints=function(t){return this.getHtml5QrcodeOrFail().applyVideoConstraints(t)},r.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},r.prototype.createConfig=function(t){return t?(t.fps||(t.fps=Xa.SCAN_DEFAULT_FPS),t.rememberLastUsedCamera!==!Xa.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(t.rememberLastUsedCamera=Xa.DEFAULT_REMEMBER_LAST_CAMERA_USED),t.supportedScanTypes||(t.supportedScanTypes=Xa.DEFAULT_SUPPORTED_SCAN_TYPE),t):{fps:Xa.SCAN_DEFAULT_FPS,rememberLastUsedCamera:Xa.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:Xa.DEFAULT_SUPPORTED_SCAN_TYPE}},r.prototype.createBasicLayout=function(t){t.style.position="relative",t.style.padding="0px",t.style.border="1px solid silver",this.createHeader(t);var e=document.createElement("div"),n=this.getScanRegionId();e.id=n,e.style.width="100%",e.style.minHeight="100px",e.style.textAlign="center",t.appendChild(e),Xo.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var a=document.createElement("div"),i=this.getDashboardId();a.id=i,a.style.width="100%",t.appendChild(a),this.setupInitialDashboard(a)},r.prototype.resetBasicLayout=function(t){t.style.border="none"},r.prototype.setupInitialDashboard=function(t){this.createSection(t),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},r.prototype.createHeader=function(t){var e=document.createElement("div");e.style.textAlign="left",e.style.margin="0px",t.appendChild(e);var n=new Q3;n.renderInto(e);var a=document.createElement("div");a.id=this.getHeaderMessageContainerId(),a.style.display="none",a.style.textAlign="center",a.style.fontSize="14px",a.style.padding="2px 10px",a.style.margin="4px",a.style.borderTop="1px solid #f6f6f6",e.appendChild(a)},r.prototype.createSection=function(t){var e=document.createElement("div");e.id=this.getDashboardSectionId(),e.style.width="100%",e.style.padding="10px 0px 10px 0px",e.style.textAlign="left",t.appendChild(e)},r.prototype.createCameraListUi=function(t,e,n){var a=this;a.showHideScanTypeSwapLink(!1),a.setHeaderMessage(on.cameraPermissionRequesting());var i=function(){n||a.createPermissionButton(t,e)};R2.getCameras().then(function(c){a.persistedDataManager.setHasPermission(!0),a.showHideScanTypeSwapLink(!0),a.resetHeaderMessage(),c&&c.length>0?(t.removeChild(e),a.renderCameraSelection(c)):(a.setHeaderMessage(on.noCameraFound(),ma.STATUS_WARNING),i())}).catch(function(c){a.persistedDataManager.setHasPermission(!1),n?n.disabled=!1:i(),a.setHeaderMessage(c,ma.STATUS_WARNING),a.showHideScanTypeSwapLink(!0)})},r.prototype.createPermissionButton=function(t,e){var n=this,a=no.createElement("button",this.getCameraPermissionButtonId());a.innerText=on.cameraPermissionTitle(),a.addEventListener("click",function(){a.disabled=!0,n.createCameraListUi(t,e,a)}),e.appendChild(a)},r.prototype.createPermissionsUi=function(t,e){var n=this;if(Xo.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){M2.hasPermissions().then(function(a){a?n.createCameraListUi(t,e):(n.persistedDataManager.setHasPermission(!1),n.createPermissionButton(t,e))}).catch(function(a){n.persistedDataManager.setHasPermission(!1),n.createPermissionButton(t,e)});return}this.createPermissionButton(t,e)},r.prototype.createSectionControlPanel=function(){var t=document.getElementById(this.getDashboardSectionId()),e=document.createElement("div");t.appendChild(e);var n=document.createElement("div");n.id=this.getDashboardSectionCameraScanRegionId(),n.style.display=Xo.isCameraScanType(this.currentScanType)?"block":"none",e.appendChild(n);var a=document.createElement("div");a.style.textAlign="center",n.appendChild(a),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(n,a),this.renderFileScanUi(e)},r.prototype.renderFileScanUi=function(t){var e=Xo.isFileScanType(this.currentScanType),n=this,a=function(i){if(!n.html5Qrcode)throw"html5Qrcode not defined";Xo.isFileScanType(n.currentScanType)&&(n.setHeaderMessage(on.loadingImage()),n.html5Qrcode.scanFileV2(i,!0).then(function(c){n.resetHeaderMessage(),n.qrCodeSuccessCallback(c.decodedText,c)}).catch(function(c){n.setHeaderMessage(c,ma.STATUS_WARNING),n.qrCodeErrorCallback(c,$x.createFrom(c))}))};this.fileSelectionUi=tA.create(t,e,a)},r.prototype.renderCameraSelection=function(t){var e=this,n=this,a=document.getElementById(this.getDashboardSectionCameraScanRegionId());a.style.textAlign="center";var i=rA.create(a,!1),c=function(N){var D=N.zoomFeature();if(D.isSupported()){i.setOnCameraZoomValueChangeCallback(function(B){D.apply(B)});var M=1;e.config.defaultZoomValueIfSupported&&(M=e.config.defaultZoomValueIfSupported),M=E3(M,D.min(),D.max()),i.setValues(D.min(),D.max(),M,D.step()),i.show()}},f=nA.create(a,t),p=document.createElement("span"),d=no.createElement("button",ba.CAMERA_START_BUTTON_ID);d.innerText=on.scanButtonStartScanningText(),p.appendChild(d);var x=no.createElement("button",ba.CAMERA_STOP_BUTTON_ID);x.innerText=on.scanButtonStopScanningText(),x.style.display="none",x.disabled=!0,p.appendChild(x);var w,C=function(N){if(!N.torchFeature().isSupported()){w&&w.hide();return}w?w.updateTorchCapability(N.torchFeature()):w=eA.create(p,N.torchFeature(),{display:"none",marginLeft:"5px"},function(D){n.setHeaderMessage(D,ma.STATUS_WARNING)}),w.show()};a.appendChild(p);var S=function(N){N||(d.style.display="none"),d.innerText=on.scanButtonStartScanningText(),d.style.opacity="1",d.disabled=!1,N&&(d.style.display="inline-block")};if(d.addEventListener("click",function(N){d.innerText=on.scanButtonScanningStarting(),f.disable(),d.disabled=!0,d.style.opacity="0.5",e.scanTypeSelector.hasMoreThanOneScanType()&&n.showHideScanTypeSwapLink(!1),n.resetHeaderMessage();var D=f.getValue();n.persistedDataManager.setLastUsedCameraId(D),n.html5Qrcode.start(D,aA(n.config),n.qrCodeSuccessCallback,n.qrCodeErrorCallback).then(function(M){x.disabled=!1,x.style.display="inline-block",S(!1);var B=n.html5Qrcode.getRunningTrackCameraCapabilities();e.config.showTorchButtonIfSupported===!0&&C(B),e.config.showZoomSliderIfSupported===!0&&c(B)}).catch(function(M){n.showHideScanTypeSwapLink(!0),f.enable(),S(!0),n.setHeaderMessage(M,ma.STATUS_WARNING)})}),f.hasSingleItem()&&d.click(),x.addEventListener("click",function(N){if(!n.html5Qrcode)throw"html5Qrcode not defined";x.disabled=!0,n.html5Qrcode.stop().then(function(D){e.scanTypeSelector.hasMoreThanOneScanType()&&n.showHideScanTypeSwapLink(!0),f.enable(),d.disabled=!1,x.style.display="none",d.style.display="inline-block",w&&(w.reset(),w.hide()),i.removeOnCameraZoomValueChangeCallback(),i.hide(),n.insertCameraScanImageToScanRegion()}).catch(function(D){x.disabled=!1,n.setHeaderMessage(D,ma.STATUS_WARNING)})}),n.persistedDataManager.getLastUsedCameraId()){var R=n.persistedDataManager.getLastUsedCameraId();f.hasValue(R)?(f.setValue(R),d.click()):n.persistedDataManager.resetLastUsedCameraId()}},r.prototype.createSectionSwap=function(){var t=this,e=on.textIfCameraScanSelected(),n=on.textIfFileScanSelected(),a=document.getElementById(this.getDashboardSectionId()),i=document.createElement("div");i.style.textAlign="center";var c=no.createElement("span",this.getDashboardSectionSwapLinkId());c.style.textDecoration="underline",c.style.cursor="pointer",c.innerText=Xo.isCameraScanType(this.currentScanType)?e:n,c.addEventListener("click",function(){if(!t.sectionSwapAllowed){t.verbose&&t.logger.logError("Section swap called when not allowed");return}t.resetHeaderMessage(),t.fileSelectionUi.resetValue(),t.sectionSwapAllowed=!1,Xo.isCameraScanType(t.currentScanType)?(t.clearScanRegion(),t.getCameraScanRegion().style.display="none",t.fileSelectionUi.show(),c.innerText=n,t.currentScanType=es.SCAN_TYPE_FILE,t.insertFileScanImageToScanRegion()):(t.clearScanRegion(),t.getCameraScanRegion().style.display="block",t.fileSelectionUi.hide(),c.innerText=e,t.currentScanType=es.SCAN_TYPE_CAMERA,t.insertCameraScanImageToScanRegion(),t.startCameraScanIfPermissionExistsOnSwap()),t.sectionSwapAllowed=!0}),i.appendChild(c),a.appendChild(i)},r.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var t=this,e=this;if(this.persistedDataManager.hasCameraPermissions()){M2.hasPermissions().then(function(n){if(n){var a=document.getElementById(e.getCameraPermissionButtonId());if(!a)throw t.logger.logError("Permission button not found, fail;"),"Permission button not found";a.click()}else e.persistedDataManager.setHasPermission(!1)}).catch(function(n){e.persistedDataManager.setHasPermission(!1)});return}},r.prototype.resetHeaderMessage=function(){var t=document.getElementById(this.getHeaderMessageContainerId());t.style.display="none"},r.prototype.setHeaderMessage=function(t,e){e||(e=ma.STATUS_DEFAULT);var n=this.getHeaderMessageDiv();switch(n.innerText=t,n.style.display="block",e){case ma.STATUS_SUCCESS:n.style.background="rgba(106, 175, 80, 0.26)",n.style.color="#477735";break;case ma.STATUS_WARNING:n.style.background="rgba(203, 36, 49, 0.14)",n.style.color="#cb2431";break;case ma.STATUS_DEFAULT:default:n.style.background="rgba(0, 0, 0, 0)",n.style.color="rgb(17, 17, 17)";break}},r.prototype.showHideScanTypeSwapLink=function(t){this.scanTypeSelector.hasMoreThanOneScanType()&&(t!==!0&&(t=!1),this.sectionSwapAllowed=t,this.getDashboardSectionSwapLink().style.display=t?"inline-block":"none")},r.prototype.insertCameraScanImageToScanRegion=function(){var t=this,e=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){e.innerHTML="<br>",e.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(n){e.innerHTML="<br>",e.appendChild(t.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=j3,this.cameraScanImage.alt=on.cameraScanAltText()},r.prototype.insertFileScanImageToScanRegion=function(){var t=this,e=document.getElementById(this.getScanRegionId());if(this.fileScanImage){e.innerHTML="<br>",e.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(n){e.innerHTML="<br>",e.appendChild(t.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=X3,this.fileScanImage.alt=on.fileScanAltText()},r.prototype.clearScanRegion=function(){var t=document.getElementById(this.getScanRegionId());t.innerHTML=""},r.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},r.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},r.prototype.getDashboardSectionSwapLinkId=function(){return ba.SCAN_TYPE_CHANGE_ANCHOR_ID},r.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},r.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},r.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},r.prototype.getCameraPermissionButtonId=function(){return ba.CAMERA_PERMISSION_BUTTON_ID},r.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},r.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},r.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},r})();const sA=({onScan:r})=>{const[t,e]=De.useState(!1);return De.useEffect(()=>{e(!0)},[]),De.useEffect(()=>{if(t){const n=new oA("reader",{fps:10,qrbox:{width:250,height:250}});n.render(a=>{n.clear(),r(a)},a=>{console.warn("QR scan error:",a)})}},[t]),Fn.jsxs("div",{className:"p-4 flex flex-col items-center justify-center min-h-screen bg-gray-100",children:[Fn.jsx("h2",{className:"text-xl font-bold mb-4",children:"Scan QR to Join Attendance"}),Fn.jsx("div",{id:"reader",className:"w-full max-w-md border rounded shadow-md bg-white p-2"})]})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var iy=function(r,t){return(iy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])})(r,t)};function Za(r,t){function e(){this.constructor=r}iy(r,t),r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Ze(r,t,e,n){return new(e||(e=Promise))((function(a,i){function c(d){try{p(n.next(d))}catch(x){i(x)}}function f(d){try{p(n.throw(d))}catch(x){i(x)}}function p(d){d.done?a(d.value):new e((function(x){x(d.value)})).then(c,f)}p((n=n.apply(r,[])).next())}))}function Qe(r,t){var e,n,a,i,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function f(p){return function(d){return(function(x){if(e)throw new TypeError("Generator is already executing.");for(;c;)try{if(e=1,n&&(a=2&x[0]?n.return:x[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,x[1])).done)return a;switch(n=0,a&&(x=[2&x[0],a.value]),x[0]){case 0:case 1:a=x;break;case 4:return c.label++,{value:x[1],done:!1};case 5:c.label++,n=x[1],x=[0];continue;case 7:x=c.ops.pop(),c.trys.pop();continue;default:if(!(a=(a=c.trys).length>0&&a[a.length-1])&&(x[0]===6||x[0]===2)){c=0;continue}if(x[0]===3&&(!a||x[1]>a[0]&&x[1]<a[3])){c.label=x[1];break}if(x[0]===6&&c.label<a[1]){c.label=a[1],a=x;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(x);break}a[2]&&c.ops.pop(),c.trys.pop();continue}x=t.call(r,c)}catch(w){x=[6,w],n=0}finally{e=a=0}if(5&x[0])throw x[1];return{value:x[0]?x[1]:void 0,done:!0}})([p,d])}}}var uA=(function(){function r(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return r.prototype.setPlatform=function(t,e){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},r.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},this.urlFlags[t]!=null){var a=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+a+"."),this.set(t,a)}},r.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},r.prototype.getNumber=function(t){return this.get(t)},r.prototype.getBool=function(t){return this.get(t)},r.prototype.getFlags=function(){return this.flags},Object.defineProperty(r.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),r.prototype.set=function(t,e){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(e)},r.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},r.prototype.setFlags=function(t){this.flags=Object.assign({},t)},r.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},r.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var e,n,a=(e=this.global.location.search,n={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(i){for(var c=[],f=1;f<arguments.length;f++)c[f-1]=arguments[f];return lA(n,c[0],c[1]),c.join("=")})),n);"tfjsflags"in a&&a.tfjsflags.split(",").forEach((function(i){var c=i.split(":"),f=c[0],p=c[1];t.urlFlags[f]=(function(d,x){if((x=x.toLowerCase())==="true"||x==="false")return x==="true";if(""+ +x===x)return+x;throw new Error("Could not parse value flag value "+x+" for flag "+d+".")})(f,p)}))}},r})();function lA(r,t,e){r[decodeURIComponent(t)]=decodeURIComponent(e||"")}function Re(){return oy}var oy=null,ch=new Map,Np=new Map;function sy(r,t){var e=ly(r,t);return ch.get(e)}function cA(r){return Np.get(r)}function B2(r){for(var t=ch.entries(),e=[];;){var n=t.next(),a=n.done,i=n.value;if(a)break;var c=i[0],f=i[1];c.split("_")[0]===r&&e.push(f)}return e}function uy(r){var t=r.kernelName,e=r.backendName,n=ly(t,e);if(ch.has(n))throw new Error("The kernel '"+t+"' for backend '"+e+"' is already registered");ch.set(n,r)}function fA(r){var t=r.kernelName;Np.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Np.set(t,r)}function ly(r,t){return t+"_"+r}function Dp(r,t,e){return Math.max(r,Math.min(t,e))}function cy(r){return r%2==0?r:r+1}function hA(r){for(var t=0,e=0;e<r.length;e++)t+=r[e];return t}function J(r,t){if(!r)throw new Error(typeof t=="string"?t:t())}function Jt(r,t,e){e===void 0&&(e=""),J(yr(r,t),(function(){return e+" Shapes "+r+" and "+t+" must match"}))}function nl(r){J(r!=null,(function(){return"The input to the tensor constructor must be a non-null value."}))}function Zu(r,t,e){if(t===void 0&&(t=[]),e===void 0&&(e=!1),t==null&&(t=[]),Array.isArray(r)||Ci(r)&&!e)for(var n=0;n<r.length;++n)Zu(r[n],t,e);else t.push(r);return t}function Je(r){if(r.length===0)return 1;for(var t=r[0],e=1;e<r.length;e++)t*=r[e];return t}function yr(r,t){if(r===t)return!0;if(r==null||t==null||r.length!==t.length)return!1;for(var e=0;e<r.length;e++)if(r[e]!==t[e])return!1;return!0}function jn(r){return r%1==0}function dA(r){if(Math.tanh!=null)return Math.tanh(r);if(r===1/0)return 1;if(r===-1/0)return-1;var t=Math.exp(2*r);return(t-1)/(t+1)}function Mp(r){var t=Math.ceil(Math.sqrt(r));return[t,Math.ceil(r/t)]}function Vu(r,t){return t<=r.length?r:r+" ".repeat(t-r.length)}function k2(r,t,e){return t===void 0&&(t=function(n){return 0}),new Promise((function(n,a){var i=0,c=function(){if(r())n();else{i++;var f=t(i);e!=null&&i>=e?a():setTimeout(c,f)}};c()}))}function pA(r,t){for(var e=1,n=-1,a=0;a<r.length;++a)if(r[a]>=0)e*=r[a];else if(r[a]===-1){if(n!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+n+" and dim "+a);n=a}else if(r[a]<0)throw Error("Shapes can not be < 0. Found "+r[a]+" at dim "+a);if(n===-1){if(t>0&&t!==e)throw Error("Size("+t+") must match the product of shape "+r);return r}if(e===0)throw Error("Cannot infer the missing size in ["+r+"] when there are 0 elements");if(t%e!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+e);var i=r.slice();return i[n]=t/e,i}function cr(r,t){var e=t.length;return J((r=r==null?t.map((function(n,a){return a})):[].concat(r)).every((function(n){return n>=-e&&n<e})),(function(){return"All values in axis param must be in range [-"+e+", "+e+") but got axis "+r})),J(r.every((function(n){return jn(n)})),(function(){return"All values in axis param must be integers but got axis "+r})),r.map((function(n){return n<0?e+n:n}))}function Bs(r,t){for(var e=[],n=[],a=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||a?null:cr(t,r).sort(),c=0,f=0;f<r.length;++f){if(i!=null){if(i[c]===f&&r[f]!==1)throw new Error("Can't squeeze axis "+f+" since its dim '"+r[f]+"' is not 1");(i[c]==null||i[c]>f)&&r[f]===1&&(e.push(r[f]),n.push(f)),i[c]<=f&&c++}r[f]!==1&&(e.push(r[f]),n.push(f))}return{newShape:e,keptDims:n}}function fc(r,t){var e=null;if(r==null||r==="float32")e=new Float32Array(t);else if(r==="int32")e=new Int32Array(t);else{if(r!=="bool")throw new Error("Unknown data type "+r);e=new Uint8Array(t)}return e}function fh(r,t){var e=null;if(r==null||r==="float32")e=new Float32Array(t);else if(r==="int32")e=new Int32Array(t);else if(r==="bool")e=new Uint8Array(t);else{if(r!=="string")throw new Error("Unknown data type "+r);e=new Array(t)}return e}function gA(r,t){for(var e=0;e<r.length;e++){var n=r[e];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type "+t+" being uploaded contains "+n+".")}}function vA(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function mA(r,t){return t!=="complex64"&&(t!=="float32"||r==="complex64")&&(t!=="int32"||r==="float32"||r==="complex64")&&(t!=="bool"||r!=="bool")}function Ci(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array}function fy(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error("Unknown dtype "+r)}function xA(r){if(r==null)return 0;var t=0;return r.forEach((function(e){return t+=e.length})),t}function s1(r){return typeof r=="string"||r instanceof String}function yA(r){return typeof r=="boolean"}function bA(r){return typeof r=="number"}function wc(r){return Array.isArray(r)?wc(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array?"int32":bA(r)?"float32":s1(r)?"string":yA(r)?"bool":"float32"}function Op(r){return!!(r&&r.constructor&&r.call&&r.apply)}function Bp(r,t){for(var e=t;e<r;++e)if(r%e==0)return e;return r}function Ai(r){var t=r.length;if(t<2)return[];var e=new Array(t-1);e[t-2]=r[t-1];for(var n=t-3;n>=0;--n)e[n]=e[n+1]*r[n+1];return e}function hy(r,t,e){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=Zu(r)),e&&gA(r,t),(function(i,c){return i instanceof Float32Array&&c==="float32"||i instanceof Int32Array&&c==="int32"||i instanceof Uint8Array&&c==="bool"})(r,t))return r;if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool"){for(var n=new Uint8Array(r.length),a=0;a<n.length;++a)Math.round(r[a])!==0&&(n[a]=1);return n}throw new Error("Unknown data type "+t)}function L2(r,t){if(r.length===0)return t[0];var e=r.reduce((function(n,a){return n*a}));if(e===0)return[];if(e!==t.length)throw new Error("["+r+"] does not match the input size.");return(function n(a,i,c){var f=new Array;if(i.length===1)for(var p=i[0],d=0;d<p;d++)f[d]=c[a+d];else{p=i[0];var x=i.slice(1),w=x.reduce((function(C,S){return C*S}));for(d=0;d<p;d++)f[d]=n(a+d*w,x,c)}return f})(0,r,t)}function dy(r,t){for(var e=Ec(r,t),n=0;n<e.length;n++)e[n]=1;return e}function Ec(r,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool")return new Uint8Array(r);throw new Error("Unknown data type "+t)}function yi(){return Re().platform.now()}function py(r){r.forEach((function(t){J(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+r+"]."}))}))}function wA(r,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",Re().platform.encode(r,t)}function hh(r,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",Re().platform.decode(r,t)}function F2(r,t,e){if(t===0)return 0;if(t===1)return r[0];for(var n=r[r.length-1],a=0;a<r.length-1;++a)n+=e[a]*r[a];return n}function EA(r,t,e){if(t===0)return[];if(t===1)return[r];for(var n=new Array(t),a=0;a<n.length-1;++a)n[a]=Math.floor(r/e[a]),r-=n[a]*e[a];return n[n.length-1]=r,n}var CA=(function(){function r(t,e){this.backendTimer=t,this.logger=e,e==null&&(this.logger=new AA)}return r.prototype.profileKernel=function(t,e,n){var a,i=this,c=this.backendTimer.time((function(){a=n()}));return a.forEach((function(f){f.data().then((function(p){(function(d,x,w){if(x!=="float32")return!1;for(var C=0;C<d.length;C++){var S=d[C];if(isNaN(S)||!isFinite(S))return console.warn("Found "+S+" in the result of '"+w+"'"),!0}})(p,f.dtype,t),c.then((function(d){var x="";d.getExtraProfileInfo!=null&&(x=d.getExtraProfileInfo()),i.logger.logKernelProfile(t,f,p,d.kernelMs,e,x)}))}))})),a},r})(),AA=(function(){function r(){}return r.prototype.logKernelProfile=function(t,e,n,a,i,c){var f=typeof a=="number"?Vu(a+"ms",9):a.error,p=Vu(t,25),d=e.rank,x=e.size,w=Vu(e.shape.toString(),14),C="";for(var S in i){var R=i[S].shape||e.shape,N=R.length;C+=S+": "+N+"D "+(N>0?R:"")+" "}console.log("%c"+p+"	%c"+f+"	%c"+d+"D "+w+"	%c"+x+"	%c"+C+"	%c"+c,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},r})(),P2=20,nc=3,$0=7;function SA(r,t,e,n){var a=Ai(t),i=(function(d,x,w,C){var S=Je(x),R=C[C.length-1],N=new Array(R).fill(0),D=x.length,M=w==="complex64"?ac(d):d;if(D>1)for(var B=0;B<S/R;B++)for(var k=B*R,L=0;L<R;L++)N[L]=Math.max(N[L],rc(M[k+L],0,w).length);return N})(r,t,e,a),c=t.length,f=(function d(x,w,C,S,R,N){N===void 0&&(N=!0);var D=C==="complex64"?2:1,M=w[0],B=w.length;if(B===0)return C==="complex64"?[rc(ac(x)[0],0,C)]:C==="bool"?[gy(x[0])]:[x[0].toString()];if(B===1){if(M>P2){var k=nc*D,L=Array.from(x.slice(0,k)),F=Array.from(x.slice((M-nc)*D,M*D));return C==="complex64"&&(L=ac(L),F=ac(F)),["["+L.map((function($,te){return rc($,R[te],C)})).join(", ")+", ..., "+F.map((function($,te){return rc($,R[M-nc+te],C)})).join(", ")+"]"]}return["["+(C==="complex64"?ac(x):Array.from(x)).map((function($,te){return rc($,R[te],C)})).join(", ")+"]"]}var W=w.slice(1),G=S.slice(1),q=S[0]*D,H=[];if(M>P2){for(var Z=0;Z<nc;Z++){var ie=(ee=Z*q)+q;H.push.apply(H,d(x.slice(ee,ie),W,C,G,R,!1))}for(H.push("..."),Z=M-nc;Z<M;Z++)ie=(ee=Z*q)+q,H.push.apply(H,d(x.slice(ee,ie),W,C,G,R,Z===M-1))}else for(Z=0;Z<M;Z++){var ee;ie=(ee=Z*q)+q,H.push.apply(H,d(x.slice(ee,ie),W,C,G,R,Z===M-1))}var me=B===2?",":"";for(H[0]="["+H[0]+me,Z=1;Z<H.length-1;Z++)H[Z]=" "+H[Z]+me;var xe=`,
`;for(Z=2;Z<B;Z++)xe+=`
`;return H[H.length-1]=" "+H[H.length-1]+"]"+(N?"":xe),H})(r,t,e,a,i),p=["Tensor"];return n&&(p.push("  dtype: "+e),p.push("  rank: "+c),p.push("  shape: ["+t+"]"),p.push("  values:")),p.push(f.map((function(d){return"    "+d})).join(`
`)),p.join(`
`)}function rc(r,t,e){return Vu(Array.isArray(r)?parseFloat(r[0].toFixed($0))+" + "+parseFloat(r[1].toFixed($0))+"j":s1(r)?"'"+r+"'":e==="bool"?gy(r):parseFloat(r.toFixed($0)).toString(),t)}function gy(r){return r===0?"false":"true"}function ac(r){for(var t=[],e=0;e<r.length;e+=2)t.push([r[e],r[e+1]]);return t}var hc=(function(){function r(t,e,n){var a=this;if(this.dtype=e,this.shape=t.slice(),this.size=Je(t),n!=null){var i=n.length;J(i===this.size,(function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+a.size+"'."}))}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||fh(e,this.size),this.strides=Ai(t)}return r.prototype.set=function(t){for(var e=this,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];n.length===0&&(n=[0]),J(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"}));var i=this.locToIndex(n);this.values[i]=t},r.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.length===0&&(t=[0]);for(var n=0,a=0,i=t;a<i.length;a++){var c=i[a];if(c<0||c>=this.shape[n]){var f="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(f)}n++}for(var p=t[t.length-1],d=0;d<t.length-1;++d)p+=this.strides[d]*t[d];return this.values[p]},r.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},r.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.toTensor=function(){return bi().makeTensor(this.values,this.shape,this.dtype)},r})(),bi=null,_e=null,vy=null,_n=(function(){function r(t,e,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=Je(t),this.strides=Ai(t),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return r.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},r.prototype.asScalar=function(){return this.throwIfDisposed(),J(this.size===1,(function(){return"The array must have only 1 element."})),this.reshape([])},r.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},r.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},r.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},r.prototype.as4D=function(t,e,n,a){return this.throwIfDisposed(),this.reshape([t,e,n,a])},r.prototype.as5D=function(t,e,n,a,i){return this.throwIfDisposed(),this.reshape([t,e,n,a,i])},r.prototype.asType=function(t){return this.throwIfDisposed(),_e.cast(this,t)},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.buffer=function(){return Ze(this,void 0,void 0,(function(){var t;return Qe(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,_e.buffer(this.shape,this.dtype,t)]}}))}))},r.prototype.bufferSync=function(){return _e.buffer(this.shape,this.dtype,this.dataSync())},r.prototype.array=function(){return Ze(this,void 0,void 0,(function(){var t;return Qe(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,L2(this.shape,t)]}}))}))},r.prototype.arraySync=function(){return L2(this.shape,this.dataSync())},r.prototype.data=function(){return Ze(this,void 0,void 0,(function(){var t,e;return Qe(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=bi().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(a){return hh(a)}))]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}}))}))},r.prototype.dataSync=function(){this.throwIfDisposed();var t=bi().readSync(this.dataId);if(this.dtype==="string")try{return t.map((function(e){return hh(e)}))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},r.prototype.bytes=function(){return Ze(this,void 0,void 0,(function(){var t;return Qe(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,bi().read(this.dataId)];case 1:return t=e.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},r.prototype.dispose=function(){this.isDisposed||(bi().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(r.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),r.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},r.prototype.toFloat=function(){return this.asType("float32")},r.prototype.toInt=function(){return this.asType("int32")},r.prototype.toBool=function(){return this.asType("bool")},r.prototype.print=function(t){return t===void 0&&(t=!1),_e.print(this,t)},r.prototype.reshape=function(t){return this.throwIfDisposed(),_e.reshape(this,t)},r.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},r.prototype.expandDims=function(t){return t===void 0&&(t=0),_e.expandDims(this,t)},r.prototype.cumsum=function(t,e,n){return t===void 0&&(t=0),e===void 0&&(e=!1),n===void 0&&(n=!1),_e.cumsum(this,t,e,n)},r.prototype.squeeze=function(t){return this.throwIfDisposed(),_e.squeeze(this,t)},r.prototype.clone=function(){return this.throwIfDisposed(),_e.clone(this)},r.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),_e.oneHot(this,t,e,n)},r.prototype.toString=function(t){return t===void 0&&(t=!1),SA(this.dataSync(),this.shape,this.dtype,t)},r.prototype.tile=function(t){return this.throwIfDisposed(),_e.tile(this,t)},r.prototype.gather=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),_e.gather(this,t,e)},r.prototype.matMul=function(t,e,n){return e===void 0&&(e=!1),n===void 0&&(n=!1),this.throwIfDisposed(),_e.matMul(this,t,e,n)},r.prototype.dot=function(t){return this.throwIfDisposed(),_e.dot(this,t)},r.prototype.norm=function(t,e,n){return t===void 0&&(t="euclidean"),e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),_e.norm(this,t,e,n)},r.prototype.slice=function(t,e){return this.throwIfDisposed(),_e.slice(this,t,e)},r.prototype.reverse=function(t){return this.throwIfDisposed(),_e.reverse(this,t)},r.prototype.concat=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),t instanceof r&&(t=[t]),_e.concat([this].concat(t),e)},r.prototype.split=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),_e.split(this,t,e)},r.prototype.stack=function(t,e){return e===void 0&&(e=0),_e.stack([this,t],e)},r.prototype.unstack=function(t){return t===void 0&&(t=0),_e.unstack(this,t)},r.prototype.pad=function(t,e){return e===void 0&&(e=0),_e.pad(this,t,e)},r.prototype.batchNormalization=function(t,e,n,a,i){return n===void 0&&(n=.001),vy("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,a,n)},r.prototype.batchNorm=function(t,e,n,a,i){return i===void 0&&(i=.001),this.throwIfDisposed(),_e.batchNorm(this,t,e,n,a,i)},r.prototype.all=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),_e.all(this,t,e)},r.prototype.any=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),_e.any(this,t,e)},r.prototype.logSumExp=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),_e.logSumExp(this,t,e)},r.prototype.sum=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),_e.sum(this,t,e)},r.prototype.prod=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),_e.prod(this,t,e)},r.prototype.mean=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),_e.mean(this,t,e)},r.prototype.min=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),_e.min(this,t,e)},r.prototype.max=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),_e.max(this,t,e)},r.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),_e.argMin(this,t)},r.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),_e.argMax(this,t)},r.prototype.cast=function(t){return this.throwIfDisposed(),_e.cast(this,t)},r.prototype.add=function(t){return this.throwIfDisposed(),_e.add(this,t)},r.prototype.addStrict=function(t){return this.throwIfDisposed(),_e.addStrict(this,t)},r.prototype.atan2=function(t){return this.throwIfDisposed(),_e.atan2(this,t)},r.prototype.sub=function(t){return this.throwIfDisposed(),_e.sub(this,t)},r.prototype.subStrict=function(t){return this.throwIfDisposed(),_e.subStrict(this,t)},r.prototype.pow=function(t){return this.throwIfDisposed(),_e.pow(this,t)},r.prototype.powStrict=function(t){return this.throwIfDisposed(),_e.powStrict(this,t)},r.prototype.mul=function(t){return this.throwIfDisposed(),_e.mul(this,t)},r.prototype.mulStrict=function(t){return this.throwIfDisposed(),_e.mulStrict(this,t)},r.prototype.div=function(t){return this.throwIfDisposed(),_e.div(this,t)},r.prototype.divNoNan=function(t){return this.throwIfDisposed(),_e.divNoNan(this,t)},r.prototype.floorDiv=function(t){return this.throwIfDisposed(),_e.floorDiv(this,t)},r.prototype.divStrict=function(t){return this.throwIfDisposed(),_e.divStrict(this,t)},r.prototype.minimum=function(t){return this.throwIfDisposed(),_e.minimum(this,t)},r.prototype.minimumStrict=function(t){return this.throwIfDisposed(),_e.minimumStrict(this,t)},r.prototype.maximum=function(t){return this.throwIfDisposed(),_e.maximum(this,t)},r.prototype.maximumStrict=function(t){return this.throwIfDisposed(),_e.maximumStrict(this,t)},r.prototype.mod=function(t){return this.throwIfDisposed(),_e.mod(this,t)},r.prototype.modStrict=function(t){return this.throwIfDisposed(),_e.modStrict(this,t)},r.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),_e.squaredDifferenceStrict(this,t)},r.prototype.transpose=function(t){return this.throwIfDisposed(),_e.transpose(this,t)},r.prototype.notEqual=function(t){return this.throwIfDisposed(),_e.notEqual(this,t)},r.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),_e.notEqualStrict(this,t)},r.prototype.less=function(t){return this.throwIfDisposed(),_e.less(this,t)},r.prototype.lessStrict=function(t){return this.throwIfDisposed(),_e.lessStrict(this,t)},r.prototype.equal=function(t){return this.throwIfDisposed(),_e.equal(this,t)},r.prototype.equalStrict=function(t){return this.throwIfDisposed(),_e.equalStrict(this,t)},r.prototype.lessEqual=function(t){return this.throwIfDisposed(),_e.lessEqual(this,t)},r.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),_e.lessEqualStrict(this,t)},r.prototype.greater=function(t){return this.throwIfDisposed(),_e.greater(this,t)},r.prototype.greaterStrict=function(t){return this.throwIfDisposed(),_e.greaterStrict(this,t)},r.prototype.greaterEqual=function(t){return this.throwIfDisposed(),_e.greaterEqual(this,t)},r.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),_e.greaterEqualStrict(this,t)},r.prototype.logicalAnd=function(t){return this.throwIfDisposed(),_e.logicalAnd(this,t)},r.prototype.logicalOr=function(t){return this.throwIfDisposed(),_e.logicalOr(this,t)},r.prototype.logicalNot=function(){return this.throwIfDisposed(),_e.logicalNot(this)},r.prototype.logicalXor=function(t){return this.throwIfDisposed(),_e.logicalXor(this,t)},r.prototype.where=function(t,e){return this.throwIfDisposed(),_e.where(t,this,e)},r.prototype.neg=function(){return this.throwIfDisposed(),_e.neg(this)},r.prototype.ceil=function(){return this.throwIfDisposed(),_e.ceil(this)},r.prototype.floor=function(){return this.throwIfDisposed(),_e.floor(this)},r.prototype.sign=function(){return this.throwIfDisposed(),_e.sign(this)},r.prototype.isNaN=function(){return this.throwIfDisposed(),_e.isNaN(this)},r.prototype.isInf=function(){return this.throwIfDisposed(),_e.isInf(this)},r.prototype.isFinite=function(){return this.throwIfDisposed(),_e.isFinite(this)},r.prototype.exp=function(){return this.throwIfDisposed(),_e.exp(this)},r.prototype.expm1=function(){return this.throwIfDisposed(),_e.expm1(this)},r.prototype.log=function(){return this.throwIfDisposed(),_e.log(this)},r.prototype.log1p=function(){return this.throwIfDisposed(),_e.log1p(this)},r.prototype.sqrt=function(){return this.throwIfDisposed(),_e.sqrt(this)},r.prototype.rsqrt=function(){return this.throwIfDisposed(),_e.rsqrt(this)},r.prototype.square=function(){return this.throwIfDisposed(),_e.square(this)},r.prototype.reciprocal=function(){return this.throwIfDisposed(),_e.reciprocal(this)},r.prototype.abs=function(){return this.throwIfDisposed(),_e.abs(this)},r.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),_e.clipByValue(this,t,e)},r.prototype.relu=function(){return this.throwIfDisposed(),_e.relu(this)},r.prototype.relu6=function(){return this.throwIfDisposed(),_e.relu6(this)},r.prototype.elu=function(){return this.throwIfDisposed(),_e.elu(this)},r.prototype.selu=function(){return this.throwIfDisposed(),_e.selu(this)},r.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),_e.leakyRelu(this,t)},r.prototype.prelu=function(t){return this.throwIfDisposed(),_e.prelu(this,t)},r.prototype.sigmoid=function(){return this.throwIfDisposed(),_e.sigmoid(this)},r.prototype.logSigmoid=function(){return this.throwIfDisposed(),_e.logSigmoid(this)},r.prototype.softplus=function(){return this.throwIfDisposed(),_e.softplus(this)},r.prototype.zerosLike=function(){return this.throwIfDisposed(),_e.zerosLike(this)},r.prototype.onesLike=function(){return this.throwIfDisposed(),_e.onesLike(this)},r.prototype.sin=function(){return this.throwIfDisposed(),_e.sin(this)},r.prototype.cos=function(){return this.throwIfDisposed(),_e.cos(this)},r.prototype.tan=function(){return this.throwIfDisposed(),_e.tan(this)},r.prototype.asin=function(){return this.throwIfDisposed(),_e.asin(this)},r.prototype.acos=function(){return this.throwIfDisposed(),_e.acos(this)},r.prototype.atan=function(){return this.throwIfDisposed(),_e.atan(this)},r.prototype.sinh=function(){return this.throwIfDisposed(),_e.sinh(this)},r.prototype.cosh=function(){return this.throwIfDisposed(),_e.cosh(this)},r.prototype.tanh=function(){return this.throwIfDisposed(),_e.tanh(this)},r.prototype.asinh=function(){return this.throwIfDisposed(),_e.asinh(this)},r.prototype.acosh=function(){return this.throwIfDisposed(),_e.acosh(this)},r.prototype.atanh=function(){return this.throwIfDisposed(),_e.atanh(this)},r.prototype.erf=function(){return this.throwIfDisposed(),_e.erf(this)},r.prototype.round=function(){return this.throwIfDisposed(),_e.round(this)},r.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),_e.step(this,t)},r.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),_e.softmax(this,t)},r.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),_e.logSoftmax(this,t)},r.prototype.resizeBilinear=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),_e.image.resizeBilinear(this,t,e)},r.prototype.resizeNearestNeighbor=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),_e.image.resizeNearestNeighbor(this,t,e)},r.prototype.conv1d=function(t,e,n,a,i,c){return a===void 0&&(a="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),_e.conv1d(this,t,e,n,a,i,c)},r.prototype.conv2d=function(t,e,n,a,i,c){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),_e.conv2d(this,t,e,n,a,i,c)},r.prototype.conv2dTranspose=function(t,e,n,a,i){return this.throwIfDisposed(),_e.conv2dTranspose(this,t,e,n,a,i)},r.prototype.depthwiseConv2D=function(t,e,n,a,i,c){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),_e.depthwiseConv2d(this,t,e,n,a,i,c)},r.prototype.separableConv2d=function(t,e,n,a,i,c){return i===void 0&&(i=[1,1]),c===void 0&&(c="NHWC"),this.throwIfDisposed(),_e.separableConv2d(this,t,e,n,a,i,c)},r.prototype.avgPool=function(t,e,n,a){return this.throwIfDisposed(),_e.avgPool(this,t,e,n,a)},r.prototype.maxPool=function(t,e,n,a){return this.throwIfDisposed(),_e.maxPool(this,t,e,n,a)},r.prototype.localResponseNormalization=function(t,e,n,a){return t===void 0&&(t=5),e===void 0&&(e=1),n===void 0&&(n=1),a===void 0&&(a=.5),_e.localResponseNormalization(this,t,e,n,a)},r.prototype.pool=function(t,e,n,a,i){return this.throwIfDisposed(),_e.pool(this,t,e,n,a,i)},r.prototype.variable=function(t,e,n){return t===void 0&&(t=!0),this.throwIfDisposed(),bi().makeVariable(this,t,e,n)},r.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),_e.unsortedSegmentSum(this,t,e)},r.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),_e.batchToSpaceND(this,t,e)},r.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),_e.spaceToBatchND(this,t,e)},r.prototype.topk=function(t,e){return t===void 0&&(t=1),e===void 0&&(e=!0),this.throwIfDisposed(),_e.topk(this,t,e)},r.prototype.stridedSlice=function(t,e,n,a,i,c,f,p){return a===void 0&&(a=0),i===void 0&&(i=0),c===void 0&&(c=0),f===void 0&&(f=0),p===void 0&&(p=0),this.throwIfDisposed(),_e.stridedSlice(this,t,e,n,a,i,c,f,p)},r.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),_e.depthToSpace(this,t,e)},r.prototype.fft=function(){return this.throwIfDisposed(),_e.spectral.fft(this)},r.prototype.ifft=function(){return this.throwIfDisposed(),_e.spectral.ifft(this)},r.prototype.rfft=function(){return this.throwIfDisposed(),_e.spectral.rfft(this)},r.prototype.irfft=function(){return this.throwIfDisposed(),_e.spectral.irfft(this)},r})();Object.defineProperty(_n,Symbol.hasInstance,{value:function(r){return!!r&&r.dataId!=null&&r.shape!=null&&r.dtype!=null}});var U2,kp,Lp,Fp,Pp,Qu=(function(r){function t(e,n,a,i){var c=r.call(this,e.shape,e.dtype,e.dataId,i)||this;return c.trainable=n,c.name=a,c}return Za(t,r),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!yr(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");bi().disposeTensor(this),this.dataId=e.dataId,bi().incRef(this,null)},t.prototype.dispose=function(){bi().disposeVariable(this),this.isDisposedInternal=!0},t})(_n);Object.defineProperty(Qu,Symbol.hasInstance,{value:function(r){return r instanceof _n&&r.assign!=null&&r.assign instanceof Function}}),(function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"})(U2||(U2={})),(function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"})(kp||(kp={})),(function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"})(Lp||(Lp={})),(function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"})(Fp||(Fp={})),(function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"})(Pp||(Pp={}));var _A={float32:Fp,int32:kp,bool:Lp,complex64:Pp};function _r(r,t){if(r==="string"||t==="string"){if(r==="string"&&t==="string")return"string";throw new Error("Can not upcast "+r+" with "+t)}return _A[r][t]}function ep(r){return _r(r,"int32")}function Rn(r,t){if(r.dtype===t.dtype)return[r,t];var e=_r(r.dtype,t.dtype);return[r.cast(e),t.cast(e)]}function TA(r,t){J(r.dtype===t.dtype,(function(){return"The dtypes of the first("+r.dtype+") and second("+t.dtype+") input must match"}))}function my(r){var t=[];return(function e(n,a,i){if(n!=null){if(n instanceof _n)return void a.push(n);if(c=n,!(!Array.isArray(c)&&typeof c!="object")){var c,f=n;for(var p in f){var d=f[p];i.has(d)||(i.add(d),e(d,a,i))}}}})(r,t,new Set),t}var tp,z2=(function(){function r(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return r.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},r})(),IA=(function(){function r(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new z2}return r.prototype.ready=function(){return Ze(this,void 0,void 0,(function(){var t,e,n;return Qe(this,(function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then((function(){}))];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),e=0,a.label=1;case 1:return e<t.length?(n=t[e],[4,this.initializeBackend(n).success]):[3,5];case 2:return a.sent()?[4,this.setBackend(n)]:[3,4];case 3:return a.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(r.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),r.prototype.backendNames=function(){return Object.keys(this.registryFactory)},r.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},r.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},r.prototype.registerBackend=function(t,e,n){return n===void 0&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},r.prototype.setBackend=function(t){return Ze(this,void 0,void 0,(function(){var e,n,a;return Qe(this,(function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return a=i.sent(),[3,3];case 2:a=n,i.label=3;case 3:if(!a)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new CA(this.backendInstance),[2,!0]}}))}))},r.prototype.setupRegisteredKernels=function(){var t=this;B2(this.backendName).forEach((function(e){e.setupFunc!=null&&e.setupFunc(t.backendInstance)}))},r.prototype.disposeRegisteredKernels=function(t){var e=this;B2(t).forEach((function(n){n.disposeFunc!=null&&n.disposeFunc(e.registry[t])}))},r.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(n==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var a=n.factory();if(Promise.resolve(a)===a){var i=++this.pendingBackendInitId,c=a.then((function(f){return!(i<e.pendingBackendInitId)&&(e.registry[t]=f,e.pendingBackendInit=null,!0)})).catch((function(f){return!(i<e.pendingBackendInitId)&&(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(f.stack||f.message),!1)}));return this.pendingBackendInit=c,{success:c,asyncInit:!0}}return this.registry[t]=a,{success:!0,asyncInit:!1}}catch(f){return console.warn("Initialization of backend "+t+" failed"),console.warn(f.stack||f.message),{success:!1,asyncInit:!1}}},r.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},r.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},r.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],a=this.initializeBackend(n),i=a.success,c=a.asyncInit;if(c||i)return{name:n,asyncInit:c}}throw new Error("Could not initialize any backends, all backend initializations failed.")},r.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),a=n.backend,i=this.readSync(e);a.disposeData(e),n.backend=t,t.move(e,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},r.prototype.tidy=function(t,e){var n,a=this,i=null;if(e==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");e=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof e!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((function(){return a.startScope(i)}),(function(){return a.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},r.prototype.scopedRun=function(t,e,n){t();try{var a=n();return e(),a}catch(i){throw e(),i}},r.prototype.nextTensorId=function(){return r.nextTensorId++},r.prototype.nextVariableId=function(){return r.nextVariableId++},r.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(function(a){return{x:function(){return a.toFloat()}}}),[]),e},r.prototype.runKernel=function(t,e,n,a,i){return this.runKernelFunc(null,e,null,t,n,a,i)},r.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},r.prototype.checkKernelForMemLeak=function(t,e,n){var a=this.backend.numDataIds(),i=0;n.forEach((function(p){i+=p.dtype==="complex64"?3:1}));var c=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],f=a-e-i-c;if(f>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+f+" data ids) after running '"+t+"'")},r.prototype.runKernelFunc=function(t,e,n,a,i,c,f){var p,d=this;c===void 0&&(c=[]),f===void 0&&(f=[]);var x=[],w=this.isTapeOn();a==null&&(a=this.state.activeScope!=null?this.state.activeScope.name:"");var C,S=function(B){w&&(x=B.map((function(k){return d.keep(d.clone(k))})))},R=this.state.numBytes,N=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var D,M=sy(a,this.backendName);return C=M!=null?function(){var B=d.backend.numDataIds();D=M.kernelFunc({inputs:e,attrs:i,backend:d.backend});var k=Array.isArray(D)?D:[D];d.shouldCheckForMemLeaks()&&d.checkKernelForMemLeak(a,B,k);var L=k.map((function(W){var G=W.dataId,q=W.shape,H=W.dtype;return d.makeTensorFromDataId(G,q,H)})),F=L.filter((function(W,G){return f[G]}));return S((c||[]).slice().concat(F)),L}:function(){var B=d.backend.numDataIds();D=d.tidy((function(){return t(d.backend,S)}));var k=Array.isArray(D)?D:[D];return d.shouldCheckForMemLeaks()&&d.checkKernelForMemLeak(a,B,k),k},this.scopedRun((function(){return d.state.kernelDepth++}),(function(){return d.state.kernelDepth--}),(function(){p=d.ENV.getBool("DEBUG")?d.profiler.profileKernel(a,e,(function(){return C()})):C()})),w&&this.addTapeNode(a,e,p,n,x),this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-R,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-N,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(B){return e[B].shape})),outputShapes:p.map((function(B){return B.shape}))}),Array.isArray(D)?p:p[0]},r.prototype.makeTensor=function(t,e,n,a){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;var i=t;n==="string"&&s1(t[0])&&(i=t.map((function(x){return wA(x)})));var c=a.write(i,e,n),f=new _n(e,n,c,this.nextTensorId());if(this.incRef(f,a),n==="string"){var p=this.state.tensorInfo.get(c),d=xA(i);this.state.numBytes+=d-p.bytes,p.bytes=d}return f},r.prototype.makeTensorFromDataId=function(t,e,n,a){var i=new _n(e,n=n||"float32",t,this.nextTensorId());return this.incRef(i,a),i},r.prototype.makeVariable=function(t,e,n,a){e===void 0&&(e=!0),n=n||this.nextVariableId().toString(),a!=null&&a!==t.dtype&&(t=t.asType(a));var i=new Qu(t,e,n,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},r.prototype.incRef=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,n===0){this.state.numDataBuffers++;var a=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(a=t.size*fy(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:a,refCount:0}),this.state.numBytes+=a}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Qu||this.track(t)},r.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},r.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},r.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},r.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},r.prototype.profile=function(t){return Ze(this,void 0,void 0,(function(){var e,n;return Qe(this,(function(a){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(i){return i.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},r.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},r.prototype.addTapeNode=function(t,e,n,a,i){var c=this,f={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},p=cA(t);p!=null&&(a=p.gradFunc),a!=null&&(f.gradient=function(d){return d=d.map((function(x,w){if(x==null){var C=n[w],S=Ec(C.size,C.dtype);return c.makeTensor(S,C.shape,C.dtype)}return x})),a(d.length>1?d:d[0],i)}),this.state.activeTape.push(f)},r.prototype.keep=function(t){return t.kept=!0,t},r.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},r.prototype.endTape=function(){this.state.gradientDepth--},r.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},r.prototype.endScope=function(t){for(var e=this,n=my(t),a=new Set(n.map((function(p){return p.id}))),i=0;i<this.state.activeScope.track.length;i++){var c=this.state.activeScope.track[i];c.kept||a.has(c.id)||c.dispose()}var f=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(p){p.kept||p.scopeId!==f.id||e.track(p)}))},r.prototype.gradients=function(t,e,n,a){var i=this;if(a===void 0&&(a=!1),J(e.length>0,(function(){return"gradients() received an empty list of xs."})),n!=null&&n.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var c=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",t)}));J(c instanceof _n,(function(){return"The result y returned by f() must be a tensor."}));var f=(function(p,d,x){for(var w={},C={},S=0;S<d.length;S++)w[d[S].id]=!0;for(S=0;S<p.length;S++){var R=(W=p[S]).inputs;for(var N in R){for(var D=R[N],M=!1,B=0;B<d.length;B++)if(w[D.id]){W.outputs.forEach((function(Z){return w[Z.id]=!0})),M=!0,C[W.id]=!0;break}if(M)break}}var k={};k[x.id]=!0;var L={};for(S=p.length-1;S>=0;S--)for(R=(W=p[S]).inputs,B=0;B<W.outputs.length;B++)if(k[W.outputs[B].id]){for(var N in R)k[R[N].id]=!0,L[W.id]=!0;break}var F=[];for(S=0;S<p.length;S++){var W;if(C[(W=p[S]).id]&&L[W.id]){var G={};for(var N in W.inputs){var q=W.inputs[N];w[q.id]&&(G[N]=q)}var H=Object.assign({},W);H.inputs=G,H.outputs=W.outputs,F.push(H)}}return F})(this.state.activeTape,e,c);if(!a&&f.length===0&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var p,d,x={};x[c.id]=n??(p=c.shape,d=dy(Je(p),"float32"),le.makeTensor(d,p,"float32")),(function(C,S,R){for(var N=function(M){var B=S[M],k=[];if(B.outputs.forEach((function(G){var q=C[G.id];q!=null?k.push(q):k.push(null)})),B.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+B.kernelName+".");var L=B.gradient(k),F=function(G){if(!(G in L))throw new Error("Cannot backprop through input "+G+". Available gradients found: "+Object.keys(L)+".");var q=R((function(){return L[G]()}));if(q.dtype!=="float32")throw new Error("Error in gradient for op "+B.kernelName+". The gradient of input "+G+" must have 'float32' dtype, but has '"+q.dtype+"'");var H=B.inputs[G];if(!yr(q.shape,H.shape))throw new Error("Error in gradient for op "+B.kernelName+". The gradient of input '"+G+"' has shape '"+q.shape+"', which does not match the shape of the input '"+H.shape+"'");if(C[H.id]==null)C[H.id]=q;else{var Z=C[H.id];C[H.id]=Z.add(q),Z.dispose()}};for(var W in B.inputs)F(W)},D=S.length-1;D>=0;D--)N(D)})(x,f,(function(C){return i.tidy(C)}));var w=e.map((function(C){return x[C.id]}));return i.state.gradientDepth===0&&(i.state.activeTape.forEach((function(C){for(var S=0,R=C.saved;S<R.length;S++)R[S].dispose()})),i.state.activeTape=null),{value:c,grads:w}}))},r.prototype.customGrad=function(t){var e=this;return J(Op(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];J(a.every((function(f){return f instanceof _n})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var c={};return a.forEach((function(f,p){c[p]=f})),e.runKernelFunc((function(f,p){return J((n=t.apply(void 0,a.concat([p]))).value instanceof _n,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),J(Op(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),c,(function(f,p){var d=n.gradFunc(f,p),x=Array.isArray(d)?d:[d];J(x.length===a.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),J(x.every((function(C){return C instanceof _n})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var w={};return x.forEach((function(C,S){w[S]=function(){return C}})),w}))}},r.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},r.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},r.prototype.time=function(t){return Ze(this,void 0,void 0,(function(){var e,n;return Qe(this,(function(a){switch(a.label){case 0:return e=yi(),[4,this.backend.time(t)];case 1:return(n=a.sent()).wallMs=yi()-e,[2,n]}}))}))},r.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(r.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),r.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new z2,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},r.nextTensorId=0,r.nextVariableId=0,r})(),le=(function(){var r=(function(){if(tp==null){var e=void 0;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else{if(typeof self>"u")throw new Error("Could not find a global object");e=self}tp=e}return tp})();if(r._tfengine==null){var t=new uA(r);r._tfengine=new IA(t)}return(function(e){oy=e})(r._tfengine.ENV),bi=function(){return r._tfengine},r._tfengine})();function xy(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var $i=Re();$i.registerFlag("DEBUG",(function(){return!1}),(function(r){r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),$i.registerFlag("IS_BROWSER",(function(){return xy()})),$i.registerFlag("IS_NODE",(function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0})),$i.registerFlag("IS_CHROME",(function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),$i.registerFlag("PROD",(function(){return!1})),$i.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return $i.getBool("DEBUG")})),$i.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),$i.registerFlag("IS_TEST",(function(){return!1}));var dc,wa,ya,Ms={},np={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function RA(r,t){Ms[r]=t}function Ri(r){r in Ms||(Ms[r]=(function(e){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=(function(a){if(typeof OffscreenCanvas<"u"&&a===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")})(e);return n.addEventListener("webglcontextlost",(function(a){a.preventDefault(),delete Ms[e]}),!1),e===1?n.getContext("webgl",np)||n.getContext("experimental-webgl",np):n.getContext("webgl2",np)})(r));var t=Ms[r];return t.isContextLost()?(delete Ms[r],Ri(r)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Ms[r])}function kh(r,t){return[t,r]}function sc(r){var t=Je(r);return Mp(Math.ceil(t/4))}function Cc(r,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(r/2))]}function u1(r,t){var e,n,a,i,c,f,p,d,x,w=r;return Re().getNumber("WEBGL_VERSION")===2?(e=w.R32F,n=w.R16F,a=w.RGBA16F,i=w.RGBA32F,c=w.RED,f=4,p=1,d=w.HALF_FLOAT,x=w.FLOAT):(e=r.RGBA,n=r.RGBA,a=r.RGBA,i=w.RGBA,c=r.RGBA,f=4,p=4,d=t!=null?t.HALF_FLOAT_OES:null,x=r.FLOAT),{internalFormatFloat:e,internalFormatHalfFloat:n,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:c,downloadTextureFormat:r.RGBA,downloadUnpackNumChannels:f,defaultNumChannels:p,textureTypeHalfFloat:d,textureTypeFloat:x}}function $e(r,t,e){var n=e();return t&&(function(a){var i=a.getError();if(i!==a.NO_ERROR)throw new Error("WebGL Error: "+OA(a,i))})(r),n}(function(r){r[r.DENSE=0]="DENSE",r[r.SHARED_BATCH=1]="SHARED_BATCH"})(dc||(dc={})),(function(r){r[r.RENDER=0]="RENDER",r[r.UPLOAD=1]="UPLOAD",r[r.PIXELS=2]="PIXELS",r[r.DOWNLOAD=3]="DOWNLOAD"})(wa||(wa={})),(function(r){r[r.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",r[r.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",r[r.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",r[r.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",r[r.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(ya||(ya={}));var NA=596e-10,DA=65504;function MA(r){return!!(Re().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||r===0||NA<Math.abs(r)&&Math.abs(r)<DA)}function OA(r,t){switch(t){case r.NO_ERROR:return"NO_ERROR";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Gf(r,t,e){return oo(r,t,(function(){return r.getExtension(e)}),'Extension "'+e+'" not supported on this browser.')}function BA(r,t,e){var n=oo(r,t,(function(){return r.createShader(r.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if($e(r,t,(function(){return r.shaderSource(n,e)})),$e(r,t,(function(){return r.compileShader(n)})),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw console.log(r.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function kA(r,t,e){var n=oo(r,t,(function(){return r.createShader(r.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if($e(r,t,(function(){return r.shaderSource(n,e)})),$e(r,t,(function(){return r.compileShader(n)})),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw(function(a,i){var c=LA.exec(i);if(c==null)return console.log("Couldn't parse line number in error: "+i),void console.log(a);for(var f=+c[1],p=a.split(`
`),d=p.length.toString().length+2,x=p.map((function(D,M){return Vu((M+1).toString(),d)+D})),w=0,C=0;C<x.length;C++)w=Math.max(x[C].length,w);var S=x.slice(0,f-1),R=x.slice(f-1,f),N=x.slice(f);console.log(S.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+Vu(R[0],w),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(N.join(`
`))})(e,r.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var rp,ap,LA=/ERROR: [0-9]+:([0-9]+):/g;function FA(r,t){return oo(r,t,(function(){return r.createProgram()}),"Unable to create WebGLProgram.")}function PA(r,t,e){if($e(r,t,(function(){return r.linkProgram(e)})),r.getProgramParameter(e,r.LINK_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function ip(r,t,e){if($e(r,t,(function(){return r.validateProgram(e)})),r.getProgramParameter(e,r.VALIDATE_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function UA(r,t,e){var n=oo(r,t,(function(){return r.createBuffer()}),"Unable to create WebGLBuffer");return $e(r,t,(function(){return r.bindBuffer(r.ARRAY_BUFFER,n)})),$e(r,t,(function(){return r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW)})),n}function zA(r,t,e){var n=oo(r,t,(function(){return r.createBuffer()}),"Unable to create WebGLBuffer");return $e(r,t,(function(){return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n)})),$e(r,t,(function(){return r.bufferData(r.ELEMENT_ARRAY_BUFFER,e,r.STATIC_DRAW)})),n}function HA(r,t){return oo(r,t,(function(){return r.createTexture()}),"Unable to create WebGLTexture.")}function VA(r,t){var e=Re().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(r<=0||t<=0){var n="["+r+"x"+t+"]";throw new Error("Requested texture size "+n+" is invalid.")}if(r>e||t>e)throw n="["+r+"x"+t+"]",new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+("["+e+"x"+e+"]")+".")}function WA(r,t){return oo(r,t,(function(){return r.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function H2(r,t,e,n,a,i,c,f){var p=r.getAttribLocation(e,n);return p!==-1&&($e(r,t,(function(){return r.bindBuffer(r.ARRAY_BUFFER,a)})),$e(r,t,(function(){return r.vertexAttribPointer(p,i,r.FLOAT,!1,c,f)})),$e(r,t,(function(){return r.enableVertexAttribArray(p)})),!0)}function GA(r,t,e,n){KA(r,n),$e(r,t,(function(){return r.activeTexture(r.TEXTURE0+n)})),$e(r,t,(function(){return r.bindTexture(r.TEXTURE_2D,e)}))}function jA(r,t,e,n){return oo(r,t,(function(){return r.getUniformLocation(e,n)}),'uniform "'+n+'" not present in program.')}function XA(r,t,e){return r.getUniformLocation(t,e)}function YA(r,t,e,n,a,i){$e(r,t,(function(){return GA(r,t,n,i)})),$e(r,t,(function(){return r.uniform1i(a,i)}))}function op(r,t,e,n){$e(r,t,(function(){return r.bindFramebuffer(r.FRAMEBUFFER,n)})),$e(r,t,(function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0)}))}function V2(r,t,e){$e(r,t,(function(){return r.bindFramebuffer(r.FRAMEBUFFER,e)})),$e(r,t,(function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0)}))}function jf(r){var t=r.checkFramebufferStatus(r.FRAMEBUFFER);if(t!==r.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+qA(r,t))}function qA(r,t){switch(t){case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case r.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function oo(r,t,e,n){var a=$e(r,t,(function(){return e()}));if(a==null)throw new Error(n);return a}function KA(r,t){var e=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=t+r.TEXTURE0;if(n<r.TEXTURE0||n>e)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+e+"]")+".")}function dh(r,t){return t===void 0&&(t=2),Je(r.slice(0,r.length-t))}function ph(r){if(r.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[r.length>1?r[r.length-2]:1,r[r.length-1]]}function sp(r){var t=[1,1,1];return r.length===0||r.length===1&&r[0]===1||(t=[dh(r)].concat(ph(r))),t}function ZA(r,t){var e;t===void 0&&(t=!1);var n=Re().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,(r=r.map((function(d,x){return x>=r.length-2?cy(r[x]):r[x]}))).length===1&&(r=[2,r[0]])),r.length!==2){var a=Bs(r);r=a.newShape}var i=Je(r);if(r.length<=1&&i<=n)return[1,i];if(r.length===2&&r[0]<=n&&r[1]<=n)return r;if(r.length===3&&r[0]*r[1]<=n&&r[2]<=n)return[r[0]*r[1],r[2]];if(r.length===3&&r[0]<=n&&r[1]*r[2]<=n)return[r[0],r[1]*r[2]];if(r.length===4&&r[0]*r[1]*r[2]<=n&&r[3]<=n)return[r[0]*r[1]*r[2],r[3]];if(r.length===4&&r[0]<=n&&r[1]*r[2]*r[3]<=n)return[r[0],r[1]*r[2]*r[3]];if(t){var c=dh(r),f=2,p=2;return r.length&&(f=(e=ph(r))[0],p=e[1]),Mp(i=c*(f/2)*(p/2)).map((function(d){return 2*d}))}return Mp(i)}function Xf(r){return r%2==0}function Yf(r,t){if(yr(r=r.slice(-2),t=t.slice(-2))||!r.length||!t.length||r[0]===0||r[1]===0||t[0]===0||t[1]===0)return!0;if(r.length!==t.length){var e=r.slice(-1)[0],n=t.slice(-1)[0];if(e===n||Xf(e)&&Xf(n)&&(r[0]===1||t[0]===1))return!0}return r[1]===t[1]&&Xf(r[0])&&Xf(t[0])}function QA(r){if(rp==null){var t=Ri(r);rp=t.getParameter(t.MAX_TEXTURE_SIZE)}return rp}function JA(r){if(ap==null){var t=Ri(r);ap=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ap)}function $A(r){if(r===0)return 0;var t=Ri(r);return Fa(t,"EXT_disjoint_timer_query_webgl2")&&r===2?2:Fa(t,"EXT_disjoint_timer_query")?1:0}function Fa(r,t){return r.getExtension(t)!=null}function W2(r){try{if(Ri(r)!=null)return!0}catch{return!1}return!1}function eS(r){if(r===0)return!1;var t=Ri(r);if(r===1){if(!Fa(t,"OES_texture_float"))return!1}else if(!Fa(t,"EXT_color_buffer_float"))return!1;return Up(t)}function tS(r){if(r===0)return!1;var t=Ri(r);if(r!==1){if(Fa(t,"EXT_color_buffer_float"))return Up(t);if(Fa(t,"EXT_color_buffer_half_float")){var e=t.getExtension("EXT_color_buffer_half_float");return(function(n,a){var i=u1(n,a),c=n.createTexture();n.bindTexture(n.TEXTURE_2D,c),n.texImage2D(n.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var f=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,f),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,c,0);var p=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(c),n.deleteFramebuffer(f),p})(t,e)}return!1}return!!Fa(t,"OES_texture_float")&&!!Fa(t,"WEBGL_color_buffer_float")&&Up(t)}function Up(r){var t=u1(r),e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e),r.texImage2D(r.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var n=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,n),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0);var a=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(e),r.deleteFramebuffer(n),a}function nS(r){return r===2&&Ri(r).fenceSync!=null}var pt=Re();function yy(r){Re().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(r+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Xe(r,t){return le.tidy(r,t)}function ra(r){my(r).forEach((function(t){return t.dispose()}))}function rS(r){return le.keep(r)}function gh(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];Re().getBool("IS_TEST")||console.warn.apply(console,r)}function rs(r,t){var e=r;if(Ci(r))return t==="string"?[]:[r.length];if(!Array.isArray(r))return[];for(var n=[];Array.isArray(e)||Ci(e)&&t!=="string";)n.push(e.length),e=e[0];return Array.isArray(r)&&Re().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&(function a(i,c,f){if(f=f||[],!Array.isArray(i)&&!Ci(i))return void J(c.length===0,(function(){return"Element arr["+f.join("][")+"] is a primitive, but should be an array/TypedArray of "+c[0]+" elements"}));J(c.length>0,(function(){return"Element arr["+f.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"})),J(i.length===c[0],(function(){return"Element arr["+f.join("][")+"] should have "+c[0]+" elements, but has "+i.length+" elements"}));for(var p=c.slice(1),d=0;d<i.length;++d)a(i[d],p,f.concat(d))})(r,n,[]),n}function G2(r,t,e,n){if(r!=null&&(r!=="numeric"&&r!==t||r==="numeric"&&t==="string"))throw new Error("Argument '"+e+"' passed to '"+n+"' must be "+r+" tensor, but got "+t+" tensor")}function X(r,t,e,n){if(n===void 0&&(n="numeric"),r instanceof _n)return G2(n,r.dtype,t,e),r;var a=wc(r);if(a!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(a=n),G2(n,a,t,e),r==null||!Ci(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){var i=r==null?"null":r.constructor.name;throw new Error("Argument '"+t+"' passed to '"+e+"' must be a Tensor or TensorLike, but got '"+i+"'")}var c=rs(r,a);Ci(r)||Array.isArray(r)||(r=[r]);var f=a!=="string"?hy(r,a,Re().getBool("DEBUG")):Zu(r,[],!0);return le.makeTensor(f,c,a)}function vh(r,t,e,n){if(n===void 0&&(n="numeric"),!Array.isArray(r))throw new Error("Argument "+t+" passed to "+e+" must be a `Tensor[]` or `TensorLike[]`");return r.map((function(a,i){return X(a,t+"["+i+"]",e)}),n)}function by(r,t){for(var e=0;e<r.length;++e)if(r[r.length-e-1]!==t-1-e)return!1;return!0}function aS(r,t,e){for(var n=r.length+t.length,a=[],i=0,c=0,f=0;f<n;f++)e.indexOf(f)===-1?a.push(r[i++]):a.push(t[c++]);return a}function kr(r,t){for(var e=[],n=r.length,a=0;a<n;a++)t.indexOf(a)===-1&&e.push(r[a]);return[e,t.map((function(i){return r[i]}))]}function aa(r,t){return aS(r,t.map((function(e){return 1})),t)}function xa(r,t,e){J(by(t,e),(function(){return r+" supports only inner-most axes for now. Got axes "+t+" and rank-"+e+" input."}))}function Ni(r,t){if(by(r,t))return null;for(var e=[],n=0;n<t;++n)r.indexOf(n)===-1&&e.push(n);return r.forEach((function(a){return e.push(a)})),e}function l1(r){return r.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function Di(r,t){for(var e=[],n=t-r;n<t;++n)e.push(n);return e}function iS(r,t){var e=r[0].length;r.forEach((function(a,i){J(a.length===e,(function(){return"Error in concat"+e+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+e+")"}))})),J(t>=0&&t<e,(function(){return"Error in concat"+e+"D: axis must be between 0 and "+(e-1)+"."}));var n=r[0];r.forEach((function(a,i){for(var c=0;c<e;c++)J(c===t||a[c]===n[c],(function(){return"Error in concat"+e+"D: Shape of tensors["+i+"] ("+a+") does not match the shape of the rest ("+n+") along the non-concatenated axis "+i+"."}))}))}function Ju(r,t){for(var e=r[0].slice(),n=1;n<r.length;n++)e[t]+=r[n][t];return e}function oe(r){var t=Object.keys(r);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var e=t[0],n=r[e];e.endsWith("_")&&(e=e.substring(0,e.length-1));var a=function(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];le.startScope(e);try{var f=n.apply(void 0,i);return f instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),le.endScope(f),f}catch(p){throw le.endScope(null),p}};return Object.defineProperty(a,"name",{value:e,configurable:!0}),a}pt.registerFlag("HAS_WEBGL",(function(){return pt.getNumber("WEBGL_VERSION")>0})),pt.registerFlag("WEBGL_VERSION",(function(){return W2(2)?2:W2(1)?1:0})),pt.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return pt.get("WEBGL_VERSION")===2})),pt.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),pt.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),pt.registerFlag("WEBGL_PACK",(function(){return pt.getBool("HAS_WEBGL")})),pt.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return pt.getBool("WEBGL_PACK")})),pt.registerFlag("WEBGL_PACK_CLIP",(function(){return pt.getBool("WEBGL_PACK")})),pt.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),pt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return pt.getBool("WEBGL_PACK")})),pt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return pt.getBool("WEBGL_PACK")})),pt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return pt.getBool("WEBGL_PACK")})),pt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return pt.getBool("WEBGL_PACK")})),pt.registerFlag("WEBGL_PACK_REDUCE",(function(){return pt.getBool("WEBGL_PACK")})),pt.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return pt.getBool("WEBGL_PACK")})),pt.registerFlag("WEBGL_CONV_IM2COL",(function(){return pt.getBool("WEBGL_PACK")})),pt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return QA(pt.getNumber("WEBGL_VERSION"))})),pt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return JA(pt.getNumber("WEBGL_VERSION"))})),pt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var r=pt.getNumber("WEBGL_VERSION");return r===0?0:$A(r)})),pt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return pt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(r=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(r)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(r.substr(0,4))));var r})),pt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return eS(pt.getNumber("WEBGL_VERSION"))})),pt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!pt.getBool("WEBGL_FORCE_F16_TEXTURES")&&pt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),pt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return tS(pt.getNumber("WEBGL_VERSION"))})),pt.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return nS(pt.getNumber("WEBGL_VERSION"))})),pt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return pt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),vy=yy;var Sr=oe({complex_:function(r,t){var e=X(r,"real","complex"),n=X(t,"imag","complex");return Jt(e.shape,n.shape,"real and imag shapes, "+e.shape+" and "+n.shape+", must match in call to tf.complex()."),le.runKernelFunc((function(a){return a.complex(e,n)}),{$real:e,$imag:n})}}),La=oe({real_:function(r){var t=X(r,"input","real");return le.runKernelFunc((function(e){return e.real(t)}),{$input:t})}}),wi=oe({imag_:function(r){var t=X(r,"input","imag");return le.runKernelFunc((function(e){return e.imag(t)}),{$input:t})}});function Tr(r,t,e){return as(r,t,rs(r,e),e)}function as(r,t,e,n){if(n==null&&(n=wc(r)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Ci(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){py(t);var a=Je(t),i=Je(e);J(a===i,(function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+i}));for(var c=0;c<e.length;++c){var f=e[c],p=c!==e.length-1||f!==Je(t.slice(c));J(e[c]===t[c]||!p,(function(){return"Error creating a new Tensor. Inferred shape ("+e+") does not match the provided shape ("+t+"). "}))}}return Ci(r)||Array.isArray(r)||(r=[r]),t=t||e,r=n!=="string"?hy(r,n,Re().getBool("DEBUG")):Zu(r,[],!0),le.makeTensor(r,t,n)}function Ge(r,t){if((Ci(r)&&t!=="string"||Array.isArray(r))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Ci(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return as(r,[],[],t)}function Zn(r,t){nl(r);var e=rs(r,t);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return as(r,null,e,t)}function Qo(r,t,e){if(nl(r),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var n=rs(r,e);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return as(r,t,n,e)}function c1(r,t,e){if(nl(r),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var n=rs(r,e);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return as(r,t,n,e)}function ta(r,t,e){if(nl(r),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var n=rs(r,e);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return as(r,t,n,e)}function oS(r,t,e){if(nl(r),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var n=rs(r,e);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return as(r,t,n,e)}function sS(r,t,e){if(nl(r),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var n=rs(r,e);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return as(r,t=t||n,n,e)}function uS(r,t,e,n){return t===void 0&&(t=!0),le.makeVariable(r,t,e,n)}function rl(r,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=rl(r,"float32"),n=yn(r,"float32");return Sr(e,n)}var a=dy(Je(r),t);return le.makeTensor(a,r,t)}function yn(r,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=yn(r,"float32"),n=yn(r,"float32");return Sr(e,n)}var a=Ec(Je(r),t);return le.makeTensor(a,r,t)}function Si(r,t,e){return le.runKernelFunc((function(n){return n.fill(r,t,e)}),{})}function lS(r,t,e){if(e<=0)throw new Error("The number of values should be positive.");return le.runKernelFunc((function(n){return n.linspace(r,t,e)}),{})}function mh(r,t,e,n){if(e===void 0&&(e=1),n===void 0&&(n="float32"),e===0)throw new Error("Cannot have a step of zero");if(r===t||r<t&&e<0||t<r&&e>1)return yn([0],n);var a=Ec(Math.abs(Math.ceil((t-r)/e)),n);t<r&&e===1&&(e=-1),a[0]=r;for(var i=1;i<a.length;i++)a[i]=a[i-1]+e;return Zn(a,n)}var wy=oe({onesLike_:function(r){var t=X(r,"x","onesLike");if(t.dtype==="complex64"){var e=wy(La(t)),n=Ut(wi(t));return Sr(e,n)}return le.runKernelFunc((function(a){return a.onesLike(t)}),{$x:t},(function(a,i){return{$x:function(){return Ut(a)}}}))}}),Ut=oe({zerosLike_:function(r){var t=X(r,"x","zerosLike");return le.runKernelFunc((function(e){return e.zerosLike(t)}),{$x:t},(function(e,n){return{$x:function(){return Ut(e)}}}))}}),or=oe({concat_:function(r,t){t===void 0&&(t=0),J(r.length>=1,(function(){return"Pass at least one tensor to concat"}));var e=vh(r,"tensors","concat");e[0].dtype==="complex64"&&e.forEach((function(f){if(f.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+f.dtype+". ")})),t=cr(t,e[0].shape)[0];var n=Ju(e.map((function(f){return f.shape})),t);if(Je(n)===0)return Tr([],n);if((e=e.filter((function(f){return f.size>0}))).length===1)return e[0];var a=e.map((function(f){return f.shape}));iS(a,t);var i=e,c={axis:t};return le.runKernelFunc((function(f){return f.concat(e,t)}),i,(function(f){var p=a.map((function(d){return d[t]}));return f1(f,p,t).map((function(d){return function(){return d}}))}),"Concat",c)}}),cS=oe({concat1d_:function(r){return or(r,0)}}),fS=oe({concat2d_:function(r,t){return or(r,t)}}),hS=oe({concat3d_:function(r,t){return or(r,t)}}),dS=oe({concat4d_:function(r,t){return or(r,t)}}),f1=oe({split_:function(r,t,e){e===void 0&&(e=0);var n,a=X(r,"x","split");return e=cr(e,a.shape)[0],typeof t=="number"?(J(a.shape[e]%t==0,(function(){return"Number of splits must evenly divide the axis."})),n=new Array(t).fill(a.shape[e]/t)):(J(a.shape[e]===t.reduce((function(i,c){return i+c})),(function(){return"The sum of sizes must match the size of the axis dimension."})),n=t),le.runKernelFunc((function(i){return i.split(a,n,e)}),{$x:a},(function(i){return{$x:function(){return or(i,e)}}}))}});function Hs(r,t){return r(t={exports:{}},t.exports),t.exports}var pS=Hs((function(r){(function(t,e,n){function a(f){var p,d=this,x=(p=4022871197,function(w){w=w.toString();for(var C=0;C<w.length;C++){var S=.02519603282416938*(p+=w.charCodeAt(C));S-=p=S>>>0,p=(S*=p)>>>0,p+=4294967296*(S-=p)}return 23283064365386963e-26*(p>>>0)});d.next=function(){var w=2091639*d.s0+23283064365386963e-26*d.c;return d.s0=d.s1,d.s1=d.s2,d.s2=w-(d.c=0|w)},d.c=1,d.s0=x(" "),d.s1=x(" "),d.s2=x(" "),d.s0-=x(f),d.s0<0&&(d.s0+=1),d.s1-=x(f),d.s1<0&&(d.s1+=1),d.s2-=x(f),d.s2<0&&(d.s2+=1),x=null}function i(f,p){return p.c=f.c,p.s0=f.s0,p.s1=f.s1,p.s2=f.s2,p}function c(f,p){var d=new a(f),x=p&&p.state,w=d.next;return w.int32=function(){return 4294967296*d.next()|0},w.double=function(){return w()+11102230246251565e-32*(2097152*w()|0)},w.quick=w,x&&(typeof x=="object"&&i(x,d),w.state=function(){return i(d,{})}),w}e&&e.exports?e.exports=c:this.alea=c})(0,r)})),gS=Hs((function(r){(function(t,e,n){function a(f){var p=this,d="";p.x=0,p.y=0,p.z=0,p.w=0,p.next=function(){var w=p.x^p.x<<11;return p.x=p.y,p.y=p.z,p.z=p.w,p.w^=p.w>>>19^w^w>>>8},f===(0|f)?p.x=f:d+=f;for(var x=0;x<d.length+64;x++)p.x^=0|d.charCodeAt(x),p.next()}function i(f,p){return p.x=f.x,p.y=f.y,p.z=f.z,p.w=f.w,p}function c(f,p){var d=new a(f),x=p&&p.state,w=function(){return(d.next()>>>0)/4294967296};return w.double=function(){do var C=((d.next()>>>11)+(d.next()>>>0)/4294967296)/2097152;while(C===0);return C},w.int32=d.next,w.quick=w,x&&(typeof x=="object"&&i(x,d),w.state=function(){return i(d,{})}),w}e&&e.exports?e.exports=c:this.xor128=c})(0,r)})),vS=Hs((function(r){(function(t,e,n){function a(f){var p=this,d="";p.next=function(){var w=p.x^p.x>>>2;return p.x=p.y,p.y=p.z,p.z=p.w,p.w=p.v,(p.d=p.d+362437|0)+(p.v=p.v^p.v<<4^w^w<<1)|0},p.x=0,p.y=0,p.z=0,p.w=0,p.v=0,f===(0|f)?p.x=f:d+=f;for(var x=0;x<d.length+64;x++)p.x^=0|d.charCodeAt(x),x==d.length&&(p.d=p.x<<10^p.x>>>4),p.next()}function i(f,p){return p.x=f.x,p.y=f.y,p.z=f.z,p.w=f.w,p.v=f.v,p.d=f.d,p}function c(f,p){var d=new a(f),x=p&&p.state,w=function(){return(d.next()>>>0)/4294967296};return w.double=function(){do var C=((d.next()>>>11)+(d.next()>>>0)/4294967296)/2097152;while(C===0);return C},w.int32=d.next,w.quick=w,x&&(typeof x=="object"&&i(x,d),w.state=function(){return i(d,{})}),w}e&&e.exports?e.exports=c:this.xorwow=c})(0,r)})),mS=Hs((function(r){(function(t,e,n){function a(f){var p=this;p.next=function(){var d,x,w=p.x,C=p.i;return d=w[C],x=(d^=d>>>7)^d<<24,x^=(d=w[C+1&7])^d>>>10,x^=(d=w[C+3&7])^d>>>3,x^=(d=w[C+4&7])^d<<7,d=w[C+7&7],x^=(d^=d<<13)^d<<9,w[C]=x,p.i=C+1&7,x},(function(d,x){var w,C=[];if(x===(0|x))C[0]=x;else for(x=""+x,w=0;w<x.length;++w)C[7&w]=C[7&w]<<15^x.charCodeAt(w)+C[w+1&7]<<13;for(;C.length<8;)C.push(0);for(w=0;w<8&&C[w]===0;++w);for(w==8?C[7]=-1:C[w],d.x=C,d.i=0,w=256;w>0;--w)d.next()})(p,f)}function i(f,p){return p.x=f.x.slice(),p.i=f.i,p}function c(f,p){f==null&&(f=+new Date);var d=new a(f),x=p&&p.state,w=function(){return(d.next()>>>0)/4294967296};return w.double=function(){do var C=((d.next()>>>11)+(d.next()>>>0)/4294967296)/2097152;while(C===0);return C},w.int32=d.next,w.quick=w,x&&(x.x&&i(x,d),w.state=function(){return i(d,{})}),w}e&&e.exports?e.exports=c:this.xorshift7=c})(0,r)})),xS=Hs((function(r){(function(t,e,n){function a(f){var p=this;p.next=function(){var d,x,w=p.w,C=p.X,S=p.i;return p.w=w=w+1640531527|0,x=C[S+34&127],d=C[S=S+1&127],x^=x<<13,d^=d<<17,x^=x>>>15,d^=d>>>12,x=C[S]=x^d,p.i=S,x+(w^w>>>16)|0},(function(d,x){var w,C,S,R,N,D=[],M=128;for(x===(0|x)?(C=x,x=null):(x+="\0",C=0,M=Math.max(M,x.length)),S=0,R=-32;R<M;++R)x&&(C^=x.charCodeAt((R+32)%x.length)),R===0&&(N=C),C^=C<<10,C^=C>>>15,C^=C<<4,C^=C>>>13,R>=0&&(N=N+1640531527|0,S=(w=D[127&R]^=C+N)==0?S+1:0);for(S>=128&&(D[127&(x&&x.length||0)]=-1),S=127,R=512;R>0;--R)C=D[S+34&127],w=D[S=S+1&127],C^=C<<13,w^=w<<17,C^=C>>>15,w^=w>>>12,D[S]=C^w;d.w=N,d.X=D,d.i=S})(p,f)}function i(f,p){return p.i=f.i,p.w=f.w,p.X=f.X.slice(),p}function c(f,p){f==null&&(f=+new Date);var d=new a(f),x=p&&p.state,w=function(){return(d.next()>>>0)/4294967296};return w.double=function(){do var C=((d.next()>>>11)+(d.next()>>>0)/4294967296)/2097152;while(C===0);return C},w.int32=d.next,w.quick=w,x&&(x.X&&i(x,d),w.state=function(){return i(d,{})}),w}e&&e.exports?e.exports=c:this.xor4096=c})(0,r)})),yS=Hs((function(r){(function(t,e,n){function a(f){var p=this,d="";p.next=function(){var w=p.b,C=p.c,S=p.d,R=p.a;return w=w<<25^w>>>7^C,C=C-S|0,S=S<<24^S>>>8^R,R=R-w|0,p.b=w=w<<20^w>>>12^C,p.c=C=C-S|0,p.d=S<<16^C>>>16^R,p.a=R-w|0},p.a=0,p.b=0,p.c=-1640531527,p.d=1367130551,f===Math.floor(f)?(p.a=f/4294967296|0,p.b=0|f):d+=f;for(var x=0;x<d.length+20;x++)p.b^=0|d.charCodeAt(x),p.next()}function i(f,p){return p.a=f.a,p.b=f.b,p.c=f.c,p.d=f.d,p}function c(f,p){var d=new a(f),x=p&&p.state,w=function(){return(d.next()>>>0)/4294967296};return w.double=function(){do var C=((d.next()>>>11)+(d.next()>>>0)/4294967296)/2097152;while(C===0);return C},w.int32=d.next,w.quick=w,x&&(typeof x=="object"&&i(x,d),w.state=function(){return i(d,{})}),w}e&&e.exports?e.exports=c:this.tychei=c})(0,r)})),Os=Hs((function(r){(function(t,e){var n,a=this,i=256,c=6,f="random",p=e.pow(i,c),d=e.pow(2,52),x=2*d,w=i-1;function C(M,B,k){var L=[],F=N((function q(H,Z){var ie,ee=[],me=typeof H;if(Z&&me=="object")for(ie in H)try{ee.push(q(H[ie],Z-1))}catch{}return ee.length?ee:me=="string"?H:H+"\0"})((B=B==1?{entropy:!0}:B||{}).entropy?[M,D(t)]:M??(function(){try{var q;return n&&(q=n.randomBytes)?q=q(i):(q=new Uint8Array(i),(a.crypto||a.msCrypto).getRandomValues(q)),D(q)}catch{var H=a.navigator,Z=H&&H.plugins;return[+new Date,a,Z,a.screen,D(t)]}})(),3),L),W=new S(L),G=function(){for(var q=W.g(c),H=p,Z=0;q<d;)q=(q+Z)*i,H*=i,Z=W.g(1);for(;q>=x;)q/=2,H/=2,Z>>>=1;return(q+Z)/H};return G.int32=function(){return 0|W.g(4)},G.quick=function(){return W.g(4)/4294967296},G.double=G,N(D(W.S),t),(B.pass||k||function(q,H,Z,ie){return ie&&(ie.S&&R(ie,W),q.state=function(){return R(W,{})}),Z?(e[f]=q,H):q})(G,F,"global"in B?B.global:this==e,B.state)}function S(M){var B,k=M.length,L=this,F=0,W=L.i=L.j=0,G=L.S=[];for(k||(M=[k++]);F<i;)G[F]=F++;for(F=0;F<i;F++)G[F]=G[W=w&W+M[F%k]+(B=G[F])],G[W]=B;(L.g=function(q){for(var H,Z=0,ie=L.i,ee=L.j,me=L.S;q--;)H=me[ie=w&ie+1],Z=Z*i+me[w&(me[ie]=me[ee=w&ee+H])+(me[ee]=H)];return L.i=ie,L.j=ee,Z})(i)}function R(M,B){return B.i=M.i,B.j=M.j,B.S=M.S.slice(),B}function N(M,B){for(var k,L=M+"",F=0;F<L.length;)B[w&F]=w&(k^=19*B[w&F])+L.charCodeAt(F++);return D(B)}function D(M){return String.fromCharCode.apply(0,M)}if(e["seed"+f]=C,N(e.random(),t),r.exports){r.exports=C;try{n=require("crypto")}catch{}}})([],Math)}));Os.alea=pS,Os.xor128=gS,Os.xorwow=vS,Os.xorshift7=mS,Os.xor4096=xS,Os.tychei=yS;var Lh=Os.alea,h1=(function(){function r(t,e,n,a,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var c=i||Math.random();this.random=Lh(c.toString())}return r.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,a=!1;!a;){var i=void 0,c=void 0,f=void 0;do f=(i=2*this.random()-1)*i+(c=2*this.random()-1)*c;while(f>=1||f===0);var p=Math.sqrt(-2*Math.log(f)/f);e=this.mean+this.stdDev*i*p,n=this.mean+this.stdDev*c*p,this.truncated&&!this.isValidTruncated(e)||(a=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},r.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},r.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},r})(),bS=(function(){function r(t,e,n,a){this.alpha=t,this.beta=1/e,this.dtype=n;var i=a||Math.random();this.randu=Lh(i.toString()),this.randn=new h1(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return r.prototype.nextValue=function(){for(var t,e,n,a,i,c;;){do a=this.randn.nextValue(),c=1+this.c*a;while(c<=0);if(c*=c*c,e=1-.331*(t=a*a)*t,n=.5*t+this.d*(1-c+Math.log(c)),(i=this.randu())<e||Math.log(i)<n)break}return c=1/this.beta*this.d*c,this.alpha<1&&(c*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(c)},r.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},r})(),wS=(function(){function r(t,e,n,a){var i=this;if(t===void 0&&(t=0),e===void 0&&(e=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=e-t,this.dtype=n,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=Lh(a)}return r.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},r.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},r})();function yt(r,t,e){return t===void 0&&(t="float32"),t=t||"float32",py(r),new hc(r,t,e)}function ES(r,t){t===void 0&&(t=!1),console.log(r.toString(t))}var Ey=oe({batchToSpaceND_:function(r,t,e){var n=X(r,"x","batchToSpaceND"),a=t.reduce((function(i,c){return i*c}));return J(n.rank>=1+t.length,(function(){return"input rank is "+n.rank+" but should be > than blockShape.length "+t.length})),J(e.length===t.length,(function(){return"crops.length is "+e.length+" but should be equal to blockShape.length  "+t.length})),J(n.shape[0]%a==0,(function(){return"input tensor batch is "+n.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a})),le.runKernelFunc((function(i){return i.batchToSpaceND(n,t,e)}),{$x:n},(function(i){return{$x:function(){return i.spaceToBatchND(t,e)}}}))}}),CS=oe({broadcastTo_:function(r,t){var e=X(r,"broadcastTo","x"),n=e.shape;if(t.some((function(p){return!(p>0)||p%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<e.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+e.rank+".");if(t.length>e.rank){for(var a=e.shape.slice();a.length<t.length;)a.unshift(1);e=e.reshape(a)}for(var i=Array.from(t),c=t.length-1;c>=0;c--)if(e.shape[c]===t[c])i[c]=1;else if(e.shape[c]!==1)throw new Error("broadcastTo(): ["+n+"] cannot be broadcast to ["+t+"].");var f=i.map((function(p,d){return p>1?d:-1})).filter((function(p){return p>=0}));return f.length===0?e.clone():le.runKernelFunc((function(p){return p.tile(e,i)}),{input:e},(function(p){return{input:function(){return p.sum(f,!0)}}}))}}),AS=oe({cast_:function(r,t){var e=X(r,"x","cast");if(!vA(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&e.dtype!=="string"||t!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");var n={dtype:t};return le.runKernelFunc((function(a){return a.cast(e,t)}),{x:e},(function(a){return{x:function(){return a.clone()}}}),"Cast",n)}}),SS=oe({clone_:function(r){var t=X(r,"x","clone",null);return le.runKernelFunc((function(){return le.makeTensorFromDataId(t.dataId,t.shape,t.dtype)}),{$x:t},(function(e){return{$x:function(){return e.toFloat()}}}))}}),_S=oe({cumsum_:function(r,t,e,n){t===void 0&&(t=0),e===void 0&&(e=!1),n===void 0&&(n=!1);var a=X(r,"x","cumsum"),i=Ni([t|=0],a.rank),c=a;i!=null&&(c=a.transpose(i));var f=Di(1,a.rank)[0],p=le.runKernelFunc((function(d){return d.cumsum(c,f,e,n)}),{permutedX:c},(function(d){return{permutedX:function(){return d.cumsum(t,e,!n)}}}));return i!=null&&(p=p.transpose(i)),p}}),TS=oe({depthToSpace_:function(r,t,e){e===void 0&&(e="NHWC");var n=X(r,"x","depthToSpace"),a=e==="NHWC"?n.shape[1]:n.shape[2],i=e==="NHWC"?n.shape[2]:n.shape[3],c=e==="NHWC"?n.shape[3]:n.shape[1];return J(a*t>=0,(function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+`  for depthToSpace with input shape
      `+n.shape})),J(i*t>=0,(function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+n.shape})),J(c%(t*t)==0,(function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+c+" for depthToSpace with input shape "+n.shape})),le.runKernelFunc((function(f){return f.depthToSpace(n,t,e)}),{$x:n})}}),ka=oe({expandDims_:function(r,t){t===void 0&&(t=0);var e=X(r,"x","expandDims",null);J(t<=e.rank,(function(){return"Axis must be <= rank of the tensor"}));var n=e.shape.slice();return t<0&&(J(-(e.rank+1)<=t,(function(){return"Axis must be in the interval ["+-(e.rank+1)+", "+e.rank+"]"})),t=e.rank+t+1),n.splice(t,0,1),qa(e,n)}}),Cy=oe({eye_:function(r,t,e,n){n===void 0&&(n="float32"),t==null&&(t=r);for(var a=yt([r,t],n),i=r<=t?r:t,c=0;c<i;++c)a.set(1,c,c);var f=a.toTensor().as2D(r,t);if(e==null)return f;if(e.length===1)return Wu(ka(f,0),[e[0],1,1]);if(e.length===2)return Wu(ka(ka(f,0),0),[e[0],e[1],1,1]);if(e.length===3)return Wu(ka(ka(ka(f,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+e.length+"D.")}}),IS=oe({multinomial_:function(r,t,e,n){n===void 0&&(n=!1);var a=X(r,"logits","multinomial"),i=a.size,c=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(c>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+c);e=e||Math.random();var f=c===1?a.as2D(1,-1):a,p=le.runKernelFunc((function(d){return d.multinomial(f,n,t,e)}),{logits2D:f});return c===1?p.as1D():p}}),zp=oe({oneHot_:function(r,t,e,n){if(e===void 0&&(e=1),n===void 0&&(n=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=X(r,"indices","oneHot","int32"),i=a.shape.concat([t]);return a=a.flatten(),le.runKernelFunc((function(c){return c.oneHot(a,t,e,n)}),{$indices:a},(function(c){return{$indices:function(){return yn(a.shape,"float32")}}})).reshape(i)}}),Vs=oe({pad_:function(r,t,e){e===void 0&&(e=0);var n=X(r,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:e};return le.runKernelFunc((function(i){return i.pad(n,t,e)}),{x:n},(function(i){var c=t.map((function(f){return f[0]}));return{x:function(){return i.slice(c,n.shape)}}}),"PadV2",a)}}),RS=oe({pad1d_:function(r,t,e){return e===void 0&&(e=0),J(t.length===2,(function(){return"Invalid number of paddings. Must be length of 2."})),Vs(r,[t],e)}}),NS=oe({pad2d_:function(r,t,e){return e===void 0&&(e=0),J(t.length===2&&t[0].length===2&&t[1].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Vs(r,t,e)}}),DS=oe({pad3d_:function(r,t,e){return e===void 0&&(e=0),J(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Vs(r,t,e)}}),MS=oe({pad4d_:function(r,t,e){return e===void 0&&(e=0),J(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Vs(r,t,e)}}),OS=oe({rand_:function(r,t,e){var n=Je(r),a=null;if(e==null||e==="float32")a=new Float32Array(n);else if(e==="int32")a=new Int32Array(n);else{if(e!=="bool")throw new Error("Unknown data type "+e);a=new Uint8Array(n)}for(var i=0;i<n;i++)a[i]=t();return le.makeTensor(a,r,e)}}),BS=oe({randomNormal_:function(r,t,e,n,a){if(t===void 0&&(t=0),e===void 0&&(e=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new h1(t,e,n,!1,a),c=yt(r,n),f=0;f<c.values.length;f++)c.values[f]=i.nextValue();return c.toTensor()}}),kS=oe({randomGamma_:function(r,t,e,n,a){if(e===void 0&&(e=1),n===void 0&&(n="float32"),e==null&&(e=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error("Unsupported data type "+n);for(var i=new bS(t,e,n,a),c=yt(r,n),f=0;f<c.values.length;f++)c.values[f]=i.nextValue();return c.toTensor()}}),Ay=oe({randomUniform_:function(r,t,e,n,a){t===void 0&&(t=0),e===void 0&&(e=1),n===void 0&&(n="float32");for(var i=yt(r,n),c=new wS(t,e,null,a),f=0;f<i.values.length;f++)i.values[f]=c.nextValue();return i.toTensor()}}),qa=oe({reshape_:function(r,t){var e=X(r,"x","reshape",null);t=pA(t,e.size),J(e.size===Je(t),(function(){return"new shape and old shape must have the same number of elements."}));var n={shape:t};return le.runKernelFunc((function(a){return a.reshape(e,t)}),{x:e},(function(a){return{x:function(){return a.reshape(e.shape)}}}),"Reshape",n)}}),Sy=oe({spaceToBatchND_:function(r,t,e){var n=X(r,"x","spaceToBatchND");return J(n.rank>=1+t.length,(function(){return"input rank "+n.rank+" should be > than [blockShape] "+t.length})),J(e.length===t.length,(function(){return"paddings.shape[0] "+e.length+" must be equal to [blockShape] "+t.length})),J(n.shape.reduce((function(a,i,c){return c>0&&c<=t.length?a&&(i+e[c-1][0]+e[c-1][1])%t[c-1]==0:a}),!0),(function(){return"input spatial dimensions "+n.shape.slice(1)+" with paddings "+e.toString()+" must be divisible by blockShapes "+t.toString()})),le.runKernelFunc((function(a){return a.spaceToBatchND(n,t,e)}),{$x:n},(function(a){return{$x:function(){return a.batchToSpaceND(t,e)}}}))}}),_y=oe({squeeze_:function(r,t){var e=X(r,"x","squeeze");return qa(e,Bs(e.shape,t).newShape)}}),Sa=oe({stack_:function(r,t){t===void 0&&(t=0);var e=vh(r,"tensors","stack");if(J(e.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),e.length===1)return e[0].expandDims(t);var n=e[0].rank,a=e[0].shape,i=e[0].dtype;J(t<=n,(function(){return"Axis must be <= rank of the tensor"})),e.forEach((function(f){Jt(a,f.shape,"All tensors passed to stack must have matching shapes")})),e.forEach((function(f){J(i===f.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var c=e.map((function(f){return f.expandDims(t)}));return or(c,t)}}),Wu=oe({tile_:function(r,t){var e=X(r,"x","tile",null);J(e.rank===t.length,(function(){return"Error in transpose: rank of input "+e.rank+" must match length of reps "+t+"."}));var n=[e],a={reps:t};return le.runKernelFunc((function(i,c){var f=i.tile(e,t);return c([e]),f}),{x:e},(function(i,c){var f=c[0];return{x:function(){var p=Ut(f);if(f.rank===1)for(var d=0;d<t[0];++d)p=p.add(i.slice([d*f.shape[0]],[f.shape[0]]));else if(f.rank===2)for(d=0;d<t[0];++d)for(var x=0;x<t[1];++x)p=p.add(i.slice([d*f.shape[0],x*f.shape[1]],[f.shape[0],f.shape[1]]));else if(f.rank===3)for(d=0;d<t[0];++d)for(x=0;x<t[1];++x)for(var w=0;w<t[2];++w)p=p.add(i.slice([d*f.shape[0],x*f.shape[1],w*f.shape[2]],[f.shape[0],f.shape[1],f.shape[2]]));else{if(f.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+f.rank+" tensors yet.");for(d=0;d<t[0];++d)for(x=0;x<t[1];++x)for(w=0;w<t[2];++w)for(var C=0;C<t[3];++C)p=p.add(i.slice([d*f.shape[0],x*f.shape[1],w*f.shape[2],C*f.shape[3]],[f.shape[0],f.shape[1],f.shape[2],f.shape[3]]))}return p}}}),"Tile",a,n)}}),LS=oe({truncatedNormal_:function(r,t,e,n,a){if(t===void 0&&(t=0),e===void 0&&(e=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new h1(t,e,n,!0,a),c=yt(r,n),f=0;f<c.values.length;f++)c.values[f]=i.nextValue();return c.toTensor()}}),sr=oe({unstack_:function(r,t){t===void 0&&(t=0),t=t||0;var e=X(r,"x","unstack");J(t>=-e.shape.length&&t<e.shape.length,(function(){return"Axis = "+t+" is not in [-"+e.shape.length+", "+e.shape.length+")"})),t<0&&(t+=e.shape.length);var n={axis:t};return le.runKernelFunc((function(a){return a.unstack(e,t)}),{x:e},(function(a){return{x:function(){return Sa(a,t)}}}),"Unpack",n)}}),FS=function(r,t){return Ze(this,void 0,void 0,(function(){var e,n,a,i,c,f,p,d,x,w;return Qe(this,(function(C){switch(C.label){case 0:return e=X(r,"x","setdiff1d"),n=X(t,"y","setdiff1d"),J(e.dtype===n.dtype,(function(){return"x and y should have the same dtype, but got x ("+e.dtype+") and y ("+n.dtype+")."})),J(e.rank===1,(function(){return"x should be 1D tensor, but got x ("+e.shape+")."})),J(n.rank===1,(function(){return"y should be 1D tensor, but got y ("+n.shape+")."})),[4,e.data()];case 1:return a=C.sent(),[4,n.data()];case 2:for(i=C.sent(),c=new Set(i),f=0,x=0;x<a.length;x++)c.has(a[x])||f++;for(p=new hc([f],e.dtype),d=new hc([f],"int32"),x=0,w=0;x<a.length;x++)c.has(a[x])||(p.values[w]=a[x],d.values[w]=x,w++);return[2,[p.toTensor(),d.toTensor()]]}}))}))};function xh(r,t,e,n){n===void 0&&(n=!0);var a=[];if(n)(a=a.concat(t.slice(0))).push(r[0]/e),a=a.concat(r.slice(1));else{a=a.concat(r[0]);for(var i=t.length,c=0;c<i;++c)a=a.concat([r[c+1]/t[c],t[c]]);a=a.concat(r.slice(i+1))}return a}function yh(r,t,e){e===void 0&&(e=!0);var n=[];if(e){n.push(t);for(var a=t+1;a<r;++a)a<=2*t?(n.push(a),n.push(a-(t+1))):n.push(a)}else{var i=[],c=[];for(a=1;a<r;++a)a>=2*t+1||a%2==1?c.push(a):i.push(a);n.push.apply(n,i),n.push(0),n.push.apply(n,c)}return n}function bh(r,t,e,n){n===void 0&&(n=!0);var a=[];n?a.push(r[0]/e):a.push(r[0]*e);for(var i=1;i<r.length;++i)i<=t.length?n?a.push(t[i-1]*r[i]):a.push(r[i]/t[i-1]):a.push(r[i]);return a}function Ty(r,t){for(var e=[0],n=0;n<t;++n)e.push(r[n][0]);return e}function Iy(r,t,e){for(var n=r.slice(0,1),a=0;a<e;++a)n.push(r[a+1]-t[a][0]-t[a][1]);return n}function Ry(r,t){if(r.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+r.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>r.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+r.rank);if(r.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+r.shape+".");for(var e=t.shape,n=e[e.length-1],a=1,i=0;i<e.length-1;++i)a*=e[i];var c=r.shape,f=e.slice();f.pop();var p=1;for(i=n;i<r.rank;++i)p*=c[i],f.push(c[i]);var d=Ai(r.shape).map((function(x){return x/p})).concat([1]).slice(0,n);return[f,a,p,d]}var Ny=30;function up(r){return r<=Ny?r:Bp(r,Math.floor(Math.sqrt(r)))}function PS(r,t,e){var n=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+e.shape+", indices.shape: "+t.shape+", shape: "+r+", sliceDim: "+n+", and batchDim: "+a+".";if(e.rank<a)throw new Error(i+" update.rank < "+a+". ");if(r.length<n+(e.rank-a))throw new Error(i+" Output shape length < "+(n+(e.rank-a)));if(e.rank!==a+r.length-n)throw new Error(i+" update.rank != "+(a+r.length-n));for(var c=0;c<a;++c)if(e.shape[c]!==t.shape[c])throw new Error(i+" updates.shape["+c+"] ("+e.shape[c]+") != indices.shape["+c+"] ("+t.shape[c]+").");for(c=0;c<e.rank-a;++c)if(e.shape[c+a]!==r[c+n])throw new Error(i+" updates.shape["+(c+a)+"] ("+e.shape[c+a]+") != shape["+(c+a)+"] ("+r[c+a]+")")}function US(r,t,e){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(r.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+r.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(e.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+e);if(e.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(r.size===0)throw new Error("Updates specified for empty output. updates shape: "+r.shape)}PS(e,t,r)}function wh(r,t,e){for(var n=t.shape.length,a=n>1?t.shape[n-1]:1,i=e.length,c=1,f=a;f<i;++f)c*=e[f];var p=a<1?1:a;return{sliceRank:a,numUpdates:Je(t.shape)/p,sliceSize:c,strides:Ai(e.slice(0,a)).concat([1]),outputSize:Je(e)}}function zS(r,t,e){J(r.rank===t.length,(function(){return"Error in slice"+r.rank+"D: Length of begin "+t+" must match the rank of the array ("+r.rank+")."})),J(r.rank===e.length,(function(){return"Error in slice"+r.rank+"D: Length of size "+e+" must match the rank of the array ("+r.rank+")."}));for(var n=function(i){J(t[i]+e[i]<=r.shape[i],(function(){return"Error in slice"+r.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+e[i])+") would overflow input.shape["+i+"] ("+r.shape[i]+")"}))},a=0;a<r.rank;++a)n(a)}function j2(r){for(var t=[],e=0;r>0;)1&r&&t.push(e),r/=2,e++;return t}function d1(r,t,e){for(var n=[],a=0;a<r.length;a++)n[a]=Math.ceil((t[a]-r[a])/e[a]);return n}function HS(r,t,e,n,a){var i=t[a],c=e[a]||1;(r&1<<a||i==null)&&(i=c>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var f=n[a];return i<0&&(i+=f),i=Dp(0,i,f-1)}function VS(r,t,e,n,a){var i=t[a],c=e[a]||1;(r&1<<a||i==null)&&(i=c>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var f=n[a];return i<0&&(i+=f),i=c>0?Dp(0,i,f):Dp(-1,i,f-1)}function Dy(r,t,e){for(var n=e.length,a=0;a<e.length;a++)if(e[a]>1){n=a;break}for(a=n+1;a<e.length;a++)if(t[a]>0||e[a]!==r[a])return!1;return!0}function My(r,t){for(var e=r.length>0?r[r.length-1]:1,n=0;n<r.length-1;n++)e+=r[n]*t[n];return e}function WS(r,t){J(Op(r),(function(){return"The f passed in variableGrads(f) must be a function"})),J(t==null||Array.isArray(t)&&t.every((function(x){return x instanceof Qu})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var e=t!=null;if(!e)for(var n in t=[],le.registeredVariables)t.push(le.registeredVariables[n]);var a=e?t.filter((function(x){return!x.trainable})):null,i=t.length;J((t=t.filter((function(x){return x.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."}));var c=le.gradients(r,t,null,!0),f=c.value,p=c.grads;J(p.some((function(x){return x!=null})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),J(f.rank===0,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+f.rank+" tensor"}));var d={};return t.forEach((function(x,w){p[w]!=null&&(d[x.name]=p[w])})),a?.forEach((function(x){return d[x.name]=null})),{value:f,grads:d}}function Fh(r){return le.customGrad(r)}var so=oe({softmax_:function(r,t){t===void 0&&(t=-1);var e=X(r,"logits","softmax","float32");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and dim was "+t);return le.runKernelFunc((function(n,a){var i=n.softmax(e,t);return a([i]),i}),{logits:e},(function(n,a){var i=a[0],c=n.mul(i);return{logits:function(){return c.sub(c.sum([t],!0).mul(i))}}}),"Softmax",{dim:t},[],[!0])}}),GS=oe({logSoftmax_:function(r,t){t===void 0&&(t=-1);var e=X(r,"logits","logSoftmax");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and axis was "+t);return Fh((function(n,a){var i=n.max(t,!0),c=n.sub(i),f=c.toFloat().sub(c.exp().sum(t,!0).log());return a([f]),{value:f,gradFunc:function(p,d){var x=d[0].exp();return p.sub(p.sum(t,!0).mul(x))}}}))(e)}}),Oy=(function(){function r(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return r.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},r.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},r.prototype.has=function(t){return this.data.has(t)},r.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},r.prototype.numDataIds=function(){return this.dataIdsCount},r})(),By=(function(){function r(){}return r.prototype.time=function(t){return Ee("time")},r.prototype.read=function(t){return Ee("read")},r.prototype.readSync=function(t){return Ee("readSync")},r.prototype.numDataIds=function(){return Ee("numDataIds")},r.prototype.disposeData=function(t){return Ee("disposeData")},r.prototype.write=function(t,e,n){return Ee("write")},r.prototype.move=function(t,e,n,a){return Ee("move")},r.prototype.memory=function(){return Ee("memory")},r.prototype.floatPrecision=function(){return Ee("floatPrecision")},r.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},r.prototype.batchMatMul=function(t,e,n,a){return Ee("batchMatMul")},r.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,Ee("fusedBatchMatMul")},r.prototype.slice=function(t,e,n){return Ee("slice")},r.prototype.stridedSlice=function(t,e,n,a){return Ee("stridedSlice")},r.prototype.unstack=function(t,e){return Ee("unstack")},r.prototype.reverse=function(t,e){return Ee("reverse")},r.prototype.concat=function(t,e){return Ee("concat")},r.prototype.neg=function(t){return Ee("neg")},r.prototype.add=function(t,e){return Ee("add")},r.prototype.addN=function(t){return Ee("addN")},r.prototype.subtract=function(t,e){return Ee("subtract")},r.prototype.multiply=function(t,e){return Ee("multiply")},r.prototype.realDivide=function(t,e){return Ee("realDivide")},r.prototype.floorDiv=function(t,e){return Ee("floorDiv")},r.prototype.sum=function(t,e){return Ee("sum")},r.prototype.prod=function(t,e){return Ee("prod")},r.prototype.unsortedSegmentSum=function(t,e,n){return Ee("unsortedSegmentSum")},r.prototype.argMin=function(t,e){return Ee("argMin")},r.prototype.argMax=function(t,e){return Ee("argMax")},r.prototype.equal=function(t,e){return Ee("equal")},r.prototype.notEqual=function(t,e){return Ee("notEqual")},r.prototype.less=function(t,e){return Ee("less")},r.prototype.lessEqual=function(t,e){return Ee("lessEqual")},r.prototype.greater=function(t,e){return Ee("greater")},r.prototype.greaterEqual=function(t,e){return Ee("greaterEqual")},r.prototype.logicalNot=function(t){return Ee("logicalNot")},r.prototype.logicalAnd=function(t,e){return Ee("logicalAnd")},r.prototype.logicalOr=function(t,e){return Ee("logicalOr")},r.prototype.where=function(t){return Ee("where")},r.prototype.select=function(t,e,n){return Ee("select")},r.prototype.topk=function(t,e,n){return Ee("topk")},r.prototype.min=function(t,e){return Ee("min")},r.prototype.minimum=function(t,e){return Ee("minimum")},r.prototype.mod=function(t,e){return Ee("mod")},r.prototype.max=function(t,e){return Ee("max")},r.prototype.maximum=function(t,e){return Ee("maximum")},r.prototype.all=function(t,e){return Ee("all")},r.prototype.any=function(t,e){return Ee("any")},r.prototype.squaredDifference=function(t,e){return Ee("squaredDifference")},r.prototype.ceil=function(t){return Ee("ceil")},r.prototype.floor=function(t){return Ee("floor")},r.prototype.round=function(t){return Ee("round")},r.prototype.sign=function(t){return Ee("sign")},r.prototype.isNaN=function(t){return Ee("isNaN")},r.prototype.isInf=function(t){return Ee("isInf")},r.prototype.isFinite=function(t){return Ee("isFinite")},r.prototype.pow=function(t,e){return Ee("pow")},r.prototype.exp=function(t){return Ee("exp")},r.prototype.expm1=function(t){return Ee("expm1")},r.prototype.softmax=function(t,e){return Ee("softmax")},r.prototype.log=function(t){return Ee("log")},r.prototype.log1p=function(t){return Ee("log1p")},r.prototype.sqrt=function(t){return Ee("sqrt")},r.prototype.rsqrt=function(t){return Ee("rsqrt")},r.prototype.square=function(t){return Ee("square")},r.prototype.reciprocal=function(t){return Ee("reciprocal")},r.prototype.relu=function(t){return Ee("relu")},r.prototype.relu6=function(t){return Ee("relu6")},r.prototype.prelu=function(t,e){return Ee("prelu")},r.prototype.elu=function(t){return Ee("elu")},r.prototype.eluDer=function(t,e){return Ee("eluDer")},r.prototype.selu=function(t){return Ee("selu")},r.prototype.int=function(t){return Ee("int")},r.prototype.clip=function(t,e,n){return Ee("clip")},r.prototype.abs=function(t){return Ee("abs")},r.prototype.complexAbs=function(t){return Ee("complexAbs")},r.prototype.sigmoid=function(t){return Ee("sigmoid")},r.prototype.softplus=function(t){return Ee("softplus")},r.prototype.sin=function(t){return Ee("sin")},r.prototype.cos=function(t){return Ee("cos")},r.prototype.tan=function(t){return Ee("tan")},r.prototype.asin=function(t){return Ee("asin")},r.prototype.acos=function(t){return Ee("acos")},r.prototype.atan=function(t){return Ee("atan")},r.prototype.atan2=function(t,e){return Ee("atan2")},r.prototype.sinh=function(t){return Ee("sinh")},r.prototype.cosh=function(t){return Ee("cosh")},r.prototype.tanh=function(t){return Ee("tanh")},r.prototype.asinh=function(t){return Ee("asinh")},r.prototype.acosh=function(t){return Ee("acosh")},r.prototype.atanh=function(t){return Ee("atanh")},r.prototype.erf=function(t){return Ee("erf")},r.prototype.step=function(t,e){return Ee("step")},r.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,Ee("fusedConv2d")},r.prototype.conv2d=function(t,e,n){return Ee("conv2d")},r.prototype.conv2dDerInput=function(t,e,n){return Ee("conv2dDerInput")},r.prototype.conv2dDerFilter=function(t,e,n){return Ee("conv2dDerFilter")},r.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,Ee("fusedDepthwiseConv2D")},r.prototype.depthwiseConv2D=function(t,e,n){return Ee("depthwiseConv2D")},r.prototype.depthwiseConv2DDerInput=function(t,e,n){return Ee("depthwiseConv2DDerInput")},r.prototype.depthwiseConv2DDerFilter=function(t,e,n){return Ee("depthwiseConv2DDerFilter")},r.prototype.conv3d=function(t,e,n){return Ee("conv3d")},r.prototype.conv3dDerInput=function(t,e,n){return Ee("conv3dDerInput")},r.prototype.conv3dDerFilter=function(t,e,n){return Ee("conv3dDerFilter")},r.prototype.maxPool=function(t,e){return Ee("maxPool")},r.prototype.maxPoolBackprop=function(t,e,n,a){return Ee("maxPoolBackprop")},r.prototype.avgPool=function(t,e){return Ee("avgPool")},r.prototype.avgPoolBackprop=function(t,e,n){return Ee("avgPoolBackprop")},r.prototype.avgPool3d=function(t,e){return Ee("avgPool3d")},r.prototype.avgPool3dBackprop=function(t,e,n){return Ee("avgPool3dBackprop")},r.prototype.maxPool3d=function(t,e){return Ee("maxPool3d")},r.prototype.maxPool3dBackprop=function(t,e,n,a){return Ee("maxPool3dBackprop")},r.prototype.reshape=function(t,e){return Ee("reshape")},r.prototype.cast=function(t,e){return Ee("cast")},r.prototype.tile=function(t,e){return Ee("tile")},r.prototype.pad=function(t,e,n){return Ee("pad")},r.prototype.transpose=function(t,e){return Ee("transpose")},r.prototype.gather=function(t,e,n){return Ee("gather")},r.prototype.gatherND=function(t,e){return Ee("gatherND")},r.prototype.scatterND=function(t,e,n){return Ee("scatterND")},r.prototype.batchToSpaceND=function(t,e,n){return Ee("batchToSpaceND")},r.prototype.spaceToBatchND=function(t,e,n){return Ee("spaceToBatchND")},r.prototype.resizeBilinear=function(t,e,n,a){return Ee("resizeBilinear")},r.prototype.resizeBilinearBackprop=function(t,e,n){return Ee("resizeBilinearBackprop")},r.prototype.resizeNearestNeighbor=function(t,e,n,a){return Ee("resizeNearestNeighbor")},r.prototype.resizeNearestNeighborBackprop=function(t,e,n){return Ee("resizeNearestNeighborBackprop")},r.prototype.batchNormalization=function(t,e,n,a,i,c){return Ee("batchNormalization")},r.prototype.localResponseNormalization4D=function(t,e,n,a,i){return Ee("localResponseNormalization4D")},r.prototype.LRNGrad=function(t,e,n,a,i,c,f){return Ee("LRNGrad")},r.prototype.multinomial=function(t,e,n,a){return Ee("multinomial")},r.prototype.oneHot=function(t,e,n,a){return Ee("oneHot")},r.prototype.cumsum=function(t,e,n,a){return Ee("cumsum")},r.prototype.nonMaxSuppression=function(t,e,n,a,i){return Ee("nonMaxSuppression")},r.prototype.fft=function(t){return Ee("fft")},r.prototype.ifft=function(t){return Ee("ifft")},r.prototype.complex=function(t,e){return Ee("complex")},r.prototype.real=function(t){return Ee("real")},r.prototype.imag=function(t){return Ee("imag")},r.prototype.cropAndResize=function(t,e,n,a,i,c){return Ee("cropAndResize")},r.prototype.depthToSpace=function(t,e,n){return Ee("depthToSpace")},r.prototype.split=function(t,e,n){return Ee("split")},r.prototype.sparseToDense=function(t,e,n,a){return Ee("sparseToDense")},r.prototype.diag=function(t){return Ee("diag")},r.prototype.fill=function(t,e,n){return Ee("fill")},r.prototype.onesLike=function(t){return Ee("onesLike")},r.prototype.zerosLike=function(t){return Ee("zerosLike")},r.prototype.linspace=function(t,e,n){return Ee("linspace")},r.prototype.dispose=function(){return Ee("dispose")},r})();function Ee(r){throw new Error("'"+r+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Ko(r,t){for(var e=r.length,n=[],a=0;a<e;a++){var i=e-1-a,c=r[i]||1;(t[t.length-1-a]||1)>1&&c===1&&n.unshift(i)}return n}function ur(r,t){for(var e=[],n=0;n<t.length;n++){var a=r[r.length-n-1],i=t.length-n-1,c=t[i];(a==null||a===1&&c>1)&&e.unshift(i)}return e}function Ot(r,t){for(var e=[],n=Math.max(r.length,t.length),a=0;a<n;a++){var i=r[r.length-a-1];i==null&&(i=1);var c=t[t.length-a-1];if(c==null&&(c=1),i===1)e.unshift(c);else if(c===1)e.unshift(i);else{if(i!==c)throw Error("Operands could not be broadcast together with shapes "+r+" and "+t+".");e.unshift(i)}}return e}function pc(r,t,e,n,a,i,c){c===void 0&&(c="channelsLast");var f,p=Ah(t),d=p[0],x=p[1];if(c==="channelsLast")f=[d,x,r[3],r[3]];else{if(c!=="channelsFirst")throw new Error("Unknown dataFormat "+c);f=[d,x,r[1],r[1]]}return Ws(r,f,e,n,a,i,!1,c)}function Eh(r,t,e,n,a,i,c){c===void 0&&(c="NDHWC");var f,p,d=Hp(t),x=d[0],w=d[1],C=d[2];if(c==="NDHWC")p="channelsLast",f=[x,w,C,r[4],r[4]];else{if(c!=="NCDHW")throw new Error("Unknown dataFormat "+c);p="channelsFirst",f=[x,w,C,r[1],r[1]]}return Ch(r,f,e,n,a,!1,p,i)}function Ws(r,t,e,n,a,i,c,f){c===void 0&&(c=!1),f===void 0&&(f="channelsLast");var p=[-1,-1,-1,-1],d=p[0],x=p[1],w=p[2],C=p[3];if(f==="channelsLast")d=r[0],x=r[1],w=r[2],C=r[3];else{if(f!=="channelsFirst")throw new Error("Unknown dataFormat "+f);d=r[0],C=r[1],x=r[2],w=r[3]}var S,R=t[0],N=t[1],D=t[3],M=Ah(e),B=M[0],k=M[1],L=Ah(n),F=L[0],W=L[1],G=Gu(R,F),q=Gu(N,W),H=(function(xe,$,te,re,he,Se,Y,fe){var Ae,Te,Le;if(typeof xe=="number"){Ae={top:xe,bottom:xe,left:xe,right:xe,type:xe===0?"VALID":"NUMBER"};var Ve=(function(it,Rt,Ye,zt,Bt){zt==null&&(zt=ky(it,Rt,Ye));var Xt=it[0],Ct=it[1],At=uc((Xt-Rt+2*zt)/Ye+1,Bt);J(jn(At),(function(){return"The output # of rows ("+At+") must be an integer. Change the stride and/or zero pad parameters"}));var ct=uc((Ct-Rt+2*zt)/Ye+1,Bt);return J(jn(ct),(function(){return"The output # of columns ("+ct+") must be an integer. Change the stride and/or zero pad parameters"})),[At,ct]})([$,te],Se,re,xe,fe);Te=Ve[0],Le=Ve[1]}else if(xe==="same"){Te=Math.ceil($/re),Le=Math.ceil(te/he);var Ie=Math.max(0,(Te-1)*re+Se-$),ut=Math.max(0,(Le-1)*he+Y-te),He=Math.floor(Ie/2),ht=Ie-He,jt=Math.floor(ut/2);Ae={top:He,bottom:ht,left:jt,right:ut-jt,type:"SAME"}}else{if(xe!=="valid")throw Error("Unknown padding parameter: "+xe);Ae={top:0,bottom:0,left:0,right:0,type:"VALID"},Te=Math.ceil(($-Se+1)/re),Le=Math.ceil((te-Y+1)/he)}return{padInfo:Ae,outHeight:Te,outWidth:Le}})(a,x,w,B,k,G,q,i),Z=H.padInfo,ie=H.outHeight,ee=H.outWidth,me=c?D*C:D;return f==="channelsFirst"?S=[d,me,ie,ee]:f==="channelsLast"&&(S=[d,ie,ee,me]),{batchSize:d,dataFormat:f,inHeight:x,inWidth:w,inChannels:C,outHeight:ie,outWidth:ee,outChannels:me,padInfo:Z,strideHeight:B,strideWidth:k,filterHeight:R,filterWidth:N,effectiveFilterHeight:G,effectiveFilterWidth:q,dilationHeight:F,dilationWidth:W,inShape:r,outShape:S,filterShape:t}}function Ch(r,t,e,n,a,i,c,f){i===void 0&&(i=!1),c===void 0&&(c="channelsLast");var p=[-1,-1,-1,-1,-1],d=p[0],x=p[1],w=p[2],C=p[3],S=p[4];if(c==="channelsLast")d=r[0],x=r[1],w=r[2],C=r[3],S=r[4];else{if(c!=="channelsFirst")throw new Error("Unknown dataFormat "+c);d=r[0],S=r[1],x=r[2],w=r[3],C=r[4]}var R,N=t[0],D=t[1],M=t[2],B=t[4],k=Hp(e),L=k[0],F=k[1],W=k[2],G=Hp(n),q=G[0],H=G[1],Z=G[2],ie=Gu(N,q),ee=Gu(D,H),me=Gu(M,Z),xe=(function(Y,fe,Ae,Te,Le,Ve,Ie,ut,He,ht,jt){var it,Rt,Ye,zt;if(typeof Y=="number"){it={top:Y,bottom:Y,left:Y,right:Y,front:Y,back:Y,type:Y===0?"VALID":"NUMBER"};var Bt=(function(fr,Wr,Pn,Cn,sn,Ht){sn==null&&(sn=ky(fr,Wr,Cn));var Xs=fr[0],ho=fr[1],al=fr[2],$t=uc((Xs-Wr+2*sn)/Cn+1,Ht);J(jn($t),(function(){return"The output # of depths ("+$t+") must be an integer. Change the stride and/or zero pad parameters"}));var ze=uc((ho-Wr+2*sn)/Cn+1,Ht);J(jn(ze),(function(){return"The output # of rows ("+ze+") must be an integer. Change the stride and/or zero pad parameters"}));var Yt=uc((al-Wr+2*sn)/Cn+1,Ht);return J(jn(Yt),(function(){return"The output # of columns ("+Yt+") must be an integer. Change the stride and/or zero pad parameters"})),[$t,ze,Yt,Pn]})([fe,Ae,Te,1],ut,1,Le,Y,jt);Rt=Bt[0],Ye=Bt[1],zt=Bt[2]}else if(Y==="same"){Rt=Math.ceil(fe/Le),Ye=Math.ceil(Ae/Ve),zt=Math.ceil(Te/Ie);var Xt=(Rt-1)*Le+ut-fe,Ct=(Ye-1)*Ve+He-Ae,At=(zt-1)*Ie+ht-Te,ct=Math.floor(Xt/2),Yr=Xt-ct,We=Math.floor(Ct/2),Hr=Ct-We,Vr=Math.floor(At/2);it={top:We,bottom:Hr,left:Vr,right:At-Vr,front:ct,back:Yr,type:"SAME"}}else{if(Y!=="valid")throw Error("Unknown padding parameter: "+Y);it={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Rt=Math.ceil((fe-ut+1)/Le),Ye=Math.ceil((Ae-He+1)/Ve),zt=Math.ceil((Te-ht+1)/Ie)}return{padInfo:it,outDepth:Rt,outHeight:Ye,outWidth:zt}})(a,x,w,C,L,F,W,ie,ee,me,f),$=xe.padInfo,te=xe.outDepth,re=xe.outHeight,he=xe.outWidth,Se=i?B*S:B;return c==="channelsFirst"?R=[d,Se,te,re,he]:c==="channelsLast"&&(R=[d,te,re,he,Se]),{batchSize:d,dataFormat:c,inDepth:x,inHeight:w,inWidth:C,inChannels:S,outDepth:te,outHeight:re,outWidth:he,outChannels:Se,padInfo:$,strideDepth:L,strideHeight:F,strideWidth:W,filterDepth:N,filterHeight:D,filterWidth:M,effectiveFilterDepth:ie,effectiveFilterHeight:ee,effectiveFilterWidth:me,dilationDepth:q,dilationHeight:H,dilationWidth:Z,inShape:r,outShape:R,filterShape:t}}function ky(r,t,e,n){n===void 0&&(n=1);var a=Gu(t,n);return Math.floor((r[0]*(e-1)-e+a)/2)}function Ah(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function Hp(r){return typeof r=="number"?[r,r,r]:r}function Gu(r,t){return t<=1?r:r+(r-1)*(t-1)}function uc(r,t){if(!t)return r;switch(t){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error("Unknown roundingMode "+t)}}function $u(r){var t=Ah(r),e=t[0],n=t[1],a=t[2];return e===1&&n===1&&a===1}function ia(r,t){return $u(r)||$u(t)}function p1(r){if(r==="NHWC")return"channelsLast";if(r==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+r)}function Ly(r,t,e){if(t==="complex64"){if(r.dtype==="complex64")return r.clone();var n=yn(r.shape),a=r.toFloat(),i=e.complex(a,n);return n.dispose(),a.dispose(),i}if(!mA(r.dtype,t))return le.makeTensorFromDataId(r.dataId,r.shape,t);if(r.dtype==="complex64"){var c=e.real(r);return i=c.cast(t),c.dispose(),i}if(t==="int32")return e.int(r);if(t==="bool"){var f=Ge(0,r.dtype);return i=e.notEqual(r,f),f.dispose(),i}throw new Error("Error in Cast: failed to cast "+r.dtype+" to "+t)}function Vp(r,t){return le.makeTensorFromDataId(r.dataId,t,r.dtype)}function Fy(r,t,e){var n=(t-r)/(e-1),a=Ec(e,"float32");a[0]=r;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return Zn(a,"float32")}function Wp(r,t){if(r.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+r.length+", imag: "+t.length+".");for(var e=new Float32Array(2*r.length),n=0;n<e.length;n+=2)e[n]=r[n/2],e[n+1]=t[n/2];return e}function X2(r,t){return{real:r[2*t],imag:r[2*t+1]}}function jS(r,t,e,n){r[2*n]=t,r[2*n+1]=e}function XS(r,t,e){var n=(e?2:-2)*Math.PI*(r/t);return{real:Math.cos(n),imag:Math.sin(n)}}function YS(r,t,e){var n=(function(i,c,f){return(function(p,d,x){for(var w=0,C=p.length,S=0,R=!1;w<C;){var N=x(d,p[S=w+(C-w>>>1)]);N>0?w=S+1:(C=S,R=!N)}return R?w:-w-1})(i,c,f||qS)})(r,t,e),a=n<0?-(n+1):n;r.splice(a,0,t)}function qS(r,t){return r>t?1:r<t?-1:0}function g1(r,t,e,n,a){return Py(r,t,e,n,a,0).selectedIndices}function v1(r,t,e,n,a,i){var c=Py(r,t,e,n,a,i);return c.numValidOutputs.dispose(),{selectedIndices:c.selectedIndices,selectedScores:c.selectedScores}}function Py(r,t,e,n,a,i,c,f){f===void 0&&(f=!1);for(var p=Array.from(t).map((function(L,F){return{score:L,boxIndex:F,suppressBeginIndex:0}})).filter((function(L){return L.score>a})).sort(Y2),d=i>0?-.5/i:0,x=[],w=[];x.length<e&&p.length>0;){var C=p.pop(),S=C.score,R=C.boxIndex,N=C.suppressBeginIndex;if(S<a)break;for(var D=!1,M=x.length-1;M>=N;--M){var B=KS(r,R,x[M]);if(B>=n){D=!0;break}if(C.score=C.score*ZS(n,d,B),C.score<=a)break}C.suppressBeginIndex=x.length,D||(C.score===S?(x.push(R),w.push(C.score)):C.score>a&&YS(p,C,Y2))}var k=x.length;return f&&(x.fill(0,k),w.fill(0,k)),{selectedIndices:Zn(x,"int32"),selectedScores:Zn(w,"float32"),numValidOutputs:Ge(k,"int32")}}function KS(r,t,e){var n=r.subarray(4*t,4*t+4),a=r.subarray(4*e,4*e+4),i=Math.min(n[0],n[2]),c=Math.min(n[1],n[3]),f=Math.max(n[0],n[2]),p=Math.max(n[1],n[3]),d=Math.min(a[0],a[2]),x=Math.min(a[1],a[3]),w=Math.max(a[0],a[2]),C=Math.max(a[1],a[3]),S=(f-i)*(p-c),R=(w-d)*(C-x);if(S<=0||R<=0)return 0;var N=Math.max(i,d),D=Math.max(c,x),M=Math.min(f,w),B=Math.min(p,C),k=Math.max(M-N,0)*Math.max(B-D,0);return k/(S+R-k)}function ZS(r,t,e){var n=Math.exp(t*e*e);return e<=r?n:0}function Y2(r,t){return r.score-t.score||r.score===t.score&&t.boxIndex-r.boxIndex}function Uy(r,t,e){var n=new Array(r.rank).fill(0),a=r.shape.slice();return t.map((function(i){a[e]=i;var c=r.slice(n,a);return n[e]+=i,c}))}function zy(r,t){for(var e=new Array(r.rank),n=0;n<e.length;n++)e[n]=r.shape[n]*t[n];var a=yt(e,r.dtype);for(n=0;n<a.values.length;++n){for(var i=a.indexToLoc(n),c=new Array(r.rank),f=0;f<c.length;f++)c[f]=i[f]%r.shape[f];var p=r.locToIndex(c);a.values[n]=r.values[p]}return a.toTensor()}function Hy(r,t,e,n,a){for(var i=t[t.length-1],c=[r.length/i,i],f=c[0],p=c[1],d=fc(e,f*n),x=fc("int32",f*n),w=0;w<f;w++){for(var C=w*p,S=r.subarray(C,C+p),R=[],N=0;N<S.length;N++)R.push({value:S[N],index:N});R.sort((function(L,F){return F.value-L.value}));var D=w*n,M=d.subarray(D,D+n),B=x.subarray(D,D+n);for(N=0;N<n;N++)M[N]=R[N].value,B[N]=R[N].index}var k=t.slice();return k[k.length-1]=n,[Tr(d,k,e),Tr(x,k,"int32")]}function m1(r,t){for(var e=[],n=0;n<t.length;n++)t[n]&&e.push(n);var a=yt(r,"int32"),i=yt([e.length,r.length],"int32");for(n=0;n<e.length;n++){var c=a.indexToLoc(e[n]),f=n*r.length;i.values.set(c,f)}return i.toTensor()}var QS=function(r,t){this.outputShape=[],this.outputShape=r,this.variableNames=t.map((function(a,i){return"T"+i}));var e=[];this.variableNames.forEach((function(a){e.push("float v"+a+" = get"+a+"AtOutCoords();")}));var n=this.variableNames.map((function(a){return"v"+a})).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        float result = `+n+`;
        setOutput(result);
      }
    `},JS=function(r,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.variableNames=t.map((function(a,i){return"T"+i}));var e=[];this.variableNames.forEach((function(a){e.push("vec4 v"+a+" = get"+a+"AtOutCoords();")}));var n=this.variableNames.map((function(a){return"v"+a})).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        vec4 result = `+n+`;
        setOutput(result);
      }
    `},$S=function(r,t,e){this.variableNames=["A"];var n=r.windowSize,a=r.batchSize,i=r.inSize,c=Math.ceil(i/n);e||this.variableNames.push("bestIndicesA"),this.outputShape=[a,c];var f=t==="max"?">":"<",p=e?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+n+`; i++) {
          int inIdx = `+p+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+f+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function Vy(r,t){return["x","y","z","w","u","v"].slice(0,t).map((function(e){return r+"."+e}))}function na(r,t){return t===1?[r]:Vy(r,t)}function Fr(){var r,t,e,n,a,i,c,f,p,d;return Re().getNumber("WEBGL_VERSION")===2?(r="#version 300 es",t="in",e="out",n="in",a="texture",i="outputColor",c="out vec4 outputColor;",f=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,p="",d=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(r="",t="attribute",e="varying",n="varying",a="texture2D",i="gl_FragColor",c="",f=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,p=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,d=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:r,attribute:t,varyingVs:e,varyingFs:n,texture2D:a,output:i,defineOutput:c,defineSpecialNaN:f,defineSpecialInf:p,defineRound:d}}function ks(r,t,e){e===void 0&&(e="index");var n=Ai(t);return n.map((function(a,i){return"int "+r[i]+" = "+e+" / "+a+"; "+(i===n.length-1?"int "+r[i+1]+" = "+e+" - "+r[i]+" * "+a:"index -= "+r[i]+" * "+a)+";"})).join("")}function x1(r){var t=Ai(r).map((function(e){return e.toString()}));return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var Wy=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function e4(r,t,e,n){var a=[];r.forEach((function(S){var R=Je(S.shapeInfo.logicalShape);S.shapeInfo.isUniform?a.push("uniform float "+S.name+(R>1?"["+R+"]":"")+";"):(a.push("uniform sampler2D "+S.name+";"),a.push("uniform int offset"+S.name+";"))}));var i,c,f=a.join(`
`),p=r.map((function(S){return(function(R,N,D){D===void 0&&(D=!1);var M="";M+=D?Gy(R):Fu(R);var B=R.shapeInfo.logicalShape,k=N.logicalShape;return B.length<=k.length&&(M+=D?(function(L,F){var W,G=L.name,q=G.charAt(0).toUpperCase()+G.slice(1),H="get"+q+"AtOutCoords",Z=L.shapeInfo.logicalShape.length,ie=F.logicalShape.length,ee=Ko(L.shapeInfo.logicalShape,F.logicalShape),me=vn(ie),xe=ie-Z,$=["x","y","z","w","u","v"];W=Z===0?"":ie<2&&ee.length>=1?"coords = 0;":ee.map((function(Ae){return"coords."+$[Ae+xe]+" = 0;"})).join(`
`);var te="";te=ie<2&&Z>0?"coords":L.shapeInfo.logicalShape.map((function(Ae,Te){return"coords."+$[Te+xe]})).join(", ");var re="return outputValue;",he=Je(L.shapeInfo.logicalShape)===1,Se=Je(F.logicalShape)===1;if(Z!==1||he||Se){if(he&&!Se)re=ie===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(ee.length){var Y=Z-2,fe=Z-1;ee.indexOf(Y)>-1&&ee.indexOf(fe)>-1?re="return vec4(outputValue.x);":ee.indexOf(Y)>-1?re="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":ee.indexOf(fe)>-1&&(re="return vec4(outputValue.xx, outputValue.zz);")}}else re=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+H+`() {
      `+me+` coords = getOutputCoords();
      `+W+`
      vec4 outputValue = get`+q+"("+te+`);
      `+re+`
    }
  `})(R,N):(function(L,F){var W=L.name,G=W.charAt(0).toUpperCase()+W.slice(1),q="get"+G+"AtOutCoords",H=F.texShape,Z=L.shapeInfo.texShape,ie=L.shapeInfo.logicalShape.length,ee=F.logicalShape.length;if(!L.shapeInfo.isUniform&&ie===ee&&L.shapeInfo.flatOffset==null&&yr(Z,H))return`
      float `+q+`() {
        return sampleTexture(`+W+`, resultUV);
      }
    `;var me,xe=vn(ee),$=Ko(L.shapeInfo.logicalShape,F.logicalShape),te=ee-ie,re=["x","y","z","w","u","v"];me=ie===0?"":ee<2&&$.length>=1?"coords = 0;":$.map((function(Se){return"coords."+re[Se+te]+" = 0;"})).join(`
`);var he="";return he=ee<2&&ie>0?"coords":L.shapeInfo.logicalShape.map((function(Se,Y){return"coords."+re[Y+te]})).join(", "),`
    float `+q+`() {
      `+xe+` coords = getOutputCoords();
      `+me+`
      return get`+G+"("+he+`);
    }
  `})(R,N)),M})(S,t,n)})).join(`
`),d=t.texShape,x=Fr(),w=(function(S){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+S.texture2D+`(textureSampler, uv).r;
    }
  `})(x),C=(function(S){return S.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+S.varyingFs+` vec2 resultUV;
    `+S.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+S.defineSpecialNaN+`
    `+S.defineSpecialInf+`
    `+S.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+t4+`
    `+n4+`
    `+r4+`
  `})(x);return t.isPacked?(i=(function(S,R){switch(S.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(L,F){var W=[Math.ceil(F[0]/2),Math.ceil(F[1]/2)];return W[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+W[1]+`.0);
      }
    `:W[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+W[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+W[0]+", "+W[1]+`));
      return 2 * (resTexRC.x * `+W[1]+` + resTexRC.y);
    }
  `})(0,R);case 2:return(function(L,F){var W=[Math.ceil(F[0]/2),Math.ceil(F[1]/2)];if(yr(L,F))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+W[0]+", "+W[1]+`));
      }
    `;var G=Math.ceil(L[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+W[0]+", "+W[1]+`));

      int index = resTexRC.x * `+W[1]+` + resTexRC.y;
      int r = 2 * (index / `+G+`);
      int c = imod(index, `+G+`) * 2;

      return ivec2(r, c);
    }
  `})(S,R);case 3:return N=S,D=R,M=[Math.ceil(D[0]/2),Math.ceil(D[1]/2)],B=Math.ceil(N[2]/2),k=B*Math.ceil(N[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+M[0]+", "+M[1]+`));
      int index = resTexRC.x * `+M[1]+` + resTexRC.y;

      int b = index / `+k+`;
      index -= b * `+k+`;

      int r = 2 * (index / `+B+`);
      int c = imod(index, `+B+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return(function(L,F){for(var W=[Math.ceil(F[0]/2),Math.ceil(F[1]/2)],G=Math.ceil(L[L.length-1]/2),q=G*Math.ceil(L[L.length-2]/2),H=q,Z="",ie="b, r, c",ee=2;ee<L.length-1;ee++)H*=L[L.length-ee-1],Z=`
      int b`+ee+" = index / "+H+`;
      index -= b`+ee+" * "+H+`;
    `+Z,ie="b"+ee+", "+ie;return`
    ivec`+L.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+W[0]+", "+W[1]+`));
      int index = resTexRC.x * `+W[1]+` + resTexRC.y;

      `+Z+`

      int b = index / `+q+`;
      index -= b * `+q+`;

      int r = 2 * (index / `+G+`);
      int c = imod(index, `+G+`) * 2;

      return ivec`+L.length+"("+ie+`);
    }
  `})(S,R)}var N,D,M,B,k})(t.logicalShape,d),c=(function(S){return`
    void setOutput(vec4 val) {
      `+S.output+` = val;
    }
  `})(x)):(i=(function(S,R){switch(S.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(M,B){return B[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+B[1]+`.0);
      }
    `:B[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+B[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+B[0]+", "+B[1]+`));
      return resTexRC.x * `+B[1]+` + resTexRC.y;
    }
  `})(0,R);case 2:return(function(M,B){return yr(M,B)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+B[0]+", "+B[1]+`));
      }
    `:M[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+B[0]+", "+B[1]+`));
        int index = resTexRC.x * `+B[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:M[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+B[0]+", "+B[1]+`));
        int index = resTexRC.x * `+B[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+B[0]+", "+B[1]+`));
      int index = resTexRC.x * `+B[1]+` + resTexRC.y;
      int r = index / `+M[1]+`;
      int c = index - r * `+M[1]+`;
      return ivec2(r, c);
    }
  `})(S,R);case 3:return N=R,D=ks(["r","c","d"],S),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+N[0]+", "+N[1]+`));
      int index = resTexRC.x * `+N[1]+` + resTexRC.y;
      `+D+`
      return ivec3(r, c, d);
    }
  `;case 4:return(function(M,B){var k=ks(["r","c","d","d2"],M);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+B[0]+", "+B[1]+`));
      int index = resTexRC.x * `+B[1]+` + resTexRC.y;
      `+k+`
      return ivec4(r, c, d, d2);
    }
  `})(S,R);case 5:return(function(M,B){var k=ks(["r","c","d","d2","d3"],M);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+B[0]+`,
                             `+B[1]+`));

      int index = resTexRC.x * `+B[1]+` + resTexRC.y;

      `+k+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `})(S,R);case 6:return(function(M,B){var k=ks(["r","c","d","d2","d3","d4"],M);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+B[0]+", "+B[1]+`));
      int index = resTexRC.x * `+B[1]+` + resTexRC.y;

      `+k+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `})(S,R);default:throw new Error(S.length+"-D output sampling is not yet supported")}var N,D})(t.logicalShape,d),c=(function(S){return`
    void setOutput(float val) {
      `+S.output+` = vec4(val, 0, 0, 0);
    }
  `})(x)),n&&(C+=a4),[C,w,c,f,i,p,e].join(`
`)}function Fu(r){var t=r.shapeInfo.logicalShape;switch(t.length){case 0:return(function(e){var n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float "+a+"() {return "+n+";}";var i=e.shapeInfo.texShape,c=i[0],f=i[1];if(c===1&&f===1)return`
      float `+a+`() {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var p=e.shapeInfo.texShape,d=p[0],x=p[1],w=Ds(n);return`
    float `+a+`() {
      vec2 uv = uvFromFlat(`+d+", "+x+", "+w+`);
      return sampleTexture(`+n+`, uv);
    }
  `})(r);case 1:return(function(e){var n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float `+a+`(int index) {
        `+Ou(e)+`
      }
    `;var i=e.shapeInfo.texShape,c=i[0],f=i[1];if(f===1&&c===1)return`
      float `+a+`(int index) {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var p=Ds(n);return f===1?`
      float `+a+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+p+") + 0.5) / "+c+`.0);
        return sampleTexture(`+n+`, uv);
      }
    `:c===1?`
      float `+a+`(int index) {
        vec2 uv = vec2((float(index + `+p+") + 0.5) / "+f+`.0, 0.5);
        return sampleTexture(`+n+`, uv);
      }
    `:`
    float `+a+`(int index) {
      vec2 uv = uvFromFlat(`+c+", "+f+", index + "+p+`);
      return sampleTexture(`+n+`, uv);
    }
  `})(r);case 2:return(function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),c=e.shapeInfo.texShape;if(c!=null&&yr(n,c)){var f=c[0],p=c[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+p+".0, "+f+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `}var d=Bs(n),x=d.newShape,w=d.keptDims,C=x;if(C.length<n.length){var S=Pu(e,C);return`
      `+Fu(S)+`
      float `+i+`(int row, int col) {
        return `+i+"("+Uu(["row","col"],w)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+n[1]+`, 1)));
        `+Ou(e)+`
      }
    `;var R=c[0],N=c[1],D=Ds(a);return N===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+D+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+R+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `:R===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+D+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+N+`.0, 0.5);
      return sampleTexture(`+a+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+n[1]+" + col + "+D+`;
    vec2 uv = uvFromFlat(`+R+", "+N+`, index);
    return sampleTexture(`+a+`, uv);
  }
`})(r);case 3:return(function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),c=n[1]*n[2],f=n[2],p=Bs(n),d=p.newShape,x=p.keptDims,w=d;if(w.length<n.length){var C=Pu(e,w);return`
        `+Fu(C)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+Uu(["row","col","depth"],x)+`);
        }
      `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+c+", "+f+`, 1)));
        `+Ou(e)+`
      }
    `;var S=e.shapeInfo.texShape,R=S[0],N=S[1],D=e.shapeInfo.flatOffset;if(N===c&&D==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+f+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+N+".0, "+R+`.0);
          return sampleTexture(`+a+`, uv);
        }
      `;if(N===f&&D==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+n[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+N+".0, "+R+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `;var M=Ds(a);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+c+" + col * "+f+" + depth + "+M+`;
        vec2 uv = uvFromFlat(`+R+", "+N+`, index);
        return sampleTexture(`+a+`, uv);
      }
  `})(r);case 4:return(function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),c=n[3],f=n[2]*c,p=n[1]*f,d=Bs(n),x=d.newShape,w=d.keptDims;if(x.length<n.length){var C=Pu(e,x);return`
      `+Fu(C)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+Uu(["row","col","depth","depth2"],w)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+p+", "+f+", "+c+`, 1)));
        `+Ou(e)+`
      }
    `;var S=e.shapeInfo.flatOffset,R=e.shapeInfo.texShape,N=R[0],D=R[1];if(D===p&&S==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+f+", "+c+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+D+".0, "+N+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(D===c&&S==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+n[1]*n[2]+", "+n[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+D+".0, "+N+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var M=Ds(a);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+p+" + col * "+f+` +
          depth * `+c+` + depth2;
      vec2 uv = uvFromFlat(`+N+", "+D+", index + "+M+`);
      return sampleTexture(`+a+`, uv);
    }
  `})(r);case 5:return(function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),c=n[4],f=n[3]*c,p=n[2]*f,d=n[1]*p,x=Bs(n),w=x.newShape,C=x.keptDims;if(w.length<n.length){var S=Pu(e,w);return`
      `+Fu(S)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+Uu(["row","col","depth","depth2","depth3"],C)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+d+", "+p+", "+f+", "+c+`)) +
          depth3;
        `+Ou(e)+`
      }
    `;var R=e.shapeInfo.flatOffset,N=e.shapeInfo.texShape,D=N[0],M=N[1];if(M===d&&R==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+p+", "+f+", "+c+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+M+".0, "+D+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(M===c&&R==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]+`,
               `+n[2]*n[3]+", "+n[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+M+".0, "+D+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var B=Ds(a);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+d+" + col * "+p+" + depth * "+f+` +
          depth2 * `+c+" + depth3 + "+B+`;
      vec2 uv = uvFromFlat(`+D+", "+M+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `})(r);case 6:return(function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),c=Bs(n),f=c.newShape,p=c.keptDims;if(f.length<n.length){var d=Pu(e,f);return`
      `+Fu(d)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+Uu(["row","col","depth","depth2","depth3","depth4"],p)+`);
      }
    `}var x=n[5],w=n[4]*x,C=n[3]*w,S=n[2]*C,R=n[1]*S;if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+R+", "+S+", "+C+", "+w+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+x+`, 1)));
        `+Ou(e)+`
      }
    `;var N=e.shapeInfo.flatOffset,D=e.shapeInfo.texShape,M=D[0],B=D[1];if(B===R&&N==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+S+", "+C+", "+w+", "+x+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+B+".0, "+M+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(B===x&&N==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]*n[4]+`,
               `+n[2]*n[3]*n[4]+`,
               `+n[3]*n[4]+`,
               `+n[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+B+".0, "+M+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var k=Ds(a);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+R+" + col * "+S+" + depth * "+C+` +
          depth2 * `+w+" + depth3 * "+x+" + depth4 + "+k+`;
      vec2 uv = uvFromFlat(`+M+", "+B+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `})(r);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function Gy(r){var t,e,n;switch(r.shapeInfo.logicalShape.length){case 0:return t=r.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),n=Fr(),`
    vec4 `+e+`() {
      return `+n.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return(function(a){var i=a.name,c="get"+i.charAt(0).toUpperCase()+i.slice(1),f=a.shapeInfo.texShape,p=[Math.ceil(f[0]/2),Math.ceil(f[1]/2)],d=Fr();return`
    vec4 `+c+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+p[0]+", "+p[1]+`, index);
      return `+d.texture2D+"("+i+`, uv);
    }
  `})(r);case 2:return(function(a){var i=a.shapeInfo.logicalShape,c=a.name,f="get"+c.charAt(0).toUpperCase()+c.slice(1),p=a.shapeInfo.texShape,d=p[0],x=p[1],w=Fr();if(p!=null&&yr(i,p))return`
      vec4 `+f+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+x+".0, "+d+`.0);

        return `+w.texture2D+"("+c+`, uv);
      }
    `;var C=[Math.ceil(p[0]/2),Math.ceil(p[1]/2)],S=Math.ceil(i[1]/2);return`
    vec4 `+f+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+S+", "+C[0]+", "+C[1]+`, row, col);
      return `+w.texture2D+"("+c+`, uv);
    }
  `})(r);case 3:return(function(a){var i=a.shapeInfo.logicalShape,c=a.name,f="get"+c.charAt(0).toUpperCase()+c.slice(1),p=a.shapeInfo.texShape,d=[Math.ceil(p[0]/2),Math.ceil(p[1]/2)];if(i[0]===1){var x=i.slice(1),w=Pu(a,x);return`
        `+Gy(w)+`
        vec4 `+f+`(int b, int row, int col) {
          return `+f+"("+Uu(["b","row","col"],[1,2])+`);
        }
      `}var C=d[0],S=d[1],R=Math.ceil(i[2]/2),N=R*Math.ceil(i[1]/2),D=Fr();return`
    vec4 `+f+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+C+", "+S+", "+N+", "+R+`, b, row, col);
      return `+D.texture2D+"("+c+`, uv);
    }
  `})(r);default:return(function(a){for(var i=a.shapeInfo.logicalShape,c=i.length,f=a.name,p="get"+f.charAt(0).toUpperCase()+f.slice(1),d=a.shapeInfo.texShape,x=[Math.ceil(d[0]/2),Math.ceil(d[1]/2)],w=x[0],C=x[1],S=Math.ceil(i[c-1]/2),R=S*Math.ceil(i[c-2]/2),N="int b, int row, int col",D="b * "+R+" + (row / 2) * "+S+" + (col / 2)",M=2;M<c-1;M++)N="int b"+M+", "+N,R*=i[c-M-1],D="b"+M+" * "+R+" + "+D;var B=Fr();return`
    vec4 `+p+"("+N+`) {
      int index = `+D+`;
      int texR = index / `+C+`;
      int texC = index - texR * `+C+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+C+", "+w+`);
      return `+B.texture2D+"("+f+`, uv);
    }
  `})(r)}}var t4=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,n4=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,r4=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,a4=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Ds(r){return"offset"+r}function Ou(r){var t=r.name,e=Je(r.shapeInfo.logicalShape);return e<2?"return "+t+";":`
    for (int i = 0; i < `+e+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function vn(r){if(r<=1)return"int";if(r===2)return"ivec2";if(r===3)return"ivec3";if(r===4)return"ivec4";if(r===5)return"ivec5";if(r===6)return"ivec6";throw Error("GPU for rank "+r+" is not yet supported")}function Pu(r,t){var e=JSON.parse(JSON.stringify(r));return e.shapeInfo.logicalShape=t,e}function Uu(r,t){return t.map((function(e){return r[e]})).join(", ")}var i4=function(r,t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,J(r.length>2,(function(){return"Packed arg"+(e.charAt(0).toUpperCase()+e.slice(1))+" supports only inputs with rank above 2."}));var a=r[r.length-1],i=Math.ceil(a/t);this.outputShape=r.slice(0,-1),i>1&&this.outputShape.push(i),n||this.variableNames.push("bestIndicesA");var c,f,p=this.outputShape,d=p.length,x=vn(d),w=na("coords",d);if(i===1){var C=vn(f=d+1);c=`
        `+C+" sourceLocR = "+C+"("+w.join()+`, 0);
        ++`+w[d-1]+`;
        `+C+" sourceLocG = "+C+"("+w.join()+`, 0);
        ++`+w[d-2]+`;
        `+C+" sourceLocA = "+C+"("+w.join()+`, 0);
        --`+w[d-1]+`;
        `+C+" sourceLocB = "+C+"("+w.join()+`, 0);
        --`+w[d-2]+";"}else f=d,c=`
        `+x+` sourceLocR = coords;
        ++`+w[d-1]+`;
        `+x+` sourceLocG = coords;
        ++`+w[d-2]+`;
        `+x+` sourceLocA = coords;
        --`+w[d-1]+`;
        `+x+` sourceLocB = coords;
        --`+w[d-2]+";";var S=["x","y","z","w","u","v"].slice(0,f),R="."+S[f-1],N=S.map((function(q){return"int "+q})),D=na("sourceLocR",f-1).concat("inIdx.r"),M=na("sourceLocG",f-1).concat("inIdx.g"),B=na("sourceLocB",f-1).concat("inIdx.b"),k=na("sourceLocA",f-1).concat("inIdx.a"),L=e==="max"?"greaterThan":"lessThan",F=n?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+D.join()+`),
                             getBestIndicesAChannel(`+M.join()+`),
                             getBestIndicesAChannel(`+B.join()+`),
                             getBestIndicesAChannel(`+k.join()+")));",W=`vec4(
            getAChannel(`+D.join()+`),
            hasNextCol ? getAChannel(`+M.join()+`) : 0.,
            hasNextRow ? getAChannel(`+B.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+k.join()+") : 0.)",G=n?"":`
      float getBestIndicesAChannel(`+N.join()+`) {
        return getChannel(getBestIndicesA(`+S.join()+`),
                                          vec2(`+S.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+N.join()+`) {
        return getChannel(getA(`+S.join()+`),
                               vec2(`+S.slice(-2).join()+`));
      }
      `+G+`
      void main() {
        `+x+` coords = getOutputCoords();
        bool hasNextCol = `+w[d-1]+" < "+(p[d-1]-1)+`;
        bool hasNextRow = `+w[d-2]+" < "+(p[d-2]-1)+`;
        `+c+`
        ivec4 srcIdx = ivec4(sourceLocR`+R+", sourceLocG"+R+`,
          sourceLocB`+R+", sourceLocA"+R+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+W+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+F+`
          vec4 candidate = `+W+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+L+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},o4=function(r){this.variableNames=["dy"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,d=f-1-r.padInfo.top,x=p-1-r.padInfo.left,w=1/(t*e);this.userCode=`
      const ivec2 pads = ivec2(`+d+", "+x+`);
      const float avgMultiplier = float(`+w+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+f+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+p+`;
            wC+= `+c+`) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},s4=function(r){this.variableNames=["dy"],this.outputShape=r.inShape;var t=r.filterDepth,e=r.filterHeight,n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,c=r.strideWidth,f=r.dilationDepth,p=r.dilationHeight,d=r.dilationWidth,x=r.effectiveFilterDepth,w=r.effectiveFilterHeight,C=r.effectiveFilterWidth,S=x-1-r.padInfo.front,R=w-1-r.padInfo.top,N=C-1-r.padInfo.left,D=1/(t*e*n);this.userCode=`
      const ivec3 pads = ivec3(`+S+", "+R+", "+N+`);
      const float avgMultiplier = float(`+D+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+x+`;
            wD += `+f+`) {
          float dyD = float(dyDCorner + wD) / `+a+`.0;

          if (dyD < 0.0 || dyD >= `+r.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+w+`;
              wR += `+p+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+C+`;
                wC += `+d+`) {
              float dyC = float(dyCCorner + wC) / `+c+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},u4=function(r,t,e,n,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Ot(r,t),Ot(r,e);var c="0.0";n!=null&&(Ot(r,n),this.variableNames.push("offset"),c="getOffsetAtOutCoords()");var f="1.0";a!=null&&(Ot(r,a),this.variableNames.push("scale"),f="getScaleAtOutCoords()"),this.outputShape=r,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+c+`;
        float scale = `+f+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},l4=function(r,t,e,n,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ot(r,t),Ot(r,e);var c="vec4(0.0)";n!=null&&(Ot(r,n),this.variableNames.push("offset"),c="getOffsetAtOutCoords()");var f="vec4(1.0)";a!=null&&(Ot(r,a),this.variableNames.push("scale"),f="getScaleAtOutCoords()"),this.outputShape=r,this.userCode=`
      void main() {
        vec4 offset = `+c+`;
        vec4 scale = `+f+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},c4="return areal * breal - aimag * bimag;",f4="return areal * bimag + aimag * breal;",q2=function(r,t,e){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ot(t,e),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+r+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},lp="return a + b;",cp="return a - b;",K2="return a * b;",jy="return (a < 0.) ? b * a : a;",kn=function(r,t,e){this.variableNames=["A","B"],this.outputShape=Ot(t,e),this.userCode=`
      float binaryOperation(float a, float b) {
        `+r+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},Xy=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,eo=function(r,t,e,n){n===void 0&&(n=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ot(t,e);var a=this.outputShape.length,i="";if(n)if(a===0||Je(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+vn(a)+` coords = getOutputCoords();
        `,a===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var c=na("coords",a);i+=`
            bool nextRowOutOfBounds =
              (`+c[a-2]+" + 1) >= "+this.outputShape[a-2]+`;
            bool nextColOutOfBounds =
              (`+c[a-1]+" + 1) >= "+this.outputShape[a-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+r+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},h4=(function(){function r(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return r.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,t),a.gl.uniform1f(n.maxLoc,e)}},r})(),d4=(function(){function r(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return r.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,t),a.gl.uniform1f(n.maxLoc,e)}},r})(),p4=function(r){this.variableNames=["real","imag"],this.outputShape=r,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},g4=function(r){this.outputShape=[],this.outputShape=Ju(r,1),this.variableNames=r.map((function(f,p){return"T"+p}));var t=new Array(r.length-1);t[0]=r[0][1];for(var e=1;e<t.length;e++)t[e]=t[e-1]+r[e][1];var n=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(e=1;e<t.length;e++){var a=t[e-1];n.push("else if (yC < "+t[e]+") setOutput(getT"+e+"(yR, yC-"+a+"));")}var i=t.length,c=t[t.length-1];n.push("else setOutput(getT"+i+"(yR, yC-"+c+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+n.join(`
        `)+`
      }
    `},v4=function(r,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ju(r,t);var e=this.outputShape,n=e.length,a=vn(n),i=na("coords",n),c=["x","y","z","w","u","v"].slice(0,n);this.variableNames=r.map((function(D,M){return"T"+M}));var f=new Array(r.length-1);f[0]=r[0][t];for(var p=1;p<f.length;p++)f[p]=f[p-1]+r[p][t];var d=c[t],x=c.slice(-2),w=c.join(),C="if ("+d+" < "+f[0]+`) {
        return getChannel(
            getT0(`+w+"), vec2("+x.join()+`));
        }`;for(p=1;p<f.length;p++){var S=f[p-1];C+=`
        if (`+d+" < "+f[p]+"  && "+d+" >= "+f[p-1]+`) {
          return getChannel(
            getT`+p+"("+qf(c,d,S)+`),
            vec2(`+qf(x,d,S)+`));
        }`}var R=f.length,N=f[f.length-1];C+=`
        return getChannel(
          getT`+R+"("+qf(c,d,N)+`),
          vec2(`+qf(x,d,N)+"));",this.userCode=`
      float getValue(`+c.map((function(D){return"int "+D}))+`) {
        `+C+`
      }

      void main() {
        `+a+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[n-1]+" = "+i[n-1]+` + 1;
        if (`+i[n-1]+" < "+e[n-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[n-2]+" = "+i[n-2]+` + 1;
        if (`+i[n-2]+" < "+e[n-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[n-1]+" = "+i[n-1]+` - 1;
        if (`+i[n-2]+" < "+e[n-2]+` &&
            `+i[n-1]+" < "+e[n-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function qf(r,t,e){var n=r.indexOf(t);return r.map((function(a,i){return i===n?a+" - "+e:a})).join()}var m4=function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideHeight,e=r.strideWidth,n=r.padInfo.top,a=r.padInfo.left,i=r.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yR = 0; yR < `+r.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+n+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+r.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},x4=function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=r.dataFormat==="channelsLast",c=t-1-r.padInfo.top,f=e-1-r.padInfo.left,p=i?1:2,d=i?2:3,x=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+c+", "+f+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+x+`];

        ivec2 dyCorner = ivec2(coords[`+p+"], coords["+d+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            for (int d2 = 0; d2 < `+r.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},y4=function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideDepth,e=r.strideHeight,n=r.strideWidth,a=r.padInfo.front,i=r.padInfo.top,c=r.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yF = 0; yF < `+r.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+a+`;

            if (xF < 0 || xF >= `+r.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+r.outHeight+`; yR++) {
              int xR = wR + yR * `+e+" - "+i+`;

              if (xR < 0 || xR >= `+r.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+r.outWidth+`; yC++) {
                int xC = wC + yC * `+n+" - "+c+`;

                if (xC < 0 || xC >= `+r.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},b4=function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterDepth,e=r.filterHeight,n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,c=r.strideWidth,f=t-1-r.padInfo.front,p=e-1-r.padInfo.top,d=n-1-r.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+f+", "+p+", "+d+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+a+`.0;

          if (dyF < 0.0 || dyF >= `+r.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+e+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+e+` - 1 - wR;

            for (int wC = 0; wC < `+n+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+c+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+n+` - 1 - wC;

              for (int d2 = 0; d2 < `+r.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},w4=function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideHeight,e=r.strideWidth,n=r.padInfo.top,a=r.padInfo.left,i=r.outChannels/r.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yR = 0; yR < `+r.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+n+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+r.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},E4=function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=t-1-r.padInfo.top,c=e-1-r.padInfo.left,f=r.outChannels/r.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+c+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+f+`; dm++) {
              int d2 = d1 * `+f+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Z2=function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=r.outShape;var a=r.padInfo.top,i=r.padInfo.left,c=r.strideHeight,f=r.strideWidth,p=r.dilationHeight,d=r.dilationWidth,x=r.filterHeight,w=r.filterWidth,C=4*Math.floor(r.inChannels/4),S=r.inChannels%4,R=r.dataFormat==="channelsLast",N=R?1:2,D=R?2:3,M=R?3:1,B="",k="";e&&(B=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,k="result = activation(result);");var L=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+B+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+a+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+M+`];

        ivec2 xRCCorner =
            ivec2(coords[`+N+"], coords["+D+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+x+`; wR++) {
          int xR = xRCorner + wR * `+p+`;

          if (xR < 0 || xR >= `+r.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+w+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+r.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+C+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+R+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(S===1)+`) {

              if (`+R+`) {
                dotProd +=
                    getX(batch, xR, xC, `+C+`) *
                    getW(wR, wC, `+C+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+C+`, xR, xC) *
                    getW(wR, wC, `+C+`, d2);
              }

            } else if (`+(S===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+C+`, d2),
                getW(wR, wC, `+C+` + 1, d2)
              );

              if (`+R+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+C+`),
                  getX(batch, xR, xC, `+C+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+C+`, xR, xC),
                  getX(batch, `+C+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(S===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+C+`, d2),
                getW(wR, wC, `+C+` + 1, d2),
                getW(wR, wC, `+C+` + 2, d2)
              );

              if (`+R+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+C+`),
                  getX(batch, xR, xC, `+C+` + 1),
                  getX(batch, xR, xC, `+C+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+C+`, xR, xC),
                  getX(batch, `+C+` + 1, xR, xC),
                  getX(batch, `+C+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+L+`
        `+k+`
        setOutput(result);
      }
    `},C4=function(r){this.variableNames=["x","W"],this.outputShape=r.outShape;var t=r.padInfo.front,e=r.padInfo.top,n=r.padInfo.left,a=r.strideDepth,i=r.strideHeight,c=r.strideWidth,f=r.dilationDepth,p=r.dilationHeight,d=r.dilationWidth,x=r.filterDepth,w=r.filterHeight,C=r.filterWidth,S=4*Math.floor(r.inChannels/4),R=r.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+a+", "+i+", "+c+`);
      const ivec3 pads = ivec3(`+t+", "+e+", "+n+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+x+`; wF++) {
          int xF = xFCorner + wF * `+f+`;

          if (xF < 0 || xF >= `+r.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+w+`; wR++) {
            int xR = xRCorner + wR * `+p+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+C+`; wC++) {
              int xC = xCCorner + wC * `+d+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+S+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(R===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+S+`) *
                  getW(wF, wR, wC, `+S+`, d2);
              } else if (`+(R===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+S+`),
                  getX(batch, xF, xR, xC, `+S+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+S+`, d2),
                  getW(wF, wR, wC, `+S+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(R===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+S+`),
                  getX(batch, xF, xR, xC, `+S+` + 1),
                  getX(batch, xF, xR, xC, `+S+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+S+`, d2),
                  getW(wF, wR, wC, `+S+` + 1, d2),
                  getW(wF, wR, wC, `+S+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},Q2=function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=r.outShape;var a=r.inHeight,i=r.inWidth,c=r.padInfo.top,f=r.padInfo.left,p=r.strideHeight,d=r.strideWidth,x=r.dilationHeight,w=r.dilationWidth,C=r.filterHeight,S=r.filterWidth,R=r.outChannels/r.inChannels,N="",D="";e&&(N=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,D="result = activation(result);");var M=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+N+`

      const ivec2 strides = ivec2(`+p+", "+d+`);
      const ivec2 pads = ivec2(`+c+", "+f+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+R+`;
        int q = d2 - d1 * `+R+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+C+`; wR++) {
          int xR = xRCorner + wR * `+x+`;

          if (xR < 0 || xR >= `+a+`) {
            continue;
          }

          for (int wC = 0; wC < `+S+`; wC++) {
            int xC = xCCorner + wC * `+w+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+M+`
        `+D+`
        setOutput(result);
      }
    `},J2=function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r.outShape;for(var a=r.inHeight,i=r.inWidth,c=r.padInfo.top,f=r.padInfo.left,p=r.strideHeight,d=r.strideWidth,x=r.dilationHeight,w=r.dilationWidth,C=r.filterHeight,S=r.filterWidth,R=S,N="int xR; int xC; int xCOffset;",D=0;D<C;D++)for(var M=0;M<S;M++)N+=`
          vec4 xTexelR`+D+"C"+2*M+` = vec4(0.);
          vec4 wR`+D+"C"+M+` = vec4(0.);
          vec4 xR`+D+"C"+M+" = vec4(0.);";for(D=0;D<C;D++)for(var B=0;B<R;B++){if(N+=`
          xR = xRCorner + `+D*x+`;
          xC = xCCorner + `+(M=2*B)*w+`;
        `,d===1){if(M<S&&(N+=f%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+D+"C"+M+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+D+"C"+M+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+D+"C"+M+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+D+"C"+M+" = vec4(previous.zw, xTexelR"+D+"C"+M+`.xy);
                } else {
                  xR`+D+"C"+M+" = vec4(0, 0, xTexelR"+D+"C"+M+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+a+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+D+"C"+M+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+D+"C"+M+` = vec4(0.);
                }

                xR`+D+"C"+M+" = xTexelR"+D+"C"+M+`;
              `,M+1<S)){var k=f%2==0?cy(w):w;w%2==0&&f%2==1||w%2!=0&&f%2!=1?(N+=`
                  xCOffset = xC + `+f%2+" + "+k+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+D+"C"+(M+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,w>1&&(N+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+a+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+D+"C"+M+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+D+"C"+M+` = vec4(0.);
                    }
                  `),N+=`
                  xR`+D+"C"+(M+1)+` = vec4(
                    xTexelR`+D+"C"+M+".zw, xTexelR"+D+"C"+(M+2)+`.xy);
                `):N+=`
                  xCOffset = xC + `+k+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+D+"C"+(M+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+D+"C"+(M+1)+" = xTexelR"+D+"C"+(M+2)+`;
                `}}else M<S&&(N+=`
              if(xR >= 0 && xR < `+a+`) {
            `,f%2==1?(N+=`
                xCOffset = xC + 1 - `+d+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+D+"C"+M+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+D+"C"+M+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+D+"C"+(M+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+D+"C"+(M+2)+` = vec4(0.);
                }

                xR`+D+"C"+M+` = vec4(
                  xTexelR`+D+"C"+M+".zw, xTexelR"+D+"C"+(M+2)+`.zw);
              `,M+1<S&&(N+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+d+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+D+"C"+(M+1)+" = vec4(xTexelR"+D+"C"+(M+2)+`.xy, final.xy);
                `)):(N+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+D+"C"+M+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+D+"C"+M+` = vec4(0.);
                }

                xCOffset = xC + `+d+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+D+"C"+(M+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+D+"C"+(M+2)+` = vec4(0.);
                }

                xR`+D+"C"+M+` = vec4(
                  xTexelR`+D+"C"+M+".xy, xTexelR"+D+"C"+(M+2)+`.xy);
              `,M+1<S&&(N+=`
                  xR`+D+"C"+(M+1)+` = vec4(
                    xTexelR`+D+"C"+M+".zw, xTexelR"+D+"C"+(M+2)+`.zw);
                `)),N+="}");M<S&&(N+=`
            vec4 wTexelR`+D+"C"+M+" = getW("+D+", "+M+`, d1, q);
            wR`+D+"C"+M+" = vec4(wTexelR"+D+"C"+M+".xz, wTexelR"+D+"C"+M+`.xz);
          `,M+1<S&&(N+=`
              vec4 wTexelR`+D+"C"+(M+1)+" = getW("+D+", "+(M+1)+`, d1, q);
              wR`+D+"C"+(M+1)+` =
                vec4(wTexelR`+D+"C"+(M+1)+".xz, wTexelR"+D+"C"+(M+1)+".xz);"))}for(D=0;D<C;D++)for(M=0;M<S;M++)N+="dotProd += xR"+D+"C"+M+" * wR"+D+"C"+M+";";var L="",F="";e&&(L=n?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`vec4 activation(vec4 x) {
          `+e+`
        }`,F="result = activation(result);");var W=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+L+`

      const ivec2 strides = ivec2(`+p+", "+d+`);
      const ivec2 pads = ivec2(`+c+", "+f+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+N+`

        vec4 result = dotProd;
        `+W+`
        `+F+`
        setOutput(result);
      }
    `},A4=function(r,t,e,n,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=r[0],c=r[1],f=r[2],p=r[3],d=t[0],x=e[0],w=e[1];this.outputShape=[d,x,w,p];var C=n==="bilinear"?1:0,S=[c-1+".0",f-1+".0"],R=S[0],N=S[1],D=x>1?[""+(c-1)/(x-1),"(y2-y1) * height_ratio","y1*"+R+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+R],M=D[0],B=D[1],k=D[2],L=w>1?[""+(f-1)/(w-1),"(x2-x1) * width_ratio","x1*"+N+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+N],F=L[0],W=L[1],G=L[2];this.userCode=`
      const float height_ratio = float(`+M+`);
      const float width_ratio = float(`+F+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+B+`;
        float width_scale = `+W+`;

        float in_y = `+k+`;
        if( in_y < 0.0 || in_y > `+R+` ) {
          setOutput(float(`+a+`));
          return;
        }
        float in_x = `+G+`;
        if( in_x < 0.0 || in_x > `+N+` ) {
          setOutput(float(`+a+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+C+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},S4=function(r,t,e){this.variableNames=["x"],this.outputShape=r;var n=r.length,a=r[r.length-1],i=e?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(e?"return "+a+" -i - 1;":"return i;")+`
      }

      void main() {
        `+vn(n)+` coords = getOutputCoords();
        int end = `+$2(n,"coords")+`;
        float val = 0.0;
        for (int i = `+a+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+$2(n,"coords")+` = idx;
          val += getX(`+(function(c,f){if(c===1)return""+f;if(c===2)return f+".x, "+f+".y";if(c===3)return f+".x, "+f+".y, "+f+".z";if(c===4)return f+".x, "+f+".y, "+f+".z, "+f+".w";throw Error("Cumulative sum for rank "+c+" is not yet supported")})(n,"coords")+`);
        }
        setOutput(val);
      }
    `};function $2(r,t){if(r===1)return""+t;if(r===2)return t+".y";if(r===3)return t+".z";if(r===4)return t+".w";throw Error("Cumulative sum for rank "+r+" is not yet supported")}var _4=function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=dc.DENSE;var t=sc(r),e=Fr();this.outputShape=r,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ks(["r","c","d"],r)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+e.output+` = result;
      }
    `},T4=function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=dc.DENSE;var t=sc(r),e=Fr();this.outputShape=r,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ks(["r","c","d"],r)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+e.output+` = result;
      }
    `},I4=(function(){function r(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+e+`;
      int offset_h = imod(h, `+e+`);
      int in_w = w / `+e+`;
      int offset_w = imod(w, `+e+`);
      int offset_d = (offset_h * `+e+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return r.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},r.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},r.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},r.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},r.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},r})(),R4=function(r){this.variableNames=["X"],this.outputShape=[r,r],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},N4=function(r){this.variableNames=["A"],this.outTexUsage=wa.DOWNLOAD;var t=Fr();this.outputShape=r,this.userCode=`
      `+Wy+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},D4=function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=wa.DOWNLOAD;var t=Fr();this.outputShape=r,this.userCode=`
      `+Wy+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},M4=function(r,t,e){e===void 0&&(e=!1),this.variableNames=["A"];var n=Fr(),a=t[0],i=t[1];this.outputShape=r;var c="result";e&&(c="floor(result * 255. + 0.5)"),this.userCode=`
      `+x1(r)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
        vec4 values = `+n.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+n.output+" = vec4("+c+`, 0., 0., 0.);
      }
    `},O4=function(r,t,e){e===void 0&&(e=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=Fr(),a=t[0],i=t[1];this.outputShape=r;var c="",f="result";e&&(f="floor(result * 255. + 0.5)");for(var p=0;p<=1;p++)for(var d=0;d<=1;d++){var x=2*p+d;c+=`
          localCoords = coords;
          if(localCoords[2] + `+d+" < "+r[2]+`) {
            localCoords[2] += `+d+`;
            if(localCoords[1] + `+p+" < "+r[1]+`) {
              localCoords[1] += `+p+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
              values = `+n.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+x+`] = values[0];
              } else if(offset == 1) {
                result[`+x+`] = values[1];
              } else if(offset == 2) {
                result[`+x+`] = values[2];
              } else {
                result[`+x+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+x1(r)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+c+`

        `+n.output+" = "+f+`;
      }
    `},B4="return real * expR - imag * expI;",k4="return real * expI + imag * expR;",ex=function(r,t,e){this.variableNames=["real","imag"];var n=t[1];this.outputShape=t;var a=e?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=e?n+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+a+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+r+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+n+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+n+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},L4=(function(){function r(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,a){e.valueLoc==null&&(e.valueLoc=n.getUniformLocationNoThrow(a,"value")),n.gl.uniform1f(e.valueLoc,t)}},r})(),F4=function(r,t,e){this.variableNames=["A","indices"];var n=r.slice();n[e]=t,this.outputShape=n,this.rank=n.length;var a=vn(this.rank),i=(function(c,f){var p=c.length;if(p>4)throw Error("Gather for rank "+p+" is not yet supported");if(p===1)return"int(getIndices(resRC))";for(var d=["resRC.x","resRC.y","resRC.z","resRC.w"],x=[],w=0;w<c.length;w++)w===f?x.push("int(getIndices("+d[w]+"))"):x.push(""+d[w]);return x.join()})(r,e);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},P4=function(r,t,e){this.sliceDim=r,this.strides=t,this.variableNames=["x","indices"],this.outputShape=e;var n=vn(t.length),a=vn(e.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+n+" strides = "+n+"("+this.strides+`);
         void main() {
          `+a+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function U4(r,t){var e=Fr();return BA(r,t,e.version+`
    precision highp float;
    `+e.attribute+` vec3 clipSpacePos;
    `+e.attribute+` vec2 uv;
    `+e.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function z4(r,t){return UA(r,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function H4(r,t){return zA(r,t,new Uint16Array([0,1,2,2,1,3]))}function Ac(r,t,e,n,a,i,c){VA(e,n);var f=HA(r,t),p=r.TEXTURE_2D;return $e(r,t,(function(){return r.bindTexture(p,f)})),$e(r,t,(function(){return r.texParameteri(p,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE)})),$e(r,t,(function(){return r.texParameteri(p,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)})),$e(r,t,(function(){return r.texParameteri(p,r.TEXTURE_MIN_FILTER,r.NEAREST)})),$e(r,t,(function(){return r.texParameteri(p,r.TEXTURE_MAG_FILTER,r.NEAREST)})),$e(r,t,(function(){return r.texImage2D(p,0,a,e,n,0,i,c,null)})),$e(r,t,(function(){return r.bindTexture(r.TEXTURE_2D,null)})),f}function V4(r,t,e,n,a){var i=kh(e,n);return Ac(r,t,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,r.FLOAT)}function W4(r,t,e,n,a){var i=kh(e,n);return Ac(r,t,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function G4(r,t,e,n,a){var i=kh(e,n);return Ac(r,t,i[0],i[1],r.RGBA,r.RGBA,r.UNSIGNED_BYTE)}function j4(r,t,e,n,a){var i=Cc(e,n);return Ac(r,t,i[0],i[1],a.internalFormatPackedFloat,r.RGBA,r.FLOAT)}function X4(r,t,e,n,a){var i=Cc(e,n);return Ac(r,t,i[0],i[1],a.internalFormatPackedHalfFloat,r.RGBA,a.textureTypeHalfFloat)}function Y4(r,t,e,n){return $e(r,t,(function(){return r.bindBuffer(r.ARRAY_BUFFER,n)})),H2(r,t,e,"clipSpacePos",n,3,20,0)&&H2(r,t,e,"uv",n,2,20,12)}function q4(r,t,e,n,a,i,c){var f,p,d;$e(r,t,(function(){return r.bindTexture(r.TEXTURE_2D,e)})),i instanceof Uint8Array?(f=new Uint8Array(n*a*4),p=r.UNSIGNED_BYTE,d=r.RGBA):(f=new Float32Array(n*a*4),p=r.FLOAT,d=c.internalFormatPackedFloat),f.set(i),$e(r,t,(function(){return r.texImage2D(r.TEXTURE_2D,0,d,n,a,0,r.RGBA,p,f)})),$e(r,t,(function(){return r.bindTexture(r.TEXTURE_2D,null)}))}function K4(r,t,e,n){$e(r,t,(function(){return r.bindTexture(r.TEXTURE_2D,e)})),n.data instanceof Uint8Array?$e(r,t,(function(){return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n.width,n.height,0,r.RGBA,r.UNSIGNED_BYTE,n.data)})):$e(r,t,(function(){return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n)})),$e(r,t,(function(){return r.bindTexture(r.TEXTURE_2D,null)}))}function Z4(r,t,e,n,a){var i=r.createBuffer();$e(r,t,(function(){return r.bindBuffer(r.PIXEL_PACK_BUFFER,i)}));var c=16*e*n;return $e(r,t,(function(){return r.bufferData(r.PIXEL_PACK_BUFFER,c,r.STREAM_READ)})),$e(r,t,(function(){return r.readPixels(0,0,n,e,r.RGBA,r.FLOAT,0)})),$e(r,t,(function(){return r.bindBuffer(r.PIXEL_PACK_BUFFER,null)})),i}function Q4(r,t,e){var n=r,a=new Float32Array(e);return n.bindBuffer(n.PIXEL_PACK_BUFFER,t),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,a),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),a}function J4(r,t,e,n,a){var i=kh(e,n),c=i[0],f=i[1],p=new Uint8Array(e*n*4);return $e(r,t,(function(){return r.readPixels(0,0,c,f,a.downloadTextureFormat,r.UNSIGNED_BYTE,p)})),new Float32Array(p.buffer)}function $4(r,t,e,n,a,i,c,f){var p=r,d=new Float32Array((function(x,w){var C=Cc(x,w);return C[0]*C[1]*4})(i,c));return p.bindBuffer(p.PIXEL_PACK_BUFFER,t),p.getBufferSubData(p.PIXEL_PACK_BUFFER,0,d),p.bindBuffer(p.PIXEL_PACK_BUFFER,null),d}function e_(r,t,e,n){var a=new Float32Array(e*n*4);return $e(r,t,(function(){return r.readPixels(0,0,n,e,r.RGBA,r.FLOAT,a)})),a}var t_=(function(){function r(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=Re().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,RA(e,t)):this.gl=Ri(e);var n="WEBGL_color_buffer_float";if(Re().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Gf(this.gl,this.debug,"OES_texture_float"),Fa(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Gf(this.gl,this.debug,"OES_texture_half_float");else if(Re().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Fa(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Gf(this.gl,this.debug,"EXT_color_buffer_half_float");else if(Re().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Fa(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!Fa(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=z4(this.gl,this.debug),this.indexBuffer=H4(this.gl,this.debug),this.framebuffer=WA(this.gl,this.debug),this.textureConfig=u1(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(r.prototype,"debug",{get:function(){return Re().getBool("DEBUG")},enumerable:!0,configurable:!0}),r.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;$e(e,this.debug,(function(){return e.finish()})),$e(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),$e(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),$e(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),$e(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),$e(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},r.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),V4(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),W4(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),G4(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),K4(this.gl,this.debug,t,e)},r.prototype.uploadDenseMatrixToTexture=function(t,e,n,a){this.throwIfDisposed(),q4(this.gl,this.debug,t,e,n,a,this.textureConfig)},r.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),X4(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),j4(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(V2(this.gl,this.debug,this.framebuffer),this.outputTexture=null),$e(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))},r.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var a=this;return this.downloadMatrixDriver(t,(function(){return J4(a.gl,a.debug,e,n,a.textureConfig)}))},r.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,a,i,c){return $4(this.gl,t,0,0,0,i,c,this.textureConfig)},r.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return Q4(this.gl,t,e)},r.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var a=Z4(this.gl,this.debug,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a},r.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},r.prototype.createFence=function(t){var e,n,a=this;if(Re().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,c=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var f=i.clientWaitSync(c,0,0);return f===i.ALREADY_SIGNALED||f===i.CONDITION_SATISFIED},e=c}else Re().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return a.isQueryAvailable(e,Re().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},r.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var a=this;return this.downloadMatrixDriver(t,(function(){return e_(a.gl,a.debug,e,n)}))},r.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=kA(e,this.debug,t),a=U4(e,this.debug),i=FA(e,this.debug);return $e(e,this.debug,(function(){return e.attachShader(i,a)})),$e(e,this.debug,(function(){return e.attachShader(i,n)})),PA(e,this.debug,i),this.debug&&ip(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=Y4(e,this.debug,this.program,this.vertexBuffer)),i},r.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&$e(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))},r.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&ip(this.gl,this.debug,this.program),$e(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))},r.prototype.getUniformLocation=function(t,e,n){return n===void 0&&(n=!0),this.throwIfDisposed(),n?jA(this.gl,this.debug,t,e):XA(this.gl,t,e)},r.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),$e(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))},r.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},r.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),YA(this.gl,this.debug,this.program,t,e,n)},r.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},r.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var a=Cc(e,n),i=a[0],c=a[1];this.setOutputMatrixTextureDriver(t,i,c)},r.prototype.setOutputMatrixWriteRegion=function(t,e,n,a){this.setOutputMatrixWriteRegionDriver(n,t,a,e)},r.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},r.prototype.debugValidate=function(){this.program!=null&&ip(this.gl,this.debug,this.program),jf(this.gl)},r.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),$e(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},r.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),$e(this.gl,this.debug,(function(){return t.gl.finish()}))},r.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Gf(this.gl,this.debug,Re().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},r.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},r.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},r.prototype.beginQuery=function(){if(Re().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var a=this.getQueryTimerExtensionWebGL1(),i=a.createQueryEXT();return a.beginQueryEXT(a.TIME_ELAPSED_EXT,i),i},r.prototype.endQuery=function(){if(Re().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},r.prototype.waitForQueryAndGetTime=function(t){return Ze(this,void 0,void 0,(function(){var e=this;return Qe(this,(function(n){switch(n.label){case 0:return[4,k2((function(){return e.disposed||e.isQueryAvailable(t,Re().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,Re().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},r.prototype.getQueryTime=function(t,e){if(e===0)return null;if(e===2){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var a=this.getQueryTimerExtensionWebGL1();return a.getQueryObjectEXT(t,a.QUERY_RESULT_EXT)/1e6},r.prototype.isQueryAvailable=function(t,e){if(e===0)return!0;if(e===2){var n=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(a=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,a.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint},r.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},r.prototype.pollItems=function(){for(var t=(function(n){for(var a=0;a<n.length&&n[a]();++a);return a-1})(this.itemsToPoll.map((function(n){return n.isDoneFn}))),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},r.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||k2((function(){return n.pollItems(),n.itemsToPoll.length===0}))},r.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),op(this.gl,this.debug,t,this.framebuffer),this.debug&&jf(this.gl)},r.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(op(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&jf(this.gl)):V2(this.gl,this.debug,this.framebuffer)},r.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},r.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var a=this.gl;op(a,this.debug,t,this.framebuffer),this.debug&&jf(a),this.outputTexture=t,$e(a,this.debug,(function(){return a.viewport(0,0,e,n)})),$e(a,this.debug,(function(){return a.scissor(0,0,e,n)}))},r.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,a){var i=this;this.throwIfDisposed(),$e(this.gl,this.debug,(function(){return i.gl.scissor(t,e,n,a)}))},r.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},r.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},r})();function tx(r,t){if(r.length!==t.length)throw Error("Binary was compiled with "+r.length+" inputs, but was executed with "+t.length+" inputs");r.forEach((function(e,n){var a=e.logicalShape,i=t[n],c=i.shape;if(!yr(a,c))throw Error("Binary was compiled with different shapes than the current args. Shapes "+a+" and "+c+" must match");if(!e.isUniform||!i.isUniform){var f=e.texShape,p=i.isUniform?null:i.texData.texShape;if(!yr(f,p))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+f+" and "+p+" must match")}}))}var n_=function(r,t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;for(var n=e.filterWidth,a=e.inChannels,i=e.strideWidth,c=e.strideHeight,f=e.padInfo,p=e.outWidth,d=e.dilationWidth,x=e.dilationHeight,w=e.dataFormat,C=f.left,S=f.top,R=a*n,N=Fr(),D=w==="channelsLast",M=D?0:1,B=D?1:2,k="",L=0;L<=1;L++)for(var F=0;F<=1;F++)k+=`
          blockIndex = rc.y + `+F+`;
          pos = rc.x + `+L+`;

          if(blockIndex < `+r[1]+" && pos < "+r[0]+`) {
            offsetY = int(blockIndex / (`+p+")) * "+c+" - "+S+`;
            d0 = offsetY + `+x+" * (pos / "+R+`);

            if(d0 < `+t[M]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+p+".) * "+i+". - "+C+`.);
              d1 = offsetX + `+d+" * (int(mod(float(pos), "+R+".) / "+a+`.));

              if(d1 < `+t[B]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+a+`.));

                if (`+D+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*L+F)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*L+F)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+k+`

        `+N.output+` = result;
      }
    `},r_=function(r,t,e,n,a){this.variableNames=["x"],this.outputShape=[];var i,c=t,f=r[3]-1;this.outputShape=r;var p="float("+e+") + float("+n+") * sum";i=a===.5?"inversesqrt("+p+")":a===1?"1.0/("+p+")":"exp(log("+p+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+c+"; j <= "+c+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+f+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},a_=function(r,t,e,n,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=r,this.depth=r[3],this.depthRadius=t,this.bias=e,this.alpha=n,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+n+") * norm + float("+e+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+n+`)
                * float(`+a+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+a+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},i_=function(r,t,e,n,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,c=t,f=r[3]-1;this.outputShape=r;var p="float("+e+") + float("+n+") * sum";i=a===.5?"inversesqrt("+p+")":a===1?"1.0/("+p+")":"exp(log("+p+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+c+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+c+"; j <= "+c+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+f+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},o_=function(r){this.variableNames=["dy","maxPos"],this.outputShape=r.inShape;var t=r.strideHeight,e=r.strideWidth,n=r.dilationHeight,a=r.effectiveFilterHeight,i=r.effectiveFilterWidth,c=a-1-r.padInfo.top,f=i-1-r.padInfo.left,p=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+c+", "+f+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
          wR += `+n+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+e+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+p+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},s_=function(r){this.variableNames=["dy","maxPos"],this.outputShape=r.inShape;var t=r.strideDepth,e=r.strideHeight,n=r.strideWidth,a=r.dilationDepth,i=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,p=r.effectiveFilterHeight,d=r.effectiveFilterWidth,x=f-1-r.padInfo.front,w=p-1-r.padInfo.top,C=d-1-r.padInfo.left,S=f*p*d-1;this.userCode=`
      const ivec3 pads = ivec3(`+x+", "+w+", "+C+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+f+`;
           wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+r.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+p+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+e+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+d+`;
                wC += `+c+`) {
              float dyC = float(dyCCorner + wC) / `+n+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+S+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+p+" * "+d+` +
                  wR * `+d+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},fp=function(r,t,e,n,a,i,c){e===void 0&&(e=!1),n===void 0&&(n=!1),a===void 0&&(a=!1),i===void 0&&(i=null),c===void 0&&(c=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var f=e?r[1]:r[2],p=Math.ceil(f/2),d=e?"i * 2, rc.y":"rc.y, i * 2",x=n?"rc.z, i * 2":"i * 2, rc.z",w=e?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],C=n?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],S="",R="";i&&(S=c?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,R="result = activation(result);");var N=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+S+`

      const float sharedDimension = `+p+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+p+`; i++) {
          vec4 a = getMatrixA(rc.x, `+d+`);
          vec4 b = getMatrixB(rc.x, `+x+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+w[0]+" * "+C[0]+`);
          result += (`+w[1]+" * "+C[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+N+`

        `+R+`

        setOutput(result);
      }
    `},u_=(function(){function r(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(e-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(e-1)+`));
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,a){e.seedLoc==null&&(e.seedLoc=n.getUniformLocation(a,"seed")),n.gl.uniform1f(e.seedLoc,t)}},r})(),l_=function(r,t,e,n){this.variableNames=["indices"],this.outputShape=[r,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+n+"), float("+e+`),
                      float(index == coords.y)));
      }
    `},c_=function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=r;var t=r.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var e=na("rc",t),n=vn(t),a=(function(f,p,d){if(f===1)return"rc > "+p[0];for(var x="",w=f-2;w<f;w++)x+=d[w]+" >= "+p[w],w<f-1&&(x+="||");return x})(t,r,e),i=(function(f,p,d,x){if(f===1)return"";var w=x.slice(-2);return`
    int r = `+w[0]+`;
    int c = `+w[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+p+`;
    bool rEdge = rp1 >= `+d+`;
  `})(t,r[r.length-1],r[r.length-2],e),c=(function(f,p){var d=f.length,x=(function(w,C){for(var S=[],R=0;R<=1;R++)for(var N=0;N<=1;N++){for(var D=(R===0?"r":"rp1")+", "+(N===0?"c":"cp1"),M=2;M<w;M++)D=C[C.length-1-M]+","+D;S.push(D)}return S})(d,p);return d===1?`getA(rc),
            rc + 1 >= `+f[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+x[0]+`),
          cEdge ? 0. : getA(`+x[1]+`),
          rEdge ? 0. : getA(`+x[2]+`),
          rEdge || cEdge ? 0. : getA(`+x[3]+")"})(r,e);this.userCode=`
        void main() {
          `+n+` rc = getOutputCoords();

          if(`+a+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+c+`));
          }
        }
      `}},f_=function(r,t,e){this.variableNames=["x"],this.outputShape=t.map((function(p,d){return p[0]+r[d]+p[1]}));var n=r.length,a=vn(n),i=t.map((function(p){return p[0]})).join(","),c=t.map((function(p,d){return p[0]+r[d]})).join(","),f=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n);this.userCode=n!==1?`
      `+a+" start = "+a+"("+i+`);
      `+a+" end = "+a+"("+c+`);

      void main() {
        `+a+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+e+`));
        } else {
          `+a+` coords = outC - start;
          setOutput(getX(`+f+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+c+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+e+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},h_=function(r,t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((function(D,M){return D[0]+r[M]+D[1]}));for(var n=r.length,a=vn(n),i=t.map((function(D){return D[0]})).join(","),c=t.map((function(D,M){return D[0]+r[M]})).join(","),f=na("rc",n),p=na("source",n),d=f[n-1]+" < "+this.outputShape[n-1],x=n===1?"source":"vec2("+p.slice(-2).join()+")",w=[a+" rc = outputLoc;",f[n-1]+` += 1;
       if(`+d+`) {
      `,n===1?"":`}
       rc = outputLoc;
       `+f[n-2]+` += 1;
       if(`+f[n-2]+" < "+this.outputShape[n-2]+") {",n===1?"":"  "+f[n-1]+` += 1;
         if(`+d+") {"],C=n===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",S="",R=0,N=n===1?2:4;R<N;R++)S+=`
        `+w[R]+`
        if (`+C+`) {
          result[`+R+"] = float("+e+`);
        } else {
          `+a+` source = rc - start;
          result[`+R+"] = getChannel(getX("+p.join()+"), "+x+`);
        }
      `;S+=n===1?"} ":"}}",this.userCode=`
      const `+a+" start = "+a+"("+i+`);
      const `+a+" end = "+a+"("+c+`);

      void main() {
        `+a+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+S+`
        setOutput(result);
      }
    `},hp=function(r,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var n=r.filterWidth,a=r.strideHeight,i=r.strideWidth,c=r.dilationHeight,f=r.dilationWidth,p=r.effectiveFilterHeight,d=r.effectiveFilterWidth,x=r.padInfo.top,w=r.padInfo.left;this.outputShape=r.outShape;var C=t==="avg",S="0.0";if(C||(S="-1.0 / 1e-20"),e)this.userCode=`
        const ivec2 strides = ivec2(`+a+", "+i+`);
        const ivec2 pads = ivec2(`+x+", "+w+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+p+`;
              wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+d+`;
                wC += `+f+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+d+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var R=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(R="avgValue / count");var N=4*Math.floor(n/4),D=n%4,M=`
      if (`+C+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+a+", "+i+`);
      const ivec2 pads = ivec2(`+x+", "+w+`);
      const float initializationValue = `+S+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+r.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+S+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+p+`;
            wR += `+c+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+r.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+N+`; wC += 4) {
            int xC = xCCorner + wC * `+f+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+f+`, d),
              getValue(batch, xR, xC + 2 * `+f+`, d),
              getValue(batch, xR, xC + 3 * `+f+`, d)
            );

            `+M+`
          }

          int xC = xCCorner + `+N+`;
          if (`+(D===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+M+`
          } else if (`+(D===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+f+`, d),
              initializationValue,
              initializationValue
            );

            `+M+`
          } else if (`+(D===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+f+`, d),
              getValue(batch, xR, xC + 2 * `+f+`, d),
              initializationValue
            );

            `+M+`
          }
        }
        setOutput(`+R+`);
      }
    `}},dp=function(r,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,c=r.strideWidth,f=r.dilationDepth,p=r.dilationHeight,d=r.dilationWidth,x=r.effectiveFilterDepth,w=r.effectiveFilterHeight,C=r.effectiveFilterWidth,S=r.padInfo.front,R=r.padInfo.top,N=r.padInfo.left;this.outputShape=r.outShape;var D=t==="avg",M="0.0";if(D||(M="-1.0 / 1e-20"),e)this.userCode=`
        const ivec3 strides =
            ivec3(`+a+", "+i+", "+c+`);
        const ivec3 pads = ivec3(`+S+", "+R+", "+N+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+x+`;
              wD += `+f+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+r.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+w+`;
                wR += `+p+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+r.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+C+`;
                  wC += `+d+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+r.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+w+" * "+C+` +
                      wR * `+C+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var B=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(B="avgValue / count");var k=4*Math.floor(n/4),L=n%4,F=`
      if (`+D+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+a+", "+i+", "+c+`);
      const ivec3 pads = ivec3(`+S+", "+R+", "+N+`);
      const float initializationValue = `+M+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+r.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+M+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+x+`;
            wD += `+f+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+r.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+w+`;
            wR += `+p+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+k+`; wC += 4) {
              int xC = xCCorner + wC * `+d+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+d+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+d+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+d+`, ch)
              );

              `+F+`
            }

            int xC = xCCorner + `+k+`;
            if (`+(L===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+F+`
            } else if (`+(L===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+d+`, ch),
                initializationValue,
                initializationValue
              );

              `+F+`
            } else if (`+(L===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+d+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+d+`, ch),
                initializationValue
              );

              `+F+`
            }
          }
          setOutput(`+B+`);
        }
      }
    `}},d_=function(r,t){this.variableNames=["x"];var e=r.windowSize,n=r.batchSize,a=r.inSize,i=Math.ceil(a/e);this.outputShape=[n,i];var c="0.0",f="";t==="prod"?c="1.0":t==="min"?(c="1.0 / 1e-20",f="min"):t==="max"&&(c="-1.0 / 1e-20",f="max");var p=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?p="sumValue":t==="prod"?p="prodValue":t==="all"?p="allValue":t==="any"&&(p="anyValue");var d=4*Math.floor(e/4),x=e%4,w=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+f+`(values, minMaxValue);
      }
    `,C="vec4";t==="all"?(c="1.0",w=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,C="bvec4"):t==="any"&&(c="0.0",w=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,C="bvec4");var S="";a%e>0&&(S=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+c+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+S+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+e+`;

        vec4 minMaxValue = vec4(`+c+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+d+`; i += 4) {
          int inIdx = inOffset + i;
          `+C+" values = "+C+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+w+`
        }

        int inIdx = inOffset + `+d+`;
        if (`+(x===1)+`) {
          `+C+" values = "+C+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+w+`
        } else if (`+(x===2)+`) {
          `+C+" values = "+C+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+w+`
        } else if (`+(x===3)+`) {
          `+C+" values = "+C+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+w+`
        }
        setOutput(`+p+`);
      }
    `},p_=function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;for(var e="",n=0;n<4;n++){var a="thisRC = rc;";n%2==1&&(a+="thisRC.z += 1;"),n>1&&(a+="thisRC.y += 1;"),e+=`
        `+a+`
        `+(n>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+n+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(n>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+ks(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+x1(r)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+r[1]+`;
        int cols = `+r[2]+`;

        `+e+`

        setOutput(result);
      }
    `},g_=function(r,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var n=t.shape,a=n[1],i=n[2],c=r.shape,f=c[1],p=c[2],d=[e&&f>1?a-1:a,e&&p>1?i-1:i],x=[e&&f>1?f-1:f,e&&p>1?p-1:p],w=d[0]/x[0],C=d[1]/x[1],S=1/w,R=1/C,N=2*Math.ceil(S)+2,D=2*Math.ceil(R)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+w+`);
        const float widthScale = float(`+C+`);

        const float invHeightScale = float(`+S+`);
        const float invWidthScale = float(`+R+`);

        const int winHeight = int(`+N+`);
        const int winWidth = int(`+D+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+f+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+p+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(a-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},v_=function(r,t,e,n){this.variableNames=["A"],this.outputShape=[];var a=r[0],i=r[1],c=r[2],f=r[3];this.outputShape=[a,t,e,f];var p=[n&&t>1?i-1:i,n&&e>1?c-1:c],d=[n&&t>1?t-1:t,n&&e>1?e-1:e];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+p[0]/d[0]+`,
          `+p[1]/d[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+c+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},m_=function(r,t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=r[0],i=r[1],c=r[2],f=r[3];this.outputShape=[a,t,e,f];var p=[n&&t>1?i-1:i,n&&e>1?c-1:c],d=[n&&t>1?t-1:t,n&&e>1?e-1:e];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+p[0]/d[0]+`,
          `+p[1]/d[1]+`,
          `+p[1]/d[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+c+`.0,
                                     `+c+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(f-1)+`;
        bool hasNextRow = coords.z < `+(e-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},x_=function(r,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var n=t.shape,a=n[1],i=n[2],c=r.shape,f=c[1],p=c[2],d=[e&&f>1?a-1:a,e&&p>1?i-1:i],x=[e&&f>1?f-1:f,e&&p>1?p-1:p],w=d[0]/x[0],C=d[1]/x[1],S=1/w,R=1/C,N=2*Math.ceil(S)+2,D=2*Math.ceil(R)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+w+`);
        const float widthScale = float(`+C+`);

        const float invHeightScale = float(`+S+`);
        const float invWidthScale = float(`+R+`);

        const int winHeight = int(`+N+`);
        const int winWidth = int(`+D+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+f+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+p+`) {
              continue;
            }

            float sourceFracRow =
              float(`+d[0]+`) *
                (float(dyR) / float(`+x[0]+`));

            float sourceFracCol =
                float(`+d[1]+`) *
                  (float(dyC) / float(`+x[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+a+`) - 1),
                `+e+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+e+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},y_=function(r,t,e,n){this.variableNames=["A"],this.outputShape=[];var a=r[0],i=r[1],c=r[2],f=r[3];this.outputShape=[a,t,e,f];var p=[n&&t>1?i-1:i,n&&e>1?c-1:c],d=[n&&t>1?t-1:t,n&&e>1?e-1:e],x=n?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+p[0]/d[0]+`,
          `+p[1]/d[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+c+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+x+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},b_=function(r,t){this.variableNames=["x"];var e=r.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");if(this.outputShape=r,e!==1){var n=r.map((function(i,c){return(function(f){return t.indexOf(f)!==-1&&r[f]!==1?r[f]+" - coords["+f+"] - 1":"coords["+f+"]"})(c)})).join(","),a=vn(e);this.userCode=`
      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+n+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+r[0]+` - coord - 1));
        }
      `},w_=function(r,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var e=r.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");this.outputShape=r;var n=na("rc",e),a=n[e-1]+" + 1 < "+this.outputShape[e-1],i=n[e-2]+" + 1 < "+this.outputShape[e-2],c=vn(e);function f(p){var d=r.map((function(x,w){return(function(C,S){return t.indexOf(C)!==-1&&r[C]!==1?r[C]+" - "+S[C]+" - 1":""+S[C]})(w,p)}));return"getChannel(getX("+d.join(",")+"), vec2("+d.slice(-2).join(",")+"))"}this.userCode=e===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+r[0]+` - rc - 1),
            `+r[0]+` - rc - 1);
          if(`+a+`){
              result.g = getChannel(getX(`+r[0]+` - (rc  + 1) - 1),
                `+r[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+c+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+(function(p){return f(p)})(n.slice())+`;
          if(`+a+`){
            result.g = `+(function(p){return p[e-1]="("+p[e-1]+" + 1)",f(p)})(n.slice())+`;
          }
          if(`+i+`) {
            result.b = `+(function(p){return p[e-2]="("+p[e-2]+" + 1)",f(p)})(n.slice())+`;
            if(`+a+`) {
              result.a = `+(function(p){return p[e-1]="("+p[e-1]+" + 1)",p[e-2]="("+p[e-2]+" + 1)",f(p)})(n.slice())+`;
            }
          }
          setOutput(result);
        }
    `},nx=function(r,t,e,n,a,i,c){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var f=vn(a.length),p=vn(i.length),d="";e===1?d="i":e===2&&(d="i, j");var x="getIndices("+d+")",w="";n===1?w="i":n===2&&(w="i, coords[1]");var C="getUpdates("+w+")",S=t>1?"strides[j]":"strides";this.userCode=`
        `+f+" strides = "+f+"("+a+`);

        void main() {
          `+p+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+r+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+x+`);
              flattenedIndex += index * `+S+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+C+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},E_=function(r,t){this.variableNames=["x","segmentIds"];var e=r.windowSize,n=r.batchSize,a=r.inSize,i=r.numSegments,c=i*Math.ceil(a/e);this.outputShape=[n,c];var f=4*Math.floor(e/4),p=e%4,d=`
        sumValue += dot(values, segFilter);
    `,x="";a%e>0&&(x=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `);var w="";a%e>0&&(w=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+x+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+w+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+e+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+f+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+d+`
        }

        int inIdx = inOffset + `+f+`;
        if (`+(p===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+d+`
        } else if (`+(p===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+d+`
        } else if (`+(p===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+d+`
        }
        setOutput(sumValue);
      }
    `},C_=function(r,t,e){var n,a;if(this.variableNames=["c","a","b"],this.outputShape=t,e>4)throw Error("Where for rank "+e+" is not yet supported");if(e===1)a="resRC",n="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],f=[],p=0;p<t.length;p++)f.push(""+i[p]),p<r&&c.push(""+i[p]);n=c.join(),a=f.join()}var d=vn(e);this.userCode=`
      void main() {
        `+d+` resRC = getOutputCoords();
        float cVal = getC(`+n+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+a+`));
        } else {
          setOutput(getB(`+a+`));
        }
      }
    `},A_=(function(){function r(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=vn(this.rank),a="uniform int start["+this.rank+"];",i=(function(c){if(c===1)return"sourceLoc";if(c<=6)return pp.slice(0,c).map((function(f){return"sourceLoc."+f})).join(",");throw Error("Slicing for rank "+c+" is not yet supported")})(this.rank);e=`
        `+n+` sourceLoc;
        `+n+` coords = getOutputCoords();
        `+t.map((function(c,f){return"sourceLoc."+pp[f]+" = start["+f+"] + coords."+pp[f]+";"})).join(`
`)+`
      `,this.userCode=`
      `+a+`
      void main() {
        `+e+`
        setOutput(getSource(`+i+`));
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,a){e.startLoc==null&&(e.startLoc=n.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||n.gl.uniform1iv(e.startLoc,t)}},r})(),pp=["x","y","z","w","u","v"],S_=(function(){function r(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=vn(this.rank),n=na("coords",this.rank),a=na("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+a.slice(-2).join()+")",c="getChannel(getSource("+a.join()+"), "+i+")",f=`
      result.x = `+c+`;
      if (++`+n[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+a[this.rank-1]+`;
        result.y = `+c+`;
        --`+a[this.rank-1]+`;
      }
    `,p=this.rank===1?"":`
      --`+n[this.rank-1]+`;
      if (++`+n[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+a[this.rank-2]+`;
        result.z = `+c+`;
        if (++`+n[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+a[this.rank-1]+`;
          result.w = `+c+`;
        }
      }
    `,d=this.rank<=4?`sourceLoc = coords +
            `+e+"("+t.map((function(x,w){return"start["+w+"]"})).join()+");":t.map((function(x,w){return a[w]+" = "+n[w]+" + start["+w+"];"})).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+e+` coords = getOutputCoords();
        `+e+` sourceLoc;
        `+d+`
        vec4 result = vec4(0.);
        `+f+`
        `+p+`
        setOutput(result);
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,a){e.startLoc==null&&(e.startLoc=n.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||n.gl.uniform1iv(e.startLoc,t)}},r})(),__=function(r,t,e){this.variableNames=["x"],this.outputShape=e;var n=e.length,a=vn(e.length),i=vn(e.length),c="";if(n===1)c="coords * strides + begin";else{var f=0;c=e.map((function(p,d){return f++,e.length===1?"coords * strides["+d+"] + begin["+d+"]":"coords["+(f-1)+"] * strides["+d+"] + begin["+d+"]"})).join(",")}this.userCode=`
      `+a+" begin = "+a+"("+r+`);
      `+a+" strides = "+a+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+c+`));
      }
    `},T_=(function(){function r(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return r.prototype.acquireTexture=function(t,e,n){var a,i=rx(e,n),c=ax(t,i,n);if(c in this.freeTextures||(this.freeTextures[c]=[]),c in this.usedTextures||(this.usedTextures[c]=[]),this.freeTextures[c].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var f=this.freeTextures[c].shift();return this.usedTextures[c].push(f),f}return this.numUsedTextures++,this.log(),i===ya.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===ya.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===ya.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===ya.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===ya.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[c].push(a),a},r.prototype.releaseTexture=function(t,e,n,a){if(this.freeTextures!=null){var i=ax(e,rx(n,a),a);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var c=this.usedTextures[i],f=c.indexOf(t);if(f<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c.splice(f,1),this.log()}},r.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},r.prototype.getNumUsedTextures=function(){return this.numUsedTextures},r.prototype.getNumFreeTextures=function(){return this.numFreeTextures},r.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(n){t.gpgpu.deleteMatrixTexture(n)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(a){t.gpgpu.deleteMatrixTexture(a)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},r})();function rx(r,t){if(r===wa.UPLOAD)return ya.PACKED_2X2_FLOAT32;if(r===wa.RENDER||r==null)return(function(e){return Re().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?ya.PACKED_2X2_FLOAT32:ya.UNPACKED_FLOAT32:e?ya.PACKED_2X2_FLOAT16:ya.UNPACKED_FLOAT16})(t);if(r===wa.DOWNLOAD||r===wa.PIXELS)return ya.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+r)}function ax(r,t,e){return r[0]+"_"+r[1]+"_"+t+"_"+e}var I_=function(r,t){this.variableNames=["A"];for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[n]*t[n];this.outputShape=e,this.rank=e.length;var a=vn(this.rank),i=(function(c){var f=c.length;if(f>5)throw Error("Tile for rank "+f+" is not yet supported");if(f===1)return"imod(resRC, "+c[0]+")";for(var p=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],d=[],x=0;x<c.length;x++)d.push("imod("+p[x]+", "+c[x]+")");return d.join()})(r);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},R_=function(r,t){this.variableNames=["A"];for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[t[n]];this.outputShape=e,this.rank=e.length;var a=vn(this.rank),i=(function(c){var f=c.length;if(f>6)throw Error("Transpose for rank "+f+" is not yet supported");for(var p=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],d=new Array(f),x=0;x<c.length;x++)d[c[x]]=p[x];return d.join()})(t);this.userCode=`
    void main() {
      `+a+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},N_=function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[t[n]];if(this.outputShape=e,this.rank=e.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=vn(this.rank),i=Vy("rc",this.rank),c=new Array(this.rank);for(n=0;n<t.length;n++)c[t[n]]=i[n];var f="vec2("+c.slice(-2).join()+")",p="++"+i[this.rank-1]+" < "+e[this.rank-1],d="getChannel(getA("+c.join()+"), "+f+")";this.userCode=`
    void main() {
      `+a+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+d+`;
      if(`+p+`) {
        result[1] = `+d+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+e[this.rank-2]+`) {
        result[2] = `+d+`;
        if(`+p+`) {
          result[3] = `+d+`;
        }
      }
      setOutput(result);
    }
    `},y1=1.7580993408473768,b1=1.0507009873554805,Et=function(r,t){this.variableNames=["A"],this.outputShape=r,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Qa="if (isnan(x)) return x;",D_="return x;",ix="return abs(x);",Yy=Qa+`
  return (x < 0.0) ? 0.0 : x;
`,qy=Qa+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Ky="return (x >= 0.0) ? x : (exp(x) - 1.0);",M_=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+y1+`;
  float scale = `+b1+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,ox="return -x;",sx="return ceil(x);",ux="return floor(x);",lx="return exp(x);",cx="return exp(x) - 1.0;",O_=Qa+`
  return sin(x);
`,B_=Qa+`
  return cos(x);
`,k_=Qa+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,L_=Qa+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,F_=Qa+`
  return atan(x);
`,P_=Qa+"return log(x + sqrt(x * x + 1.0));",U_=Qa+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,z_=Qa+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Kf="return x;",H_="return x;",Zy=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Qy=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Jy=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,ic=function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},V_=function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=r;var t=r.length,e=na("rc",t),n=vn(t),a=(function(f,p){if(f===1)return"rc";for(var d="",x=0;x<f;x++)d+=p[x],x<f-1&&(d+=",");return d})(t,e),i=e.slice(-2),c=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+n+` rc = getOutputCoords();
        vec4 packedInput = getA(`+a+`);

        setOutput(getChannel(packedInput, `+c+`));
      }
    `},Zf={};function Qf(r,t){if(t===void 0&&(t=!1),r==="linear")return t?H_:D_;if(r==="relu")return t?Zy:Yy;if(r==="elu")return t?Jy:Ky;if(r==="relu6")return t?Qy:qy;if(r==="prelu")return t?Xy:jy;throw new Error("Activation "+r+" has not been implemented for the WebGL backend.")}var W_=600,G_=(function(r){function t(e){var n,a=r.call(this)||this;if(a.pendingRead=new WeakMap,a.pendingDisposal=new WeakSet,a.dataRefCount=new WeakMap,a.numBytesInGPU=0,a.uploadWaitMs=0,a.downloadWaitMs=0,a.warnedAboutMemory=!1,a.pendingDeletes=0,a.disposed=!1,!Re().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(e==null){var i=Ri(Re().getNumber("WEBGL_VERSION"));a.binaryCache=((n=Re().getNumber("WEBGL_VERSION"))in Zf||(Zf[n]={}),Zf[n]),a.gpgpu=new t_(i),a.canvas=i.canvas,a.gpgpuCreatedLocally=!0}else a.gpgpu=e,a.binaryCache={},a.gpgpuCreatedLocally=!1,a.canvas=e.gl.canvas;return a.textureManager=new T_(a.gpgpu),a.numMBBeforeWarning=Re().global.screen==null?1024:Re().global.screen.height*Re().global.screen.width*window.devicePixelRatio*W_/1024/1024,a.texData=new Oy(a,le),a}return Za(t,r),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,n,a){if(Re().getBool("DEBUG")&&this.checkNumericalProblems(e),a==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:n,dtype:a,values:e,usage:wa.UPLOAD}),i},t.prototype.move=function(e,n,a,i){if(Re().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:a,dtype:i,values:n,usage:wa.UPLOAD})},t.prototype.readSync=function(e){var n=this.texData.get(e),a=n.values,i=n.dtype,c=n.complexTensors,f=n.slice,p=n.shape,d=n.isPacked;if(f!=null){var x=void 0;x=d?new ic(p,Kf):new Et(p,Kf);var w=this.runWebGLProgram(x,[{dataId:e,shape:p,dtype:i}],i),C=this.readSync(w.dataId);return this.disposeData(w.dataId),C}if(a!=null)return this.convertAndCacheOnCPU(e);if(i==="string")return a;var S,R,N=this.activeTimers!=null;return N&&(S=yi()),i==="complex64"?R=Wp(c.real.dataSync(),c.imag.dataSync()):R=this.getValuesFromTexture(e),N&&(this.downloadWaitMs+=yi()-S),this.convertAndCacheOnCPU(e,R)},t.prototype.read=function(e){return Ze(this,void 0,void 0,(function(){var n,a,i,c,f,p,d,x,w,C,S,R,N,D,M,B,k,L,F,W,G,q;return Qe(this,(function(H){switch(H.label){case 0:if(this.pendingRead.has(e))return n=this.pendingRead.get(e),[2,new Promise((function(Z){return n.push(Z)}))];if(a=this.texData.get(e),i=a.values,c=a.shape,f=a.slice,p=a.dtype,d=a.complexTensors,x=a.isPacked,f!=null)return w=void 0,w=x?new ic(c,Kf):new Et(c,Kf),C=this.runWebGLProgram(w,[{dataId:e,shape:c,dtype:p}],p),S=this.read(C.dataId),this.disposeData(C.dataId),[2,S];if(i!=null)return[2,this.convertAndCacheOnCPU(e)];if(!Re().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Re().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return R=null,p!=="complex64"&&Re().get("WEBGL_BUFFER_SUPPORTED")&&(N=this.decode(e),D=this.texData.get(N.dataId),R=(q=this.gpgpu).createBufferFromTexture.apply(q,[D.texture].concat(sc(c)))),this.pendingRead.set(e,[]),p==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:H.sent(),H.label=2;case 2:return p!=="complex64"?[3,4]:[4,Promise.all([d.real.data(),d.imag.data()])];case 3:return B=H.sent(),k=B[0],L=B[1],M=Wp(k,L),[3,5];case 4:R==null?M=this.getValuesFromTexture(e):(F=Je(c),M=this.gpgpu.downloadFloat32MatrixFromBuffer(R,F)),H.label=5;case 5:return N!=null&&this.disposeData(N.dataId),W=this.convertAndCacheOnCPU(e,M),G=this.pendingRead.get(e),this.pendingRead.delete(e),G.forEach((function(Z){return Z(W)})),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,W]}}))}))},t.prototype.checkNumericalProblems=function(e){if(e!=null)for(var n=0;n<e.length;n++){var a=e[n];if(!MA(a))throw Re().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+a+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+a+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(e){var n,a=this.texData.get(e),i=a.shape,c=a.dtype,f=a.isPacked,p=Je(i);if(Re().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var d=this.decode(e),x=this.texData.get(d.dataId),w=(n=this.gpgpu).downloadMatrixFromPackedTexture.apply(n,[x.texture].concat(sc(i))).subarray(0,p);return this.disposeData(d.dataId),w}var C=Re().getBool("WEBGL_PACK")&&f===!0,S=C?sp(i):i,R=C?new D4(S):new N4(S),N=this.runWebGLProgram(R,[{shape:S,dtype:c,dataId:e}],"float32"),D=this.texData.get(N.dataId),M=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(D.texture,D.texShape[0],D.texShape[1]).subarray(0,p);return this.disposeData(N.dataId),M},t.prototype.time=function(e){return Ze(this,void 0,void 0,(function(){var n,a,i,c,f,p,d;return Qe(this,(function(x){switch(x.label){case 0:return n=this.activeTimers,a=[],i=!1,this.programTimersStack==null?(this.programTimersStack=a,i=!0):this.activeTimers.push(a),this.activeTimers=a,e(),c=Zu(this.activeTimers.map((function(w){return w.query}))).filter((function(w){return w!=null})),f=Zu(this.activeTimers.map((function(w){return w.name}))).filter((function(w){return w!=null})),this.activeTimers=n,i&&(this.programTimersStack=null),p={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},Re().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(c)]:[3,2];case 1:return d=x.sent(),p.kernelMs=hA(d),p.getExtraProfileInfo=function(){return d.map((function(w,C){return{name:f[C],ms:w}})).map((function(w){return w.name+": "+w.ms})).join(", ")},[3,3];case 2:p.kernelMs={error:"WebGL query timers are not supported in this environment."},x.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,p]}}))}))},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return Re().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:yi(),endMs:null}},t.prototype.endTimer=function(e){return Re().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=yi(),e)},t.prototype.getQueryTime=function(e){return Ze(this,void 0,void 0,(function(){var n;return Qe(this,(function(a){return Re().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(n=e).endMs-n.startMs]}))}))},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var n=this.texData.get(e).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var n=this.texData.get(e),a=n.texture,i=n.dtype,c=n.texShape,f=n.usage,p=n.isPacked,d=n.slice,x=d&&d.origDataId||e,w=this.dataRefCount.get(x);w>1?this.dataRefCount.set(x,w-1):(this.dataRefCount.delete(x),a!=null&&(this.numBytesInGPU-=this.computeBytes(c,i),this.textureManager.releaseTexture(a,c,f,p)));var C=this.texData.get(e);C.texture=null,C.texShape=null,C.isPacked=!1,C.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return Re().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=le.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,n){var a=this;return n===void 0&&(n=128),this.getCPUBackend()!=null&&e.every((function(i){return a.texData.get(i.dataId).texture==null&&i.size<n}))},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,n){var a=this.makeOutput(e.shape,"complex64");return this.texData.get(a.dataId).complexTensors={real:le.keep(e.clone()),imag:le.keep(n.clone())},a},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,n,a){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,n,a);if(Je(a)===0)return Tr([],a,e.dtype);var i=this.texData.get(e.dataId).isPacked,c=Dy(e.shape,n,a);if(i||!c){var f=Re().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new S_(a):new A_(a),p=f.getCustomSetupFunc(n);return this.compileAndRun(f,[e],null,p)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,n,a)},t.prototype.shallowSlice=function(e,n,a){var i=this.texData.get(e.dataId),c=this.makeOutput(a,e.dtype),f=this.texData.get(c.dataId);Object.assign(f,i),f.shape=a,f.dtype=e.dtype;var p=My(n,e.strides);i.slice&&(p+=i.slice.flatOffset),f.slice={flatOffset:p,origDataId:i.slice&&i.slice.origDataId||e.dataId};var d=this.dataRefCount.get(f.slice.origDataId)||1;return this.dataRefCount.set(f.slice.origDataId,d+1),c},t.prototype.stridedSlice=function(e,n,a,i){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,n,a,i);var c=d1(n,a,i);if(c.some((function(p){return p===0})))return Tr([],c);var f=new __(n,i,c);return this.compileAndRun(f,[e])},t.prototype.reverse=function(e,n){var a=Re().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new w_(e.shape,n):new b_(e.shape,n);return this.compileAndRun(a,[e])},t.prototype.concat=function(e,n){if(e[0].dtype==="complex64"){var a=e.map((function(S){return La(S)})),i=e.map((function(S){return wi(S)}));return Sr(this.concat(a,n),this.concat(i,n))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,n);if(e.length===1)return e[0];if(e.length>Re().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var c=Math.floor(e.length/2),f=this.concat(e.slice(0,c),n),p=this.concat(e.slice(c),n);return this.concat([f,p],n)}if(Re().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var d=new v4(e.map((function(S){return S.shape})),n);return this.compileAndRun(d,e)}var x=Ju(e.map((function(S){return S.shape})),n),w=e.map((function(S){return S.as2D(-1,Je(S.shape.slice(n)))})),C=new g4(w.map((function(S){return S.shape})));return this.compileAndRun(C,w).reshape(x)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(Re().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ox,e.dtype);var n=new Et(e.shape,ox);return this.compileAndRun(n,[e])},t.prototype.batchMatMul=function(e,n,a,i){var c=a?e.shape[2]:e.shape[1],f=i?n.shape[1]:n.shape[2],p=a?e.shape[1]:e.shape[2],d=e.shape[0];if((c===1||f===1)&&p>1e3){a&&(e=e.transpose([0,2,1])),i&&(n=n.transpose([0,2,1]));var x=f===1?e:e.as3D(d,p,1),w=f===1?2:1,C=f===1?n.as3D(d,1,p):n;return this.multiply(x,C).sum(w,!0)}var S=_r(e.dtype,n.dtype),R=new fp(e.shape,[d,c,f],a,i);return this.compileAndRun(R,[e,n],S)},t.prototype.fusedBatchMatMul=function(e){var n=e.a,a=e.b,i=e.transposeA,c=e.transposeB,f=e.bias,p=e.activation,d=e.preluActivationWeights,x=i?n.shape[2]:n.shape[1],w=c?a.shape[1]:a.shape[2],C=n.shape[0],S=_r(n.dtype,a.dtype),R=f!=null,N=d!=null,D=p?Qf(p,!0):null,M=new fp(n.shape,[C,x,w],i,c,R,D,N),B=[n,a];return f&&B.push(f),d&&B.push(d),this.compileAndRun(M,B,S)},t.prototype.multiply=function(e,n){if(e.dtype==="complex64"){var a=this.texData.get(e.dataId),i=this.texData.get(n.dataId),c=new q2(c4,e.shape,n.shape),f=new q2(f4,e.shape,n.shape),p=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag),this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag)],d=this.compileAndRun(c,p),x=this.compileAndRun(f,p),w=this.complex(d,x);return d.dispose(),x.dispose(),w}if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.multiply(e,n);if(Re().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,K2,e.dtype);var C=new kn(K2,e.shape,n.shape);return this.compileAndRun(C,[e,n],e.dtype)},t.prototype.batchNormalization=function(e,n,a,i,c,f){var p=[e,n,a],d=null;f!=null&&(d=f.shape,p.push(f));var x=null;if(c!=null&&(x=c.shape,p.push(c)),Re().getBool("WEBGL_PACK_NORMALIZATION")){var w=new l4(e.shape,n.shape,a.shape,d,x,i);return this.compileAndRun(w,p)}var C=new u4(e.shape,n.shape,a.shape,d,x,i);return this.compileAndRun(C,p)},t.prototype.localResponseNormalization4D=function(e,n,a,i,c){var f=Re().getBool("WEBGL_PACK_NORMALIZATION")?new i_(e.shape,n,a,i,c):new r_(e.shape,n,a,i,c);return this.compileAndRun(f,[e])},t.prototype.LRNGrad=function(e,n,a,i,c,f,p){var d=new a_(n.shape,i,c,f,p);return this.compileAndRun(d,[n,a,e])},t.prototype.tile=function(e,n){if(e.dtype==="string"){var a=this.readSync(e.dataId).map((function(c){return hh(c)}));return zy(yt(e.shape,e.dtype,a),n)}var i=new I_(e.shape,n);return this.compileAndRun(i,[e])},t.prototype.pad=function(e,n,a){var i=Re().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new h_(e.shape,n,a):new f_(e.shape,n,a);return this.compileAndRun(i,[e])},t.prototype.transpose=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,n);var a=Re().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new N_(e.shape,n):new R_(e.shape,n);return this.compileAndRun(a,[e])},t.prototype.gather=function(e,n,a){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.gather(e,n,a);var i=new F4(e.shape,n.size,a);return this.compileAndRun(i,[e,n])},t.prototype.batchToSpaceND=function(e,n,a){J(e.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var i=n.reduce((function(w,C){return w*C})),c=xh(e.shape,n,i),f=yh(c.length,n.length),p=bh(e.shape,n,i),d=Ty(a,n.length),x=Iy(p,a,n.length);return e.reshape(c).transpose(f).reshape(p).slice(d,x)},t.prototype.spaceToBatchND=function(e,n,a){J(e.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var i=n.reduce((function(C,S){return C*S})),c=[[0,0]];c.push.apply(c,a);for(var f=1+n.length;f<e.shape.length;++f)c.push([0,0]);var p=e.pad(c),d=xh(p.shape,n,i,!1),x=yh(d.length,n.length,!1),w=bh(p.shape,n,i,!1);return p.reshape(d).transpose(x).reshape(w)},t.prototype.reduce=function(e,n,a){var i=e.shape[0],c=e.shape[1],f=up(c),p=new d_({windowSize:f,inSize:c,batchSize:i},n),d=this.compileAndRun(p,[e],a);return d.shape[1]===1?d:this.reduce(d,n,a)},t.prototype.argReduce=function(e,n,a){a===void 0&&(a=null);var i=e.shape[0],c=e.shape[1];a!=null&&(i=a.shape[0],c=a.shape[1]);var f=up(c),p=new $S({windowSize:f,inSize:c,batchSize:i},n,a==null),d=[e];a!=null&&d.push(a);var x=this.compileAndRun(p,d,"int32");return x.shape[1]===1?x:this.argReduce(e,n,x)},t.prototype.argReducePacked=function(e,n,a){a===void 0&&(a=null);var i=a!=null?a.shape:e.shape,c=up(i[i.length-1]),f=new i4(i,c,n,a==null),p=a==null?[e]:[e,a],d=this.compileAndRun(f,p,"int32");return d.rank===e.rank?this.argReducePacked(e,n,d):d},t.prototype.sum=function(e,n){xa("sum",n,e.rank);var a=kr(e.shape,n),i=a[0],c=Je(a[1]),f=e.as2D(-1,c),p=ep(e.dtype);return this.reduce(f,"sum",p).reshape(i)},t.prototype.prod=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,n);var a=kr(e.shape,n),i=a[0],c=Je(a[1]),f=e.as2D(-1,c),p=ep(e.dtype);return this.reduce(f,"prod",p).reshape(i)},t.prototype.unsortedSegmentSum=function(e,n,a){var i=0,c=Ni([i],e.rank),f=e;c!=null&&(f=e.transpose(c),i=Di(1,e.rank)[0]);var p=(function(S,R,N){for(var D=[],M=S.length,B=0;B<M;B++)B!==R?D.push(S[B]):D.push(N);return D})(f.shape,i,a),d=Je([f.shape[i]]),x=f.as2D(-1,d),w=ep(e.dtype),C=this.segOpCompute(x,"unsortedSegmentSum",n,w,a).reshape(p);return c!=null&&(C=C.transpose(l1(c))),C},t.prototype.segOpCompute=function(e,n,a,i,c){var f=e.shape[0],p=e.shape[1],d=(function(C,S){var R,N=!1;for(C<=Ny?(R=C,N=!0):R=Bp(C,Math.floor(Math.sqrt(C)));!N;)R>S||R===C?N=!0:R=Bp(C,R+1);return R})(p,c),x=new E_({windowSize:d,inSize:p,batchSize:f,numSegments:c}),w=this.compileAndRun(x,[e,a],i);return w.shape[1]===c?w:(a=mh(0,c).tile([p/d]),this.segOpCompute(w,n,a,i,c))},t.prototype.argMinMaxReduce=function(e,n,a){var i=[n];if(xa("arg"+a.charAt(0).toUpperCase()+a.slice(1),i,e.rank),!Re().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var c=kr(e.shape,i),f=c[0],p=Je(c[1]),d=e.as2D(-1,p);return this.argReduce(d,a).reshape(f)}return this.argReducePacked(e,a)},t.prototype.argMin=function(e,n){return this.argMinMaxReduce(e,n,"min")},t.prototype.argMax=function(e,n){return this.argMinMaxReduce(e,n,"max")},t.prototype.cumsum=function(e,n,a,i){if(n!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+n);var c=new S4(e.shape,a,i);return this.compileAndRun(c,[e])},t.prototype.equal=function(e,n){if(Re().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(equal(a, b));
`,"bool");var a=new kn("return float(a == b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.notEqual=function(e,n){if(Re().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(notEqual(a, b));
`,"bool");var a=new kn("return float(a != b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.less=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.less(e,n);if(Re().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(lessThan(a, b));
`,"bool");var a=new kn("return float(a < b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.lessEqual=function(e,n){if(Re().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(lessThanEqual(a, b));
`,"bool");var a=new kn("return float(a <= b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.greater=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.greater(e,n);if(Re().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(greaterThan(a, b));
`,"bool");var a=new kn("return float(a > b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.greaterEqual=function(e,n){if(Re().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var a=new kn("return float(a >= b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.logicalNot=function(e){var n=new Et(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(n,[e])},t.prototype.logicalAnd=function(e,n){if(Re().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var a=new kn("return float(a >= 1.0 && b >= 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.logicalOr=function(e,n){if(Re().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var a=new kn("return float(a >= 1.0 || b >= 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.select=function(e,n,a){var i=new C_(e.rank,n.shape,n.rank);return this.compileAndRun(i,[e,n,a],_r(n.dtype,a.dtype))},t.prototype.where=function(e){gh("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var n=e.dataSync();return m1(e.shape,n)},t.prototype.topk=function(e,n,a){return Hy(e.dataSync(),e.shape,e.dtype,n)},t.prototype.min=function(e,n){xa("min",n,e.rank);var a=kr(e.shape,n),i=a[0],c=Je(a[1]),f=e.as2D(-1,c);return this.reduce(f,"min",f.dtype).reshape(i)},t.prototype.minimum=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.minimum(e,n);var a=Re().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new eo(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new kn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.mod=function(e,n){var a=Re().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new eo(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new kn(`if (b == 0.0) return NAN;
  return mod(a, b);`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.max=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,n);xa("max",n,e.rank);var a=kr(e.shape,n),i=a[0],c=Je(a[1]),f=e.as2D(-1,c);return this.reduce(f,"max",f.dtype).reshape(i)},t.prototype.maximum=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.maximum(e,n);var a=Re().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new eo(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new kn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.all=function(e,n){xa("all",n,e.rank);var a=kr(e.shape,n),i=a[0],c=Je(a[1]),f=e.as2D(-1,c);return this.reduce(f,"all",f.dtype).reshape(i)},t.prototype.any=function(e,n){xa("any",n,e.rank);var a=kr(e.shape,n),i=a[0],c=Je(a[1]),f=e.as2D(-1,c);return this.reduce(f,"any",f.dtype).reshape(i)},t.prototype.realDivide=function(e,n){if(Re().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var a=new kn(`
if (a == b) {
  return 1.0;
};
return a / b;`,e.shape,n.shape);return this.compileAndRun(a,[e,n],"float32")},t.prototype.floorDiv=function(e,n){if(Re().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var a=new kn(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,e.shape,n.shape);return this.compileAndRun(a,[e,n],"int32")},t.prototype.add=function(e,n){if(e.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(e,n,lp);if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.add(e,n);var a=_r(e.dtype,n.dtype);if(Re().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,lp,a);var i=new kn(lp,e.shape,n.shape);return this.compileAndRun(i,[e,n],a)},t.prototype.packedUnaryOp=function(e,n,a){var i=new ic(e.shape,n);return this.compileAndRun(i,[e],a)},t.prototype.packedBinaryOp=function(e,n,a,i,c){c===void 0&&(c=!1);var f=new eo(a,e.shape,n.shape,c);return this.compileAndRun(f,[e,n],i)},t.prototype.complexSeparableBinaryOp=function(e,n,a){var i=this,c=this.texData.get(e.dataId),f=this.texData.get(n.dataId),p=[[c.complexTensors.real,f.complexTensors.real],[c.complexTensors.imag,f.complexTensors.imag]].map((function(C){var S=C[0],R=C[1],N=i.makeComplexComponentTensorInfo(e,S),D=i.makeComplexComponentTensorInfo(n,R),M=new kn(a,e.shape,n.shape);return i.compileAndRun(M,[N,D],_r(S.dtype,R.dtype))})),d=p[0],x=p[1],w=this.complex(d,x);return d.dispose(),x.dispose(),w},t.prototype.makeComplexComponentTensorInfo=function(e,n){return{dataId:n.dataId,dtype:n.dtype,shape:e.shape}},t.prototype.addN=function(e){if(e.length===1)return e[0];if(e.length>Re().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var n=Math.floor(e.length/2),a=this.addN(e.slice(0,n)),i=this.addN(e.slice(n));return this.addN([a,i])}var c=e.map((function(d){return d.dtype})).reduce((function(d,x){return _r(d,x)})),f=e.map((function(d){return d.shape})),p=Re().getBool("WEBGL_PACK")?new JS(e[0].shape,f):new QS(e[0].shape,f);return this.compileAndRun(p,e,c)},t.prototype.subtract=function(e,n){if(e.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(e,n,cp);if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.subtract(e,n);var a=_r(e.dtype,n.dtype);if(Re().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,cp,e.dtype);var i=new kn(cp,e.shape,n.shape);return this.compileAndRun(i,[e,n],a)},t.prototype.pow=function(e,n){var a=Re().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new eo(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new kn(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,e.shape,n.shape),i=_r(e.dtype,n.dtype);return this.compileAndRun(a,[e,n],i)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(Re().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,sx,e.dtype);var n=new Et(e.shape,sx);return this.compileAndRun(n,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(Re().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ux,e.dtype);var n=new Et(e.shape,ux);return this.compileAndRun(n,[e])},t.prototype.sign=function(e){var n=new Et(e.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(n,[e])},t.prototype.isNaN=function(e){var n=new Et(e.shape,"return float(isnan(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.isInf=function(e){var n=new Et(e.shape,"return float(isinf(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.isFinite=function(e){var n=new Et(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.round=function(e){var n=new Et(e.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(n,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(Re().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,lx,e.dtype);var n=new Et(e.shape,lx);return this.compileAndRun(n,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(Re().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,cx,e.dtype);var n=new Et(e.shape,cx);return this.compileAndRun(n,[e])},t.prototype.softmax=function(e,n){var a=cr([n],e.shape),i=this.max(e,a),c=aa(i.shape,a),f=this.subtract(e,i.reshape(c)),p=this.exp(f),d=this.sum(p,a).reshape(c);return this.realDivide(p,d)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(Re().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,e.dtype);var n=new Et(e.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(n,[e])},t.prototype.log1p=function(e){var n=new Et(e.shape,"return log(1.0 + x);");return this.compileAndRun(n,[e])},t.prototype.sqrt=function(e){var n=new Et(e.shape,"return sqrt(x);");return this.compileAndRun(n,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var n=new Et(e.shape,"return inversesqrt(x);");return this.compileAndRun(n,[e])},t.prototype.reciprocal=function(e){var n=new Et(e.shape,"return 1.0 / x;");return this.compileAndRun(n,[e])},t.prototype.relu=function(e){var n;return n=Re().getBool("WEBGL_PACK")?new ic(e.shape,Zy):new Et(e.shape,Yy),this.compileAndRun(n,[e])},t.prototype.relu6=function(e){var n;return n=Re().getBool("WEBGL_PACK")?new ic(e.shape,Qy):new Et(e.shape,qy),this.compileAndRun(n,[e])},t.prototype.prelu=function(e,n){var a=Re().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new eo(Xy,e.shape,n.shape):new kn(jy,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.elu=function(e){if(Re().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Jy,e.dtype);var n=new Et(e.shape,Ky);return this.compileAndRun(n,[e])},t.prototype.eluDer=function(e,n){var a=Re().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new eo(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,e.shape,n.shape):new kn("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.selu=function(e){var n=new Et(e.shape,M_);return this.compileAndRun(n,[e])},t.prototype.int=function(e){var n=new Et(e.shape,"return float(int(x));");return this.compileAndRun(n,[e],"int32")},t.prototype.clip=function(e,n,a){var i,c=(i=Re().getBool("WEBGL_PACK_CLIP")?new d4(e.shape):new h4(e.shape)).getCustomSetupFunc(n,a);return this.compileAndRun(i,[e],null,c)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(Re().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ix,e.dtype);var n=new Et(e.shape,ix);return this.compileAndRun(n,[e])},t.prototype.complexAbs=function(e){var n=this.texData.get(e.dataId),a=new p4(e.shape),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)];return this.compileAndRun(a,i)},t.prototype.sigmoid=function(e){var n=new Et(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(n,[e])},t.prototype.softplus=function(e){var n=new Et(e.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(n,[e])},t.prototype.sin=function(e){var n=new Et(e.shape,O_);return this.compileAndRun(n,[e])},t.prototype.cos=function(e){var n=new Et(e.shape,B_);return this.compileAndRun(n,[e])},t.prototype.tan=function(e){var n=new Et(e.shape,"return tan(x);");return this.compileAndRun(n,[e])},t.prototype.asin=function(e){var n=new Et(e.shape,k_);return this.compileAndRun(n,[e])},t.prototype.acos=function(e){var n=new Et(e.shape,L_);return this.compileAndRun(n,[e])},t.prototype.atan=function(e){var n=new Et(e.shape,F_);return this.compileAndRun(n,[e])},t.prototype.atan2=function(e,n){var a=Re().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new eo(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new kn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.sinh=function(e){var n=new Et(e.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[e])},t.prototype.cosh=function(e){var n=new Et(e.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[e])},t.prototype.tanh=function(e){var n=new Et(e.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(n,[e])},t.prototype.asinh=function(e){var n=new Et(e.shape,P_);return this.compileAndRun(n,[e])},t.prototype.acosh=function(e){var n=new Et(e.shape,U_);return this.compileAndRun(n,[e])},t.prototype.atanh=function(e){var n=new Et(e.shape,z_);return this.compileAndRun(n,[e])},t.prototype.erf=function(e){var n=new Et(e.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(n,[e])},t.prototype.step=function(e,n){var a=new Et(e.shape,(function(i){return i===void 0&&(i=0),Qa+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `})(n));return this.compileAndRun(a,[e])},t.prototype.conv2dByMatMul=function(e,n,a,i,c,f){var p=e.shape,d=this.texData.get(e.dataId),x=a.inChannels,w=p[0]*p[1]*p[2],C=a.outChannels,S=a.dataFormat==="channelsLast",R=(w===1||C===1)&&x>1e3,N=p[2]%2!=0&&!!d.isPacked;if(R||!Re().getBool("WEBGL_LAZILY_UNPACK")||!Re().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!N){var D=S?p[0]*p[1]*p[2]:p[0]*p[2]*p[3],M=this.reshape(e,[1,D,a.inChannels]),B=this.reshape(n,[1,a.inChannels,a.outChannels]);return this.reshape(this.fusedBatchMatMul({a:M,b:B,transposeA:!1,transposeB:!1,bias:i,activation:c,preluActivationWeights:f}),a.outShape)}var k=S?p[0]*p[1]*(p[2]+1):p[0]*p[2]*(p[3]+1),L={dataId:e.dataId,shape:[1,k,a.inChannels],dtype:e.dtype},F=d.shape;d.shape=d.shape.slice(),d.shape[d.shape.length-2]++,J(Yf(d.shape,L.shape),(function(){return"packed reshape "+d.shape+" to "+L.shape+" isn't free"}));var W=this.reshape(n,[1,a.inChannels,a.outChannels]),G=this.fusedBatchMatMul({a:L,b:W,transposeA:!1,transposeB:!1,bias:i,activation:c,preluActivationWeights:f}),q=this.texData.get(G.dataId);return J(q.isPacked,(function(){return"batchMatMul result is expected to be packed"})),d.shape=F,q.shape=a.outShape,le.makeTensorFromDataId(G.dataId,a.outShape,G.dtype)},t.prototype.conv2dWithIm2Row=function(e,n,a,i,c,f){var p=a.filterWidth,d=a.filterHeight,x=a.inChannels,w=a.outWidth,C=a.outHeight,S=a.dataFormat==="channelsLast",R=p*d*x,N=C*w,D=[R,N],M=e.squeeze([0]),B=n.reshape([1,R,-1]),k=new n_(D,M.shape,a),L=this.compileAndRun(k,[M]).reshape([1,D[0],D[1]]),F=i!=null,W=f!=null,G=c?Qf(c,!0):null,q=new fp(L.shape,[1,N,a.outChannels],!0,!1,F,G,W),H=[L,B];i&&H.push(i),W&&H.push(f);var Z=this.compileAndRun(q,H);return S?Z.reshape([1,C,w,a.outChannels]):Z.reshape([1,a.outChannels,C,w])},t.prototype.fusedConv2d=function(e){var n=e.input,a=e.filter,i=e.convInfo,c=e.bias,f=e.activation,p=e.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(n,a,i,c,f,p);if(Re().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,a,i,c,f,p);var d=c!=null,x=p!=null,w=f?Qf(f,!1):null,C=new Z2(i,d,w,x),S=[n,a];return c&&S.push(c),p&&S.push(p),this.compileAndRun(C,S)},t.prototype.conv2d=function(e,n,a){if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(e,n,a);if(Re().getBool("WEBGL_CONV_IM2COL")&&e.shape[0]===1)return this.conv2dWithIm2Row(e,n,a);var i=new Z2(a);return this.compileAndRun(i,[e,n])},t.prototype.conv2dDerInput=function(e,n,a){var i=new x4(a);return this.compileAndRun(i,[e,n])},t.prototype.conv2dDerFilter=function(e,n,a){var i=new m4(a);return this.compileAndRun(i,[e,n])},t.prototype.fusedDepthwiseConv2D=function(e){var n,a=e.input,i=e.filter,c=e.convInfo,f=e.bias,p=e.activation,d=e.preluActivationWeights,x=Re().getBool("WEBGL_PACK_DEPTHWISECONV")&&c.strideWidth<=2&&c.outChannels/c.inChannels==1,w=p?Qf(p,x):null,C=[a,i],S=f!=null,R=d!=null;return S&&C.push(f),R&&C.push(d),x?(n=new J2(c,S,w,R),this.compileAndRun(n,C)):(n=new Q2(c,S,w,R),this.compileAndRun(n,C))},t.prototype.depthwiseConv2D=function(e,n,a){var i;return Re().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1?(i=new J2(a),this.compileAndRun(i,[e,n])):(i=new Q2(a),this.compileAndRun(i,[e,n]))},t.prototype.depthwiseConv2DDerInput=function(e,n,a){var i=new E4(a);return this.compileAndRun(i,[e,n])},t.prototype.depthwiseConv2DDerFilter=function(e,n,a){var i=new w4(a);return this.compileAndRun(i,[e,n])},t.prototype.conv3d=function(e,n,a){var i=new C4(a);return this.compileAndRun(i,[e,n])},t.prototype.conv3dDerInput=function(e,n,a){var i=new b4(a);return this.compileAndRun(i,[e,n])},t.prototype.conv3dDerFilter=function(e,n,a){var i=new y4(a);return this.compileAndRun(i,[e,n])},t.prototype.maxPool=function(e,n){var a=new hp(n,"max",!1);return this.compileAndRun(a,[e])},t.prototype.avgPool=function(e,n){var a=new hp(n,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPoolBackprop=function(e,n,a,i){var c=new hp(i,"max",!0),f=this.compileAndRun(c,[n]),p=new o_(i),d=this.compileAndRun(p,[e,f],n.dtype);return f.dispose(),d},t.prototype.avgPoolBackprop=function(e,n,a){var i=new o4(a);return this.compileAndRun(i,[e],n.dtype)},t.prototype.cast=function(e,n){return Ly(e,n,this)},t.prototype.unstack=function(e,n){for(var a=e.shape[n],i=new Array(e.rank-1),c=0,f=0;f<e.rank;f++)f!==n&&(i[c++]=e.shape[f]);var p=new Array(e.rank).fill(0),d=e.shape.slice();d[n]=1;var x=new Array(a);for(f=0;f<x.length;f++)p[n]=f,x[f]=this.slice(e,p,d).reshape(i);return x},t.prototype.avgPool3d=function(e,n){var a=new dp(n,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,n,a){var i=new s4(a);return this.compileAndRun(i,[e],n.dtype)},t.prototype.maxPool3d=function(e,n){var a=new dp(n,"max",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,n,a,i){var c=new dp(i,"max",!0),f=this.compileAndRun(c,[n]),p=new s_(i),d=this.compileAndRun(p,[e,f],n.dtype);return f.dispose(),d},t.prototype.reshape=function(e,n){var a=this.texData.get(e.dataId);if(a.isPacked&&!Yf(e.shape,n)&&(a.texture===null||!Yf(a.shape,n))){var i=this.packedReshape(e,n);return le.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return Vp(e,n)},t.prototype.resizeBilinear=function(e,n,a,i){var c=Re().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new m_(e.shape,n,a,i):new v_(e.shape,n,a,i);return this.compileAndRun(c,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,n,a){var i=new g_(e,n,a);return this.compileAndRun(i,[e])},t.prototype.resizeNearestNeighbor=function(e,n,a,i){var c=new y_(e.shape,n,a,i);return this.compileAndRun(c,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,n,a){var i=new x_(e,n,a);return this.compileAndRun(i,[e])},t.prototype.multinomial=function(e,n,a,i){var c=n?e:so(e),f=c.shape[0],p=c.shape[1],d=new u_(f,p,a),x=d.getCustomSetupFunc(i);return this.compileAndRun(d,[c],"int32",x)},t.prototype.oneHot=function(e,n,a,i){var c=new l_(e.size,n,a,i);return this.compileAndRun(c,[e])},t.prototype.diag=function(e){var n=new R4(e.size);return this.compileAndRun(n,[e])},t.prototype.nonMaxSuppression=function(e,n,a,i,c){return gh("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),g1(e.dataSync(),n.dataSync(),a,i,c)},t.prototype.cropAndResize=function(e,n,a,i,c,f){var p=new A4(e.shape,n.shape,i,c,f);return this.compileAndRun(p,[e,n,a],"float32")},t.prototype.depthToSpace=function(e,n,a){J(n>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+n}));var i=e.shape[0],c=a==="NHWC"?e.shape[1]:e.shape[2],f=a==="NHWC"?e.shape[2]:e.shape[3],p=a==="NHWC"?e.shape[3]:e.shape[1],d=c*n,x=f*n,w=p/(n*n),C=new I4(a==="NHWC"?[i,d,x,w]:[i,w,d,x],n,a);return this.compileAndRun(C,[e])},t.prototype.split=function(e,n,a){return Uy(e,n,a)},t.prototype.scatterND=function(e,n,a){var i=wh(0,e,a),c=i.sliceRank,f=i.numUpdates,p=i.sliceSize,d=i.strides,x=i.outputSize,w=[x/p,p],C=e.reshape([f,c]),S=n.reshape([f,p]);if(x===0)return Vp(Tr([]),a);var R=Ge(0),N=new nx(f,c,C.rank,S.rank,d,w);return this.compileAndRun(N,[S,C,R]).reshape(a)},t.prototype.sparseToDense=function(e,n,a,i){var c=wh(0,e,a),f=c.sliceRank,p=c.numUpdates,d=c.strides,x=c.outputSize,w=new nx(p,f,e.rank,n.rank,d,[x,1]);return this.compileAndRun(w,[n,e,i]).reshape(a)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,n){var a=this.texData.get(e.dataId),i=new ex(B4,e.shape,n),c=new ex(k4,e.shape,n),f=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag)],p=this.compileAndRun(i,f),d=this.compileAndRun(c,f),x=this.complex(p,d).as2D(e.shape[0],e.shape[1]);return p.dispose(),d.dispose(),x},t.prototype.gatherND=function(e,n){var a=n.shape,i=a[a.length-1],c=Ry(e,n),f=c[0],p=c[1],d=c[2],x=c[3],w=n.reshape([p,i]),C=e.reshape([e.size/d,d]),S=new P4(i,x,[p,d]);return this.compileAndRun(S,[C,w]).reshape(f)},t.prototype.fill=function(e,n,a){if((a=a||wc(n))==="string"){var i=fh(a,Je(e));return i.fill(n),le.makeTensor(i,e,a,this)}var c=new L4(e,n),f=c.getCustomSetupFunc(n);return this.compileAndRun(c,[],a,f)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,e.dtype==="string"?"":0,e.dtype)},t.prototype.linspace=function(e,n,a){return Fy(e,n,a)},t.prototype.makeTensorInfo=function(e,n){var a=this.write(null,e,n);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:n}},t.prototype.makeOutput=function(e,n){var a=this.makeTensorInfo(e,n).dataId;return le.makeTensorFromDataId(a,e,n,this)},t.prototype.unpackTensor=function(e){var n=new V_(e.shape);return this.runWebGLProgram(n,[e],e.dtype)},t.prototype.packTensor=function(e){var n=new c_(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,n){var a=[dh(e.shape)].concat(ph(e.shape)),i={dtype:e.dtype,shape:a,dataId:e.dataId},c=[dh(n)].concat(ph(n)),f=new p_(c,a),p=this.runWebGLProgram(f,[i],e.dtype,null,!0);return{dataId:p.dataId,shape:n,dtype:p.dtype}},t.prototype.decode=function(e){var n,a=this.texData.get(e),i=a.isPacked,c=a.shape,f=a.dtype,p=sp(c);return n=i?new T4(p):new _4(p),{dtype:f,shape:c,dataId:this.runWebGLProgram(n,[{shape:p,dtype:f,dataId:e}],f,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,n,a,i,c){var f=this;c===void 0&&(c=!1);var p=this.makeTensorInfo(e.outputShape,a),d=this.texData.get(p.dataId);if(e.packedOutput&&(d.isPacked=!0),e.outPackingScheme===dc.DENSE){var x=sc(e.outputShape);d.texShape=x.map((function(k){return 2*k}))}if(e.outTexUsage!=null&&(d.usage=e.outTexUsage),Je(p.shape)===0)return d.values=fc(p.dtype,0),p;var w=[],C=n.map((function(k){if(k.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var L=f.texData.get(k.dataId);if(L.texture==null){if(!e.packedInputs&&Je(k.shape)<=Re().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:k.shape,texData:null,isUniform:!0,uniformValues:L.values};e.packedInputs&&(L.isPacked=!0,L.shape=k.shape)}else if(!!L.isPacked!=!!e.packedInputs)k=L.isPacked?f.unpackTensor(k):f.packTensor(k),w.push(k),L=f.texData.get(k.dataId);else if(L.isPacked&&!Yf(L.shape,k.shape)){var F=k,W=k.shape;k.shape=L.shape,k=f.packedReshape(k,W),w.push(k),L=f.texData.get(k.dataId),F.shape=W}return f.uploadToGPU(k.dataId),{shape:k.shape,texData:L,isUniform:!1}}));this.uploadToGPU(p.dataId);var S,R={shape:p.shape,texData:d,isUniform:!1},N=(function(k,L,F){var W="";L.concat(F).forEach((function(H){var Z=H.texData!=null&&H.texData.slice!=null&&H.texData.slice.flatOffset>0,ie=H.isUniform?"uniform":H.texData.texShape;W+=H.shape+"_"+ie+"_"+Z}));var G=k.userCode,q=k.constructor.name;return q+="_"+W+"_"+G})(e,C,R),D=this.getAndSaveBinary(N,(function(){return(function(k,L,F,W){var G=L.userCode,q=F.map((function(he,Se){var Y={logicalShape:he.shape,texShape:he.isUniform?null:he.texData.texShape,isUniform:he.isUniform,isPacked:!he.isUniform&&he.texData.isPacked,flatOffset:null};return he.texData!=null&&he.texData.slice!=null&&he.texData.slice.flatOffset>0&&(Y.flatOffset=he.texData.slice.flatOffset),{name:L.variableNames[Se],shapeInfo:Y}})),H=q.map((function(he){return he.shapeInfo})),Z={logicalShape:W.shape,texShape:W.texData.texShape,isUniform:!1,isPacked:W.texData.isPacked,flatOffset:null},ie=e4(q,Z,G,L.packedInputs),ee=k.createProgram(ie),me=null,xe=k.getUniformLocation(ee,"NAN",!1);Re().getNumber("WEBGL_VERSION")===1&&(me=k.getUniformLocation(ee,"INFINITY",!1));for(var $={},te=0;te<L.variableNames.length;te++){var re=L.variableNames[te];$[re]=k.getUniformLocation(ee,re,!1),$["offset"+re]=k.getUniformLocation(ee,"offset"+re,!1)}return{program:L,source:ie,webGLProgram:ee,uniformLocations:$,inShapeInfos:H,outShapeInfo:Z,infLoc:me,nanLoc:xe}})(f.gpgpu,e,C,R)})),M=this.activeTimers!=null;if(M&&(S=this.startTimer()),(function(k,L,F,W,G){tx(L.inShapeInfos,F),tx([L.outShapeInfo],[W]);var q=W.texData.texture,H=W.texData.texShape;W.texData.isPacked?k.setOutputPackedMatrixTexture(q,H[0],H[1]):k.setOutputMatrixTexture(q,H[0],H[1]),k.setProgram(L.webGLProgram),Re().getNumber("WEBGL_VERSION")===1&&L.infLoc!==null&&k.gl.uniform1f(L.infLoc,1/0),L.nanLoc!==null&&k.gl.uniform1f(L.nanLoc,NaN),F.forEach((function(Z,ie){var ee=L.program.variableNames[ie],me=L.uniformLocations[ee],xe=L.uniformLocations["offset"+ee];if(me!=null)if(Z.isUniform)if(Je(Z.shape)<2)k.gl.uniform1f(me,Z.uniformValues[0]);else{var $=Z.uniformValues;$ instanceof Float32Array||($=new Float32Array($)),k.gl.uniform1fv(me,$)}else Z.texData.slice!=null&&xe!=null&&k.gl.uniform1i(xe,Z.texData.slice.flatOffset),k.setInputMatrixTexture(Z.texData.texture,me,ie)})),G?.(k,L.webGLProgram),k.executeProgram()})(this.gpgpu,D,C,R,i),w.forEach((function(k){return f.disposeData(k.dataId)})),M&&(S=this.endTimer(S),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(S)})),!Re().getBool("WEBGL_LAZILY_UNPACK")&&d.isPacked&&c===!1){var B=this.unpackTensor(p);return this.disposeData(p.dataId),B}return p},t.prototype.compileAndRun=function(e,n,a,i,c){c===void 0&&(c=!1),a=a||n[0].dtype;var f=this.runWebGLProgram(e,n,a,i,c);return le.makeTensorFromDataId(f.dataId,f.shape,f.dtype)},t.prototype.getAndSaveBinary=function(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(Re().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(n){e.gpgpu.deleteProgram(e.binaryCache[n].webGLProgram),delete e.binaryCache[n]})),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Xe((function(){if(!Re().get("WEBGL_RENDER_FLOAT32_ENABLED")){var n=Re().getBool("DEBUG");Re().set("DEBUG",!1);var a=e.abs(Ge(1e-8)).dataSync()[0];if(Re().set("DEBUG",n),a>0)return 32}return 16}))),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var n,a=this.texData.get(e),i=a.shape,c=a.dtype,f=a.values,p=a.texture,d=a.usage,x=a.isPacked;if(p==null){var w,C=this.activeTimers!=null;C&&(w=yi());var S=a.texShape;if(S==null&&(S=ZA(i,x),a.texShape=S),f!=null){var R=sp(i),N=void 0,D=S[1],M=S[0],B=f instanceof Uint8Array;x?(D=(n=Cc(S[0],S[1]))[0],M=n[1],N=new O4(R,[M,D],B)):N=new M4(R,[M,D],B);var k=this.makeTensorInfo([M,D],c);this.texData.get(k.dataId).usage=B?wa.PIXELS:wa.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(k.dataId),D,M,f);var L=this.runWebGLProgram(N,[k],c,null,!0),F=this.texData.get(L.dataId);a.texture=F.texture,a.texShape=F.texShape,a.isPacked=F.isPacked,a.usage=F.usage,this.disposeData(k.dataId),this.texData.delete(L.dataId),a.values=null,C&&(this.uploadWaitMs+=yi()-w)}else{var W=this.acquireTexture(S,d,c,x);a.texture=W}}},t.prototype.convertAndCacheOnCPU=function(e,n){var a=this.texData.get(e),i=a.dtype;return this.releaseGPUData(e),n!=null&&(a.values=(function(c,f){if(f==="float32"||f==="complex64")return c;if(f==="int32"||f==="bool"){for(var p=f==="int32"?new Int32Array(c.length):new Uint8Array(c.length),d=0;d<p.length;++d)p[d]=Math.round(c[d]);return p}throw new Error("Unknown dtype "+f)})(n,i)),a.values},t.prototype.acquireTexture=function(e,n,a,i){if(this.numBytesInGPU+=this.computeBytes(e,a),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var c=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+c+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,n,i)},t.prototype.computeBytes=function(e,n){return e[0]*e[1]*fy(n)},t})(By);xy()&&le.registerBackend("webgl",(function(){return new G_}),2);var j_=oe({square_:function(r){var t=X(r,"x","square"),e=[t];return le.runKernelFunc((function(n,a){return a([t]),n.square(t)}),{x:t},null,"Square",{},e,[])}}),gc="SquaredDifference",$y=oe({squaredDifference_:function(r,t){var e,n=X(r,"a","squaredDifference"),a=X(t,"b","squaredDifference");e=Rn(n,a),n=e[0],a=e[1],Ot(n.shape,a.shape);var i={a:n,b:a},c=[n,a];return le.runKernelFunc((function(f,p){var d=f.squaredDifference(n,a);return p([n,a]),d}),i,(function(f,p){var d=p[0],x=p[1],w=Ge(2);return{a:function(){return f.mul(d.sub(x).mul(w))},b:function(){return f.mul(x.sub(d).mul(w))}}}),gc,{},c,[])}}),X_=oe({abs_:function(r){var t=X(r,"x","abs");return t.dtype==="complex64"?le.runKernelFunc((function(e){return e.complexAbs(t)}),{$x:t}):le.runKernelFunc((function(e,n){var a=e.abs(t);return n([t]),a}),{x:t},(function(e,n){var a=n[0];return{x:function(){return e.mul(a.toFloat().step(-1))}}}),"Abs")}}),Y_=oe({acos_:function(r){var t=X(r,"x","acos");return le.runKernelFunc((function(e,n){var a=e.acos(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.divStrict(Ge(1).sub(a.toFloat().square()).sqrt()).neg()}}}))}}),q_=oe({acosh_:function(r){var t=X(r,"x","acosh");return le.runKernelFunc((function(e,n){var a=e.acosh(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.divStrict(a.toFloat().square().sub(1).sqrt())}}}))}}),K_=oe({asin_:function(r){var t=X(r,"x","asin");return le.runKernelFunc((function(e,n){var a=e.asin(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.divStrict(Ge(1).sub(a.toFloat().square()).sqrt())}}}))}}),Z_=oe({asinh_:function(r){var t=X(r,"x","asinh");return le.runKernelFunc((function(e,n){var a=e.asinh(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.divStrict(Ge(1).add(a.toFloat().square()).sqrt())}}}))}}),Q_=oe({atan_:function(r){var t=X(r,"x","atan");return le.runKernelFunc((function(e,n){var a=e.atan(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.div(a.toFloat().square().add(1))}}}))}}),J_=oe({atanh_:function(r){var t=X(r,"x","atanh");return le.runKernelFunc((function(e,n){var a=e.atanh(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.div(Ge(1).sub(a.toFloat().square()))}}}))}}),$_=oe({ceil_:function(r){var t=X(r,"x","ceil");return le.runKernelFunc((function(e){return e.ceil(t)}),{$x:t},(function(e){return{$x:function(){return Ut(e)}}}))}}),w1=oe({clipByValue_:function(r,t,e){var n=X(r,"x","clipByValue");J(t<=e,(function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+e+")."}));var a=[n],i={min:t,max:e};return le.runKernelFunc((function(c,f){var p=c.clip(n,t,e);return f([n]),p}),{x:n},(function(c,f){var p=f[0];return{x:function(){return c.where(p.greaterEqual(t).logicalAnd(p.lessEqual(e)),Ut(c))}}}),"ClipByValue",i,a)}}),eT=oe({cos_:function(r){var t=X(r,"x","cos"),e=[t];return le.runKernelFunc((function(n,a){var i=n.cos(t);return a([t]),i}),{x:t},(function(n,a){var i=a[0];return{x:function(){return i.toFloat().sin().neg().mul(n)}}}),"Cos",{},e)}}),tT=oe({cosh_:function(r){var t=X(r,"x","cosh");return le.runKernelFunc((function(e,n){var a=e.cosh(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return a.toFloat().sinh().mulStrict(e)}}}))}}),nT=oe({erf_:function(r){var t=X(r,"x","erf");return J(t.dtype==="int32"||t.dtype==="float32",(function(){return"Input dtype must be `int32` or `float32`."})),t.dtype==="int32"&&(t=t.toFloat()),le.runKernelFunc((function(e,n){var a=e.erf(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),Gp=oe({exp_:function(r){var t=X(r,"x","exp");return le.runKernelFunc((function(e,n){var a=e.exp(t);return n([a]),a}),{x:t},(function(e,n){return{x:function(){return e.mulStrict(n[0])}}}),"Exp",{},[],[!0])}}),rT=oe({expm1_:function(r){var t=X(r,"x","expm1");return le.runKernelFunc((function(e,n){var a=e.expm1(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.mul(a.exp())}}}))}}),aT=oe({floor_:function(r){var t=X(r,"x","floor");return le.runKernelFunc((function(e){return e.floor(t)}),{$x:t},(function(e){return{$x:function(){return Ut(e)}}}))}}),iT=oe({log_:function(r){var t=X(r,"x","log"),e=[t];return le.runKernelFunc((function(n,a){var i=n.log(t);return a([t]),i}),{x:t},(function(n,a){var i=a[0];return{x:function(){return n.div(i.toFloat())}}}),"Log",{},e)}}),oT=oe({log1p_:function(r){var t=X(r,"x","log1p");return le.runKernelFunc((function(e,n){var a=e.log1p(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.div(a.add(1))}}}))}}),sT=oe({logSigmoid_:function(r){var t=X(r,"x","logSigmoid");return le.runKernelFunc((function(e,n){var a=e.softplus(t.neg()).neg();return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.mul(a.neg().sigmoid())}}}))}}),Sh=oe({neg_:function(r){var t=X(r,"x","neg"),e=[t];return le.runKernelFunc((function(n){return n.neg(t)}),{x:t},(function(n){return{x:function(){return n.neg()}}}),"Neg",{},e)}}),uT=oe({reciprocal_:function(r){var t=X(r,"x","reciprocal");return le.runKernelFunc((function(e,n){var a=e.reciprocal(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.div(a.square().neg())}}}))}}),lT=oe({round_:function(r){var t=X(r,"x","round");return le.runKernelFunc((function(e){return e.round(t)}),{$x:t},(function(e){return{$x:function(){return Ut(e)}}}))}}),eb=oe({rsqrt_:function(r){var t=X(r,"x","rsqrt"),e=[t];return le.runKernelFunc((function(n,a){var i=n.rsqrt(t);return a([t]),i}),{x:t},(function(n,a){var i=a[0];return{x:function(){return n.div(i.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},e)}}),tb=oe({sigmoid_:function(r){var t=X(r,"x","sigmoid");return le.runKernelFunc((function(e,n){var a=e.sigmoid(t);return n([a]),a}),{x:t},(function(e,n){var a=n[0];return{x:function(){return e.mul(a.mul(Ge(1).sub(a)))}}}),"Sigmoid")}}),cT=oe({sign_:function(r){var t=X(r,"x","sign");return le.runKernelFunc((function(e){return e.sign(t)}),{$x:t},(function(e){return{$x:function(){return Ut(e)}}}))}}),fT=oe({isNaN_:function(r){var t=X(r,"x","isNaN");return le.runKernelFunc((function(e){return e.isNaN(t)}),{$x:t},(function(e){return{$x:function(){return Ut(e)}}}))}}),hT=oe({isInf_:function(r){var t=X(r,"x","isInf");return le.runKernelFunc((function(e){return e.isInf(t)}),{$x:t},(function(e){return{$x:function(){return Ut(e)}}}))}}),dT=oe({isFinite_:function(r){var t=X(r,"x","isFinite");return le.runKernelFunc((function(e){return e.isFinite(t)}),{$x:t},(function(e){return{$x:function(){return Ut(e)}}}))}}),pT=oe({sin_:function(r){var t=X(r,"x","sin"),e=[t];return le.runKernelFunc((function(n,a){var i=n.sin(t);return a([t]),i}),{x:t},(function(n,a){var i=a[0];return{x:function(){return i.toFloat().cos().mul(n)}}}),"Sin",{},e)}}),gT=oe({sinh_:function(r){var t=X(r,"x","sinh");return le.runKernelFunc((function(e,n){var a=e.sinh(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return a.toFloat().cosh().mulStrict(e)}}}))}}),vT=oe({softplus_:function(r){var t=X(r,"x","softplus");return le.runKernelFunc((function(e,n){var a=e.softplus(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.mul(a.sigmoid())}}}))}}),mT=oe({sqrt_:function(r){var t=X(r,"x","sqrt");return le.runKernelFunc((function(e,n){var a=e.sqrt(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.div(a.toFloat().sqrt().mul(2))}}}))}}),xT=oe({step_:function(r,t){t===void 0&&(t=0);var e=X(r,"x","step");return le.runKernelFunc((function(n){return n.step(e,t)}),{$x:e},(function(n){return{$x:function(){return Ut(n)}}}))}}),yT=oe({tan_:function(r){var t=X(r,"x","tan");return le.runKernelFunc((function(e,n){var a=e.tan(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.div(a.cos().square())}}}))}}),bT=oe({tanh_:function(r){var t=X(r,"x","tanh");return le.runKernelFunc((function(e,n){var a=e.tanh(t);return n([a]),a}),{x:t},(function(e,n){var a=n[0];return{x:function(){return Ge(1).sub(a.square()).mulStrict(e)}}}),"Tanh",{},null,[!0])}});function nb(r,t,e,n,a,i){var c,f,p=X(r,"x","batchNorm"),d=X(t,"mean","batchNorm"),x=X(e,"variance","batchNorm");return a!=null&&(c=X(a,"scale","batchNorm")),n!=null&&(f=X(n,"offset","batchNorm")),J(p.rank===2,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+p.rank+"."})),J(d.rank===2||d.rank===1,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+d.rank+"."})),J(x.rank===2||x.rank===1,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+x.rank+"."})),c!=null&&J(c.rank===2||c.rank===1,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+c.rank+"."})),f!=null&&J(f.rank===2||f.rank===1,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+f.rank+"."})),Sc(p,d,x,f,c,i)}function rb(r,t,e,n,a,i){var c,f,p=X(r,"x","batchNorm"),d=X(t,"mean","batchNorm"),x=X(e,"variance","batchNorm");return a!=null&&(c=X(a,"scale","batchNorm")),n!=null&&(f=X(n,"offset","batchNorm")),J(p.rank===3,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+p.rank+"."})),J(d.rank===3||d.rank===1,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+d.rank+"."})),J(x.rank===3||x.rank===1,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+x.rank+"."})),c!=null&&J(c.rank===3||c.rank===1,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+c.rank+"."})),f!=null&&J(f.rank===3||f.rank===1,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+f.rank+"."})),Sc(p,d,x,f,c,i)}function ab(r,t,e,n,a,i){var c,f,p=X(r,"x","batchNorm"),d=X(t,"mean","batchNorm"),x=X(e,"variance","batchNorm");return a!=null&&(c=X(a,"scale","batchNorm")),n!=null&&(f=X(n,"offset","batchNorm")),J(p.rank===4,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+p.rank+"."})),J(d.rank===4||d.rank===1,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+d.rank+"."})),J(x.rank===4||x.rank===1,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+x.rank+"."})),c!=null&&J(c.rank===4||c.rank===1,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+c.rank+"."})),f!=null&&J(f.rank===4||f.rank===1,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+f.rank+"."})),Sc(p,d,x,f,c,i)}function Sc(r,t,e,n,a,i){i==null&&(i=.001);var c,f,p,d=X(r,"x","batchNorm"),x=X(t,"mean","batchNorm"),w=X(e,"variance","batchNorm");a!=null&&(c=X(a,"scale","batchNorm")),n!=null&&(f=X(n,"offset","batchNorm")),J(x.rank===w.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),J(f==null||x.rank===f.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),J(c==null||x.rank===c.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),p=d.rank===0||d.rank===1?d.as4D(1,1,1,d.size):d.rank===2?d.as4D(1,1,d.shape[0],d.shape[1]):d.rank===3?d.as4D(1,d.shape[0],d.shape[1],d.shape[2]):d;var C=[d,x,w,c];return le.runKernelFunc((function(S,R){var N=S.batchNormalization(p,Jf(x),Jf(w),i,Jf(c),Jf(f));return R([d,x,w,c]),N}),{x:d,mean:x,variance:w,scale:c,offset:f},(function(S,R){var N=R,D=N[0],M=N[1],B=N[2],k=N[3],L=k??Ge(1),F=ur(M.shape,p.shape),W=[];if(M.rank===1){for(var G=0;G<p.shape.length-1;++G)W.push(p.shape[G]);W.push(1)}var q=D.sub(M),H=S.mul(L),Z=eb(B.add(Ge(i))),ie=Z.mul(Z).mul(Z).mul(Ge(-.5));return{x:function(){return M.rank===1?S.mul(Wu(Z.as4D(1,1,1,M.shape[0]),W)).mul(L).reshape(D.shape):S.mul(Z).mul(L).reshape(D.shape)},mean:function(){var ee=Z.mul(Ge(-1)).mul(H);return M.rank===1&&(ee=ee.sum(F)),ee.reshape(M.shape)},variance:function(){var ee=ie.mul(q).mul(H);return M.rank===1&&(ee=ee.sum(F)),ee.reshape(M.shape)},scale:function(){var ee=q.mul(Z),me=S.mul(ee);return M.rank===1&&(me=me.sum(F)),me.reshape(M.shape)},offset:function(){var ee=S;return M.rank===1&&(ee=ee.sum(F)),ee.reshape(M.shape)}}}),"BatchNormalization",{varianceEpsilon:i},C).reshape(d.shape)}function Jf(r){return r==null?null:r.rank===0?r.as1D():r.rank===1?r:r.rank===2?r.as4D(1,1,r.shape[0],r.shape[1]):r.rank===3?r.as4D(1,r.shape[0],r.shape[1],r.shape[2]):r}function Ph(){yy("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var wT=oe({batchNormalization2d_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Ph(),nb(r,t,e,i,a,n)}}),ET=oe({batchNormalization3d_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Ph(),rb(r,t,e,i,a,n)}}),CT=oe({batchNormalization4d_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Ph(),ab(r,t,e,i,a,n)}}),AT=oe({batchNormalization_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Ph(),Sc(r,t,e,i,a,n)}}),ib=oe({batchNorm_:Sc}),ST=oe({batchNorm2d_:nb}),_T=oe({batchNorm3d_:rb}),TT=oe({batchNorm4d_:ab}),Uh=oe({logicalAnd_:function(r,t){var e=X(r,"a","logicalAnd","bool"),n=X(t,"b","logicalAnd","bool");return Ot(e.shape,n.shape),le.runKernelFunc((function(a){return a.logicalAnd(e,n)}),{a:e,b:n},null,"LogicalAnd")}}),IT=oe({logicalNot_:function(r){var t=X(r,"x","logicalNot","bool");return le.runKernelFunc((function(e){return e.logicalNot(t)}),{$x:t})}}),ob=oe({logicalOr_:function(r,t){var e=X(r,"a","logicalOr","bool"),n=X(t,"b","logicalOr","bool");return Ot(e.shape,n.shape),le.runKernelFunc((function(a){return a.logicalOr(e,n)}),{$a:e,$b:n})}}),RT=oe({logicalXor_:function(r,t){var e=X(r,"a","logicalXor","bool"),n=X(t,"b","logicalXor","bool");return Ot(e.shape,n.shape),ob(r,t).logicalAnd(Uh(r,t).logicalNot())}}),Ps=oe({where_:function(r,t,e){var n=X(t,"a","where"),a=X(e,"b","where"),i=X(r,"condition","where","bool");return Jt(n.shape,a.shape,"Error in where: "),i.rank===1?J(i.shape[0]===n.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):Jt(i.shape,a.shape,"Error in where: "),le.runKernelFunc((function(c,f){var p=c.select(i,n,a);return f([i]),p}),{$condition:i,$a:n,$b:a},(function(c,f){var p=f[0];return{$condition:function(){return Ut(p).toFloat()},$a:function(){return c.mul(p.cast(c.dtype))},$b:function(){return c.mul(p.logicalNot().cast(c.dtype))}}}))}}),sb=function(r){return Ze(this,void 0,void 0,(function(){var t,e,n;return Qe(this,(function(a){switch(a.label){case 0:return[4,(t=X(r,"condition","whereAsync","bool")).data()];case 1:return e=a.sent(),n=m1(t.shape,e),r!==t&&t.dispose(),[2,n]}}))}))},It=oe({add_:function(r,t){var e,n=X(r,"a","add"),a=X(t,"b","add");e=Rn(n,a),n=e[0],a=e[1];var i=Ot(n.shape,a.shape);return le.runKernelFunc((function(c){return c.add(n,a)}),{a:n,b:a},(function(c){return{a:function(){var f=c,p=ur(n.shape,i);return p.length>0&&(f=f.sum(p)),f.reshape(n.shape)},b:function(){var f=c,p=ur(a.shape,i);return p.length>0&&(f=f.sum(p)),f.reshape(a.shape)}}}),"Add")}}),NT=oe({addN_:function(r){J(Array.isArray(r),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),J(r.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+r.length}));var t=r.map((function(a,i){return X(a,"tensors"+i,"addN")})),e=t[0];t.forEach((function(a){if(a.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(a){if(!yr(a.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var n=t;return le.runKernelFunc((function(a){return a.addN(t)}),n,(function(a){var i={};return t.forEach((function(c,f){i[f]=function(){return a.clone()}})),i}),"AddN")}}),DT=oe({addStrict_:function(r,t){var e=X(r,"a","addStrict"),n=X(t,"b","addStrict");return Jt(e.shape,n.shape,"Error in addStrict: "),e.add(n)}}),MT=oe({atan2_:function(r,t){var e,n=X(r,"a","atan2"),a=X(t,"b","atan2");e=Rn(n,a),n=e[0],a=e[1];var i=Ot(n.shape,a.shape);return le.runKernelFunc((function(c,f){var p=c.atan2(n,a);return f([n,a]),p}),{$a:n,$b:a},(function(c,f){var p=f[0],d=f[1];return{$a:function(){var x=It(p.square(),d.square()),w=c.mul(d.div(x)),C=ur(p.shape,i);return C.length>0&&(w=w.sum(C)),w.reshape(p.shape)},$b:function(){var x=It(p.square(),d.square()),w=Sh(c.mul(p.div(x))),C=ur(d.shape,i);return C.length>0&&(w=w.sum(C)),w.reshape(d.shape)}}}))}}),Ya=oe({div_:function(r,t){var e,n=X(r,"a","div"),a=X(t,"b","div");if(e=Rn(n,a),n=e[0],a=e[1],n.dtype==="int32"&&a.dtype==="int32")return ub(n,a);var i=Ot(n.shape,a.shape);return le.runKernelFunc((function(c,f){var p=c.realDivide(n,a);return f([n,a]),p}),{a:n,b:a},(function(c,f){var p=f[0],d=f[1];return{a:function(){var x=c.div(d.toFloat()),w=ur(p.shape,i);return w.length>0?x.sum(w).reshape(p.shape):x},b:function(){var x=c.mul(p.toFloat()),w=ur(d.shape,i);w.length>0&&(x=x.sum(w).reshape(d.shape));var C=d.square();return x.div(C.toFloat()).neg()}}}),"Div")}}),OT=oe({divNoNan_:function(r,t){var e,n=X(r,"a","div"),a=X(t,"b","div");n=(e=Rn(n,a))[0],a=e[1];var i=Ya(n,a),c=Ut(i),f=a.equal(c);return Ps(f,c,i)}}),BT=oe({divStrict_:function(r,t){var e=X(r,"a","div"),n=X(t,"b","div");return Jt(e.shape,n.shape,"Error in divideStrict: "),e.div(n)}}),ub=oe({floorDiv_:function(r,t){var e,n=X(r,"a","floorDiv"),a=X(t,"b","floorDiv");e=Rn(n,a),n=e[0],a=e[1];var i=Ot(n.shape,a.shape);return le.runKernelFunc((function(c,f){var p=c.floorDiv(n,a);return f([n,a]),p}),{a:n,b:a},(function(c,f){var p=f[0],d=f[1];return{a:function(){var x=c.div(d.toFloat()),w=ur(p.shape,i);return w.length>0?x.sum(w).reshape(p.shape):x},b:function(){var x=c.mul(p.toFloat()),w=ur(d.shape,i);w.length>0&&(x=x.sum(w).reshape(d.shape));var C=d.square();return x.div(C.toFloat()).neg()}}}),"FloorDiv")}}),E1=oe({maximum_:function(r,t){var e,n=X(r,"a","maximum"),a=X(t,"b","maximum");return e=Rn(n,a),n=e[0],a=e[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),Ot(n.shape,a.shape),le.runKernelFunc((function(i,c){var f=i.maximum(n,a);return c([n,a]),f}),{a:n,b:a},(function(i,c){var f=c[0],p=c[1];return{a:function(){return i.mul(f.greaterEqual(p).toFloat())},b:function(){return i.mul(f.less(p).toFloat())}}}),"Maximum")}}),kT=oe({maximumStrict_:function(r,t){var e=X(r,"a","maximumStrict"),n=X(t,"b","maximumStrict");return Jt(e.shape,n.shape,"Error in maximumStrict: "),e.maximum(n)}}),lb=oe({minimum_:function(r,t){var e,n=X(r,"a","minimum"),a=X(t,"b","minimum");return e=Rn(n,a),n=e[0],a=e[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),Ot(n.shape,a.shape),le.runKernelFunc((function(i,c){var f=i.minimum(n,a);return c([n,a]),f}),{a:n,b:a},(function(i,c){var f=c[0],p=c[1];return{a:function(){return i.mul(f.lessEqual(p).toFloat())},b:function(){return i.mul(f.greater(p).toFloat())}}}),"Minimum")}}),LT=oe({minimumStrict_:function(r,t){var e=X(r,"a","minimumStrict"),n=X(t,"b","minimumStrict");return Jt(e.shape,n.shape,"Error in minimumStrict: "),e.minimum(n)}}),FT=oe({mod_:function(r,t){var e,n=X(r,"a","mod"),a=X(t,"b","mod");e=Rn(n,a),n=e[0],a=e[1];var i=Ot(n.shape,a.shape);return le.runKernelFunc((function(c,f){var p=c.mod(n,a);return f([n,a]),p}),{$a:n,$b:a},(function(c,f){var p=f[0],d=f[1];return{$a:function(){var x=ur(p.shape,i);return x.length>0?c.sum(x).reshape(p.shape):c},$b:function(){var x=c.mul(p.div(d).floor().neg()),w=ur(d.shape,i);return w.length>0?x.sum(w).reshape(d.shape):x}}}))}}),PT=oe({modStrict_:function(r,t){var e=X(r,"a","modStrict"),n=X(t,"b","modStrict");return Jt(e.shape,n.shape,"Error in modStrict: "),e.mod(n)}}),Ur=oe({mul_:function(r,t){var e,n=X(r,"a","mul"),a=X(t,"b","mul");e=Rn(n,a),n=e[0],a=e[1];var i=Ot(n.shape,a.shape);return le.runKernelFunc((function(c,f){var p=c.multiply(n,a);return f([n,a]),p}),{a:n,b:a},(function(c,f){var p=f[0],d=f[1];return{a:function(){var x=c.mul(d.toFloat()),w=ur(p.shape,i);return w.length>0?x.sum(w).reshape(p.shape):x},b:function(){var x=c.mul(p.toFloat()),w=ur(d.shape,i);return w.length>0?x.sum(w).reshape(d.shape):x}}}),"Mul")}}),UT=oe({mulStrict_:function(r,t){var e=X(r,"a","mul"),n=X(t,"b","mul");return Jt(e.shape,n.shape,"Error in multiplyStrict: "),e.mul(n)}}),_h=oe({pow_:function(r,t){var e,n=X(r,"base","pow"),a=X(t,"exp","pow");e=Rn(n,a),n=e[0],a=e[1];var i=Ot(n.shape,a.shape),c=[n,a];return le.runKernelFunc((function(f,p){var d=f.pow(n,a);return p([n,a,d]),d}),{a:n,b:a},(function(f,p){var d=p[0],x=p[1],w=p[2];return{a:function(){var C=x.toFloat(),S=f.mul(C.mul(d.pow(C.sub(Ge(1))))),R=ur(d.shape,i);return R.length>0&&(S=S.sum(R)),S.reshape(d.shape)},b:function(){var C=d.greater(0),S=d.log().where(C,Ut(d)),R=f.mul(w.mul(S)),N=ur(x.shape,i);return N.length>0&&(R=R.sum(N)),R.reshape(x.shape)}}}),"Pow",{},c,[!0])}}),zT=oe({powStrict_:function(r,t){return Jt(r.shape,t.shape,"Error in powStrict: "),r.pow(t)}}),HT=oe({squaredDifferenceStrict_:function(r,t){var e=X(r,"a","squaredDifferenceStrict"),n=X(t,"b","squaredDifferenceStrict");return Jt(e.shape,n.shape,"Error in squaredDifferenceStrict: "),e.squaredDifference(n)}}),lr=oe({sub_:function(r,t){var e,n=X(r,"a","sub"),a=X(t,"b","sub");e=Rn(n,a),n=e[0],a=e[1];var i=Ot(n.shape,a.shape);return le.runKernelFunc((function(c){return c.subtract(n,a)}),{a:n,b:a},(function(c){return{a:function(){var f=c,p=ur(n.shape,i);return p.length>0&&(f=f.sum(p)),f.reshape(n.shape)},b:function(){var f=c,p=ur(a.shape,i);return p.length>0&&(f=f.sum(p)),f.neg().reshape(a.shape)}}}),"Sub")}}),VT=oe({subStrict_:function(r,t){var e=X(r,"a","subStrict"),n=X(t,"b","subStrict");return Jt(e.shape,n.shape,"Error in subStrict: "),e.sub(n)}}),cb=oe({equal_:function(r,t){var e,n=X(r,"a","equal"),a=X(t,"b","equal");return e=Rn(n,a),n=e[0],a=e[1],Ot(n.shape,a.shape),le.runKernelFunc((function(i){return i.equal(n,a)}),{$a:n,$b:a})}}),WT=oe({equalStrict_:function(r,t){var e=X(r,"a","equalStrict"),n=X(t,"b","equalStrict");return Jt(e.shape,n.shape,"Error in equalStrict: "),e.equal(n)}}),GT=oe({greater_:function(r,t){var e,n=X(r,"a","greater"),a=X(t,"b","greater");return e=Rn(n,a),n=e[0],a=e[1],Ot(n.shape,a.shape),le.runKernelFunc((function(i){return i.greater(n,a)}),{a:n,b:a},null,"Greater")}}),fb=oe({greaterEqual_:function(r,t){var e,n=X(r,"a","greaterEqual"),a=X(t,"b","greaterEqual");return e=Rn(n,a),n=e[0],a=e[1],Ot(n.shape,a.shape),le.runKernelFunc((function(i,c){var f=i.greaterEqual(n,a);return c([n,a]),f}),{a:n,b:a},(function(i,c){var f=c[0],p=c[1];return{a:function(){return Ut(f)},b:function(){return Ut(p)}}}),"GreaterEqual")}}),jT=oe({greaterEqualStrict_:function(r,t){var e=X(r,"a","greaterEqualStrict"),n=X(t,"b","greaterEqualStrict");return Jt(e.shape,n.shape,"Error in greaterEqualStrict: "),e.greaterEqual(n)}}),XT=oe({greaterStrict_:function(r,t){var e=X(r,"a","greaterStrict"),n=X(t,"b","greaterStrict");return Jt(e.shape,n.shape,"Error in greaterStrict: "),e.greater(n)}}),YT=oe({less_:function(r,t){var e,n=X(r,"a","less"),a=X(t,"b","less");return e=Rn(n,a),n=e[0],a=e[1],Ot(n.shape,a.shape),le.runKernelFunc((function(i){return i.less(n,a)}),{a:n,b:a},null,"Less")}}),qT=oe({lessEqual_:function(r,t){var e,n=X(r,"a","lessEqual"),a=X(t,"b","lessEqual");return e=Rn(n,a),n=e[0],a=e[1],Ot(n.shape,a.shape),le.runKernelFunc((function(i,c){var f=i.lessEqual(n,a);return c([n,a]),f}),{a:n,b:a},null,"LessEqual")}}),KT=oe({lessEqualStrict_:function(r,t){var e=X(r,"a","lessEqualStrict"),n=X(t,"b","lessEqualStrict");return Jt(e.shape,n.shape,"Error in lessEqualStrict: "),e.lessEqual(n)}}),ZT=oe({lessStrict_:function(r,t){var e=X(r,"a","lessStrict"),n=X(t,"b","lessStrict");return Jt(e.shape,n.shape,"Error in lessStrict: "),e.less(n)}}),QT=oe({notEqual_:function(r,t){var e,n=X(r,"a","notEqual"),a=X(t,"b","notEqual");return e=Rn(n,a),n=e[0],a=e[1],Ot(n.shape,a.shape),le.runKernelFunc((function(i){return i.notEqual(n,a)}),{a:n,b:a},null,"NotEqual")}}),JT=oe({notEqualStrict_:function(r,t){var e=X(r,"a","notEqualStrict"),n=X(t,"b","notEqualStrict");return Jt(e.shape,n.shape,"Error in notEqualStrict: "),e.notEqual(n)}});function fx(r,t){for(var e=[],n=r;n<t;++n)e.push(n);return e}function hx(r){for(var t=[],e=0;e<r.length;++e)for(var n=0;n<r[e].length;++n)t.push(r[e][n]);return t}var C1=oe({gather_:function(r,t,e){e===void 0&&(e=0);var n=X(r,"x","gather"),a=X(t,"indices","gather","int32");e=cr(e,n.shape)[0];var i=(function(c,f,p){for(var d=c.shape[p],x=[],w=1,C=1,S=0;S<p;S++)x.push(c.shape[S]),w*=c.shape[S];for(S=0;S<f.rank;S++)x.push(f.shape[S]);for(S=p+1;S<c.rank;S++)x.push(c.shape[S]),C*=c.shape[S];return{batchSize:w,sliceSize:C,dimSize:d,outputShape:x}})(n,a,e);return le.runKernelFunc((function(c,f){var p=c.gather(n,a.flatten(),e);return f([a]),p}),{x:n,indices:a},(function(c,f){var p=f[0];return{x:function(){var d=n.shape,x=p.size,w=d.slice(0,e),C=w.length,S=d.slice(e,d.length).slice(1),R=S.length,N=fx(0,C),D=fx(C+1,C+1+R),M=hx([w,[x],S]),B=c.reshape(M),k=p.reshape([x]),L=hx([[C],N,D]),F=B.transpose(L),W=hb(F,k,n.shape[e]),G=l1(L);return W=W.transpose(G)},indices:function(){return p}}}),"Gather",{axis:e}).reshape(i.outputShape)}}),hb=oe({unsortedSegmentSum_:function(r,t,e){var n=X(r,"x","unsortedSegmentSum"),a=X(t,"segmentIds","unsortedSegmentSum","int32");return J(jn(e),(function(){return"numSegments must be of dtype int"})),le.runKernelFunc((function(i,c){var f=i.unsortedSegmentSum(n,a,e);return c([a]),f}),{$x:n},(function(i,c){var f=c[0];return{$x:function(){return(function(p,d){for(var x=E1(d,Ut(d)),w=C1(p,x),C=fb(d,Ge(0,"int32")),S=w.rank-C.rank,R=0;R<S;++R)C=ka(C,R+1);C=Uh(C,rl(w.shape,"bool"));var N=Ut(w);return Ps(C,w,N)})(i,f)}}}))}}),$T=function(r,t,e){return Ze(this,void 0,void 0,(function(){var n,a,i,c,f,p,d,x,w,C,S,R,N;return Qe(this,(function(D){switch(D.label){case 0:for(n=X(r,"tensor","boolMask"),a=X(t,"mask","boolMask","bool"),i=e??0,c=a.rank,f=n.shape,J(c>0,(function(){return"mask cannot be scalar"})),Jt(f.slice(i,i+c),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),p=1,d=i;d<i+c;d++)p*=f[d];return x=f.slice(0,i).concat([p],f.slice(i+c)),w=n.reshape(x),C=a.reshape([-1]),[4,sb(C)];case 1:return S=D.sent(),R=S.squeeze([1]),N=C1(w,R,i),r!==n&&n.dispose(),t!==a&&a.dispose(),R.dispose(),w.dispose(),C.dispose(),S.dispose(),[2,N]}}))}))};function db(r,t,e,n,a,i,c){i===void 0&&(i="NHWC"),J(r.length===t.rank,(function(){return"Length of inShape ("+r.length+") and rank of dy ("+t.rank+") must match"}));var f=r,p=t,d=!1;t.rank===3&&(d=!0,p=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),f=[1,r[0],r[1],r[2]]),J(f.length===4,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+f.length+"."})),J(p.rank===4,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+p.rank})),J(e.rank===4,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+e.rank}));var x=i==="NHWC"?f[3]:f[1],w=i==="NHWC"?p.shape[3]:p.shape[1];J(x===e.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+x+") must match input depth for filter "+e.shape[2]+"."})),J(w===e.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+w+") must match output depth for filter "+e.shape[3]+"."})),c!=null&&J(jn(a),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+a+"."}));var C=p1(i),S=Ws(f,e.shape,n,1,a,c,!1,C),R=le.runKernelFunc((function(N,D){var M=N.conv2dDerInput(p,e,S);return D([e,p]),M}),{dy4D:p,filter:e},(function(N,D){var M=D[0],B=D[1];return{dy4D:function(){return Pa(N,M,n,a,i,1,c)},filter:function(){return A1(N,B,M.shape,n,a,i,c)}}}));return d?R.as3D(R.shape[1],R.shape[2],R.shape[3]):R}function gp(r){var t=(function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i})(r),e=t[0],n=t[1],a=t[2];return e===1&&n===1&&a===1}function pb(r,t,e,n,a){J(r.length===t.rank,(function(){return"Length of inShape ("+r.length+") and rank of dy ("+t.rank+") must match"}));var i=r,c=t,f=!1;t.rank===4&&(f=!0,c=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,r[0],r[1],r[2],r[3]]);var p=i[4],d=c.shape[4];J(i.length===5,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."})),J(c.rank===5,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+c.rank})),J(e.rank===5,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+e.rank})),J(p===e.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+p+") must match input depth for filter "+e.shape[3]+"."})),J(d===e.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+d+") must match output depth for filter "+e.shape[4]+"."}));var x=Ch(i,e.shape,n,1,a),w=le.runKernelFunc((function(C){return C.conv3dDerInput(c,e,x)}),{dy5D:c});return f?w.as4D(w.shape[1],w.shape[2],w.shape[3],w.shape[4]):w}var eI=oe({conv1d_:function(r,t,e,n,a,i,c){a===void 0&&(a="NWC"),i===void 0&&(i=1);var f=X(r,"x","conv1d"),p=X(t,"filter","conv1d"),d=f,x=!1;f.rank===2&&(x=!0,d=f.as3D(1,f.shape[0],f.shape[1])),J(d.rank===3,(function(){return"Error in conv1d: input must be rank 3, but got rank "+d.rank+"."})),J(p.rank===3,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+p.rank+"."})),c!=null&&J(jn(n),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+n+"."})),J(d.shape[2]===p.shape[1],(function(){return"Error in conv1d: depth of input ("+d.shape[2]+") must match input depth for filter "+p.shape[1]+"."})),J(ia(e,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+e+" and dilation '"+i+"'"})),J(a==="NWC",(function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."}));var w=p.as4D(1,p.shape[0],p.shape[1],p.shape[2]),C=d.as4D(d.shape[0],1,d.shape[1],d.shape[2]),S=Pa(C,w,[1,e],n,"NHWC",[1,i],c);return x?S.as2D(S.shape[2],S.shape[3]):S.as3D(S.shape[0],S.shape[2],S.shape[3])}}),Pa=oe({conv2d_:function(r,t,e,n,a,i,c){a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]);var f=X(r,"x","conv2d"),p=X(t,"filter","conv2d"),d=f,x=!1;f.rank===3&&(x=!0,d=f.as4D(1,f.shape[0],f.shape[1],f.shape[2])),J(d.rank===4,(function(){return"Error in conv2d: input must be rank 4, but got rank "+d.rank+"."})),J(p.rank===4,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+p.rank+"."})),c!=null&&J(jn(n),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+n+"."}));var w=a==="NHWC"?d.shape[3]:d.shape[1];J(w===p.shape[2],(function(){return"Error in conv2d: depth of input ("+w+") must match input depth for filter "+p.shape[2]+"."})),J(ia(e,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}));var C=p1(a),S=Ws(d.shape,p.shape,e,i,n,c,!1,C),R=[p,d],N=le.runKernelFunc((function(D,M){var B=D.conv2d(d,p,S);return M([p,d]),B}),{x:d,filter:p},(function(D,M){var B=M,k=B[0],L=B[1];return J($u(i),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"})),{x:function(){return gb(L.shape,D,k,e,n,a)},filter:function(){return A1(L,D,k.shape,e,n,a)}}}),"Conv2D",S,R);return x?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),tI=oe({conv3d_:function(r,t,e,n,a,i){a===void 0&&(a="NDHWC"),i===void 0&&(i=[1,1,1]);var c=X(r,"x","conv3d"),f=X(t,"filter","conv3d"),p=c,d=!1;c.rank===4&&(d=!0,p=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3])),J(p.rank===5,(function(){return"Error in conv3d: input must be rank 5, but got rank "+p.rank+"."})),J(f.rank===5,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+f.rank+"."})),J(p.shape[4]===f.shape[3],(function(){return"Error in conv3d: depth of input ("+p.shape[4]+") must match input depth for filter "+f.shape[3]+"."})),J((function(C,S){return gp(C)||gp(S)})(e,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"})),J(a==="NDHWC",(function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."}));var x=Ch(p.shape,f.shape,e,i,n),w=le.runKernelFunc((function(C,S){var R=C.conv3d(p,f,x);return S([p,f]),R}),{x:p,$filter:f},(function(C,S){J(gp(i),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}));var R=S[0],N=S[1];return{x:function(){return pb(R.shape,C,N,e,n)},$filter:function(){return(function(D,M,B,k,L){var F=D;D.rank===4&&(F=D.as5D(1,D.shape[0],D.shape[1],D.shape[2],D.shape[3]));var W=M;W.rank===4&&(W=M.as5D(1,M.shape[0],M.shape[1],M.shape[2],M.shape[3])),J(F.rank===5,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+F.shape+"."})),J(W.rank===5,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+W.shape+"."})),J(B.length===5,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+B+"."})),J(F.shape[4]===B[3],(function(){return"Error in conv3dDerFilter: depth of input "+F.shape[4]+") must match input depth in filter ("+B[3]+"."})),J(W.shape[4]===B[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+W.shape[4]+") must match output depth for filter ("+B[4]+")."}));var G=Ch(F.shape,B,k,1,L);return le.runKernelFunc((function(q){return q.conv3dDerFilter(F,W,G)}),{x5D:F,dy5D:W})})(R,C,N.shape,e,n)}}}));return d?w.as4D(w.shape[1],w.shape[2],w.shape[3],w.shape[4]):w}}),A1=oe({conv2dDerFilter_:function(r,t,e,n,a,i,c){i===void 0&&(i="NHWC");var f=r;r.rank===3&&(f=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var p=t;p.rank===3&&(p=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),J(f.rank===4,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+f.shape+"."})),J(p.rank===4,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+p.shape+"."})),J(e.length===4,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+e+"."}));var d=i==="NHWC"?f.shape[3]:f.shape[1],x=i==="NHWC"?p.shape[3]:p.shape[1];J(d===e[2],(function(){return"Error in conv2dDerFilter: depth of input "+d+") must match input depth in filter ("+e[2]+"."})),J(x===e[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+x+") must match output depth for filter ("+e[3]+")."})),c!=null&&J(jn(a),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+a+"."}));var w=p1(i),C=Ws(f.shape,e,n,1,a,c,!1,w);return le.runKernelFunc((function(S){return S.conv2dDerFilter(f,p,C)}),{x4D:f,dy4D:p})}}),gb=oe({conv2dDerInput_:db}),zh=oe({depthwiseConv2d_:function(r,t,e,n,a,i,c){i===void 0&&(i=[1,1]);var f=X(r,"x","depthwiseConv2d"),p=X(t,"filter","depthwiseConv2d"),d=f,x=!1;f.rank===3&&(x=!0,d=f.as4D(1,f.shape[0],f.shape[1],f.shape[2])),J(d.rank===4,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+d.rank+"."})),J(p.rank===4,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+p.rank+"."})),J(d.shape[3]===p.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+d.shape[3]+") must match the inChannels dimension in filter "+p.shape[2]+"."})),i==null&&(i=[1,1]),J(ia(e,i),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"})),c!=null&&J(jn(n),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+n+"."}));var w=Ws(d.shape,p.shape,e,i,n,c,!0),C=[d,p],S=le.runKernelFunc((function(R,N){var D=R.depthwiseConv2D(d,p,w);return N([d,p]),D}),{x:d,filter:p},(function(R,N){J($u(i),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"}));var D=N[0],M=N[1];return{x:function(){return vb(D.shape,R,M,w)},filter:function(){return mb(D,R,M.shape,w)}}}),"DepthwiseConv2dNative",w,C);return x?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),vb=oe({depthwiseConv2dDerInput_:function(r,t,e,n){var a=t,i=!1;t.rank===3&&(i=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var c=le.runKernelFunc((function(f){return f.depthwiseConv2DDerInput(a,e,n)}),{dy4D:a});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),mb=oe({depthwiseConv2dDerFilter_:function(r,t,e,n){var a=r;r.rank===3&&(a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),le.runKernelFunc((function(c){return c.depthwiseConv2DDerFilter(a,i,n)}),{x4D:a,dy4D:i})}}),S1=oe({separableConv2d_:function(r,t,e,n,a,i,c){i===void 0&&(i=[1,1]),c===void 0&&(c="NHWC");var f=X(r,"x","separableConv2d"),p=X(t,"depthwiseFilter","separableConv2d"),d=X(e,"pointwiseFilter","separableConv2d"),x=f,w=!1;if(f.rank===3&&(w=!0,x=f.as4D(1,f.shape[0],f.shape[1],f.shape[2])),c==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");J(x.rank===4,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+x.rank+"."})),J(p.rank===4,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+p.rank+"."})),J(d.rank===4,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+p.rank+"."})),J(d.shape[0]===1,(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+d.shape[0]+"."})),J(d.shape[1]===1,(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+d.shape[1]+"."}));var C=p.shape[2],S=p.shape[3];J(d.shape[2]===C*S,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+C*S+", but got "+d.shape[2]+"."}));var R=zh(x,p,n,a,c,i),N=Pa(R,d,1,"valid",c);return w?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),nI=oe({conv2dTranspose_:function(r,t,e,n,a,i){return db(e,X(r,"x","conv2dTranspose"),X(t,"filter","conv2dTranspose"),n,a,"NHWC",i)}}),rI=oe({conv3dTranspose_:function(r,t,e,n,a){return pb(e,X(r,"x","conv3dTranspose"),X(t,"filter","conv3dTranspose"),n,a)}}),Hh=oe({matMul_:function(r,t,e,n){var a;e===void 0&&(e=!1),n===void 0&&(n=!1);var i=X(r,"a","matMul"),c=X(t,"b","matMul");a=Rn(i,c),i=a[0],c=a[1];var f=e?i.shape[i.rank-2]:i.shape[i.rank-1],p=n?c.shape[c.rank-1]:c.shape[c.rank-2],d=e?i.shape[i.rank-1]:i.shape[i.rank-2],x=n?c.shape[c.rank-2]:c.shape[c.rank-1],w=i.shape.slice(0,-2),C=c.shape.slice(0,-2),S=Je(w),R=Je(C);J(i.rank>=2&&c.rank>=2&&i.rank===c.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+c.rank+"."})),J(yr(w,C),(function(){return"Error in matMul: outer dimensions ("+w+") and ("+C+") of Tensors with shapes "+i.shape+" and "+c.shape+" must match."})),J(f===p,(function(){return"Error in matMul: inner shapes ("+f+") and ("+p+") of Tensors with shapes "+i.shape+" and "+c.shape+" and transposeA="+e+" and transposeB="+n+" must match."}));var N=i.shape.slice(0,-2).concat([d,x]),D=e?i.as3D(S,f,d):i.as3D(S,d,f),M=n?c.as3D(R,x,p):c.as3D(R,p,x),B={transposeA:e,transposeB:n};return le.runKernelFunc((function(k,L){var F=k.batchMatMul(D,M,e,n);return L([D,M]),F}),{a:D,b:M},(function(k,L){var F=L,W=F[0],G=F[1];return e||n?!e&&n?{a:function(){return k.matMul(G,!1,!1)},b:function(){return k.matMul(W,!0,!1)}}:e&&!n?{a:function(){return G.matMul(k,!1,!0)},b:function(){return W.matMul(k,!1,!1)}}:{a:function(){return G.matMul(k,!0,!0)},b:function(){return k.matMul(W,!0,!0)}}:{a:function(){return k.matMul(G,!1,!0)},b:function(){return W.matMul(k,!0,!1)}}}),"BatchMatMul",B).reshape(N)}}),aI=oe({dot_:function(r,t){var e=X(r,"t1","dot"),n=X(t,"t2","dot");J(!(e.rank!==1&&e.rank!==2||n.rank!==1&&n.rank!==2),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+e.rank+" and "+n.rank+"."}));var a=e.rank===1?e.size:e.shape[1],i=n.rank===1?n.size:n.shape[0];return J(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."})),e.rank===1&&n.rank===1?e.as2D(1,-1).matMul(n.as2D(-1,1)).asScalar():e.rank===1&&n.rank===2?e.as2D(1,-1).matMul(n.as2D(n.shape[0],n.shape[1])).as1D():e.rank===2&&n.rank===1?e.matMul(n.as2D(-1,1)).as1D():e.matMul(n.as2D(n.shape[0],n.shape[1]))}}),iI=oe({outerProduct_:function(r,t){var e=X(r,"v1","outerProduct"),n=X(t,"v2","outerProduct");return J(e.rank===1&&n.rank===1,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+n.rank+"."})),e.as2D(-1,1).matMul(n.as2D(1,-1))}}),_c=oe({reverse_:function(r,t){var e=X(r,"x","reverse");if(e.rank===0)return e.clone();var n=cr(t,e.shape);return le.runKernelFunc((function(a){return a.reverse(e,n)}),{$x:e},(function(a){return{$x:function(){return a.reverse(n)}}})).reshapeAs(e)}}),oI=oe({reverse1d_:function(r){var t=X(r,"x","reverse");return J(t.rank===1,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."})),_c(t,0)}}),sI=oe({reverse2d_:function(r,t){var e=X(r,"x","reverse");return J(e.rank===2,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+e.rank+"."})),_c(e,t)}}),uI=oe({reverse3d_:function(r,t){var e=X(r,"x","reverse");return J(e.rank===3,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+e.rank+"."})),_c(e,t)}}),lI=oe({reverse4d_:function(r,t){var e=X(r,"x","reverse");return J(e.rank===4,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+e.rank+"."})),_c(e,t)}});function xb(r,t,e,n,a,i){var c=X(r,"x","maxPool"),f=c,p=!1;c.rank===3&&(p=!0,f=c.as4D(1,c.shape[0],c.shape[1],c.shape[2])),J(f.rank===4,(function(){return"Error in maxPool: input must be rank 4 but got rank "+f.rank+"."})),J(ia(e,n),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+n+"'"})),i!=null&&J(jn(a),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."}));var d=pc(f.shape,t,e,n,a,i);if(d.filterWidth===1&&d.filterHeight===1&&yr(d.inShape,d.outShape))return c.clone();var x=[f],w=le.runKernelFunc((function(C,S){var R=C.maxPool(f,d);return S([f,R]),R}),{x:f},(function(C,S){var R=S[0],N=S[1];return{x:function(){return(function(D,M,B,k,L,F,W,G){var q=X(D,"dy","maxPoolBackprop"),H=X(M,"input","maxPoolBackprop"),Z=X(B,"output","maxPoolBackprop");J(H.rank===q.rank,(function(){return"Rank of input ("+H.rank+") does not match rank of dy ("+q.rank+")"})),J(ia(L,F),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+L+" and dilations '"+F+"'"})),J(q.rank===4,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+q.rank+"."})),J(H.rank===4,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+H.rank+"."}));var ie=pc(H.shape,k,L,F,W,G);return le.runKernelFunc((function(ee){return ee.maxPoolBackprop(q,H,Z,ie)}),{$dy:q,$input:H})})(C,R,N,t,e,n,a)}}}),"MaxPool",d,x);return p?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}function yb(r,t,e,n,a,i){var c=X(r,"x","avgPool","float32");J(ia(e,n),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+n+"'"}));var f=c,p=!1;c.rank===3&&(p=!0,f=c.as4D(1,c.shape[0],c.shape[1],c.shape[2])),J(f.rank===4,(function(){return"Error in avgPool: x must be rank 4 but got rank "+f.rank+"."})),i!=null&&J(jn(a),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."}));var d=pc(f.shape,t,e,n,a,i);if(d.filterWidth===1&&d.filterHeight===1&&yr(d.inShape,d.outShape))return c.clone();var x=le.runKernelFunc((function(w){return w.avgPool(f,d)}),{x:f},(function(w){return{x:function(){return(function(C,S,R,N,D,M){var B=X(C,"dy","avgPoolBackprop"),k=X(S,"input","avgPoolBackprop");J(k.rank===B.rank,(function(){return"Rank of input ("+k.rank+") does not match rank of dy ("+B.rank+")"})),J(ia(N,D),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+N+" and dilations '"+D+"'"}));var L=k,F=B,W=!1;k.rank===3&&(W=!0,L=k.as4D(1,k.shape[0],k.shape[1],k.shape[2]),F=B.as4D(1,B.shape[0],B.shape[1],B.shape[2])),J(F.rank===4,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+F.rank+"."})),J(L.rank===4,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+L.rank+"."}));var G=pc(L.shape,R,N,D,M),q=le.runKernelFunc((function(H){return H.avgPoolBackprop(F,L,G)}),{dy4D:F,input4D:L});return W?q.as3D(q.shape[1],q.shape[2],q.shape[3]):q})(w,f,t,e,n,a)}}}),"AvgPool",d);return x=x.cast(c.dtype),p?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}var xr=oe({maxPool_:function(r,t,e,n,a){return xb(r,t,e,1,n,a)}}),Tc=oe({avgPool_:function(r,t,e,n,a){return yb(r,t,e,1,n,a)}}),cI=oe({pool_:function(r,t,e,n,a,i){a==null&&(a=[1,1]),i==null&&(i=1),n===0&&(n="valid");var c=X(r,"x","maxPool"),f=c,p=!1;c.rank===3&&(p=!0,f=c.as4D(1,c.shape[0],c.shape[1],c.shape[2])),J(ia(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"}));var d,x=pc(f.shape,t,i,a,n),w=[x.dilationHeight,x.dilationWidth];d=n==="same"?(function(L,F){var W=L.map((function(H,Z){return H+(H-1)*(F[Z]-1)})).map((function(H){return H-1})),G=W.map((function(H){return Math.floor(H/2)})),q=W.map((function(H,Z){return H-G[Z]}));return W.map((function(H,Z){return[G[Z],q[Z]]}))})([x.filterHeight,x.filterWidth],w):[[0,0],[0,0]];var C=w[0]===1&&w[1]===1,S=(function(L,F,W){var G=W.map((function(xe){return xe[0]})),q=W.map((function(xe){return xe[1]})),H=L.concat(G,q),Z=F.map((function(xe,$){return(xe-H[$]%xe)%xe})),ie=q.map((function(xe,$){return xe+Z[$]})),ee=F.map((function(xe,$){return[G[$],ie[$]]})),me=F.map((function(xe,$){return[0,Z[$]]}));return[ee,me]})([x.inHeight,x.inWidth],w,d),R=S[0],N=S[1],D=C?n:"valid",M=C?f:Sy(f,w,R),B=(e==="avg"?function(){return yb(M,t,i,1,D)}:function(){return xb(M,t,i,1,D)})(),k=C?B:Ey(B,w,N);return p?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}}),fI=oe({maxPool3d_:function(r,t,e,n,a,i,c){i===void 0&&(i="NDHWC");var f=X(r,"x","maxPool3d"),p=f,d=!1;f.rank===4&&(d=!0,p=f.as5D(1,f.shape[0],f.shape[1],f.shape[2],f.shape[3])),c==null&&(c=[1,1,1]),J(p.rank===5,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+p.rank+"."})),J(i==="NDHWC",(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),J(ia(e,c),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+c+"'"})),a!=null&&J(jn(n),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."}));var x=Eh(p.shape,t,e,c,n,a,i),w=le.runKernelFunc((function(C,S){var R=C.maxPool3d(p,x);return S([p,R]),R}),{x:p},(function(C,S){var R=S[0],N=S[1];return{x:function(){return(function(D,M,B,k,L,F,W,G){var q=X(D,"dy","maxPool3dBackprop"),H=X(M,"input","maxPool3dBackprop"),Z=X(B,"output","maxPool3dBackprop"),ie=q,ee=H,me=Z,xe=!1;H.rank===4&&(xe=!0,ie=q.as5D(1,q.shape[0],q.shape[1],q.shape[2],q.shape[3]),ee=H.as5D(1,H.shape[0],H.shape[1],H.shape[2],H.shape[3]),me=Z.as5D(1,Z.shape[0],Z.shape[1],Z.shape[2],Z.shape[3])),J(ie.rank===5,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+ie.rank+"."})),J(ee.rank===5,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+ee.rank+"."})),J(me.rank===5,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+me.rank+"."})),F==null&&(F=[1,1,1]),J(ia(L,F),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+L+" and dilations '"+F+"'"})),G!=null&&J(jn(W),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+G+" but got pad "+W+"."}));var $=Eh(ee.shape,k,L,F,W,G),te=le.runKernelFunc((function(re){return re.maxPool3dBackprop(ie,ee,me,$)}),{dy5D:ie,input5D:ee});return xe?te.as4D(te.shape[1],te.shape[2],te.shape[3],te.shape[4]):te})(C,R,N,t,e,c,n,a)}}}));return d?w.as4D(w.shape[1],w.shape[2],w.shape[3],w.shape[4]):w}}),hI=oe({avgPool3d_:function(r,t,e,n,a,i,c){i===void 0&&(i="NDHWC");var f=X(r,"x","avgPool3d","float32"),p=f,d=!1;f.rank===4&&(d=!0,p=f.as5D(1,f.shape[0],f.shape[1],f.shape[2],f.shape[3])),c==null&&(c=[1,1,1]),J(p.rank===5,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+p.rank+"."})),J(i==="NDHWC",(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),J(ia(e,c),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+c+"'"})),a!=null&&J(jn(n),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."}));var x=Eh(p.shape,t,e,c,n,a,i),w=le.runKernelFunc((function(C){return C.avgPool3d(p,x)}),{x:p},(function(C){return{x:function(){return(function(S,R,N,D,M,B,k){var L=X(S,"dy","avgPool3dBackprop"),F=X(R,"input","avgPool3dBackprop"),W=L,G=F,q=!1;F.rank===4&&(q=!0,W=L.as5D(1,L.shape[0],L.shape[1],L.shape[2],L.shape[3]),G=F.as5D(1,F.shape[0],F.shape[1],F.shape[2],F.shape[3])),J(W.rank===5,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+W.rank+"."})),J(G.rank===5,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+G.rank+"."})),M==null&&(M=[1,1,1]),J(ia(D,M),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+D+" and dilations '"+M+"'"})),k!=null&&J(jn(B),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+k+" but got pad "+B+"."}));var H=Eh(G.shape,N,D,M,B,k),Z=le.runKernelFunc((function(ie){return ie.avgPool3dBackprop(W,G,H)}),{dy5D:W,input5D:G});return q?Z.as4D(Z.shape[1],Z.shape[2],Z.shape[3],Z.shape[4]):Z})(C,p,t,e,c,n,a)}}}));return w=w.cast(p.dtype),d?w.as4D(w.shape[1],w.shape[2],w.shape[3],w.shape[4]):w}}),Ti=oe({slice_:function(r,t,e){var n,a,i=X(r,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(n=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach((function(p){J(p!==-1,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=e==null?new Array(i.rank).fill(-1):typeof e=="number"?[e].concat(new Array(i.rank-1).fill(-1)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(-1)):e).map((function(p,d){return p>=0?p:(J(p===-1,(function(){return"Negative size values should be exactly -1 but got "+p+" for the slice() size at index "+d+"."})),i.shape[d]-n[d])})),zS(i,n,a);var c=i.shape,f={begin:n,size:a};return le.runKernelFunc((function(p){return p.slice(i,n,a)}),{x:i},(function(p){for(var d=[],x=0;x<p.rank;x++)d.push([n[x],c[x]-n[x]-a[x]]);return{x:function(){return p.pad(d)}}}),"Slice",f)}}),dI=oe({slice1d_:function(r,t,e){var n=X(r,"x","slice1d");return J(n.rank===1,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+n.rank+" tensor"})),Ti(n,[t],[e])}}),pI=oe({slice2d_:function(r,t,e){var n=X(r,"x","slice2d");return J(n.rank===2,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+n.rank+" tensor"})),Ti(n,t,e)}}),bb=oe({slice3d_:function(r,t,e){var n=X(r,"x","slice3d");return J(n.rank===3,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+n.rank+" tensor"})),Ti(n,t,e)}}),gI=oe({slice4d_:function(r,t,e){var n=X(r,"x","slice4d");return J(n.rank===4,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+n.rank+" tensor"})),Ti(n,t,e)}});function wb(r,t,e,n,a){return t.rank<e.rank&&(t=t.reshape(aa(t.shape,n))),r.rank<e.rank&&(r=r.reshape(aa(r.shape,n))),{x:function(){var i=r.mul(e.equal(t).cast(r.dtype));return a==null?i:i.transpose(a)}}}var vI=oe({all_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=X(r,"x","all","bool"),a=cr(t,n.shape),i=a,c=Ni(i,n.rank);c!=null&&(n=n.transpose(c),i=Di(i.length,n.rank));var f=le.runKernelFunc((function(d){return d.all(n,i)}),{$x:n});if(e){var p=aa(f.shape,a);return f.reshape(p)}return f}}),mI=oe({any_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=X(r,"x","any","bool"),a=cr(t,n.shape),i=a,c=Ni(i,n.rank);c!=null&&(n=n.transpose(c),i=Di(i.length,n.rank));var f=le.runKernelFunc((function(d){return d.any(n,i)}),{$x:n});if(e){var p=aa(f.shape,a);return f.reshape(p)}return f}}),xI=oe({argMax_:function(r,t){t===void 0&&(t=0);var e=X(r,"x","argMax");t==null&&(t=0);var n=cr(t,e.shape),a=Ni(n,e.rank);a!=null&&(e=e.transpose(a),n=Di(n.length,e.rank));var i={axis:n[0]},c=[e];return le.runKernelFunc((function(f,p){var d=f.argMax(e,n[0]);return p([e]),d}),{x:e},(function(f,p){var d=p[0];return{x:function(){return Ut(d)}}}),"ArgMax",i,c)}}),yI=oe({argMin_:function(r,t){t===void 0&&(t=0);var e=X(r,"x","argMin");t==null&&(t=0);var n=cr(t,e.shape),a=Ni(n,e.rank);return a!=null&&(e=e.transpose(a),n=Di(n.length,e.rank)),le.runKernelFunc((function(i,c){var f=i.argMin(e,n[0]);return c([e]),f}),{$x:e},(function(i,c){var f=c[0];return{$x:function(){return Ut(f)}}}))}}),bI=oe({logSumExp_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=X(r,"x","logSumExp"),a=cr(t,n.shape),i=n.max(a,!0),c=n.sub(i).exp().sum(a).log(),f=i.reshape(c.shape).add(c);if(e){var p=aa(f.shape,a);return f.reshape(p)}return f}}),Vh=oe({max_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=X(r,"x","max"),a=n,i=cr(t,n.shape),c=i,f=Ni(c,n.rank);f!=null&&(n=n.transpose(f),c=Di(c.length,n.rank));var p=[n],d=le.runKernelFunc((function(w,C){var S=w.max(n,c);return C([a,S]),S}),{x:n},(function(w,C){return wb(w,C[1],C[0],i,f)}),"Max",{axes:c},p,[!0]);if(e){var x=aa(d.shape,i);d=d.reshape(x)}return d}}),wI=oe({mean_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=X(r,"x","mean"),a=cr(t,n.shape),i=Je(kr(n.shape,a)[1]);return Fh((function(c){var f=Ge(i);return{value:(f.dtype===c.dtype?c:c.cast(f.dtype)).div(f).sum(t,e),gradFunc:function(p){var d=c.shape.slice();return a.forEach((function(x){d[x]=1})),p.reshape(d).mul(rl(c.shape,"float32")).div(i)}}}))(n)}}),EI=oe({min_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=X(r,"x","min"),a=n,i=cr(t,n.shape),c=i,f=Ni(c,n.rank);f!=null&&(n=n.transpose(f),c=Di(c.length,n.rank));var p=[n],d=le.runKernelFunc((function(w,C){var S=w.min(n,c);return C([a,S]),S}),{x:n},(function(w,C){return wb(w,C[1],C[0],i,f)}),"Min",{axes:c},p,[!0]);if(e){var x=aa(d.shape,i);d=d.reshape(x)}return d}}),CI=oe({moments_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=cr(t,(r=X(r,"x","moments")).shape),a=r.mean(n,e),i=a.shape;e||(i=aa(a.shape,n));var c=r.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:c.mean(n,e)}}}),Eb=oe({sum_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=X(r,"x","sum");n.dtype==="bool"&&(n=n.toInt());var a=cr(t,n.shape);return Fh((function(i){var c=Ni(a,i.rank),f=a,p=i;c!=null&&(p=i.transpose(c),f=Di(f.length,i.rank));var d=function(S){var R=i.shape.slice();return a.forEach((function(N){R[N]=1})),S.reshape(R).mul(rl(i.shape,"float32"))},x={axes:f},w=le.runKernelFunc((function(S){return S.sum(p,f)}),{x:p},(function(S){return{x:function(){return d(S)}}}),"Sum",x);if(e){var C=aa(w.shape,a);w=w.reshape(C)}return{value:w,gradFunc:d}}))(n)}}),AI=oe({prod_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=X(r,"x","prod");n.dtype==="bool"&&(n=n.toInt());var a=cr(t,n.shape),i=Ni(a,n.rank),c=a,f=n;i!=null&&(f=n.transpose(i),c=Di(c.length,n.rank));var p=le.runKernelFunc((function(x){return x.prod(f,c)}),{permutedX:f});if(e){var d=aa(p.shape,a);p=p.reshape(d)}return p}}),Cb=oe({elu_:function(r){var t=X(r,"x","elu");return le.runKernelFunc((function(e,n){var a=e.elu(t);return n([a]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return le.runKernelFunc((function(i){return i.eluDer(e,a)}),{dy:e,y:a})}}}))}}),SI=oe({leakyRelu_:function(r,t){t===void 0&&(t=.2);var e=X(r,"x","leakyRelu");return E1(Ge(t).mul(e),e)}}),Ab=oe({prelu_:function(r,t){var e=X(r,"x","prelu"),n=X(t,"alpha","prelu");return le.runKernelFunc((function(a,i){var c=a.prelu(e,n);return i([e,n]),c}),{x:e,alpha:n},(function(a,i){var c=i[0],f=i[1],p=c.greater(0);return{x:function(){return Ps(p,a,a.mul(f))},alpha:function(){var d=Ps(p,Ut(a),a.mul(c)),x=ur(f.shape,a.shape);return x.length>0&&(d=d.sum(x)),d.reshape(f.shape)}}}),"Prelu")}}),Tn=oe({relu_:function(r){var t=X(r,"x","relu");return t.dtype==="bool"?t.toInt():le.runKernelFunc((function(e,n){var a=e.relu(t);return n([t]),a}),{x:t},(function(e,n){var a=n[0];return{x:function(){return e.mulStrict(a.step().toFloat())}}}),"Relu")}}),Sb=oe({relu6_:function(r){var t=X(r,"x","relu6");return t.dtype==="bool"?t.toInt():le.runKernelFunc((function(e,n){var a=e.relu6(t);return n([t]),a}),{x:t},(function(e,n){var a=n[0],i=a.lessEqual(6).mul(a.step());return{x:function(){return e.mulStrict(i.toFloat())}}}),"Relu6")}}),_I=oe({selu_:function(r){var t=X(r,"x","selu");return le.runKernelFunc((function(e,n){var a=e.selu(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){var i=a.greater(Ge(0)),c=Ge(y1),f=Ge(b1),p=e.mul(f),d=e.mul(c).mul(a.toFloat().exp());return Ps(i,p,d)}}}))}}),ts=oe({transpose_:function(r,t){var e=X(r,"x","transpose");if(t==null&&(t=e.shape.map((function(a,i){return i})).reverse()),J(e.rank===t.length,(function(){return"Error in transpose: rank of input "+e.rank+" must match length of perm "+t+"."})),t.forEach((function(a){J(a>=0&&a<e.rank,(function(){return"All entries in 'perm' must be between 0 and "+(e.rank-1)+" but got "+t}))})),e.rank<=1)return e.clone();var n={perm:t};return le.runKernelFunc((function(a){return a.transpose(e,t)}),{x:e},(function(a){var i=l1(t);return{x:function(){return a.transpose(i)}}}),"Transpose",n)}}),TI=oe({localResponseNormalization_:function(r,t,e,n,a){t===void 0&&(t=5),e===void 0&&(e=1),n===void 0&&(n=1),a===void 0&&(a=.5);var i=X(r,"x","localResponseNormalization");J(i.rank===4||i.rank===3,(function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."})),J(jn(t),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."}));var c=i,f=!1;i.rank===3&&(f=!0,c=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var p=le.runKernelFunc((function(d,x){var w=d.localResponseNormalization4D(c,t,e,n,a);return x([c,w]),w}),{x4D:c},(function(d,x){var w=x[0],C=x[1];return{x4D:function(){return le.runKernelFunc((function(S){return S.LRNGrad(d,w,C,t,e,n,a)}),{})}}}));return f?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),_b=oe({norm_:function(r,t,e,n){t===void 0&&(t="euclidean"),e===void 0&&(e=null),n===void 0&&(n=!1);var a=(function f(p,d,x){if(x===void 0&&(x=null),p.rank===0)return p.abs();if(p.rank!==1&&x===null)return f(p.reshape([-1]),d,x);if(p.rank===1||typeof x=="number"||Array.isArray(x)&&x.length===1){if(d===1)return p.abs().sum(x);if(d===1/0)return p.abs().max(x);if(d===-1/0)return p.abs().min(x);if(d==="euclidean"||d===2)return p.abs().pow(Ge(2,"int32")).sum(x).sqrt();throw new Error("Error in norm: invalid ord value: "+d)}if(Array.isArray(x)&&x.length===2){if(d===1)return p.abs().sum(x[0]).max(x[1]-1);if(d===1/0)return p.abs().sum(x[1]).max(x[0]);if(d===-1/0)return p.abs().sum(x[1]).min(x[0]);if(d==="fro"||d==="euclidean")return p.square().sum(x).sqrt();throw new Error("Error in norm: invalid ord value: "+d)}throw new Error("Error in norm: invalid axis: "+x)})(r=X(r,"x","norm"),t,e),i=a.shape;if(n){var c=cr(e,r.shape);i=aa(a.shape,c)}return a.reshape(i)}}),II=oe({basicLSTMCell_:function(r,t,e,n,a,i){var c=X(r,"forgetBias","basicLSTMCell"),f=X(t,"lstmKernel","basicLSTMCell"),p=X(e,"lstmBias","basicLSTMCell"),d=X(n,"data","basicLSTMCell"),x=X(a,"c","basicLSTMCell"),w=X(i,"h","basicLSTMCell"),C=d.concat(w,1).matMul(f).add(p),S=C.shape[0],R=C.shape[1]/4,N=[S,R],D=C.slice([0,0],N),M=C.slice([0,R],N),B=C.slice([0,2*R],N),k=C.slice([0,3*R],N),L=D.sigmoid().mulStrict(M.tanh()).addStrict(x.mulStrict(c.add(B).sigmoid())),F=L.tanh().mulStrict(k.sigmoid());return[L,F]}}),RI=oe({multiRNNCell_:function(r,t,e,n){for(var a=X(t,"data","multiRNNCell"),i=vh(e,"c","multiRNNCell"),c=vh(n,"h","multiRNNCell"),f=a,p=[],d=0;d<r.length;d++){var x=r[d](f,i[d],c[d]);p.push(x[0]),p.push(x[1]),f=x[1]}var w=[],C=[];for(d=0;d<p.length;d+=2)w.push(p[d]),C.push(p[d+1]);return[w,C]}}),NI=oe({movingAverage_:function(r,t,e,n,a){a===void 0&&(a=!0);var i=X(r,"v","movingAverage"),c=X(t,"x","movingAverage"),f=X(e,"decay","movingAverage");TA(i,c),J(yr(i.shape,c.shape),(function(){return"Shape mismatch in v and x"}));var p=Ge(1),d=p.sub(f),x=c.sub(i).mul(d);if(a){J(n!=null,(function(){return"When using zeroDebias: true, step is required."}));var w=X(n,"step","movingAverage");x=x.div(p.sub(_h(f,w)))}return i.add(x)}}),DI=oe({stridedSlice_:function(r,t,e,n,a,i,c,f,p){if(a===void 0&&(a=0),i===void 0&&(i=0),c===void 0&&(c=0),f===void 0&&(f=0),p===void 0&&(p=0),n==null&&(n=new Array(t.length)),c!==0)throw new Error("ellipsis mask is not yet supported");var d=X(r,"x","stridedSlice"),x=j2(f),w=d.shape.slice();x.forEach((function(D){t[D]=0,e[D]=1,w.splice(D,0,1)})),d=d.reshape(w);for(var C=0;C<d.rank;C++)t[C]=HS(a,t,n,d.shape,C),e[C]=VS(i,e,n,d.shape,C),n[C]=n[C]||1;var S=j2(p);S.forEach((function(D){e[D]=t[D]+1,n[D]=1}));var R=d1(t,e,n),N=R.filter((function(D,M){return S.indexOf(M)===-1}));return n.every((function(D){return D===1}))?Ti(d,t,R).reshape(N):le.runKernelFunc((function(D){return D.stridedSlice(d,t,e,n)}),{$x:d}).reshape(N)}}),MI=oe({topk_:function(r,t,e){t===void 0&&(t=1),e===void 0&&(e=!0);var n=X(r,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var a=n.shape[n.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var i=le.runKernelFunc((function(c){return c.topk(n,t,e)}),{$x:n});return{values:i[0],indices:i[1]}}}),OI=oe({scatterND_:function(r,t,e){var n=X(r,"indices","scatterND","int32"),a=X(t,"updates","scatterND");return US(a,n,e),le.runKernelFunc((function(i){return i.scatterND(n,a,e)}),{indices:n,updates:a},null,"ScatterNd",{shape:e})}}),_1=oe({fft_:function(r){J(r.dtype==="complex64",(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+r.dtype+"."}));var t=r.shape[r.shape.length-1],e=r.size/t,n=r.as2D(e,t);return le.runKernelFunc((function(a){return a.fft(n)}),{input:r}).reshape(r.shape)}}),Th=oe({ifft_:function(r){J(r.dtype==="complex64",(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+r.dtype+"."}));var t=r.shape[r.shape.length-1],e=r.size/t,n=r.as2D(e,t);return le.runKernelFunc((function(a){return a.ifft(n)}),{input:r}).reshape(r.shape)}}),T1=oe({rfft_:function(r,t){J(r.dtype==="float32",(function(){return"The dtype for rfft() must be real value but got "+r.dtype}));var e,n=r.shape[r.shape.length-1],a=r.size/n;if(t!=null&&t<n){var i=r.shape.map((function(M){return 0})),c=r.shape.map((function(M){return M}));c[r.shape.length-1]=t,e=r.slice(i,c),n=t}else if(t!=null&&t>n){var f=r.shape.map((function(M){return M}));f[r.shape.length-1]=t-n,e=r.concat(yn(f),r.shape.length-1),n=t}else e=r;var p=e.zerosLike(),d=Sr(e,p).as2D(a,n),x=_1(d),w=Math.floor(n/2)+1,C=La(x),S=wi(x),R=C.split([w,n-w],C.shape.length-1),N=S.split([w,n-w],S.shape.length-1),D=e.shape.slice();return D[e.shape.length-1]=w,Sr(R[0],N[0]).reshape(D)}}),Tb=oe({irfft_:function(r){var t=r.shape[r.shape.length-1],e=r.size/t;if(t<=2){var n=r.as2D(e,t),a=Th(n);return La(a)}var i=[e,2*(t-1)],c=La(r).as2D(e,t),f=wi(r).as2D(e,t),p=c.slice([0,1],[e,t-2]).reverse(1),d=f.slice([0,1],[e,t-2]).reverse(1).mul(Ge(-1)),x=c.concat(p,1),w=f.concat(d,1);return n=Sr(x,w).as2D(i[0],i[1]),a=Th(n),La(a)}}),BI=Object.freeze({fft:_1,ifft:Th,rfft:T1,irfft:Tb}),kI=oe({sparseToDense_:function(r,t,e,n){n===void 0&&(n=0);var a=X(r,"sparseIndices","sparseToDense","int32"),i=X(t,"sparseValues","sparseToDense"),c=X(n,"defaultValue","sparseToDense",i.dtype);return(function(f,p,d,x){if(f.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+f.dtype+".");if(f.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+f.shape+".");var w=f.rank>0?f.shape[0]:1,C=f.rank>1?f.shape[1]:1;if(d.length!==C)throw new Error("outputShape has incorrect number of elements:, "+d.length+", should be: "+C+".");var S=p.size;if(p.rank!==0&&(p.rank!==1||S!==w))throw new Error("sparseValues has incorrect shape "+p.shape+", should be [] or ["+w+"]");if(p.dtype!==x.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")})(a,i,e,c),le.runKernelFunc((function(f){return f.sparseToDense(a,i,e,c)}),{$sparseIndices:a,$sparseValues:i,$defaultValue:c})}}),LI=oe({gatherND_:function(r,t){var e=X(t,"indices","gatherND","int32"),n=X(r,"x","gatherND");return le.runKernelFunc((function(a){return a.gatherND(n,e)}),{x:n,indices:e},null,"GatherNd")}}),FI=oe({diag_:function(r){var t=X(r,"x","diag").flatten(),e=r.shape.concat(r.shape);return le.runKernelFunc((function(n){return n.diag(t)}),{$x:t}).reshape(e)}}),PI=oe({dropout_:function(r,t,e,n){var a=X(r,"x","dropout");if(J(a.dtype==="float32",(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."})),J(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got "+t+"."})),t===0)return r instanceof _n?a.clone():a;var i=(function(p,d){if(d==null)return p.shape.slice();if(yr(p.shape,d))return d;if(p.shape.length===d.length){for(var x=[],w=0;w<p.shape.length;w++)d[w]==null&&p.shape[w]!=null?x.push(p.shape[w]):x.push(d[w]);return x}return d})(a,e),c=1-t,f=Ay(i,0,1,"float32",n).add(c).floor().div(c);return a.mul(f)}});function Ib(r,t,e){for(var n=1-r%2,a=new Float32Array(r),i=0;i<r;++i){var c=2*Math.PI*i/(r+n-1);a[i]=t-e*Math.cos(c)}return Zn(a,"float32")}var I1=oe({hannWindow_:function(r){return Ib(r,.5,.5)}}),Rb=oe({hammingWindow_:function(r){return Ib(r,.54,.46)}}),R1=oe({frame_:function(r,t,e,n,a){n===void 0&&(n=!1),a===void 0&&(a=0);for(var i=0,c=[];i+t<=r.size;)c.push(Ti(r,i,t)),i+=e;if(n)for(;i<r.size;){var f=i+t-r.size,p=or([Ti(r,i,t-f),Si([f],a)]);c.push(p),i+=e}return c.length===0?Qo([],[0,t]):or(c).as2D(c.length,t)}}),Nb=oe({stft_:function(r,t,e,n,a){var i;a===void 0&&(a=I1),n==null&&(i=t,n=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var c=R1(r,t,e),f=Ur(c,a(t)),p=[],d=0;d<c.shape[0];d++)p.push(T1(f.slice([d,0],[1,t]),n));return or(p)}}),UI=Object.freeze({hannWindow:I1,hammingWindow:Rb,frame:R1,stft:Nb}),Pr,zI=function(r,t,e){return e===void 0&&(e=1),Ze(this,void 0,void 0,(function(){var n,a,i,c,f,p,d,x,w,C,S,R,N,D;return Qe(this,(function(M){switch(M.label){case 0:return n=X(r,"predictions","inTopK"),a=X(t,"targets","inTopK"),J(n.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+n.rank})),J(n.rank-1===a.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+n.rank+" and targets rank "+a.rank})),Jt(n.shape.slice(0,n.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=n.shape[n.shape.length-1],J(e>0&&e<=i,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+e})),[4,n.data()];case 1:return c=M.sent(),[4,a.data()];case 2:for(f=M.sent(),p=[c.length/i,i],x=p[1],w=fc("bool",d=p[0]),C=0;C<d;C++){for(S=C*x,R=c.subarray(S,S+x),N=[],D=0;D<R.length;D++)N.push({value:R[D],index:D});for(N.sort((function(B,k){return k.value-B.value})),w[C]=0,D=0;D<e;D++)if(N[D].index===f[C]){w[C]=1;break}}return r!==n&&n.dispose(),t!==a&&a.dispose(),[2,Tr(w,a.shape,"bool")]}}))}))};(function(r){r[r.NONE=0]="NONE",r[r.MEAN=1]="MEAN",r[r.SUM=2]="SUM",r[r.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Pr||(Pr={}));var HI=oe({absoluteDifference_:function(r,t,e,n){n===void 0&&(n=Pr.SUM_BY_NONZERO_WEIGHTS);var a=X(r,"labels","absoluteDifference"),i=X(t,"predictions","absoluteDifference"),c=null;e!=null&&(c=X(e,"weights","absoluteDifference")),Jt(a.shape,i.shape,"Error in absoluteDifference: ");var f=a.sub(i).abs();return uo(f,c,n)}}),uo=oe({computeWeightedLoss_:function(r,t,e){e===void 0&&(e=Pr.SUM_BY_NONZERO_WEIGHTS);var n=X(r,"losses","computeWeightedLoss"),a=null;t!=null&&(a=X(t,"weights","computeWeightedLoss"));var i=a==null?n:n.mul(a);if(e===Pr.NONE)return i;if(e===Pr.SUM)return i.sum();if(e===Pr.MEAN){if(a==null)return i.mean();var c=n.size/a.size,f=i.sum().div(a.sum());return c>1?f.div(Ge(c)):f}if(e===Pr.SUM_BY_NONZERO_WEIGHTS){if(a==null)return i.sum().div(Ge(n.size));var p=a.mul(rl(n.shape)).notEqual(Ge(0)).sum().toFloat();return i.sum().div(p)}throw Error("Unknown reduction: "+e)}}),VI=oe({cosineDistance_:function(r,t,e,n,a){a===void 0&&(a=Pr.SUM_BY_NONZERO_WEIGHTS);var i=X(r,"labels","cosineDistance"),c=X(t,"predictions","cosineDistance"),f=null;n!=null&&(f=X(n,"weights","cosineDistance")),Jt(i.shape,c.shape,"Error in cosineDistance: ");var p=Ge(1).sub(i.mul(c).sum(e,!0));return uo(p,f,a)}}),WI=oe({hingeLoss_:function(r,t,e,n){n===void 0&&(n=Pr.SUM_BY_NONZERO_WEIGHTS);var a=X(r,"labels","hingeLoss"),i=X(t,"predictions","hingeLoss"),c=null;e!=null&&(c=X(e,"weights","hingeLoss")),Jt(a.shape,i.shape,"Error in hingeLoss: ");var f=Ge(1);a=Ge(2).mul(a).sub(f);var p=f.sub(a.mul(i)).relu();return uo(p,c,n)}}),GI=oe({huberLoss_:function(r,t,e,n,a){n===void 0&&(n=1),a===void 0&&(a=Pr.SUM_BY_NONZERO_WEIGHTS);var i=X(r,"labels","huberLoss"),c=X(t,"predictions","huberLoss"),f=null;e!=null&&(f=X(e,"weights","huberLoss")),Jt(i.shape,c.shape,"Error in huberLoss: ");var p=Ge(n),d=c.sub(i).abs(),x=lb(d,p),w=d.sub(x),C=Ge(.5).mul(x.square()).add(p.mul(w));return uo(C,f,a)}}),jI=oe({logLoss_:function(r,t,e,n,a){n===void 0&&(n=1e-7),a===void 0&&(a=Pr.SUM_BY_NONZERO_WEIGHTS);var i=X(r,"labels","logLoss"),c=X(t,"predictions","logLoss"),f=null;e!=null&&(f=X(e,"weights","logLoss")),Jt(i.shape,c.shape,"Error in logLoss: ");var p=Ge(1),d=Ge(n),x=i.mul(c.add(d).log()).neg().sub(p.sub(i).mul(p.sub(c).add(d).log()));return uo(x,f,a)}}),XI=oe({meanSquaredError_:function(r,t,e,n){n===void 0&&(n=Pr.SUM_BY_NONZERO_WEIGHTS);var a=X(r,"labels","meanSquaredError"),i=X(t,"predictions","meanSquaredError"),c=null;e!=null&&(c=X(e,"weights","meanSquaredError")),Jt(a.shape,i.shape,"Error in meanSquaredError: ");var f=a.squaredDifference(i);return uo(f,c,n)}}),YI=oe({sigmoidCrossEntropy_:function(r,t,e,n,a){n===void 0&&(n=0),a===void 0&&(a=Pr.SUM_BY_NONZERO_WEIGHTS);var i=X(r,"multiClassLabels","sigmoidCrossEntropy"),c=X(t,"logits","sigmoidCrossEntropy"),f=null;if(e!=null&&(f=X(e,"weights","sigmoidCrossEntropy")),Jt(i.shape,c.shape,"Error in sigmoidCrossEntropy: "),n>0){var p=Ge(n),d=Ge(1),x=Ge(.5);i=i.mul(d.sub(p)).add(x.mul(p))}var w=(function(C,S){var R=X(C,"labels","sigmoidCrossEntropyWithLogits"),N=X(S,"logits","sigmoidCrossEntropyWithLogits");Jt(R.shape,N.shape,"Error in sigmoidCrossEntropyWithLogits: ");var D=N.relu(),M=N.mul(R),B=N.abs().neg().exp().log1p();return D.sub(M).add(B)})(i,c);return uo(w,f,a)}}),qI=oe({softmaxCrossEntropy_:function(r,t,e,n,a){n===void 0&&(n=0),a===void 0&&(a=Pr.SUM_BY_NONZERO_WEIGHTS);var i=X(r,"onehotLabels","softmaxCrossEntropy"),c=X(t,"logits","softmaxCrossEntropy"),f=null;if(e!=null&&(f=X(e,"weights","softmaxCrossEntropy")),Jt(i.shape,c.shape,"Error in softmaxCrossEntropy: "),n>0){var p=Ge(n),d=Ge(1),x=Ge(i.shape[1]);i=i.mul(d.sub(p)).add(p.div(x))}var w=(function(C,S,R){if(R===void 0&&(R=-1),R===-1&&(R=S.rank-1),R!==S.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+S.rank+" and dim was "+R);return Fh((function(N,D,M){var B=D.logSumExp([R],!0),k=D.toFloat().sub(B);return M([N,k]),{value:k.mul(N).neg().sum([R]),gradFunc:function(L,F){var W=F[0],G=F[1],q=aa(L.shape,[R]);return[L.reshape(q).mul(W.toFloat().sub(G.exp())),L.reshape(q).mul(G.exp().sub(W.toFloat()))]}}}))(C,S)})(i,c);return uo(w,f,a)}}),KI=Object.freeze({get Reduction(){return Pr},absoluteDifference:HI,computeWeightedLoss:uo,cosineDistance:VI,hingeLoss:WI,huberLoss:GI,logLoss:jI,meanSquaredError:XI,sigmoidCrossEntropy:YI,softmaxCrossEntropy:qI});function dx(r,t){return t===void 0&&(t=!1),le.tidy((function(){if(r.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+r.shape.length+"D Tensor.");for(var e=r.shape[0],n=r.shape[1],a=Cy(e),i=r.clone(),c=Qo([[1]],[1,1]),f=c.clone(),p=e>=n?n:e,d=function(w){var C,S=i,R=f,N=a;C=le.tidy((function(){var D=i.slice([w,w],[e-w,1]),M=D.norm(),B=i.slice([w,w],[1,1]),k=Qo([[-1]]).where(B.greater(0),Qo([[1]])),L=B.sub(k.mul(M)),F=D.div(L);f=F.shape[0]===1?c.clone():c.concat(F.slice([1,0],[F.shape[0]-1,F.shape[1]]),0);var W=k.matMul(L).div(M).neg(),G=i.slice([w,0],[e-w,n]),q=W.mul(f);if(w===0)i=G.sub(q.matMul(f.transpose().matMul(G)));else{var H=G.sub(q.matMul(f.transpose().matMul(G)));i=i.slice([0,0],[w,n]).concat(H,0)}var Z=a.slice([0,w],[e,a.shape[1]-w]);if(w===0)a=Z.sub(Z.matMul(f).matMul(q.transpose()));else{var ie=Z.sub(Z.matMul(f).matMul(q.transpose()));a=a.slice([0,0],[e,w]).concat(ie,1)}return[f,i,a]})),f=C[0],i=C[1],a=C[2],ra([S,R,N])},x=0;x<p;++x)d(x);return!t&&e>n&&(a=a.slice([0,0],[e,n]),i=i.slice([0,0],[n,n])),[a,i]}))}var ZI=oe({bandPart_:function(r,t,e){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(e%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+e+".");var n=X(r,"a","bandPart");if(n.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+n.rank+".");var a=n.shape,i=n.shape.slice(-2),c=i[0],f=i[1];if(!(t<=c))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+c+").");if(!(e<=f))throw new Error("bandPart(): numUpper ("+e+") must not be greater than the number of columns ("+f+").");t<0&&(t=c),e<0&&(e=f);var p=mh(0,c,1,"int32").reshape([-1,1]),d=mh(0,f,1,"int32"),x=lr(p,d),w=Uh(x.lessEqual(Ge(+t,"int32")),x.greaterEqual(Ge(-e,"int32"))),C=yn([c,f],n.dtype);return Sa(sr(n.reshape([-1,c,f])).map((function(S){return Ps(w,S,C)}))).reshape(a)}}),QI=oe({gramSchmidt_:function(r){var t;if(Array.isArray(r)){t=!1,J(r!=null&&r.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var e=r[0].shape[0],n=function(p){J(r[p].shape[0]===e,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+r[p].shape[0]+" vs. "+e+")"}))},a=1;a<r.length;++a)n(a)}else t=!0,r=f1(r,r.shape[0],0).map((function(p){return _y(p,[0])}));J(r.length<=r[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+r.length+") exceeds number of dimensions ("+r[0].shape[0]+")."}));var i=[],c=r,f=function(p){i.push(le.tidy((function(){var d=c[p];if(p>0)for(var x=0;x<p;++x){var w=Eb(i[x].mulStrict(d)).mul(i[x]);d=d.sub(w)}return d.div(_b(d,"euclidean"))})))};for(a=0;a<r.length;++a)f(a);return t?Sa(i,0):i}}),JI=oe({qr_:function(r,t){if(t===void 0&&(t=!1),r.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+r.rank);if(r.rank===2)return dx(r,t);var e=r.shape.slice(0,r.shape.length-2).reduce((function(c,f){return c*f})),n=sr(r.reshape([e,r.shape[r.shape.length-2],r.shape[r.shape.length-1]]),0),a=[],i=[];return n.forEach((function(c){var f=dx(c,t),p=f[0],d=f[1];a.push(p),i.push(d)})),[Sa(a,0).reshape(r.shape),Sa(i,0).reshape(r.shape)]}}),$I=Object.freeze({bandPart:ZI,gramSchmidt:QI,qr:JI});function Wh(r,t,e,n,a,i){n==null&&(n=.5),a==null&&(a=Number.NEGATIVE_INFINITY),i==null&&(i=0);var c=r.shape[0];return e=Math.min(e,c),J(0<=n&&n<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+n+"'"})),J(r.rank===2,(function(){return"boxes must be a 2D tensor, but was of rank '"+r.rank+"'"})),J(r.shape[1]===4,(function(){return"boxes must have 4 columns, but 2nd dimension was "+r.shape[1]})),J(t.rank===1,(function(){return"scores must be a 1D tensor"})),J(t.shape[0]===c,(function(){return"scores has incompatible shape with boxes. Expected "+c+", but was "+t.shape[0]})),J(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"})),{maxOutputSize:e,iouThreshold:n,scoreThreshold:a,softNmsSigma:i}}var eR=oe({resizeBilinear_:function(r,t,e){e===void 0&&(e=!1);var n=X(r,"images","resizeBilinear");J(n.rank===3||n.rank===4,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+n.rank+"."})),J(t.length===2,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."}));var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var c=t[0],f=t[1],p=le.runKernelFunc((function(d,x){return x([a]),d.resizeBilinear(a,c,f,e)}),{x:a},(function(d,x){return{x:function(){return le.runKernelFunc((function(w){return w.resizeBilinearBackprop(d,x[0],e)}),{})}}}),"ResizeBilinear",{alignCorners:e,newHeight:c,newWidth:f});return i?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),tR=oe({resizeNearestNeighbor_:function(r,t,e){e===void 0&&(e=!1);var n=X(r,"images","resizeNearestNeighbor");J(n.rank===3||n.rank===4,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+n.rank+"."})),J(t.length===2,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."})),J(n.dtype==="float32"||n.dtype==="int32",(function(){return"`images` must have `int32` or `float32` as dtype"}));var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var c=t[0],f=t[1],p=le.runKernelFunc((function(d,x){return x([a]),d.resizeNearestNeighbor(a,c,f,e)}),{batchImages:a},(function(d,x){return{batchImages:function(){return le.runKernelFunc((function(w){return w.resizeNearestNeighborBackprop(d,x[0],e)}),{})}}}));return i?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),nR=oe({nonMaxSuppression_:function(r,t,e,n,a){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY);var i=X(r,"boxes","nonMaxSuppression"),c=X(t,"scores","nonMaxSuppression"),f=Wh(i,c,e,n,a);e=f.maxOutputSize,n=f.iouThreshold,a=f.scoreThreshold;var p={maxOutputSize:e,iouThreshold:n,scoreThreshold:a};return le.runKernelFunc((function(d){return d.nonMaxSuppression(i,c,e,n,a)}),{boxes:i,scores:c},null,"NonMaxSuppressionV3",p)}}),rR=function(r,t,e,n,a){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),Ze(this,void 0,void 0,(function(){var i,c,f,p,d,x,w;return Qe(this,(function(C){switch(C.label){case 0:return i=X(r,"boxes","nonMaxSuppressionAsync"),c=X(t,"scores","nonMaxSuppressionAsync"),f=Wh(i,c,e,n,a),e=f.maxOutputSize,n=f.iouThreshold,a=f.scoreThreshold,[4,Promise.all([i.data(),c.data()])];case 1:return p=C.sent(),d=p[0],x=p[1],w=g1(d,x,e,n,a),i!==r&&i.dispose(),c!==t&&c.dispose(),[2,w]}}))}))},aR=oe({nonMaxSuppressionWithScore_:function(r,t,e,n,a,i){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var c=X(r,"boxes","nonMaxSuppression"),f=X(t,"scores","nonMaxSuppression"),p=Wh(c,f,e,n,a,i),d={maxOutputSize:e=p.maxOutputSize,iouThreshold:n=p.iouThreshold,scoreThreshold:a=p.scoreThreshold,softNmsSigma:i=p.softNmsSigma},x=le.runKernel("NonMaxSuppressionV5",{boxes:c,scores:f},d);return{selectedIndices:x[0],selectedScores:x[1]}}}),iR=function(r,t,e,n,a,i){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),Ze(this,void 0,void 0,(function(){var c,f,p,d,x,w,C;return Qe(this,(function(S){switch(S.label){case 0:return c=X(r,"boxes","nonMaxSuppressionAsync"),f=X(t,"scores","nonMaxSuppressionAsync"),p=Wh(c,f,e,n,a,i),e=p.maxOutputSize,n=p.iouThreshold,a=p.scoreThreshold,i=p.softNmsSigma,[4,Promise.all([c.data(),f.data()])];case 1:return d=S.sent(),x=d[0],w=d[1],C=v1(x,w,e,n,a,i),c!==r&&c.dispose(),f!==t&&f.dispose(),[2,C]}}))}))},oR=oe({cropAndResize_:function(r,t,e,n,a,i){var c=X(r,"image","cropAndResize"),f=X(t,"boxes","cropAndResize","float32"),p=X(e,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var d=f.shape[0];return J(c.rank===4,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+c.rank+"."})),J(f.rank===2&&f.shape[1]===4,(function(){return"Error in cropAndResize: boxes must be have size ["+d+",4] but had shape "+f.shape+"."})),J(p.rank===1&&p.shape[0]===d,(function(){return"Error in cropAndResize: boxInd must be have size ["+d+"] but had shape "+f.shape+"."})),J(n.length===2,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+n.length+"."})),J(n[0]>=1&&n[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+n})),J(a==="bilinear"||a==="nearest",(function(){return"method must be bilinear or nearest, but was "+a})),le.runKernelFunc((function(x,w){return x.cropAndResize(c,f,p,n,a,i)}),{images:c,boxes:f,boxInd:p},null,"CropAndResize",{method:a,extrapolationValue:i,cropSize:n})}}),N1=Object.freeze({resizeBilinear:eR,resizeNearestNeighbor:tR,nonMaxSuppression:nR,nonMaxSuppressionAsync:rR,nonMaxSuppressionWithScore:aR,nonMaxSuppressionWithScoreAsync:iR,cropAndResize:oR}),D1=function(r,t){return!(r>0)||t==="linear"},M1=function(r,t,e){if(e==null||e==="linear")return r;if(e==="relu")return r.mul(t.step());throw new Error("Gradient for activation "+e+" has not been implemented yet.")},O1=function(r,t){var e=t,n=ur(r.shape,t.shape);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},B1=function(r,t,e){if(t==="linear")return r;if(t==="relu")return Tn(r);if(t==="elu")return Cb(r);if(t==="relu6")return Sb(r);if(t==="prelu")return Ab(r,e);throw new Error("Unknown fused activation "+t+".")},sR=oe({fusedMatMul_:function(r){var t,e=r.a,n=r.b,a=r.transposeA,i=a!==void 0&&a,c=r.transposeB,f=c!==void 0&&c,p=r.bias,d=r.activation,x=d===void 0?"linear":d,w=r.preluActivationWeights;if(D1(le.state.gradientDepth,x)===!1){var C=Hh(e,n,i,f);return p!=null&&(C=It(C,p)),B1(C,x,w)}var S=X(e,"a","fused matMul"),R=X(n,"b","fused matMul");t=Rn(S,R),S=t[0],R=t[1];var N=i?S.shape[S.rank-2]:S.shape[S.rank-1],D=f?R.shape[R.rank-1]:R.shape[R.rank-2],M=i?S.shape[S.rank-1]:S.shape[S.rank-2],B=f?R.shape[R.rank-2]:R.shape[R.rank-1],k=S.shape.slice(0,-2),L=R.shape.slice(0,-2),F=Je(k),W=Je(L);J(S.rank>=2&&R.rank>=2&&S.rank===R.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+S.rank+" and "+R.rank+"."})),J(yr(k,L),(function(){return"Error in fused matMul: outer dimensions ("+k+") and ("+L+") of Tensors with shapes "+S.shape+" and "+R.shape+" must match."})),J(N===D,(function(){return"Error in fused matMul: inner shapes ("+N+") and ("+D+") of Tensors with shapes "+S.shape+" and "+R.shape+" and transposeA="+i+" and transposeB="+f+" must match."}));var G,q,H=S.shape.slice(0,-2).concat([M,B]),Z=i?S.as3D(F,N,M):S.as3D(F,M,N),ie=f?R.as3D(W,B,D):R.as3D(W,D,B);p!=null&&Ot(H,(G=Rn(G=X(p,"bias","fused matMul"),S)[0]).shape),w!=null&&(q=X(w,"prelu weights","fused matMul"));var ee={a:Z,b:ie};p!=null&&(ee.bias=G),w!=null&&(ee.preluActivationWeights=q);var me=[Z,ie];return le.runKernelFunc((function(xe,$){var te=xe.fusedBatchMatMul({a:Z,b:ie,transposeA:i,transposeB:f,bias:G,activation:x,preluActivationWeights:q});return $([Z,ie,te]),te}),ee,(function(xe,$){var te=$[0],re=$[1],he=$[2],Se=M1(xe,he,x),Y={};return p!=null&&(Y={bias:function(){return O1(G,Se)}}),Object.assign(i||f?!i&&f?{a:function(){return Se.matMul(re,!1,!1)},b:function(){return Se.matMul(te,!0,!1)}}:i&&!f?{a:function(){return re.matMul(Se,!1,!0)},b:function(){return te.matMul(Se,!1,!1)}}:{a:function(){return re.matMul(Se,!0,!0)},b:function(){return Se.matMul(te,!0,!0)}}:{a:function(){return Se.matMul(re,!1,!0)},b:function(){return te.matMul(Se,!0,!1)}},Y)}),"_FusedMatMul",{transposeA:i,transposeB:f,activation:x},me,[!0]).reshape(H)}}),uR=oe({fusedConv2d_:function(r){var t=r.x,e=r.filter,n=r.strides,a=r.pad,i=r.dataFormat,c=i===void 0?"NHWC":i,f=r.dilations,p=f===void 0?[1,1]:f,d=r.dimRoundingMode,x=r.bias,w=r.activation,C=w===void 0?"linear":w,S=r.preluActivationWeights;if(C=C||"linear",D1(le.state.gradientDepth,C)===!1){var R=Pa(t,e,n,a,c,p,d);return x!=null&&(R=It(R,x)),B1(R,C,S)}var N=X(t,"x","conv2d"),D=X(e,"filter","conv2d"),M=N,B=!1;N.rank===3&&(B=!0,M=N.as4D(1,N.shape[0],N.shape[1],N.shape[2])),J(M.rank===4,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+M.rank+"."})),J(D.rank===4,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+D.rank+"."})),d!=null&&J(jn(a),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+d+" but got pad "+a+"."})),J(M.shape[3]===D.shape[2],(function(){return"Error in conv2d: depth of input ("+M.shape[3]+") must match input depth for filter "+D.shape[2]+"."})),J(ia(n,p),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+p+"'"})),J(c==="NHWC",(function(){return"Error in conv2d: got dataFormat of "+c+" but only NHWC is currently supported."}));var k,L,F=Ws(M.shape,D.shape,n,p,a,d);x!=null&&(k=Rn(k=X(x,"bias","fused conv2d"),N)[0],Ot(F.outShape,k.shape)),S!=null&&(L=X(S,"prelu weights","fused conv2d"));var W={x:M,filter:D};x!=null&&(W.bias=k),S!=null&&(W.preluActivationWeights=L);var G=[D,M],q=le.runKernelFunc((function(H,Z){var ie=H.fusedConv2d({input:M,filter:D,convInfo:F,bias:k,activation:C,preluActivationWeights:L});return Z([D,M,ie]),ie}),W,(function(H,Z){var ie=Z,ee=ie[0],me=ie[1],xe=ie[2],$=M1(H,xe,C);J($u(p),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+p+"'"}));var te={};return x!=null&&(te={bias:function(){return O1(k,$)}}),Object.assign({x:function(){return gb(me.shape,$,ee,n,a)},filter:function(){return A1(me,$,ee.shape,n,a)}},te)}),"FusedConv2D",{convInfo:F,activation:C},G,[!0]);return B?q.as3D(q.shape[1],q.shape[2],q.shape[3]):q}}),lR=oe({fusedDepthwiseConv2d_:function(r){var t=r.x,e=r.filter,n=r.strides,a=r.pad,i=r.dataFormat,c=i===void 0?"NHWC":i,f=r.dilations,p=f===void 0?[1,1]:f,d=r.dimRoundingMode,x=r.bias,w=r.activation,C=w===void 0?"linear":w,S=r.preluActivationWeights;if(D1(le.state.gradientDepth,C)===!1){var R=zh(t,e,n,a,c,p,d);return x!=null&&(R=It(R,x)),B1(R,C,S)}var N=X(t,"x","depthwiseConv2d"),D=X(e,"filter","depthwiseConv2d"),M=N,B=!1;N.rank===3&&(B=!0,M=N.as4D(1,N.shape[0],N.shape[1],N.shape[2])),J(M.rank===4,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+M.rank+"."})),J(D.rank===4,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+D.rank+"."})),J(M.shape[3]===D.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+M.shape[3]+") must match the inChannels dimension in filter "+D.shape[2]+"."})),p==null&&(p=[1,1]),J(ia(n,p),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+p+"'"})),d!=null&&J(jn(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+d+" but got pad "+a+"."}));var k,L,F=Ws(M.shape,D.shape,n,p,a,d,!0);x!=null&&(k=Rn(k=X(x,"bias","fused conv2d"),N)[0],Ot(F.outShape,k.shape)),S!=null&&(L=X(S,"prelu weights","fused depthwiseConv2d"));var W={x:M,filter:D};x!=null&&(W.bias=k),S!=null&&(W.preluActivationWeights=L);var G=[D,M],q=le.runKernelFunc((function(H,Z){var ie=H.fusedDepthwiseConv2D({input:M,filter:D,convInfo:F,bias:k,activation:C,preluActivationWeights:L});return Z([D,M,ie]),ie}),W,(function(H,Z){J($u(p),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+p+"'"}));var ie=Z[0],ee=Z[1],me=Z[2],xe=M1(H,me,C),$={};return x!=null&&($={bias:function(){return O1(k,xe)}}),Object.assign({x:function(){return vb(ee.shape,xe,ie,F)},filter:function(){return mb(ee,xe,ie.shape,F)}},$)}),"FusedDepthwiseConv2D",{convInfo:F,activation:C},G,[!0]);return B?q.as3D(q.shape[1],q.shape[2],q.shape[3]):q}}),cR=Object.freeze({matMul:sR,conv2d:uR,depthwiseConv2d:lR}),fR=Object.freeze({image:N1,linalg:$I,losses:KI,spectral:BI,fused:cR,signal:UI,square:j_,squaredDifference:$y,conv1d:eI,conv2d:Pa,conv3d:tI,depthwiseConv2d:zh,separableConv2d:S1,conv2dTranspose:nI,conv3dTranspose:rI,op:oe,batchNormalization2d:wT,batchNormalization3d:ET,batchNormalization4d:CT,batchNormalization:AT,batchNorm:ib,batchNorm2d:ST,batchNorm3d:_T,batchNorm4d:TT,booleanMaskAsync:$T,complex:Sr,real:La,imag:wi,concat:or,concat1d:cS,concat2d:fS,concat3d:hS,concat4d:dS,split:f1,matMul:Hh,dot:aI,outerProduct:iI,reverse:_c,reverse1d:oI,reverse2d:sI,reverse3d:uI,reverse4d:lI,maxPool:xr,avgPool:Tc,pool:cI,maxPool3d:fI,avgPool3d:hI,slice:Ti,slice1d:dI,slice2d:pI,slice3d:bb,slice4d:gI,abs:X_,acos:Y_,acosh:q_,asin:K_,asinh:Z_,atan:Q_,atanh:J_,ceil:$_,clipByValue:w1,cos:eT,cosh:tT,erf:nT,exp:Gp,expm1:rT,floor:aT,log:iT,log1p:oT,logSigmoid:sT,neg:Sh,reciprocal:uT,round:lT,rsqrt:eb,sigmoid:tb,sign:cT,isNaN:fT,isInf:hT,isFinite:dT,sin:pT,sinh:gT,softplus:vT,sqrt:mT,step:xT,tan:yT,tanh:bT,all:vI,any:mI,argMax:xI,argMin:yI,logSumExp:bI,max:Vh,mean:wI,min:EI,moments:CI,sum:Eb,prod:AI,equal:cb,equalStrict:WT,greater:GT,greaterEqual:fb,greaterEqualStrict:jT,greaterStrict:XT,less:YT,lessEqual:qT,lessEqualStrict:KT,lessStrict:ZT,notEqual:QT,notEqualStrict:JT,add:It,addN:NT,addStrict:DT,atan2:MT,div:Ya,divNoNan:OT,divStrict:BT,floorDiv:ub,maximum:E1,maximumStrict:kT,minimum:lb,minimumStrict:LT,mod:FT,modStrict:PT,mul:Ur,mulStrict:UT,pow:_h,powStrict:zT,squaredDifferenceStrict:HT,sub:lr,subStrict:VT,elu:Cb,leakyRelu:SI,prelu:Ab,relu:Tn,relu6:Sb,selu:_I,logicalAnd:Uh,logicalNot:IT,logicalOr:ob,logicalXor:RT,where:Ps,whereAsync:sb,buffer:yt,print:ES,batchToSpaceND:Ey,broadcastTo:CS,cast:AS,clone:SS,cumsum:_S,depthToSpace:TS,expandDims:ka,eye:Cy,multinomial:IS,oneHot:zp,pad:Vs,pad1d:RS,pad2d:NS,pad3d:DS,pad4d:MS,rand:OS,randomNormal:BS,randomGamma:kS,randomUniform:Ay,reshape:qa,spaceToBatchND:Sy,squeeze:_y,stack:Sa,tile:Wu,truncatedNormal:LS,unstack:sr,setdiff1dAsync:FS,fill:Si,linspace:lS,ones:rl,range:mh,scalar:Ge,tensor:Tr,tensor1d:Zn,tensor2d:Qo,tensor3d:c1,tensor4d:ta,tensor5d:oS,tensor6d:sS,variable:uS,zeros:yn,onesLike:wy,zerosLike:Ut,transpose:ts,softmax:so,logSoftmax:GS,localResponseNormalization:TI,norm:_b,gather:C1,unsortedSegmentSum:hb,basicLSTMCell:II,multiRNNCell:RI,movingAverage:NI,stridedSlice:DI,topk:MI,scatterND:OI,fft:_1,ifft:Th,rfft:T1,irfft:Tb,sparseToDense:kI,gatherND:LI,diag:FI,dropout:PI,hannWindow:I1,hammingWindow:Rb,frame:R1,stft:Nb,inTopKAsync:zI});function ke(r,t){Array.isArray(r)||(r=[r]),r.forEach((function(e){e!=null&&J(e.dtype!=="complex64",(function(){return t+" does not support complex64 tensors."}))}))}function vp(r,t,e,n){if(e==="linear")return r.linear(t);if(e==="relu")return r.relu(t);if(e==="elu")return r.elu(t);if(e==="relu6")return r.relu6(t);if(e==="prelu")return r.prelu(t,n);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}var hR=(function(r){function t(){var e=r.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new Oy(e,le),e}return Za(t,r),t.prototype.write=function(e,n,a){this.firstUse&&(this.firstUse=!1,Re().get("IS_NODE")&&gh(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:e,dtype:a}),i},t.prototype.move=function(e,n,a,i){this.data.set(e,{values:n,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(n){return[2,this.readSync(e)]}))}))},t.prototype.readSync=function(e){var n=this.data.get(e),a=n.dtype,i=n.complexTensors;return a==="complex64"?Wp(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var n=this.readSync(e.dataId),a=n;if(e.dtype==="string")try{a=n.map((function(i){return hh(i)}))}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return yt(e.shape,e.dtype,a)},t.prototype.makeOutput=function(e,n,a){var i=this.write(e,n,a);return le.makeTensorFromDataId(i,n,a,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var n=this.data.get(e).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return Ze(this,void 0,void 0,(function(){var n;return Qe(this,(function(a){return n=yi(),e(),[2,{kernelMs:yi()-n}]}))}))},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,n){var a=this.makeOutput(null,e.shape,"complex64");return this.data.get(a.dataId).complexTensors={real:le.keep(e.clone()),imag:le.keep(n.clone())},a},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,n,a){if(ke(e,"slice"),Dy(e.shape,n,a)){var i=My(n,e.strides),c=Je(a);return Tr(this.readSync(e.dataId).subarray(i,i+c),a,e.dtype)}for(var f=yt(a,e.dtype),p=this.bufferSync(e),d=0;d<f.size;++d){var x=f.indexToLoc(d).map((function(w,C){return w+n[C]}));f.values[d]=p.get.apply(p,x)}return f.toTensor()},t.prototype.stridedSlice=function(e,n,a,i){ke(e,"stridedSlice");var c=d1(n,a,i);if(c.some((function(S){return S===0})))return Tr([],c);for(var f=yt(c,e.dtype),p=this.bufferSync(e),d=0;d<f.size;d++){for(var x=f.indexToLoc(d),w=new Array(x.length),C=0;C<w.length;C++)w[C]=x[C]*i[C]+n[C];f.set.apply(f,[p.get.apply(p,w)].concat(x))}return f.toTensor()},t.prototype.diag=function(e){for(var n=this.readSync(e.dataId),a=yt([e.size,e.size],e.dtype),i=a.values,c=0;c<n.length;c++)i[c*e.size+c]=n[c];return a.toTensor()},t.prototype.unstack=function(e,n){for(var a=e.shape[n],i=new Array(e.rank-1),c=0,f=0;f<e.rank;f++)f!==n&&(i[c++]=e.shape[f]);var p=new Array(e.rank).fill(0),d=e.shape.slice();d[n]=1;var x=new Array(a);for(f=0;f<x.length;f++)p[n]=f,x[f]=this.slice(e,p,d).reshape(i);return x},t.prototype.reverse=function(e,n){ke(e,"reverse");for(var a=yt(e.shape,e.dtype),i=this.bufferSync(e),c=function(p){var d=a.indexToLoc(p),x=d.slice();n.forEach((function(w){return x[w]=e.shape[w]-1-x[w]})),a.set.apply(a,[i.get.apply(i,x)].concat(d))},f=0;f<a.size;f++)c(f);return a.toTensor()},t.prototype.concat=function(e,n){var a=this;if(e[0].dtype==="complex64"){var i=e.map((function(S){return La(S)})),c=e.map((function(S){return wi(S)}));return Sr(this.concat(i,n),this.concat(c,n))}var f=e.map((function(S){var R=Je(S.shape.slice(n));return S.as2D(-1,R)})),p=Ju(f.map((function(S){return S.shape})),1),d=yt(p,e[0].dtype).values;if(f[0].shape[0]===1){var x=0;f.forEach((function(S){d.set(a.readSync(S.dataId),x),x+=S.size}))}else{var w=0;f.forEach((function(S){for(var R=a.readSync(S.dataId),N=0,D=0;D<S.shape[0];++D)for(var M=D*p[1]+w,B=0;B<S.shape[1];++B)d[M+B]=R[N++];w+=S.shape[1]}))}var C=Ju(e.map((function(S){return S.shape})),n);return Tr(d,C,e[0].dtype)},t.prototype.neg=function(e){return ke(e,"neg"),this.multiply(Ge(-1),e)},t.prototype.add=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),(function(a,i,c,f){return{real:a+c,imag:i+f}})):this.broadcastedBinaryOp(e,n,_r(e.dtype,n.dtype),(function(a,i){return a+i}))},t.prototype.addN=function(e){var n=this;ke(e,"addN");for(var a=e.map((function(x){return n.readSync(x.dataId)})),i=yt(e[0].shape,e[0].dtype),c=i.values,f=0;f<e.length;f++)for(var p=a[f],d=0;d<c.length;d++)c[d]+=p[d];return i.toTensor()},t.prototype.softmax=function(e,n){var a=cr([n],e.shape),i=this.max(e,a),c=aa(i.shape,a),f=this.subtract(e,i.reshape(c)),p=this.exp(f),d=this.sum(p,a).reshape(c);return this.realDivide(p,d)},t.prototype.subtract=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),(function(a,i,c,f){return{real:a-c,imag:i-f}})):this.broadcastedBinaryOp(e,n,_r(e.dtype,n.dtype),(function(a,i){return a-i}))},t.prototype.pow=function(e,n){return ke([e,n],"pow"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,i){return Math.pow(a,i)}))},t.prototype.batchMatMul=function(e,n,a,i){ke([e,n],"matMul");for(var c=a?e.shape[1]:e.shape[2],f=a?e.shape[2]:e.shape[1],p=i?n.shape[1]:n.shape[2],d=e.shape[0],x=this.readSync(e.dataId),w=this.readSync(n.dataId),C=a?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],S=C[0],R=C[1],N=C[2],D=i?[1,n.strides[1],n.strides[0]]:[n.strides[1],1,n.strides[0]],M=D[0],B=D[1],k=D[2],L=f*p,F=yt([d,f,p],e.dtype),W=F.values,G=this.blockSize,q=0;q<d;q++)for(var H=0;H<f;H+=G)for(var Z=0;Z<p;Z+=G)for(var ie=0;ie<c;ie+=G)for(var ee=Math.min(H+G,f),me=Math.min(Z+G,p),xe=Math.min(ie+G,c),$=H;$<ee;$++)for(var te=Z;te<me;te++){for(var re=0,he=ie;he<xe;he++)re+=x[q*S+$*R+he*N]*w[he*M+te*B+q*k];W[q*L+($*p+te)]+=re}return F.toTensor()},t.prototype.fusedBatchMatMul=function(e){var n=e.a,a=e.b,i=e.transposeA,c=e.transposeB,f=e.bias,p=e.activation,d=e.preluActivationWeights,x=this.batchMatMul(n,a,i,c);return f&&(x=this.add(x,f)),p&&(x=vp(this,x,p,d)),x},t.prototype.multiply=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),(function(a,i,c,f){return{real:a*c-i*f,imag:a*f+i*c}})):this.broadcastedBinaryOp(e,n,_r(e.dtype,n.dtype),(function(a,i){return a*i}))},t.prototype.realDivide=function(e,n){return ke([e,n],"realDivide"),this.broadcastedBinaryOp(e,n,"float32",(function(a,i){return a/i}))},t.prototype.floorDiv=function(e,n){return ke([e,n],"floorDiv"),this.broadcastedBinaryOp(e,n,"int32",(function(a,i){return Math.floor(a/i)}))},t.prototype.sum=function(e,n){ke(e,"sum"),xa("sum",n,e.rank);for(var a=kr(e.shape,n),i=a[0],c=a[1],f=yn(i,_r(e.dtype,"int32")),p=Je(c),d=this.readSync(f.dataId),x=this.readSync(e.dataId),w=0;w<d.length;++w){for(var C=w*p,S=0,R=0;R<p;++R)S+=x[C+R];d[w]=S}return f},t.prototype.prod=function(e,n){ke(e,"sum");for(var a=kr(e.shape,n),i=a[0],c=a[1],f=yn(i,_r(e.dtype,"int32")),p=Je(c),d=this.readSync(f.dataId),x=this.readSync(e.dataId),w=0;w<d.length;++w){for(var C=w*p,S=1,R=0;R<p;++R)S*=x[C+R];d[w]=S}return f},t.prototype.unsortedSegmentSum=function(e,n,a){ke(e,"unsortedSegmentSum");for(var i=[],c=e.rank-n.rank,f=0;f<c;++f)n=n.expandDims(f+1);for(f=0;f<a;++f){var p=Ge(f,"int32"),d=cb(p,n).asType("float32").mul(e).sum(0);i.push(d)}return Sa(i)},t.prototype.argMin=function(e,n){ke(e,"argMin");var a=[n];xa("argMin",a,e.rank);for(var i=kr(e.shape,a),c=i[0],f=i[1],p=yn(c,"int32"),d=Je(f),x=this.readSync(p.dataId),w=this.readSync(e.dataId),C=0;C<x.length;++C){for(var S=C*d,R=w[S],N=0,D=0;D<d;++D){var M=w[S+D];M<R&&(R=M,N=D)}x[C]=N}return p},t.prototype.argMax=function(e,n){ke(e,"argMax");var a=[n];xa("argMax",a,e.rank);for(var i=kr(e.shape,a),c=i[0],f=i[1],p=yn(c,"int32"),d=Je(f),x=this.readSync(p.dataId),w=this.readSync(e.dataId),C=0;C<x.length;++C){for(var S=C*d,R=w[S],N=0,D=0;D<d;++D){var M=w[S+D];M>R&&(R=M,N=D)}x[C]=N}return p},t.prototype.cumsum=function(e,n,a,i){if(ke(e,"cumsum"),n!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+n);for(var c=_r(e.dtype,"int32"),f=yn(e.shape,c),p=this.readSync(f.dataId),d=this.readSync(e.dataId),x=e.shape[e.rank-1],w=i?function(D,M){return D+x-M-1}:function(D,M){return D+M},C=0;C<d.length;C+=x)for(var S=0;S<x;S++){var R=w(C,S);if(S===0)p[R]=a?0:d[R];else{var N=w(C,S-1);p[R]=a?d[N]+p[N]:d[R]+p[N]}}return f},t.prototype.equal=function(e,n){return ke([e,n],"equal"),this.broadcastedBinaryOp(e,n,"bool",(function(a,i){return a===i?1:0}))},t.prototype.notEqual=function(e,n){return ke([e,n],"notEqual"),this.broadcastedBinaryOp(e,n,"bool",(function(a,i){return a!==i?1:0}))},t.prototype.less=function(e,n){return ke([e,n],"less"),this.broadcastedBinaryOp(e,n,"bool",(function(a,i){return a<i?1:0}))},t.prototype.lessEqual=function(e,n){return ke([e,n],"lessEqual"),this.broadcastedBinaryOp(e,n,"bool",(function(a,i){return a<=i?1:0}))},t.prototype.greater=function(e,n){return ke([e,n],"greater"),this.broadcastedBinaryOp(e,n,"bool",(function(a,i){return a>i?1:0}))},t.prototype.greaterEqual=function(e,n){return ke([e,n],"greaterEqual"),this.broadcastedBinaryOp(e,n,"bool",(function(a,i){return a>=i?1:0}))},t.prototype.logicalNot=function(e){ke(e,"logicalNot");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)a[i]=n[i]?0:1;return this.makeOutput(a,e.shape,"bool")},t.prototype.logicalAnd=function(e,n){return ke([e,n],"logicalAnd"),this.broadcastedBinaryOp(e,n,"bool",(function(a,i){return a&&i}))},t.prototype.logicalOr=function(e,n){return ke([e,n],"logicalOr"),this.broadcastedBinaryOp(e,n,"bool",(function(a,i){return a||i}))},t.prototype.select=function(e,n,a){ke([e,n,a],"select");for(var i=this.readSync(e.dataId),c=this.readSync(n.dataId),f=this.readSync(a.dataId),p=yn(n.shape,_r(n.dtype,a.dtype)),d=this.readSync(p.dataId),x=0,w=e.rank===0||e.rank>1||n.rank===1?1:Je(n.shape.slice(1)),C=0;C<i.length;C++)for(var S=0;S<w;S++)i[C]===1?d[x++]=c[C]:d[x++]=f[C];return p},t.prototype.where=function(e){ke([e],"where");var n=this.readSync(e.dataId);return m1(e.shape,n)},t.prototype.topk=function(e,n,a){return ke(e,"topk"),Hy(this.readSync(e.dataId),e.shape,e.dtype,n)},t.prototype.min=function(e,n){ke(e,"min"),xa("min",n,e.rank);for(var a=kr(e.shape,n),i=a[0],c=a[1],f=yn(i,e.dtype),p=Je(c),d=this.readSync(f.dataId),x=this.readSync(e.dataId),w=0;w<d.length;++w){for(var C=w*p,S=x[C],R=0;R<p;++R){var N=x[C+R];N<S&&(S=N)}d[w]=S}return f},t.prototype.minimum=function(e,n){return ke([e,n],"minimum"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,i){return Math.min(a,i)}))},t.prototype.mod=function(e,n){return ke([e,n],"mod"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,i){var c=a%i;return a<0&&i<0||a>=0&&i>=0?c:(c+i)%i}))},t.prototype.max=function(e,n){ke(e,"max"),xa("max",n,e.rank);for(var a=kr(e.shape,n),i=a[0],c=a[1],f=yn(i,e.dtype),p=Je(c),d=this.readSync(f.dataId),x=this.readSync(e.dataId),w=0;w<d.length;++w){for(var C=w*p,S=x[C],R=0;R<p;++R){var N=x[C+R];N>S&&(S=N)}d[w]=S}return f},t.prototype.maximum=function(e,n){return ke([e,n],"maximum"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,i){return Math.max(a,i)}))},t.prototype.all=function(e,n){ke(e,"all"),xa("all",n,e.rank);for(var a=kr(e.shape,n),i=a[0],c=a[1],f=yn(i,e.dtype),p=Je(c),d=this.readSync(f.dataId),x=this.readSync(e.dataId),w=0;w<d.length;++w){for(var C=w*p,S=x[C],R=0;R<p;++R){var N=x[C+R];S=S&&N}d[w]=S}return f},t.prototype.any=function(e,n){ke(e,"any"),xa("any",n,e.rank);for(var a=kr(e.shape,n),i=a[0],c=a[1],f=yn(i,e.dtype),p=Je(c),d=this.readSync(f.dataId),x=this.readSync(e.dataId),w=0;w<d.length;++w){for(var C=w*p,S=x[C],R=0;R<p;++R){var N=x[C+R];S=S||N}d[w]=S}return f},t.prototype.squaredDifference=function(e,n){return ke([e,n],"squaredDifference"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,i){var c=a-i;return c*c}))},t.prototype.ceil=function(e){ke(e,"ceil");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.ceil(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.floor=function(e){ke(e,"floor");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.floor(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.sign=function(e){ke(e,"x");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)n[i]<0?a[i]=-1:n[i]>0?a[i]=1:a[i]=0;return this.makeOutput(a,e.shape,"float32")},t.prototype.isNaN=function(e){ke(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isNaN(n[i])&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isInf=function(e){ke(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Math.abs(n[i])===1/0&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isFinite=function(e){ke(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isFinite(n[i])&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.round=function(e){ke(e,"round");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var c=Math.floor(n[i]);n[i]-c<.5?a[i]=Math.floor(n[i]):n[i]-c>.5?a[i]=Math.ceil(n[i]):a[i]=c%2==0?c:c+1}return this.makeOutput(a,e.shape,"float32")},t.prototype.exp=function(e){ke(e,"exp");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.exp(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.expm1=function(e){ke(e,"expm1");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.expm1(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.log=function(e){ke(e,"log");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var c=n[i];a[i]=Math.log(c)}return this.makeOutput(a,e.shape,"float32")},t.prototype.log1p=function(e){ke(e,"log1p");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var c=n[i];a[i]=Math.log1p(c)}return this.makeOutput(a,e.shape,"float32")},t.prototype.sqrt=function(e){ke(e,"sqrt");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var c=n[i];a[i]=Math.sqrt(c)}return this.makeOutput(a,e.shape,"float32")},t.prototype.rsqrt=function(e){ke(e,"rsqrt");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var c=n[i];a[i]=1/Math.sqrt(c)}return this.makeOutput(a,e.shape,"float32")},t.prototype.reciprocal=function(e){ke(e,"reciprocal");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=1/n[i];return this.makeOutput(a,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){ke(e,"relu");for(var n=yn(e.shape,e.dtype),a=this.readSync(n.dataId),i=this.readSync(e.dataId),c=0;c<i.length;++c)a[c]=Math.max(0,i[c]);return n},t.prototype.relu6=function(e){ke(e,"relu");for(var n=yn(e.shape,e.dtype),a=this.readSync(n.dataId),i=this.readSync(e.dataId),c=0;c<i.length;++c)a[c]=Math.min(Math.max(0,i[c]),6);return n},t.prototype.prelu=function(e,n){return ke([e,n],"prelu"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,i){return a<0?i*a:a}))},t.prototype.elu=function(e){ke(e,"elu");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var c=a[i];n[i]=c>=0?c:Math.exp(c)-1}return this.makeOutput(n,e.shape,"float32")},t.prototype.eluDer=function(e,n){ke([e,n],"eluDer");for(var a=new Float32Array(n.size),i=this.readSync(n.dataId),c=this.readSync(e.dataId),f=0;f<i.length;++f){var p=i[f];a[f]=p>=1?c[f]:c[f]*(p+1)}return this.makeOutput(a,n.shape,"float32")},t.prototype.selu=function(e){ke(e,"selu");for(var n=y1,a=b1,i=new Float32Array(e.size),c=this.readSync(e.dataId),f=0;f<c.length;++f){var p=c[f];i[f]=p>=0?a*p:n*(Math.exp(p)-1)}return this.makeOutput(i,e.shape,"float32")},t.prototype.clip=function(e,n,a){ke(e,"clip");for(var i=new Float32Array(e.size),c=this.readSync(e.dataId),f=0;f<c.length;++f){var p=c[f];i[f]=p>a?a:p<n?n:p}return this.makeOutput(i,e.shape,"float32")},t.prototype.abs=function(e){for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.abs(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<e.size;++i){var c=a[2*i],f=a[2*i+1];n[i]=Math.hypot(c,f)}return this.makeOutput(n,e.shape,"float32")},t.prototype.int=function(e){ke(e,"int");for(var n=new Int32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=a[i];return this.makeOutput(n,e.shape,"int32")},t.prototype.sigmoid=function(e){ke(e,"sigmoid");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=1/(1+Math.exp(-a[i]));return this.makeOutput(n,e.shape,"float32")},t.prototype.softplus=function(e){ke(e,"softplus");for(var n=Math.log(11920928955078125e-23)+2,a=new Float32Array(e.size),i=this.readSync(e.dataId),c=0;c<i.length;++c){var f=i[c]>-n,p=i[c]<n,d=Math.exp(i[c]),x=void 0;x=p?d:f?i[c]:Math.log(1+d),a[c]=x}return this.makeOutput(a,e.shape,"float32")},t.prototype.sin=function(e){ke(e,"sin");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.sin(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.cos=function(e){ke(e,"cos");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.cos(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.tan=function(e){ke(e,"tan");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.tan(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.asin=function(e){ke(e,"asin");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.asin(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.acos=function(e){ke(e,"acos");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.acos(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atan=function(e){ke(e,"atan");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.atan(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atan2=function(e,n){return ke([e,n],"atan2"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,i){return Math.atan2(a,i)}))},t.prototype.sinh=function(e){ke(e,"sinh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.sinh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.cosh=function(e){ke(e,"cosh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.cosh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.tanh=function(e){ke(e,"tanh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=dA(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.asinh=function(e){ke(e,"asinh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.asinh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.acosh=function(e){ke(e,"acosh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.acosh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atanh=function(e){ke(e,"atanh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.atanh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.erf=function(e){ke(e,"erf");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var c=Math.sign(a[i]),f=Math.abs(a[i]),p=1/(1+.3275911*f);n[i]=c*(1-((((1.061405429*p-1.453152027)*p+1.421413741)*p-.284496736)*p+.254829592)*p*Math.exp(-f*f))}return this.makeOutput(n,e.shape,"float32")},t.prototype.step=function(e,n){n===void 0&&(n=0),ke(e,"step");for(var a=new Float32Array(e.size),i=this.readSync(e.dataId),c=0;c<i.length;++c){var f=i[c];isNaN(f)?a[c]=NaN:a[c]=f>0?1:n}return this.makeOutput(a,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var n=e.input,a=e.filter,i=e.convInfo,c=e.bias,f=e.activation,p=e.preluActivationWeights,d=this.conv2d(n,a,i);return c&&(d=this.add(d,c)),f&&(d=vp(this,d,f,p)),d},t.prototype.conv2d=function(e,n,a){ke([e,n],"conv2d");for(var i=a.filterHeight,c=a.filterWidth,f=a.dilationHeight,p=a.dilationWidth,d=a.padInfo.left,x=a.padInfo.top,w=a.dataFormat==="channelsLast",C=yt(a.outShape,e.dtype),S=e.strides[0],R=w?e.strides[1]:e.strides[2],N=w?e.strides[2]:1,D=w?1:e.strides[1],M=C.strides[0],B=w?C.strides[1]:C.strides[2],k=w?C.strides[2]:1,L=w?1:C.strides[1],F=this.readSync(e.dataId),W=this.readSync(n.dataId),G=C.values,q=0;q<a.batchSize;++q)for(var H=q*S,Z=q*M,ie=0;ie<a.outHeight;++ie)for(var ee=Z+ie*B,me=ie*a.strideHeight-x,xe=0;xe<i;xe++){var $=me+xe*f;if(!($<0||$>=a.inHeight))for(var te=xe*n.strides[0],re=H+$*R,he=0;he<a.outWidth;++he)for(var Se=ee+he*k,Y=he*a.strideWidth-d,fe=0;fe<c;fe++){var Ae=Y+fe*p;if(!(Ae<0||Ae>=a.inWidth))for(var Te=re+Ae*N,Le=te+fe*n.strides[1],Ve=0;Ve<a.inChannels;++Ve){for(var Ie=F[Te+Ve*D],ut=0;ut<a.outChannels;++ut)G[Se+ut*L]+=Ie*W[Le+ut];Le+=a.outChannels}}}return C.toTensor()},t.prototype.conv3d=function(e,n,a){for(var i=a.filterDepth,c=a.filterHeight,f=a.filterWidth,p=a.dilationDepth,d=a.dilationHeight,x=a.dilationWidth,w=a.padInfo.front,C=a.padInfo.left,S=a.padInfo.top,R=yt(a.outShape,e.dtype),N=this.readSync(e.dataId),D=this.readSync(n.dataId),M=R.values,B=0;B<a.batchSize;++B)for(var k=B*e.strides[0],L=B*R.strides[0],F=0;F<a.outDepth;++F)for(var W=L+F*R.strides[1],G=F*a.strideDepth-w,q=0;q<i;q++){var H=G+q*p;if(!(H<0||H>=a.inDepth))for(var Z=q*n.strides[0],ie=k+H*e.strides[1],ee=0;ee<a.outHeight;++ee)for(var me=W+ee*R.strides[2],xe=ee*a.strideHeight-S,$=0;$<c;$++){var te=xe+$*d;if(!(te<0||te>=a.inHeight))for(var re=Z+$*n.strides[1],he=ie+te*e.strides[2],Se=0;Se<a.outWidth;++Se)for(var Y=me+Se*a.outChannels,fe=Se*a.strideWidth-C,Ae=0;Ae<f;Ae++){var Te=fe+Ae*x;if(!(Te<0||Te>=a.inWidth))for(var Le=re+Ae*n.strides[2],Ve=he+Te*a.inChannels,Ie=Le,ut=0;ut<a.inChannels;++ut){for(var He=N[Ve+ut],ht=0;ht<a.outChannels;++ht)M[Y+ht]+=He*D[Ie+ht];Ie+=a.outChannels}}}}return R.toTensor()},t.prototype.conv2dDerInput=function(e,n,a){ke([e,n],"conv2dDerInput");for(var i=yt(a.inShape,"float32"),c=i.values,f=this.readSync(e.dataId),p=this.readSync(n.dataId),d=n.strides,x=d[0],w=d[1],C=d[2],S=a.batchSize,R=a.filterHeight,N=a.filterWidth,D=a.inChannels,M=a.inHeight,B=a.inWidth,k=a.outChannels,L=a.outHeight,F=a.outWidth,W=a.strideHeight,G=a.strideWidth,q=a.dataFormat,H=R-1-a.padInfo.top,Z=N-1-a.padInfo.left,ie=q==="channelsLast",ee=i.strides[0],me=ie?i.strides[1]:i.strides[2],xe=ie?i.strides[2]:1,$=ie?1:i.strides[1],te=e.strides[0],re=ie?e.strides[1]:e.strides[2],he=ie?e.strides[2]:1,Se=ie?1:e.strides[1],Y=0;Y<S;++Y)for(var fe=0;fe<D;++fe)for(var Ae=0;Ae<M;++Ae)for(var Te=Ae-H,Le=Math.max(0,Math.ceil(Te/W)),Ve=Math.min(L,(R+Te)/W),Ie=0;Ie<B;++Ie){for(var ut=Ie-Z,He=Math.max(0,Math.ceil(ut/G)),ht=Math.min(F,(N+ut)/G),jt=0,it=Le;it<Ve;++it)for(var Rt=it*W-Te,Ye=He;Ye<ht;++Ye)for(var zt=te*Y+re*it+he*Ye,Bt=x*(R-1-Rt)+w*(N-1-(Ye*G-ut))+C*fe,Xt=0;Xt<k;++Xt)jt+=f[zt+Se*Xt]*p[Bt+Xt];c[ee*Y+me*Ae+xe*Ie+$*fe]=jt}return i.toTensor()},t.prototype.conv3dDerInput=function(e,n,a){for(var i=yt(a.inShape,"float32"),c=i.values,f=i.strides,p=f[0],d=f[1],x=f[2],w=f[3],C=this.readSync(e.dataId),S=e.strides,R=S[0],N=S[1],D=S[2],M=S[3],B=this.readSync(n.dataId),k=n.strides,L=k[0],F=k[1],W=k[2],G=k[3],q=a.batchSize,H=a.filterDepth,Z=a.filterHeight,ie=a.filterWidth,ee=a.inChannels,me=a.inDepth,xe=a.inHeight,$=a.inWidth,te=a.outChannels,re=a.outDepth,he=a.outHeight,Se=a.outWidth,Y=a.strideDepth,fe=a.strideHeight,Ae=a.strideWidth,Te=H-1-a.padInfo.front,Le=Z-1-a.padInfo.top,Ve=ie-1-a.padInfo.left,Ie=0;Ie<q;++Ie)for(var ut=0;ut<ee;++ut)for(var He=0;He<me;++He)for(var ht=He-Te,jt=Math.max(0,Math.ceil(ht/Y)),it=Math.min(re,(H+ht)/Y),Rt=0;Rt<xe;++Rt)for(var Ye=Rt-Le,zt=Math.max(0,Math.ceil(Ye/fe)),Bt=Math.min(he,(Z+Ye)/fe),Xt=0;Xt<$;++Xt){for(var Ct=Xt-Ve,At=Math.max(0,Math.ceil(Ct/Ae)),ct=Math.min(Se,(ie+Ct)/Ae),Yr=0,We=jt;We<it;++We)for(var Hr=We*Y-ht,Vr=zt;Vr<Bt;++Vr)for(var fr=Vr*fe-Ye,Wr=At;Wr<ct;++Wr)for(var Pn=R*Ie+N*We+D*Vr+M*Wr,Cn=L*(H-1-Hr)+F*(Z-1-fr)+W*(ie-1-(Wr*Ae-Ct))+G*ut,sn=0;sn<te;++sn)Yr+=C[Pn+sn]*B[Cn+sn];c[p*Ie+d*He+x*Rt+w*Xt+ut]=Yr}return i.toTensor()},t.prototype.conv2dDerFilter=function(e,n,a){ke([e,n],"conv2dDerFilter");for(var i=a.strideHeight,c=a.strideWidth,f=a.filterHeight,p=a.filterWidth,d=a.dataFormat==="channelsLast",x=yt(a.filterShape,"float32"),w=a.padInfo.left,C=a.padInfo.top,S=this.bufferSync(e),R=this.bufferSync(n),N=0;N<f;++N)for(var D=Math.max(0,Math.ceil((C-N)/i)),M=Math.min(a.outHeight,(a.inHeight+C-N)/i),B=0;B<p;++B)for(var k=Math.max(0,Math.ceil((w-B)/c)),L=Math.min(a.outWidth,(a.inWidth+w-B)/c),F=0;F<a.inChannels;++F)for(var W=0;W<a.outChannels;++W){for(var G=0,q=0;q<a.batchSize;++q)for(var H=D;H<M;++H)for(var Z=N+H*i-C,ie=k;ie<L;++ie){var ee=B+ie*c-w;G+=d?S.get(q,Z,ee,F)*R.get(q,H,ie,W):S.get(q,F,Z,ee)*R.get(q,W,H,ie)}x.set(G,N,B,F,W)}return x.toTensor()},t.prototype.conv3dDerFilter=function(e,n,a){for(var i=a.strideDepth,c=a.strideHeight,f=a.strideWidth,p=a.filterDepth,d=a.filterHeight,x=a.filterWidth,w=yt(a.filterShape,"float32"),C=w.values,S=w.strides,R=S[0],N=S[1],D=S[2],M=S[3],B=this.readSync(n.dataId),k=n.strides,L=k[0],F=k[1],W=k[2],G=k[3],q=this.readSync(e.dataId),H=e.strides,Z=H[0],ie=H[1],ee=H[2],me=H[3],xe=a.padInfo.front,$=a.padInfo.left,te=a.padInfo.top,re=0;re<p;++re)for(var he=Math.max(0,Math.ceil((xe-re)/i)),Se=Math.min(a.outDepth,(a.inDepth+xe-re)/i),Y=re*R,fe=0;fe<d;++fe)for(var Ae=Math.max(0,Math.ceil((te-fe)/c)),Te=Math.min(a.outHeight,(a.inHeight+te-fe)/c),Le=fe*N+Y,Ve=0;Ve<x;++Ve)for(var Ie=Math.max(0,Math.ceil(($-Ve)/f)),ut=Math.min(a.outWidth,(a.inWidth+$-Ve)/f),He=Ve*D+Le,ht=0;ht<a.inChannels;++ht)for(var jt=ht*M+He,it=0;it<a.outChannels;++it){for(var Rt=0,Ye=0;Ye<a.batchSize;++Ye)for(var zt=Ye*Z,Bt=Ye*L,Xt=he;Xt<Se;++Xt)for(var Ct=(re+Xt*i-xe)*ie+zt,At=Xt*F+Bt,ct=Ae;ct<Te;++ct)for(var Yr=(fe+ct*c-te)*ee+Ct,We=ct*W+At,Hr=Ie;Hr<ut;++Hr){var Vr=Hr*G+We;Rt+=q[(Ve+Hr*f-$)*me+Yr+ht]*B[Vr+it]}C[jt+it]=Rt}return w.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var n=e.input,a=e.filter,i=e.convInfo,c=e.bias,f=e.activation,p=e.preluActivationWeights,d=this.depthwiseConv2D(n,a,i);return c&&(d=this.add(d,c)),f&&(d=vp(this,d,f,p)),d},t.prototype.depthwiseConv2D=function(e,n,a){ke([e,n],"depthwiseConv2D");for(var i=a.filterHeight,c=a.filterWidth,f=a.dilationHeight,p=a.dilationWidth,d=a.padInfo.left,x=a.padInfo.top,w=a.outChannels/a.inChannels,C=yt(a.outShape,e.dtype),S=this.readSync(e.dataId),R=this.readSync(n.dataId),N=C.values,D=0;D<a.batchSize;++D)for(var M=D*e.strides[0],B=D*C.strides[0],k=0;k<a.outHeight;++k)for(var L=B+k*C.strides[1],F=k*a.strideHeight-d,W=0;W<i;++W){var G=F+W*f;if(!(G<0||G>=a.inHeight))for(var q=W*n.strides[0],H=M+G*e.strides[1],Z=0;Z<a.outWidth;++Z)for(var ie=L+Z*C.strides[2],ee=Z*a.strideWidth-x,me=0;me<c;++me){var xe=ee+me*p;if(!(xe<0||xe>=a.inWidth))for(var $=q+me*n.strides[1],te=H+xe*a.inChannels,re=ie,he=$,Se=0;Se<a.inChannels;++Se){for(var Y=S[te+Se],fe=0;fe<w;++fe)N[re+fe]+=Y*R[he+fe];re+=w,he+=w}}}return C.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,n,a){ke([e,n],"depthwiseConv2DDerInput");for(var i=yt(a.inShape,"float32"),c=i.values,f=i.strides,p=f[0],d=f[1],x=f[2],w=this.readSync(e.dataId),C=e.strides,S=C[0],R=C[1],N=C[2],D=this.readSync(n.dataId),M=n.strides,B=M[0],k=M[1],L=M[2],F=a.batchSize,W=a.filterHeight,G=a.filterWidth,q=a.inChannels,H=a.inHeight,Z=a.inWidth,ie=a.outChannels,ee=a.outHeight,me=a.outWidth,xe=a.strideHeight,$=a.strideWidth,te=W-1-a.padInfo.top,re=G-1-a.padInfo.left,he=ie/q,Se=0;Se<F;++Se)for(var Y=0;Y<q;++Y)for(var fe=0;fe<H;++fe)for(var Ae=fe-te,Te=Math.max(0,Math.ceil(Ae/xe)),Le=Math.min(ee,(W+Ae)/xe),Ve=0;Ve<Z;++Ve){for(var Ie=Ve-re,ut=Math.max(0,Math.ceil(Ie/$)),He=Math.min(me,(G+Ie)/$),ht=0,jt=Te;jt<Le;++jt)for(var it=jt*xe-Ae,Rt=ut;Rt<He;++Rt)for(var Ye=S*Se+R*jt+N*Rt,zt=B*(W-1-it)+k*(G-1-(Rt*$-Ie))+L*Y,Bt=0;Bt<he;++Bt)ht+=w[Ye+(Y*he+Bt)]*D[zt+Bt];c[p*Se+d*fe+x*Ve+Y]=ht}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,n,a){ke([e,n],"depthwiseConv2DDerFilter");for(var i=a.strideHeight,c=a.strideWidth,f=a.filterHeight,p=a.filterWidth,d=yt(a.filterShape,"float32"),x=a.padInfo.left,w=a.padInfo.top,C=a.outChannels/a.inChannels,S=this.bufferSync(e),R=this.bufferSync(n),N=0;N<f;++N)for(var D=Math.max(0,Math.ceil((w-N)/i)),M=Math.min(a.outHeight,(a.inHeight+w-N)/i),B=0;B<p;++B)for(var k=Math.max(0,Math.ceil((x-B)/c)),L=Math.min(a.outWidth,(a.inWidth+x-B)/c),F=0;F<a.outChannels;++F){for(var W=Math.trunc(F/C),G=F%C,q=0,H=0;H<a.batchSize;++H)for(var Z=D;Z<M;++Z)for(var ie=N+Z*i-w,ee=k;ee<L;++ee){var me=B+ee*c-x;q+=S.get(H,ie,me,W)*R.get(H,Z,ee,F)}d.set(q,N,B,W,G)}return d.toTensor()},t.prototype.tile=function(e,n){return ke(e,"tile"),zy(this.bufferSync(e),n)},t.prototype.pad=function(e,n,a){ke(e,"pad");var i=n.map((function(C,S){return C[0]+e.shape[S]+C[1]})),c=n.map((function(C){return C[0]})),f=this.bufferSync(e),p=yt(i,e.dtype);a!==0&&p.values.fill(a);for(var d=0;d<e.size;d++){var x=f.indexToLoc(d),w=x.map((function(C,S){return C+c[S]}));p.set.apply(p,[f.get.apply(f,x)].concat(w))}return p.toTensor()},t.prototype.transpose=function(e,n){ke(e,"transpose");for(var a=new Array(e.rank),i=0;i<a.length;i++)a[i]=e.shape[n[i]];var c=this.readSync(e.dataId),f=yt(a,e.dtype),p=this.bufferSync(e);for(i=0;i<e.size;++i){for(var d=p.indexToLoc(i),x=new Array(d.length),w=0;w<x.length;w++)x[w]=d[n[w]];var C=f.locToIndex(x);f.values[C]=c[i]}return f.toTensor()},t.prototype.gather=function(e,n,a){ke([e,n],"gather");var i=e.shape.slice(),c=this.readSync(n.dataId);i[a]=c.length;for(var f=yt(i,e.dtype),p=this.bufferSync(e),d=0;d<f.size;++d){var x=f.indexToLoc(d),w=x.slice();w[a]=c[x[a]];var C=p.locToIndex(w);f.values[d]=p.values[C]}return f.toTensor()},t.prototype.batchToSpaceND=function(e,n,a){ke([e],"batchToSpaceND");var i=n.reduce((function(w,C){return w*C})),c=xh(e.shape,n,i),f=yh(c.length,n.length),p=bh(e.shape,n,i),d=Ty(a,n.length),x=Iy(p,a,n.length);return e.reshape(c).transpose(f).reshape(p).slice(d,x)},t.prototype.spaceToBatchND=function(e,n,a){ke([e],"spaceToBatchND");var i=n.reduce((function(C,S){return C*S})),c=[[0,0]];c.push.apply(c,a);for(var f=1+n.length;f<e.shape.length;++f)c.push([0,0]);var p=e.pad(c),d=xh(p.shape,n,i,!1),x=yh(d.length,n.length,!1),w=bh(p.shape,n,i,!1);return p.reshape(d).transpose(x).reshape(w)},t.prototype.pool=function(e,n,a){ke(e,"pool");for(var i=n.strideHeight,c=n.strideWidth,f=n.dilationHeight,p=n.dilationWidth,d=n.effectiveFilterHeight,x=n.effectiveFilterWidth,w=n.padInfo.top,C=n.padInfo.left,S=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,R=this.readSync(e.dataId),N=yt(n.outShape,e.dtype),D=N.values,M=n.outShape[1]*n.outShape[2]*n.outShape[3],B=n.outShape[2]*n.outShape[3],k=n.outShape[3],L=0;L<n.batchSize;++L)for(var F=L*M,W=L*e.strides[0],G=0;G<n.inChannels;++G)for(var q=0;q<n.outHeight;++q)for(var H=q*i-w,Z=Math.max(0,H),ie=Math.min(n.inHeight,d+H),ee=F+q*B,me=0;me<n.outWidth;++me){for(var xe=me*c-C,$=Math.max(0,xe),te=Math.min(n.inWidth,x+xe),re=S,he=0,Se=0,Y=Z;Y<ie;Y+=f){for(var fe=W+Y*e.strides[1],Ae=$;Ae<te;Ae+=p){var Te=R[fe+Ae*e.strides[2]+G];a==="max"&&Te>re?re=Te:a==="avg"&&(he+=Te,Se++)}if(isNaN(re))break}D[ee+me*k+G]=a==="avg"?he/Se:re}return N.toTensor()},t.prototype.maxPool=function(e,n){return this.pool(e,n,"max")},t.prototype.maxPoolPositions=function(e,n){for(var a=yt(n.outShape,"int32"),i=n.strideHeight,c=n.strideWidth,f=n.dilationHeight,p=n.dilationWidth,d=n.effectiveFilterHeight,x=n.effectiveFilterWidth,w=n.padInfo.top,C=n.padInfo.left,S=this.bufferSync(e),R=0;R<n.batchSize;++R)for(var N=0;N<n.inChannels;++N)for(var D=0;D<n.outHeight;++D){for(var M=D*i-w,B=M;B<0;)B+=f;for(var k=Math.min(n.inHeight,d+M),L=0;L<n.outWidth;++L){for(var F=L*c-C,W=F;W<0;)W+=p;for(var G=Math.min(n.inWidth,x+F),q=Number.NEGATIVE_INFINITY,H=-1,Z=B;Z<k;Z+=f)for(var ie=Z-M,ee=W;ee<G;ee+=p){var me=ee-F,xe=S.get(R,Z,ee,N);xe>q&&(q=xe,H=ie*x+me)}a.set(H,R,D,L,N)}}return a.toTensor()},t.prototype.maxPoolBackprop=function(e,n,a,i){ke([n,a],"maxPoolBackprop");for(var c=this.maxPoolPositions(n,i),f=i.strideHeight,p=i.strideWidth,d=i.dilationHeight,x=i.dilationWidth,w=i.effectiveFilterHeight,C=i.effectiveFilterWidth,S=C-1-i.padInfo.left,R=w-1-i.padInfo.top,N=yt(n.shape,"float32"),D=this.bufferSync(c),M=this.bufferSync(e),B=0;B<i.batchSize;++B)for(var k=0;k<i.inChannels;++k)for(var L=0;L<i.inHeight;++L)for(var F=0;F<i.inWidth;++F){for(var W=L-R,G=F-S,q=0,H=0;H<w;H+=d){var Z=(W+H)/f;if(!(Z<0||Z>=i.outHeight||Math.floor(Z)!==Z))for(var ie=0;ie<C;ie+=x){var ee=(G+ie)/p;if(!(ee<0||ee>=i.outWidth||Math.floor(ee)!==ee)){var me=w*C-1-D.get(B,Z,ee,k)===H*C+ie?1:0;me!==0&&(q+=M.get(B,Z,ee,k)*me)}}}N.set(q,B,L,F,k)}return N.toTensor()},t.prototype.avgPoolBackprop=function(e,n,a){ke([e,n],"avgPoolBackprop");for(var i=a.strideHeight,c=a.strideWidth,f=a.filterHeight,p=a.filterWidth,d=a.dilationHeight,x=a.dilationWidth,w=a.effectiveFilterHeight,C=a.effectiveFilterWidth,S=C-1-a.padInfo.left,R=w-1-a.padInfo.top,N=yt(n.shape,"float32"),D=1/(f*p),M=this.bufferSync(e),B=0;B<a.batchSize;++B)for(var k=0;k<a.inChannels;++k)for(var L=0;L<a.inHeight;++L)for(var F=0;F<a.inWidth;++F){for(var W=L-R,G=F-S,q=0,H=0;H<w;H+=d){var Z=(W+H)/i;if(!(Z<0||Z>=a.outHeight||Math.floor(Z)!==Z))for(var ie=0;ie<C;ie+=x){var ee=(G+ie)/c;ee<0||ee>=a.outWidth||Math.floor(ee)!==ee||(q+=M.get(B,Z,ee,k))}}N.set(q*D,B,L,F,k)}return N.toTensor()},t.prototype.pool3d=function(e,n,a){ke(e,"pool3d");for(var i=n.strideDepth,c=n.strideHeight,f=n.strideWidth,p=n.dilationDepth,d=n.dilationHeight,x=n.dilationWidth,w=n.effectiveFilterDepth,C=n.effectiveFilterHeight,S=n.effectiveFilterWidth,R=n.padInfo.front,N=n.padInfo.top,D=n.padInfo.left,M=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,B=this.readSync(e.dataId),k=yt(n.outShape,e.dtype),L=k.values,F=n.outShape[1]*n.outShape[2]*n.outShape[3]*n.outShape[4],W=n.outShape[2]*n.outShape[3]*n.outShape[4],G=n.outShape[3]*n.outShape[4],q=n.outShape[4],H=0;H<n.batchSize;++H)for(var Z=H*F,ie=H*e.strides[0],ee=0;ee<n.inChannels;++ee)for(var me=0;me<n.outDepth;++me){for(var xe=me*i-R,$=xe;$<0;)$+=p;for(var te=Math.min(n.inDepth,w+xe),re=Z+me*W,he=0;he<n.outHeight;++he){for(var Se=he*c-N,Y=Se;Y<0;)Y+=d;for(var fe=Math.min(n.inHeight,C+Se),Ae=re+he*G,Te=0;Te<n.outWidth;++Te){for(var Le=Te*f-D,Ve=Le;Ve<0;)Ve+=x;for(var Ie=Math.min(n.inWidth,S+Le),ut=Ae+Te*q,He=M,ht=0,jt=0,it=$;it<te;it+=p){for(var Rt=ie+it*e.strides[1],Ye=Y;Ye<fe;Ye+=d){for(var zt=Rt+Ye*e.strides[2],Bt=Ve;Bt<Ie;Bt+=x){var Xt=B[zt+Bt*e.strides[3]+ee];if(a==="max"&&Xt>He?He=Xt:a==="avg"&&(ht+=Xt,jt++),isNaN(He))break}if(isNaN(He))break}if(isNaN(He))break}L[ut+ee]=a==="avg"?ht/jt:He}}}return k.toTensor()},t.prototype.avgPool3d=function(e,n){return ke(e,"avgPool3d"),this.pool3d(e,n,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,n,a){ke([e,n],"avgPool3dBackprop");for(var i=a.strideDepth,c=a.strideHeight,f=a.strideWidth,p=a.filterDepth,d=a.filterHeight,x=a.filterWidth,w=a.dilationDepth,C=a.dilationHeight,S=a.dilationWidth,R=a.effectiveFilterDepth,N=a.effectiveFilterHeight,D=a.effectiveFilterWidth,M=R-1-a.padInfo.front,B=D-1-a.padInfo.left,k=N-1-a.padInfo.top,L=yt(n.shape,"float32"),F=1/(p*d*x),W=this.bufferSync(e),G=0;G<a.batchSize;++G)for(var q=0;q<a.inChannels;++q)for(var H=0;H<a.inDepth;++H)for(var Z=0;Z<a.inHeight;++Z)for(var ie=0;ie<a.inWidth;++ie){for(var ee=H-M,me=Z-k,xe=ie-B,$=0,te=0;te<R;te+=w){var re=(ee+te)/i;if(!(re<0||re>=a.outDepth||Math.floor(re)!==re))for(var he=0;he<N;he+=C){var Se=(me+he)/c;if(!(Se<0||Se>=a.outHeight||Math.floor(Se)!==Se))for(var Y=0;Y<D;Y+=S){var fe=(xe+Y)/f;fe<0||fe>=a.outWidth||Math.floor(fe)!==fe||($+=W.get(G,re,Se,fe,q))}}}L.set($*F,G,H,Z,ie,q)}return L.toTensor()},t.prototype.maxPool3d=function(e,n){return ke(e,"maxPool3d"),this.pool3d(e,n,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,n){for(var a=yt(n.outShape,"int32"),i=n.strideDepth,c=n.strideHeight,f=n.strideWidth,p=n.dilationDepth,d=n.dilationHeight,x=n.dilationWidth,w=n.effectiveFilterDepth,C=n.effectiveFilterHeight,S=n.effectiveFilterWidth,R=n.padInfo.front,N=n.padInfo.top,D=n.padInfo.left,M=this.bufferSync(e),B=0;B<n.batchSize;++B)for(var k=0;k<n.inChannels;++k)for(var L=0;L<n.outDepth;++L){for(var F=L*i-R,W=F;W<0;)W+=p;for(var G=Math.min(n.inDepth,w+F),q=0;q<n.outHeight;++q){for(var H=q*c-N,Z=H;Z<0;)Z+=d;for(var ie=Math.min(n.inHeight,C+H),ee=0;ee<n.outWidth;++ee){for(var me=ee*f-D,xe=me;xe<0;)xe+=x;for(var $=Math.min(n.inWidth,S+me),te=Number.NEGATIVE_INFINITY,re=-1,he=W;he<G;he+=p)for(var Se=he-F,Y=Z;Y<ie;Y+=d)for(var fe=Y-H,Ae=xe;Ae<$;Ae+=x){var Te=Ae-me,Le=M.get(B,he,Y,Ae,k);Le>=te&&(te=Le,re=Se*C*S+fe*C+Te)}a.set(re,B,L,q,ee,k)}}}return a.toTensor()},t.prototype.maxPool3dBackprop=function(e,n,a,i){ke([n,a],"maxPool3dBackprop");for(var c=this.maxPool3dPositions(n,i),f=i.strideDepth,p=i.strideHeight,d=i.strideWidth,x=i.dilationDepth,w=i.dilationHeight,C=i.dilationWidth,S=i.effectiveFilterDepth,R=i.effectiveFilterHeight,N=i.effectiveFilterWidth,D=S-1-i.padInfo.front,M=N-1-i.padInfo.left,B=R-1-i.padInfo.top,k=yt(n.shape,"float32"),L=this.bufferSync(c),F=this.bufferSync(e),W=0;W<i.batchSize;++W)for(var G=0;G<i.inChannels;++G)for(var q=0;q<i.inDepth;++q)for(var H=0;H<i.inHeight;++H)for(var Z=0;Z<i.inWidth;++Z){for(var ie=q-D,ee=H-B,me=Z-M,xe=0,$=0;$<S;$+=x){var te=(ie+$)/f;if(!(te<0||te>=i.outDepth||Math.floor(te)!==te))for(var re=0;re<R;re+=w){var he=(ee+re)/p;if(!(he<0||he>=i.outHeight||Math.floor(he)!==he))for(var Se=0;Se<N;Se+=C){var Y=(me+Se)/d;if(!(Y<0||Y>=i.outWidth||Math.floor(Y)!==Y)){var fe=S*R*N-1-L.get(W,te,he,Y,G)===$*R*N+re*N+Se?1:0;fe!==0&&(xe+=F.get(W,te,he,Y,G)*fe)}}}}k.set(xe,W,q,H,Z,G)}return k.toTensor()},t.prototype.cast=function(e,n){return Ly(e,n,this)},t.prototype.reshape=function(e,n){return Vp(e,n)},t.prototype.avgPool=function(e,n){return ke(e,"avgPool"),this.pool(e,n,"avg").toFloat()},t.prototype.resizeBilinear=function(e,n,a,i){ke(e,"resizeBilinear");for(var c=e.shape,f=c[0],p=c[1],d=c[2],x=c[3],w=this.readSync(e.dataId),C=new Float32Array(Je([f,n,a,x])),S=[i&&n>1?p-1:p,i&&a>1?d-1:d],R=[i&&n>1?n-1:n,i&&a>1?a-1:a],N=0,D=S[0]/R[0],M=S[1]/R[1],B=0;B<f;B++)for(var k=0;k<n;k++)for(var L=D*k,F=Math.floor(L),W=L-F,G=Math.min(p-1,Math.ceil(L)),q=B*e.strides[0]+F*e.strides[1],H=B*e.strides[0]+G*e.strides[1],Z=0;Z<a;Z++)for(var ie=M*Z,ee=Math.floor(ie),me=ie-ee,xe=Math.min(d-1,Math.ceil(ie)),$=q+ee*e.strides[2],te=H+ee*e.strides[2],re=q+xe*e.strides[2],he=H+xe*e.strides[2],Se=0;Se<x;Se++){var Y=w[$+Se],fe=w[te+Se],Ae=Y+(w[re+Se]-Y)*me,Te=Ae+(fe+(w[he+Se]-fe)*me-Ae)*W;C[N++]=Te}return Tr(C,[f,n,a,x])},t.prototype.resizeBilinearBackprop=function(e,n,a){ke([e,n],"resizeBilinearBackprop");for(var i=n.shape,c=i[0],f=i[1],p=i[2],d=i[3],x=e.shape,w=x[1],C=x[2],S=new Float32Array(c*f*p*d),R=[a&&w>1?f-1:f,a&&C>1?p-1:p],N=[a&&w>1?w-1:w,a&&C>1?C-1:C],D=R[0]/N[0],M=R[1]/N[1],B=this.readSync(e.dataId),k=0,L=0;L<c;L++)for(var F=L*n.strides[0],W=0;W<w;W++)for(var G=W*D,q=Math.floor(G),H=Math.min(Math.ceil(G),f-1),Z=F+q*n.strides[1],ie=F+H*n.strides[1],ee=G-q,me=1-ee,xe=0;xe<C;xe++)for(var $=xe*M,te=Math.floor($),re=Math.min(Math.ceil($),p-1),he=$-te,Se=1-he,Y=Z+te*n.strides[2],fe=Z+re*n.strides[2],Ae=ie+te*n.strides[2],Te=ie+re*n.strides[2],Le=me*Se,Ve=me*he,Ie=ee*Se,ut=ee*he,He=0;He<d;He++){var ht=B[k++];S[Y+He]+=ht*Le,S[fe+He]+=ht*Ve,S[Ae+He]+=ht*Ie,S[Te+He]+=ht*ut}return ta(S,[c,p,f,d],n.dtype)},t.prototype.resizeNearestNeighbor=function(e,n,a,i){ke(e,"resizeNearestNeighbor");for(var c=e.shape,f=c[0],p=c[1],d=c[2],x=c[3],w=this.readSync(e.dataId),C=new Float32Array(f*n*a*x),S=[i&&n>1?p-1:p,i&&a>1?d-1:d],R=[i&&n>1?n-1:n,i&&a>1?a-1:a],N=S[0]/R[0],D=S[1]/R[1],M=0,B=0;B<f;B++)for(var k=B*e.strides[0],L=0;L<n;L++)for(var F=N*L,W=k+Math.min(p-1,i?Math.round(F):Math.floor(F))*e.strides[1],G=0;G<a;G++)for(var q=D*G,H=W+Math.min(d-1,i?Math.round(q):Math.floor(q))*e.strides[2],Z=0;Z<x;Z++){var ie=w[H+Z];C[M++]=ie}return Tr(C,[f,n,a,x],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,n,a){ke([e,n],"resizeNearestNeighborBackprop");for(var i=n.shape,c=i[0],f=i[1],p=i[2],d=i[3],x=e.shape,w=x[1],C=x[2],S=new Float32Array(c*f*p*d),R=this.readSync(e.dataId),N=[a&&w>1?f-1:f,a&&C>1?p-1:p],D=[a&&w>1?w-1:w,a&&C>1?C-1:C],M=N[0]/D[0],B=N[1]/D[1],k=1/M,L=1/B,F=2*Math.ceil(k)+2,W=2*Math.ceil(L)+2,G=0;G<c;G++)for(var q=G*n.strides[0],H=0;H<f;H++)for(var Z=q+H*n.strides[1],ie=Math.floor(H*k),ee=Math.floor(ie-F/2),me=0;me<p;me++)for(var xe=Z+me*n.strides[2],$=Math.floor(me*L),te=Math.floor($-W/2),re=0;re<d;re++){for(var he=0,Se=0;Se<F;Se++){var Y=Se+ee;if(!(Y<0||Y>=w)){var fe=q+Y*e.strides[1],Ae=Y*M;if(H===Math.min(f-1,a?Math.round(Ae):Math.floor(Ae)))for(var Te=0;Te<W;Te++){var Le=Te+te;if(!(Le<0||Le>=C)){var Ve=fe+Le*e.strides[2],Ie=Le*B;me===Math.min(p-1,a?Math.round(Ie):Math.floor(Ie))&&(he+=R[Ve+re])}}}}S[xe+re]=he}return ta(S,n.shape,n.dtype)},t.prototype.batchNormalization=function(e,n,a,i,c,f){ke([e,n,a,c,f],"batchNorm");for(var p=this.readSync(e.dataId),d=this.readSync(n.dataId),x=this.readSync(a.dataId),w=c?this.readSync(c.dataId):new Float32Array([1]),C=f?this.readSync(f.dataId):new Float32Array([0]),S=new Float32Array(p.length),R=C.length,N=w.length,D=x.length,M=d.length,B=0,k=0,L=0,F=0,W=0;W<p.length;++W)S[W]=C[B++]+(p[W]-d[k++])*w[L++]/Math.sqrt(x[F++]+i),B>=R&&(B=0),k>=M&&(k=0),L>=N&&(L=0),F>=D&&(F=0);return ta(S,e.shape)},t.prototype.localResponseNormalization4D=function(e,n,a,i,c){ke(e,"localResponseNormalization4D");var f=e.shape[3],p=f-1,d=this.readSync(e.dataId),x=e.size,w=new Float32Array(x);function C(D){for(var M=D%f,B=D-M+Math.max(0,M-n),k=D-M+Math.min(M+n,p),L=0;B<=k;B++){var F=d[B];L+=F*F}return L}for(var S=0;S<x;S++){var R=C(S),N=d[S]*Math.pow(a+i*R,-c);w[S]=N}return ta(w,e.shape)},t.prototype.LRNGrad=function(e,n,a,i,c,f,p){ke(e,"LRNGrad");for(var d=e.shape[3],x=this.readSync(e.dataId),w=this.readSync(n.dataId),C=this.readSync(a.dataId),S=new Float32Array(e.size),R=e.size,N=0;N<R;N++){for(var D=N%d,M=N-D+Math.max(0,D-i),B=N-D+Math.min(d,D+i+1),k=0,L=M;L<B;L++)k+=Math.pow(w[L],2);for(k=f*k+c,L=M;L<B;L++){var F=-2*f*p*w[L]*C[N]/k;N===L&&(F+=Math.pow(k,-p)),F*=x[N],S[L]+=F}}return ta(S,e.shape)},t.prototype.multinomial=function(e,n,a,i){ke(e,"multinomial");for(var c=n?e:so(e),f=c.shape[0],p=c.shape[1],d=yn([f,a],"int32"),x=this.readSync(d.dataId),w=this.readSync(c.dataId),C=0;C<f;++C){var S=C*p,R=new Float32Array(p-1);R[0]=w[S];for(var N=1;N<R.length;++N)R[N]=R[N-1]+w[S+N];for(var D=Lh(i.toString()),M=C*a,B=0;B<a;++B){var k=D();x[M+B]=R.length;for(var L=0;L<R.length;L++)if(k<R[L]){x[M+B]=L;break}}}return d},t.prototype.oneHot=function(e,n,a,i){ke(e,"oneHot");var c=new Float32Array(e.size*n);c.fill(i);for(var f=this.readSync(e.dataId),p=0;p<e.size;++p)f[p]>=0&&f[p]<n&&(c[p*n+f[p]]=a);return Qo(c,[e.size,n],"int32")},t.prototype.nonMaxSuppression=function(e,n,a,i,c){return ke(e,"nonMaxSuppression"),g1(this.readSync(e.dataId),this.readSync(n.dataId),a,i,c)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,n){for(var a=e.shape[0],i=e.shape[1],c=yt(e.shape,"float32"),f=yt(e.shape,"float32"),p=La(e).as2D(a,i),d=wi(e).as2D(a,i),x=0;x<a;x++)for(var w=p.slice([x,0],[1,i]),C=d.slice([x,0],[1,i]),S=Sr(w,C),R=this.readSync(this.fftImpl(S,n).dataId),N=0;N<i;N++){var D=X2(R,N);c.values[x*i+N]=D.real,f.values[x*i+N]=D.imag}return Sr(c.toTensor(),f.toTensor()).as2D(a,i)},t.prototype.fftImpl=function(e,n){var a=e.as1D(),i=a.size;if(this.isExponentOf2(i)){var c=this.fftRadix2(a,i,n).as2D(e.shape[0],e.shape[1]);return n&&(c=Sr(La(c).div(Ge(i)),wi(c).div(Ge(i)))),c}var f=this.readSync(e.dataId),p=(function(d){for(var x=new Float32Array(d.length/2),w=new Float32Array(d.length/2),C=0;C<d.length;C+=2)x[C/2]=d[C],w[C/2]=d[C+1];return{real:x,imag:w}})(this.fourierTransformByMatmul(f,i,n));return Sr(p.real,p.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return(e&e-1)==0},t.prototype.fftRadix2=function(e,n,a){if(n===1)return e;var i=this.readSync(e.dataId),c=n/2,f=(function(M){for(var B=Math.ceil(M.length/4),k=new Float32Array(B),L=new Float32Array(B),F=0;F<M.length;F+=4)k[Math.floor(F/4)]=M[F],L[Math.floor(F/4)]=M[F+1];return{real:k,imag:L}})(i),p=Sr(f.real,f.imag).as1D(),d=(function(M){for(var B=Math.floor(M.length/4),k=new Float32Array(B),L=new Float32Array(B),F=2;F<M.length;F+=4)k[Math.floor(F/4)]=M[F],L[Math.floor(F/4)]=M[F+1];return{real:k,imag:L}})(i),x=Sr(d.real,d.imag).as1D();p=this.fftRadix2(p,c,a),x=this.fftRadix2(x,c,a);var w=(function(M,B){for(var k=new Float32Array(M/2),L=new Float32Array(M/2),F=0;F<Math.ceil(M/2);F++){var W=(B?2:-2)*Math.PI*(F/M);k[F]=Math.cos(W),L[F]=Math.sin(W)}return{real:k,imag:L}})(n,a),C=Sr(w.real,w.imag).mul(x),S=p.add(C),R=p.sub(C),N=La(S).concat(La(R)),D=wi(S).concat(wi(R));return Sr(N,D).as1D()},t.prototype.fourierTransformByMatmul=function(e,n,a){for(var i=new Float32Array(2*n),c=0;c<n;c++){for(var f=0,p=0,d=0;d<n;d++){var x=XS(c*d,n,a),w=X2(e,d);f+=w.real*x.real-w.imag*x.imag,p+=w.real*x.imag+w.imag*x.real}a&&(f/=n,p/=n),jS(i,f,p,c)}return i},t.prototype.depthToSpace=function(e,n,a){J(a==="NHWC",(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+a})),J(n>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+n}));for(var i=e.shape[0],c=e.shape[1],f=e.shape[2],p=e.shape[3],d=c*n,x=f*n,w=p/(n*n),C=this.readSync(e.dataId),S=new Float32Array(i*d*x*w),R=0,N=0;N<i;++N)for(var D=0;D<d;++D)for(var M=Math.floor(D/n),B=D%n,k=0;k<x;++k)for(var L=Math.floor(k/n),F=(B*n+k%n)*w,W=0;W<w;++W){var G=W+F+p*(L+f*(M+c*N));S[R++]=C[G]}return ta(S,[i,d,x,w])},t.prototype.broadcastedBinaryOp=function(e,n,a,i){var c=Ot(e.shape,n.shape),f=yt(c,a),p=this.readSync(e.dataId),d=this.readSync(n.dataId),x=Ko(e.shape,c),w=Ko(n.shape,c),C=f.values;if(x.length+w.length===0)for(var S=0;S<C.length;++S)C[S]=i(p[S%p.length],d[S%d.length]);else{var R=this.bufferSync(e),N=this.bufferSync(n),D=function(M){var B=f.indexToLoc(M),k=B.slice(-e.rank);x.forEach((function(G){return k[G]=0}));var L=R.locToIndex(k),F=B.slice(-n.rank);w.forEach((function(G){return F[G]=0}));var W=N.locToIndex(F);C[M]=i(p[L],d[W])};for(S=0;S<C.length;++S)D(S)}return f.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,n,a){var i=Ot(e.shape,n.shape),c=yt(i,"float32"),f=yt(i,"float32"),p=this.readSync(e.dataId),d=this.readSync(n.dataId),x=Ko(e.shape,i),w=Ko(n.shape,i),C=c.values,S=f.values;if(x.length+w.length===0)for(var R=0;R<C.length;R++){var N=R%p.length,D=R%d.length,M=a(p[2*N],p[2*N+1],d[2*D],d[2*D+1]);C[R]=M.real,S[R]=M.imag}else{var B=this.bufferSync(this.data.get(e.dataId).complexTensors.real),k=this.bufferSync(this.data.get(n.dataId).complexTensors.real),L=function(F){var W=c.indexToLoc(F),G=W.slice(-e.rank);x.forEach((function(ee){return G[ee]=0}));var q=B.locToIndex(G),H=W.slice(-n.rank);w.forEach((function(ee){return H[ee]=0}));var Z=k.locToIndex(H),ie=a(p[2*q],p[2*q+1],d[2*Z],d[2*Z+1]);C[F]=ie.real,S[F]=ie.imag};for(R=0;R<C.length;R++)L(R)}return this.complex(c.toTensor(),f.toTensor())},t.prototype.split=function(e,n,a){return Uy(e,n,a)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,n,a,i,c,f){for(var p=e.shape,d=p[0],x=p[1],w=p[2],C=p[3],S=n.shape[0],R=i[0],N=i[1],D=yt([S,R,N,C],"float32"),M=this.readSync(n.dataId),B=this.readSync(a.dataId),k=this.readSync(e.dataId),L=e.strides,F=D.strides,W=0;W<S;W++){var G=4*W,q=M[G],H=M[G+1],Z=M[G+2],ie=M[G+3],ee=B[W];if(!(ee>=d))for(var me=R>1?(Z-q)*(x-1)/(R-1):0,xe=N>1?(ie-H)*(w-1)/(N-1):0,$=0;$<R;$++){var te=R>1?q*(x-1)+$*me:.5*(q+Z)*(x-1);if(te<0||te>x-1)for(var re=0;re<N;re++)for(var he=0;he<C;he++){var Se=he+re*F[2]+$*F[1]+W*F[0];D.values[Se]=f}else if(c==="bilinear"){var Y=Math.floor(te),fe=Math.ceil(te),Ae=te-Y;for(re=0;re<N;re++)if((it=N>1?H*(w-1)+re*xe:.5*(H+ie)*(w-1))<0||it>w-1)for(he=0;he<C;he++)Se=he+re*F[2]+$*F[1]+W*F[0],D.values[Se]=f;else{var Te=Math.floor(it),Le=Math.ceil(it),Ve=it-Te;for(he=0;he<C;he++){var Ie=k[Se=he+Te*L[2]+Y*L[1]+ee*L[0]],ut=k[Se=he+Le*L[2]+Y*L[1]+ee*L[0]],He=k[Se=he+Te*L[2]+fe*L[1]+ee*L[0]],ht=Ie+(ut-Ie)*Ve,jt=He+(k[Se=he+Le*L[2]+fe*L[1]+ee*L[0]]-He)*Ve;Se=he+re*F[2]+$*F[1]+W*F[0],D.values[Se]=ht+(jt-ht)*Ae}}}else for(re=0;re<N;++re){var it;if((it=N>1?H*(w-1)+re*xe:.5*(H+ie)*(w-1))<0||it>w-1)for(he=0;he<C;he++)Se=he+re*F[2]+$*F[1]+W*F[0],D.values[Se]=f;else{var Rt=Math.round(it),Ye=Math.round(te);for(he=0;he<C;he++){var zt=he+Rt*L[2]+Ye*L[1]+ee*L[0],Bt=he+re*F[2]+$*F[1]+W*F[0];D.values[Bt]=k[zt]}}}}}return D.toTensor()},t.prototype.sparseToDense=function(e,n,a,i){var c=wh(0,e,a),f=c.sliceRank,p=c.numUpdates,d=c.sliceSize,x=c.strides,w=c.outputSize;return this.scatter(e,n,a,w,d,p,f,x,i,!1)},t.prototype.gatherND=function(e,n){var a=n.shape,i=a[a.length-1],c=Ry(e,n),f=c[0],p=c[1],d=c[2],x=c[3];if(p===0)return Tr([],f,e.dtype);for(var w=new hc([p,d],e.dtype),C=this.readSync(n.dataId),S=this.readSync(e.dataId),R=0;R<p;R++){for(var N=[],D=0,M=0;M<i;M++){var B=C[R*i+M];D+=B*x[M],N.push(B)}if(D<0||D>=e.size/d)throw new Error("Invalid indices: "+N+" does not index into "+e.shape);for(var k=0;k<d;k++)w.values[R*d+k]=S[D*d+k]}return w.toTensor().reshape(f)},t.prototype.scatterND=function(e,n,a){var i=wh(0,e,a),c=i.sliceRank,f=i.numUpdates,p=i.sliceSize,d=i.strides,x=i.outputSize,w=Ge(0);return this.scatter(e,n,a,x,p,f,c,d,w,!0)},t.prototype.fill=function(e,n,a){var i=fh(a=a||wc(n),Je(e));return i.fill(n),le.makeTensor(i,e,a,this)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var n=fh(e.dtype,Je(e.shape));return this.makeOutput(n,e.shape,e.dtype)},t.prototype.linspace=function(e,n,a){return Fy(e,n,a)},t.prototype.scatter=function(e,n,a,i,c,f,p,d,x,w){var C=[i/c,c],S=this.readSync(e.dataId),R=this.readSync(n.dataId);if(i===0)return Tr([],a,n.dtype);var N=new hc(C,n.dtype);N.values.fill(this.readSync(x.dataId)[0]);for(var D=0;D<f;D++){for(var M=[],B=0,k=0;k<p;k++){var L=S[D*p+k];M.push(L),B+=L*d[k]}if(B<0||B>=i/c)throw new Error("Invalid indices: "+M+" does not index into "+a);for(var F=0;F<c;F++)w?N.values[B*c+F]+=R[D*c+F]:N.values[B*c+F]=n.rank===0?R[0]:R[D*c+F]}return N.toTensor().reshape(a)},t})(By);le.registerBackend("cpu",(function(){return new hR}),1);for(var mp=0,px=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=r.attrs,a=t,i=a.boxes,c=a.scores,f=n,p=f.maxOutputSize,d=f.iouThreshold,x=f.scoreThreshold,w=f.softNmsSigma,C=e;ke(i,"NonMaxSuppressionWithScore");var S=v1(C.data.get(i.dataId).values,C.data.get(c.dataId).values,p,d,x,w);return[S.selectedIndices,S.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t.x,a=e;ke(n,"square");for(var i=a.data.get(n.dataId).values,c=new Float32Array(i.length),f=0;f<i.length;++f){var p=i[f];c[f]=p*p}return{dataId:a.write(c,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},{kernelName:gc,backendName:"cpu",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t,a=n.a,i=n.b,c=e;ke([a,i],gc);var f=c.data.get(a.dataId).values,p=c.data.get(i.dataId).values,d=(function(C,S,R,N,D,M){var B=Ot(C,S),k=B.length,L=Ai(B),F=fc(D,Je(B)),W=C.length,G=S.length,q=Ai(C),H=Ai(S),Z=Ko(C,B),ie=Ko(S,B);if(Z.length+ie.length===0)for(var ee=0;ee<F.length;++ee)F[ee]=M(R[ee%R.length],N[ee%N.length]);else{var me=function(xe){var $=EA(xe,k,L),te=$.slice(-W);Z.forEach((function(Y){return te[Y]=0}));var re=F2(te,W,q),he=$.slice(-G);ie.forEach((function(Y){return he[Y]=0}));var Se=F2(he,G,H);F[xe]=M(R[re],N[Se])};for(ee=0;ee<F.length;++ee)me(ee)}return[F,B]})(a.shape,i.shape,f,p,a.dtype,(function(C,S){var R=C-S;return R*R})),x=d[0],w=d[1];return{dataId:c.write(x,w,a.dtype),shape:w,dtype:a.dtype}}}];mp<px.length;mp++)uy(px[mp]);var Bu,dR=function(r){this.variableNames=["A"];var t=Fr(),e=r[0],n=r[1];this.outputShape=r,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+n+".0, "+e+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},pR=function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Fr(),e=r[0],n=r[1];this.outputShape=r,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+n+".0, "+e+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var xp=0,gx=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=r.attrs,a=t.pixels,i=n.numChannels,c=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,f=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,p=c?[a.videoWidth,a.videoHeight]:[a.width,a.height],d=p[0],x=p[1],w=[x,d],C=[x,d,i];(f||c)&&(Bu==null&&(Bu=document.createElement("canvas").getContext("2d")),Bu.canvas.width=d,Bu.canvas.height=x,Bu.drawImage(a,0,0,d,x),a=Bu.canvas);var S=e.makeTensorInfo(w,"int32");e.texData.get(S.dataId).usage=wa.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(S.dataId),a);var R=Re().getBool("WEBGL_PACK")?new pR(C):new dR(C),N=e.runWebGLProgram(R,[S],"int32");return e.disposeData(S.dataId),N}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=r.attrs;gh("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t,i=a.boxes,c=a.scores,f=n,p=f.maxOutputSize,d=f.iouThreshold,x=f.scoreThreshold,w=f.softNmsSigma,C=e,S=v1(C.readSync(i.dataId),C.readSync(c.dataId),p,d,x,w);return[S.selectedIndices,S.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t.x,a=e,i=new Et(n.shape,"return x * x;");return a.runWebGLProgram(i,[n],n.dtype)}},{kernelName:gc,backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t,a=n.a,i=n.b,c=e,f=Re().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new eo("return (a - b) * (a - b);",a.shape,i.shape):new kn("return (a - b) * (a - b);",a.shape,i.shape);return c.compileAndRun(f,[a,i])}}];xp<gx.length;xp++)uy(gx[xp]);for(var yp=0,vx=[{kernelName:"Square",gradFunc:function(r,t){var e=t[0];return{x:function(){return r.mul(e.toFloat().mul(2))}}}},{kernelName:gc,gradFunc:function(r,t){var e=t[0],n=t[1],a=Ge(2);return{a:function(){return Ur(r,Ur(a,lr(e,n)))},b:function(){return Ur(r,Ur(a,lr(n,e)))}}}}];yp<vx.length;yp++)fA(vx[yp]);var gR=(function(){function r(){}return r.prototype.fetch=function(t,e){return fetch(t,e)},r.prototype.now=function(){return performance.now()},r.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+e);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},r.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},r})();Re().get("IS_BROWSER")&&Re().setPlatform("browser",new gR);var bp,vR=function(){return require("node-fetch")},mR=(function(){function r(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return r.prototype.fetch=function(t,e){return Re().global.fetch!=null?Re().global.fetch(t,e):(bp==null&&(bp=vR()),bp(t,e))},r.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},r.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},r.prototype.decode=function(t,e){return t.length===0?"":new this.util.TextDecoder(e).decode(t)},r})();Re().get("IS_NODE")&&Re().setPlatform("node",new mR);var jp={float32:4,int32:4,uint16:2,uint8:1,bool:1},Ih=4;function Db(r,t){for(var e={},n=0,a=function(f){var p=f.name,d=f.dtype,x=f.shape,w=Je(x),C=void 0;if("quantization"in f){var S=f.quantization;if(S.dtype!=="uint8"&&S.dtype!=="uint16")throw new Error("Weight "+f.name+" has unknown quantization dtype "+S.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var R=jp[S.dtype],N=r.slice(n,n+w*R),D=S.dtype==="uint8"?new Uint8Array(N):new Uint16Array(N);if(d==="float32")C=Float32Array.from(D,(function(W){return W*S.scale+S.min}));else{if(d!=="int32")throw new Error("Unsupported dtype in weight '"+p+"': "+d);C=Int32Array.from(D,(function(W){return Math.round(W*S.scale+S.min)}))}n+=w*R}else if(d==="string"){var M=Je(f.shape);C=[];for(var B=0;B<M;B++){var k=new Uint32Array(r.slice(n,n+Ih))[0];n+=Ih;var L=new Uint8Array(r.slice(n,n+k));C.push(L),n+=k}}else{var F=jp[d];if(N=r.slice(n,n+w*F),d==="float32")C=new Float32Array(N);else if(d==="int32")C=new Int32Array(N);else{if(d!=="bool")throw new Error("Unsupported dtype in weight '"+p+"': "+d);C=new Uint8Array(N)}n+=w*F}e[p]=Tr(C,x,d)},i=0,c=t;i<c.length;i++)a(c[i]);return e}function xR(r){if(r===null)throw new Error("Invalid input value: "+JSON.stringify(r));var t=0,e=[];r.forEach((function(i){if(t+=i.byteLength,e.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)}));var n=new Uint8Array(t),a=0;return e.forEach((function(i){n.set(new Uint8Array(i.buffer),a),a+=i.byteLength})),n.buffer}var Xp=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function mx(r){return Xp?Buffer.byteLength(r):new Blob([r]).size}function k1(r){var t=0;r.forEach((function(a){t+=a.byteLength}));var e=new Uint8Array(t),n=0;return r.forEach((function(a){e.set(new Uint8Array(a),n),n+=a.byteLength})),e.buffer}function xx(r){for(r=r.trim();r.endsWith("/");)r=r.slice(0,r.length-1);var t=r.split("/");return t[t.length-1]}function Ic(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:mx(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:mx(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}var Ea=(function(){function r(){this.saveRouters=[],this.loadRouters=[]}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerSaveRouter=function(t){r.getInstance().saveRouters.push(t)},r.registerLoadRouter=function(t){r.getInstance().loadRouters.push(t)},r.getSaveHandlers=function(t){return r.getHandlers(t,"save")},r.getLoadHandlers=function(t,e){return r.getHandlers(t,"load",e)},r.getHandlers=function(t,e,n){var a=[];return(e==="load"?r.getInstance().loadRouters:r.getInstance().saveRouters).forEach((function(i){var c=i(t,n);c!==null&&a.push(c)})),a},r})(),ju="://",Jo=(function(){function r(){this.managers={}}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerManager=function(t,e){J(t!=null,(function(){return"scheme must not be undefined or null."})),t.endsWith(ju)&&(t=t.slice(0,t.indexOf(ju))),J(t.length>0,(function(){return"scheme must not be an empty string."}));var n=r.getInstance();J(n.managers[t]==null,(function(){return"A model store manager is already registered for scheme '"+t+"'."})),n.managers[t]=e},r.getManager=function(t){var e=this.getInstance().managers[t];if(e==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},r.getSchemes=function(){return Object.keys(this.getInstance().managers)},r})();function oh(r){if(r.indexOf(ju)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Jo.getSchemes().join(","));return{scheme:r.split(ju)[0],path:r.split(ju)[1]}}function yx(r,t,e){return e===void 0&&(e=!1),Ze(this,void 0,void 0,(function(){var n,a,i,c,f,p,d,x,w;return Qe(this,(function(C){switch(C.label){case 0:return J(r!==t,(function(){return"Old path and new path are the same: '"+r+"'"})),J((n=Ea.getLoadHandlers(r)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+r+"."})),J(n.length<2,(function(){return"Copying failed because more than one ("+n.length+") load handlers for source URL "+r+"."})),a=n[0],J((i=Ea.getSaveHandlers(t)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+t+"."})),J(i.length<2,(function(){return"Copying failed because more than one ("+n.length+") save handlers for destination URL "+t+"."})),c=i[0],f=oh(r).scheme,p=oh(r).path,d=f===oh(r).scheme,[4,a.load()];case 1:return x=C.sent(),e&&d?[4,Jo.getManager(f).removeModel(p)]:[3,3];case 2:C.sent(),C.label=3;case 3:return[4,c.save(x)];case 4:return w=C.sent(),!e||d?[3,6]:[4,Jo.getManager(f).removeModel(p)];case 5:C.sent(),C.label=6;case 6:return[2,w.modelArtifactsInfo]}}))}))}var Ls="models_store",Zo="model_info_store";function Mb(){if(!Re().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var r=window||self,t=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Yp(r){var t=r.result;t.createObjectStore(Ls,{keyPath:"modelPath"}),t.createObjectStore(Zo,{keyPath:"modelPath"})}var Xu=(function(){function r(t){if(this.indexedDB=Mb(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return r.prototype.save=function(t){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},r.prototype.load=function(){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},r.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(a,i){var c=n.indexedDB.open("tensorflowjs",1);c.onupgradeneeded=function(){return Yp(c)},c.onsuccess=function(){var f=c.result;if(e==null){var p=f.transaction(Ls,"readonly"),d=p.objectStore(Ls).get(n.modelPath);d.onsuccess=function(){if(d.result==null)return f.close(),i(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));a(d.result.modelArtifacts)},d.onerror=function(N){return f.close(),i(d.error)},p.oncomplete=function(){return f.close()}}else{var x,w=Ic(e),C=f.transaction(Zo,"readwrite"),S=C.objectStore(Zo),R=S.put({modelPath:n.modelPath,modelArtifactsInfo:w});R.onsuccess=function(){var N=(x=f.transaction(Ls,"readwrite")).objectStore(Ls).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:w});N.onsuccess=function(){return a({modelArtifactsInfo:w})},N.onerror=function(D){var M=(S=C.objectStore(Zo)).delete(n.modelPath);M.onsuccess=function(){return f.close(),i(N.error)},M.onerror=function(B){return f.close(),i(N.error)}}},R.onerror=function(N){return f.close(),i(R.error)},C.oncomplete=function(){x==null?f.close():x.oncomplete=function(){return f.close()}}}},c.onerror=function(f){return i(c.error)}}))},r.URL_SCHEME="indexeddb://",r})(),bx=function(r){return Re().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Xu.URL_SCHEME)?(t=r.slice(Xu.URL_SCHEME.length),new Xu(t)):null;var t};Ea.registerSaveRouter(bx),Ea.registerLoadRouter(bx);var yR=(function(){function r(){this.indexedDB=Mb()}return r.prototype.listModels=function(){return Ze(this,void 0,void 0,(function(){var t=this;return Qe(this,(function(e){return[2,new Promise((function(n,a){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Yp(i)},i.onsuccess=function(){var c=i.result,f=c.transaction(Zo,"readonly"),p=f.objectStore(Zo).getAll();p.onsuccess=function(){for(var d={},x=0,w=p.result;x<w.length;x++){var C=w[x];d[C.modelPath]=C.modelArtifactsInfo}n(d)},p.onerror=function(d){return c.close(),a(p.error)},f.oncomplete=function(){return c.close()}},i.onerror=function(c){return a(i.error)}}))]}))}))},r.prototype.removeModel=function(t){return Ze(this,void 0,void 0,(function(){var e=this;return Qe(this,(function(n){var a;return t=(a=t).startsWith(Xu.URL_SCHEME)?a.slice(Xu.URL_SCHEME.length):a,[2,new Promise((function(i,c){var f=e.indexedDB.open("tensorflowjs",1);f.onupgradeneeded=function(){return Yp(f)},f.onsuccess=function(){var p,d=f.result,x=d.transaction(Zo,"readwrite"),w=x.objectStore(Zo),C=w.get(t);C.onsuccess=function(){if(C.result==null)return d.close(),c(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var S=w.delete(t),R=function(){var N=(p=d.transaction(Ls,"readwrite")).objectStore(Ls).delete(t);N.onsuccess=function(){return i(C.result.modelArtifactsInfo)},N.onerror=function(D){return c(C.error)}};S.onsuccess=R,S.onerror=function(N){return R(),d.close(),c(C.error)}},C.onerror=function(S){return d.close(),c(C.error)},x.oncomplete=function(){p==null?d.close():p.oncomplete=function(){return d.close()}}},f.onerror=function(p){return c(f.error)}}))]}))}))},r})();if(Re().getBool("IS_BROWSER"))try{Jo.registerManager(Xu.URL_SCHEME,new yR)}catch{}var to="/",zu="tensorflowjs_models",Ob="info",bR="model_topology",wR="weight_specs",ER="weight_data",CR="model_metadata";function Bb(r){return{info:[zu,r,Ob].join(to),topology:[zu,r,bR].join(to),weightSpecs:[zu,r,wR].join(to),weightData:[zu,r,ER].join(to),modelMetadata:[zu,r,CR].join(to)}}function AR(r){var t=r.split(to);if(t.length<3)throw new Error("Invalid key format: "+r);return t.slice(1,t.length-1).join(to)}var Yu=(function(){function r(t){if(!Re().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=Bb(this.modelPath)}return r.prototype.save=function(t){return Ze(this,void 0,void 0,(function(){var e,n,a;return Qe(this,(function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),a=Ic(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(function(c){if(Xp)return Buffer.from(c).toString("base64");for(var f=new Uint8Array(c),p="",d=0,x=f.length;d<x;d++)p+=String.fromCharCode(f[d]);return btoa(p)})(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:a}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+a.modelTopologyBytes+", weightSpecsBytes="+a.weightSpecsBytes+", weightDataBytes="+a.weightDataBytes+".")}return[2]}))}))},r.prototype.load=function(){return Ze(this,void 0,void 0,(function(){var t,e,n,a,i,c,f;return Qe(this,(function(p){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},(n=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=a,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(c=JSON.parse(i),e.format=c.format,e.generatedBy=c.generatedBy,e.convertedBy=c.convertedBy,e.userDefinedMetadata=c.userDefinedMetadata),(f=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=(function(d){if(Xp){var x=Buffer.from(d,"base64");return x.buffer.slice(x.byteOffset,x.byteOffset+x.byteLength)}for(var w=atob(d),C=new Uint8Array(w.length),S=0;S<w.length;++S)C.set([w.charCodeAt(S)],S);return C.buffer})(f),[2,e]}))}))},r.URL_SCHEME="localstorage://",r})(),wx=function(r){return Re().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Yu.URL_SCHEME)?(t=r.slice(Yu.URL_SCHEME.length),new Yu(t)):null;var t};Ea.registerSaveRouter(wx),Ea.registerLoadRouter(wx);var SR=(function(){function r(){J(Re().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),J(typeof window>"u"||window.localStorage!==void 0,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return r.prototype.listModels=function(){return Ze(this,void 0,void 0,(function(){var t,e,n,a,i,c;return Qe(this,(function(f){for(t={},e=zu+to,n=to+Ob,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(e)&&i.endsWith(n)&&(c=AR(i),t[c]=JSON.parse(this.LS.getItem(i)));return[2,t]}))}))},r.prototype.removeModel=function(t){return Ze(this,void 0,void 0,(function(){var e,n;return Qe(this,(function(a){var i;if(t=(i=t).startsWith(Yu.URL_SCHEME)?i.slice(Yu.URL_SCHEME.length):i,e=Bb(t),this.LS.getItem(e.info)==null)throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]}))}))},r})();if(Re().getBool("IS_BROWSER"))try{Jo.registerManager(Yu.URL_SCHEME,new SR)}catch{}var _R="model",TR=".json",IR=".weights.bin";function Ex(r){return new Promise((function(t){return setTimeout(t)})).then(r)}var wp=(function(){function r(t){if(!Re().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(r.URL_SCHEME)&&(t=t.slice(r.URL_SCHEME.length)),t!=null&&t.length!==0||(t=_R),this.modelTopologyFileName=t+TR,this.weightDataFileName=t+IR}return r.prototype.save=function(t){return Ze(this,void 0,void 0,(function(){var e,n,a,i,c,f;return Qe(this,(function(p){switch(p.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n},i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(c=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,c.href=i,[4,Ex((function(){return c.dispatchEvent(new MouseEvent("click"))}))];case 2:return p.sent(),t.weightData==null?[3,4]:((f=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,f.href=e,[4,Ex((function(){return f.dispatchEvent(new MouseEvent("click"))}))]);case 3:p.sent(),p.label=4;case 4:return[2,{modelArtifactsInfo:Ic(t)}]}}))}))},r.URL_SCHEME="downloads://",r})(),RR=(function(){function r(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return r.prototype.load=function(){return Ze(this,void 0,void 0,(function(){var t,e,n=this;return Qe(this,(function(a){return t=this.files[0],e=this.files.slice(1),[2,new Promise((function(i,c){var f=new FileReader;f.onload=function(p){var d=JSON.parse(p.target.result),x=d.modelTopology;if(x!=null){e.length===0&&i({modelTopology:x});var w=d.weightsManifest;if(w!=null){var C;try{C=n.checkManifestAndWeightFiles(w,e)}catch(D){return void c(D)}var S=[],R=[],N=[];w.forEach((function(D){D.paths.forEach((function(M){R.push(M),N.push(null)})),S.push.apply(S,D.weights)})),w.forEach((function(D){D.paths.forEach((function(M){var B=new FileReader;B.onload=function(k){var L=k.target.result,F=R.indexOf(M);N[F]=L,N.indexOf(null)===-1&&i({modelTopology:x,weightSpecs:S,weightData:k1(N),format:d.format,generatedBy:d.generatedBy,convertedBy:d.convertedBy,userDefinedMetadata:d.userDefinedMetadata})},B.onerror=function(k){return c("Failed to weights data from file of path '"+M+"'.")},B.readAsArrayBuffer(C[M])}))}))}else c(new Error("weightManifest field is missing from file "+t.name))}else c(new Error("modelTopology field is missing from file "+t.name))},f.onerror=function(p){return c("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},f.readAsText(t)}))]}))}))},r.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],a=e.map((function(p){return xx(p.name)})),i={},c=0,f=t;c<f.length;c++)f[c].paths.forEach((function(p){var d=xx(p);if(n.indexOf(d)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+d+"'");if(n.push(d),a.indexOf(d)===-1)throw new Error("Weight file with basename '"+d+"' is not provided.");i[p]=e[a.indexOf(d)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return i},r})();function Cx(r,t,e,n){(function(i){J(i!=null&&Array.isArray(i)&&i.length>0,(function(){return"promises must be a none empty array"}))})(r),(function(i,c){J(i>=0&&i<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i})),J(c>=0&&c<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+c})),J(c>=i,(function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+c}))})(e=e??0,n=n??1);var a=0;return Promise.all(r.map((function(i){return i.then((function(c){var f=e+ ++a/r.length*(n-e);return t(f),c})),i})))}function kb(r,t){return Ze(this,void 0,void 0,(function(){var e,n,a,i,c,f,p,d,x;return Qe(this,(function(w){switch(w.label){case 0:return t==null&&(t={}),e=t.fetchFunc==null?Re().platform.fetch:t.fetchFunc,n=r.map((function(C){return e(C,t.requestInit,{isBinary:!0})})),a=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(n)];case 1:return c=w.sent(),[3,4];case 2:return[4,Cx(n,t.onProgress,a,i)];case 3:c=w.sent(),w.label=4;case 4:return f=c.map((function(C){return C.arrayBuffer()})),p=.5,d=1,t.onProgress!=null?[3,6]:[4,Promise.all(f)];case 5:return x=w.sent(),[3,8];case 6:return[4,Cx(f,t.onProgress,p,d)];case 7:x=w.sent(),w.label=8;case 8:return[2,x]}}))}))}function Ax(r){var t=this;return function(e,n,a){return n===void 0&&(n=""),Ze(t,void 0,void 0,(function(){var i,c,f,p,d,x,w,C,S,R;return Qe(this,(function(N){switch(N.label){case 0:if(i=e.map((function(){return!1})),c={},f=a!=null?a.map((function(){return!1})):[],p=[],e.forEach((function(D,M){var B=0;D.weights.forEach((function(k){var L="quantization"in k?k.quantization.dtype:k.dtype,F=jp[L]*Je(k.shape),W=function(){i[M]=!0,c[M]==null&&(c[M]=[]),c[M].push({manifestEntry:k,groupOffset:B,sizeBytes:F})};a!=null?a.forEach((function(G,q){G===k.name&&(W(),f[q]=!0)})):W(),p.push(k.name),B+=F}))})),!f.every((function(D){return D})))throw d=a.filter((function(D,M){return!f[M]})),new Error("Could not find weights in manifest with names: "+d.join(", ")+`. 
Manifest JSON has weights with names: `+p.join(", ")+".");return x=i.reduce((function(D,M,B){return M&&D.push(B),D}),[]),w=[],x.forEach((function(D){e[D].paths.forEach((function(M){var B=n+(n.endsWith("/")?"":"/")+M;w.push(B)}))})),[4,r(w)];case 1:return C=N.sent(),S={},R=0,x.forEach((function(D){for(var M=e[D].paths.length,B=0,k=0;k<M;k++)B+=C[R+k].byteLength;for(var L=new ArrayBuffer(B),F=new Uint8Array(L),W=0,G=0;G<M;G++){var q=new Uint8Array(C[R+G]);F.set(q,W),W+=q.byteLength}c[D].forEach((function(H){var Z=Db(L.slice(H.groupOffset,H.groupOffset+H.sizeBytes),[H.manifestEntry]);for(var ie in Z)S[ie]=Z[ie]})),R+=M})),[2,S]}}))}))}}Ea.registerSaveRouter((function(r){return Re().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(wp.URL_SCHEME)?(function(t){return t===void 0&&(t="model"),new wp(t)})(r.slice(wp.URL_SCHEME.length)):null}));var Lb=(function(){function r(t,e){if(this.DEFAULT_METHOD="POST",e==null&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,e.fetchFunc!=null?(J(typeof e.fetchFunc=="function",(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=Re().platform.fetch,J(t!=null&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&J(t.length===2,(function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."})),this.path=t,e.requestInit!=null&&e.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return r.prototype.save=function(t){return Ze(this,void 0,void 0,(function(){var e,n,a,i;return Qe(this,(function(c){switch(c.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:n},e.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),t.weightData!=null&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((i=c.sent()).ok)return[2,{modelArtifactsInfo:Ic(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}}))}))},r.prototype.load=function(){return Ze(this,void 0,void 0,(function(){var t,e,n,a,i,c,f,p,d,x,w,C;return Qe(this,(function(S){switch(S.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=S.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");S.label=2;case 2:return S.trys.push([2,4,,5]),[4,t.json()];case 3:return e=S.sent(),[3,5];case 4:throw S.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(a=e.modelTopology,i=e.weightsManifest,c=e.generatedBy,f=e.convertedBy,p=e.format,d=e.userDefinedMetadata,a==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:C=S.sent(),x=C[0],w=C[1],S.label=7;case 7:return[2,{modelTopology:a,weightSpecs:x,weightData:w,userDefinedMetadata:d,generatedBy:c,convertedBy:f,format:p}]}}))}))},r.prototype.loadWeights=function(t){return Ze(this,void 0,void 0,(function(){var e,n,a,i,c,f,p,d,x,w,C;return Qe(this,(function(S){switch(S.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=(function(R){var N=R.lastIndexOf("/"),D=R.lastIndexOf("?"),M=R.substring(0,N),B=D>N?R.substring(D):"";return[M+"/",B]})(e),a=n[0],i=n[1],c=this.weightPathPrefix||a,f=[],p=0,d=t;p<d.length;p++)x=d[p],f.push.apply(f,x.weights);return w=[],t.forEach((function(R){R.paths.forEach((function(N){w.push(c+N+i)}))})),[4,kb(w,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return C=S.sent(),[2,[f,k1(C)]]}}))}))},r.URL_SCHEME_REGEX=/^https?:\/\//,r})();function qp(r){return r.match(Lb.URL_SCHEME_REGEX)!=null}var Sx=function(r,t){return typeof fetch>"u"?null:(Array.isArray(r)?r.every((function(e){return qp(e)})):qp(r))?Kp(r,{onProgress:t}):null};function Kp(r,t){return new Lb(r,t)}Ea.registerSaveRouter(Sx),Ea.registerLoadRouter(Sx);var Ep=(function(){function r(t){this.modelArtifacts=t}return r.prototype.load=function(){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(t){return[2,this.modelArtifacts]}))}))},r})(),NR=(function(){function r(t){this.saveHandler=t}return r.prototype.save=function(t){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(e){return[2,this.saveHandler(t)]}))}))},r})(),Fb=Object.freeze({browserFiles:function(r){return new RR(r)},browserHTTPRequest:function(r,t){return Kp(r,t)},concatenateArrayBuffers:k1,decodeWeights:Db,encodeWeights:function(r,t){return Ze(this,void 0,void 0,(function(){var e,n,a,i,c,f=this;return Qe(this,(function(p){switch(p.label){case 0:for(e=[],n=[],a=Array.isArray(r)?r.map((function(d){return d.name})):Object.keys(r),i=function(d){var x=a[d],w=Array.isArray(r)?r[d].tensor:r[x];if(w.dtype!=="float32"&&w.dtype!=="int32"&&w.dtype!=="bool"&&w.dtype!=="string")throw new Error("Unsupported dtype in weight '"+x+"': "+w.dtype);var C={name:x,shape:w.shape,dtype:w.dtype};if(w.dtype==="string"){var S=new Promise((function(R){return Ze(f,void 0,void 0,(function(){var N,D,M,B,k,L,F;return Qe(this,(function(W){switch(W.label){case 0:return[4,w.bytes()];case 1:for(N=W.sent(),D=N.reduce((function(G,q){return G+q.length}),0)+Ih*N.length,M=new Uint8Array(D),B=0,k=0;k<N.length;k++)L=N[k],F=new Uint8Array(new Uint32Array([L.length]).buffer),M.set(F,B),B+=Ih,M.set(L,B),B+=L.length;return R(M),[2]}}))}))}));n.push(S)}else n.push(w.data());t!=null&&(C.group=t),e.push(C)},c=0;c<a.length;++c)i(c);return[4,Promise.all(n)];case 1:return[2,{data:xR(p.sent()),specs:e}]}}))}))},fromMemory:function(r,t,e,n){return arguments.length===1?r.modelTopology!=null||r.weightSpecs!=null?new Ep(r):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Ep({modelTopology:r})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Ep({modelTopology:r,weightSpecs:t,weightData:e,trainingConfig:n}))},getLoadHandlers:function(r,t){return Ea.getLoadHandlers(r,t)},getModelArtifactsInfoForJSON:Ic,getSaveHandlers:function(r){return Ea.getSaveHandlers(r)},http:Kp,isHTTPScheme:qp,loadWeights:function(r,t,e,n){return t===void 0&&(t=""),Ze(this,void 0,void 0,(function(){return Qe(this,(function(a){return[2,Ax((function(i){return kb(i,{requestInit:n})}))(r,t,e)]}))}))},registerLoadRouter:function(r){return Ea.registerLoadRouter(r)},registerSaveRouter:function(r){return Ea.registerSaveRouter(r)},weightsLoaderFactory:Ax,withSaveHandler:function(r){return new NR(r)},copyModel:function(r,t){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(e){return[2,yx(r,t,!1)]}))}))},listModels:function(){return Ze(this,void 0,void 0,(function(){var r,t,e,n,a,i,c;return Qe(this,(function(f){switch(f.label){case 0:r=Jo.getSchemes(),t={},e=0,n=r,f.label=1;case 1:return e<n.length?(a=n[e],[4,Jo.getManager(a).listModels()]):[3,4];case 2:for(c in i=f.sent())t[a+ju+c]=i[c];f.label=3;case 3:return e++,[3,1];case 4:return[2,t]}}))}))},moveModel:function(r,t){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(e){return[2,yx(r,t,!0)]}))}))},removeModel:function(r){return Ze(this,void 0,void 0,(function(){var t;return Qe(this,(function(e){return t=oh(r),[2,Jo.getManager(t.scheme).removeModel(t.path)]}))}))}}),ku;oe({confusionMatrix_:function(r,t,e){var n=X(r,"labels","confusionMatrix"),a=X(t,"predictions","confusionMatrix");J(e==null||e>0&&Number.isInteger(e),(function(){return"If provided, numClasses must be a positive integer, but got "+e})),J(n.rank===1,(function(){return"Expected the rank of labels to be 1, but got "+n.rank})),J(a.rank===1,(function(){return"Expected the rank of predictions to be 1, but got "+a.rank})),J(n.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: "+n.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."})),J(e>0&&Number.isInteger(e),(function(){return"numClasses is required to be a positive integer, but got "+e}));var i=zp(n.asType("int32"),e),c=zp(a.asType("int32"),e);return i.transpose().matMul(c).asType("int32")}});var DR=oe({fromPixels_:function(r,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(r==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var e=!1,n=!1,a=!1,i=!1,c=!1;if(r.data instanceof Uint8Array)e=!0;else if(typeof ImageData<"u"&&r instanceof ImageData)n=!0;else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement)i=!0;else{if(r.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+r.constructor.name);c=!0}if(a&&a&&r.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(sy("FromPixels",le.backendName)!=null)return le.runKernel("FromPixels",{pixels:r},{numChannels:t});var f,p,d=a?[r.videoWidth,r.videoHeight]:[r.width,r.height],x=d[0],w=d[1];if(c?f=r.getContext("2d").getImageData(0,0,x,w).data:n||e?f=r.data:(i||a)&&(ku==null&&(ku=document.createElement("canvas").getContext("2d")),ku.canvas.width=x,ku.canvas.height=w,ku.drawImage(r,0,0,x,w),f=ku.getImageData(0,0,x,w).data),t===4)p=new Int32Array(f);else{var C=x*w;p=new Int32Array(C*t);for(var S=0;S<C;S++)for(var R=0;R<t;++R)p[S*t+R]=f[4*S+R]}return c1(p,[w,x,t],"int32")}}),L1=Object.freeze({toPixels:function(r,t){return Ze(this,void 0,void 0,(function(){var e,n,a,i,c,f,p,d,x,w,C,S,R,N,D,M,B,k,L,F,W,G,q;return Qe(this,(function(H){switch(H.label){case 0:if(e=X(r,"img","toPixels"),r instanceof _n||(e=e.toInt()),e.rank!==2&&e.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+e.rank+".");if(n=e.shape.slice(0,2),a=n[0],i=n[1],(c=e.rank===2?1:e.shape[2])>4||c===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+c);return[4,e.data()];case 1:return f=H.sent(),p=e.min(),d=e.max(),[4,Promise.all([p.data(),d.data()])];case 2:if(x=H.sent(),w=x[0],C=x[1],S=w[0],R=C[0],p.dispose(),d.dispose(),e.dtype==="float32"){if(S<0||R>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+S+" - "+R+"].")}else{if(e.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+e.dtype+". Please use float32 or int32 tensors.");if(S<0||R>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+S+" - "+R+"].")}for(N=e.dtype==="float32"?255:1,D=new Uint8ClampedArray(i*a*4),M=0;M<a*i;++M)B=void 0,k=void 0,L=void 0,F=void 0,c===1?(B=f[M]*N,k=f[M]*N,L=f[M]*N,F=255):c===3?(B=f[3*M]*N,k=f[3*M+1]*N,L=f[3*M+2]*N,F=255):c===4&&(B=f[4*M]*N,k=f[4*M+1]*N,L=f[4*M+2]*N,F=f[4*M+3]*N),D[(W=4*M)+0]=Math.round(B),D[W+1]=Math.round(k),D[W+2]=Math.round(L),D[W+3]=Math.round(F);return t!=null&&(t.width=i,t.height=a,G=t.getContext("2d"),q=new ImageData(D,i,a),G.putImageData(q,0,0)),e!==r&&e.dispose(),[2,D]}}))}))},fromPixels:DR}),MR=(function(){function r(){}return r.prototype.getClassName=function(){return this.constructor.className},r.fromConfig=function(t,e){return new t(e)},r})(),OR=(function(){function r(){this.classNameMap={}}return r.getMap=function(){return r.instance==null&&(r.instance=new r),r.instance},r.register=function(t){r.getMap().classNameMap[t.className]=[t,t.fromConfig]},r})();function Gs(r){J(r.className!=null,(function(){return"Class being registered does not have the static className property defined."})),J(typeof r.className=="string",(function(){return"className is required to be a string, but got type "+typeof r.className})),J(r.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),OR.register(r)}var js=(function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return Za(t,r),t.prototype.minimize=function(e,n,a){n===void 0&&(n=!1);var i=this.computeGradients(e,a),c=i.value,f=i.grads;if(a!=null){var p=a.map((function(d){return{name:d.name,tensor:f[d.name]}}));this.applyGradients(p)}else this.applyGradients(f);return ra(f),n?c:(c.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,n){return WS(e,n)},t.prototype.dispose=function(){this.iterations_!=null&&ra(this.iterations_)},t.prototype.saveIterations=function(){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(e){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:Ge(this.iterations_,"int32")}]}))}))},t.prototype.getWeights=function(){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},t.prototype.setWeights=function(e){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(n){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},t.prototype.extractIterations=function(e){return Ze(this,void 0,void 0,(function(){var n;return Qe(this,(function(a){switch(a.label){case 0:return n=this,[4,e[0].tensor.data()];case 1:return n.iterations_=a.sent()[0],[2,e.slice(1)]}}))}))},t})(MR);Object.defineProperty(js,Symbol.hasInstance,{value:function(r){return r.minimize!=null&&r.computeGradients!=null&&r.applyGradients!=null}});var BR=(function(r){function t(e,n,a){a===void 0&&(a=null);var i=r.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=a,i.accumulatedGrads=[],i.accumulatedUpdates=[],a==null&&(i.epsilon=le.backend.epsilon()),i}return Za(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map((function(a){return a.name})):Object.keys(e)).forEach((function(a,i){var c=le.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accum_grad",variable:Xe((function(){return Ut(c).variable(!1)}))}),n.accumulatedUpdates[i]==null&&(n.accumulatedUpdates[i]={originalName:a+"/accum_var",variable:Xe((function(){return Ut(c).variable(!1)}))});var f=Array.isArray(e)?e[i].tensor:e[a];if(f!=null){var p=n.accumulatedGrads[i].variable,d=n.accumulatedUpdates[i].variable;Xe((function(){var x=p.mul(n.rho).add(f.square().mul(1-n.rho)),w=d.add(n.epsilon).sqrt().div(p.add(n.epsilon).sqrt()).mul(f),C=d.mul(n.rho).add(w.square().mul(1-n.rho));p.assign(x),d.assign(C);var S=w.mul(-n.learningRate).add(c);c.assign(S)}))}})),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(ra(this.accumulatedGrads.map((function(e){return e.variable}))),ra(this.accumulatedUpdates.map((function(e){return e.variable}))))},t.prototype.getWeights=function(){return Ze(this,void 0,void 0,(function(){var e;return Qe(this,(function(n){switch(n.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map((function(a){return{name:a.originalName,tensor:a.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ze(this,void 0,void 0,(function(){var n;return Qe(this,(function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),n=e.length/2,this.accumulatedGrads=e.slice(0,n).map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),this.accumulatedUpdates=e.slice(n,2*n).map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,n){return new e(n.learningRate,n.rho,n.epsilon)},t.className="Adadelta",t})(js);Gs(BR);var kR=(function(r){function t(e,n){n===void 0&&(n=.1);var a=r.call(this)||this;return a.learningRate=e,a.initialAccumulatorValue=n,a.accumulatedGrads=[],a}return Za(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map((function(a){return a.name})):Object.keys(e)).forEach((function(a,i){var c=le.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accumulator",variable:Xe((function(){return Si(c.shape,n.initialAccumulatorValue).variable(!1)}))});var f=Array.isArray(e)?e[i].tensor:e[a];if(f!=null){var p=n.accumulatedGrads[i].variable;Xe((function(){var d=p.add(f.square());p.assign(d);var x=f.div(d.add(le.backend.epsilon()).sqrt()).mul(-n.learningRate).add(c);c.assign(x)}))}})),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&ra(this.accumulatedGrads.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map((function(n){return{name:n.originalName,tensor:n.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),this.accumulatedGrads=e.map((function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,n){return new e(n.learningRate,n.initialAccumulatorValue)},t.className="Adagrad",t})(js);Gs(kR);var LR=(function(r){function t(e,n,a,i){i===void 0&&(i=null);var c=r.call(this)||this;return c.learningRate=e,c.beta1=n,c.beta2=a,c.epsilon=i,c.accumulatedFirstMoment=[],c.accumulatedSecondMoment=[],Xe((function(){c.accBeta1=Ge(n).variable(),c.accBeta2=Ge(a).variable()})),i==null&&(c.epsilon=le.backend.epsilon()),c}return Za(t,r),t.prototype.applyGradients=function(e){var n=this,a=Array.isArray(e)?e.map((function(i){return i.name})):Object.keys(e);Xe((function(){var i=lr(1,n.accBeta1),c=lr(1,n.accBeta2);a.forEach((function(f,p){var d=le.registeredVariables[f];n.accumulatedFirstMoment[p]==null&&(n.accumulatedFirstMoment[p]={originalName:f+"/m",variable:Xe((function(){return Ut(d).variable(!1)}))}),n.accumulatedSecondMoment[p]==null&&(n.accumulatedSecondMoment[p]={originalName:f+"/v",variable:Xe((function(){return Ut(d).variable(!1)}))});var x=Array.isArray(e)?e[p].tensor:e[f];if(x!=null){var w=n.accumulatedFirstMoment[p].variable,C=n.accumulatedSecondMoment[p].variable,S=w.mul(n.beta1).add(x.mul(1-n.beta1)),R=C.mul(n.beta2).add(x.square().mul(1-n.beta2)),N=S.div(i),D=R.div(c);w.assign(S),C.assign(R);var M=N.div(D.sqrt().add(n.epsilon)).mul(-n.learningRate).add(d);d.assign(M)}})),n.accBeta1.assign(n.accBeta1.mul(n.beta1)),n.accBeta2.assign(n.accBeta2.mul(n.beta2))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&ra(this.accumulatedFirstMoment.map((function(e){return e.variable}))),this.accumulatedSecondMoment!=null&&ra(this.accumulatedSecondMoment.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return Ze(this,void 0,void 0,(function(){var e;return Qe(this,(function(n){switch(n.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map((function(a){return{name:a.originalName,tensor:a.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ze(this,void 0,void 0,(function(){var n,a=this;return Qe(this,(function(i){switch(i.label){case 0:return[4,this.extractIterations(e)];case 1:return e=i.sent(),Xe((function(){a.accBeta1.assign(_h(a.beta1,a.iterations_+1)),a.accBeta2.assign(_h(a.beta2,a.iterations_+1))})),n=e.length/2,this.accumulatedFirstMoment=e.slice(0,n).map((function(c){return{originalName:c.name,variable:c.tensor.variable(!1)}})),this.accumulatedSecondMoment=e.slice(n,2*n).map((function(c){return{originalName:c.name,variable:c.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)},t.className="Adam",t})(js);Gs(LR);var FR=(function(r){function t(e,n,a,i,c){i===void 0&&(i=null),c===void 0&&(c=0);var f=r.call(this)||this;return f.learningRate=e,f.beta1=n,f.beta2=a,f.epsilon=i,f.decay=c,f.accumulatedFirstMoment=[],f.accumulatedWeightedInfNorm=[],Xe((function(){f.iteration=Ge(0).variable(),f.accBeta1=Ge(n).variable()})),i==null&&(f.epsilon=le.backend.epsilon()),f}return Za(t,r),t.prototype.applyGradients=function(e){var n=this,a=Array.isArray(e)?e.map((function(i){return i.name})):Object.keys(e);Xe((function(){var i=lr(1,n.accBeta1),c=Ya(-n.learningRate,n.iteration.mul(n.decay).add(1));a.forEach((function(f,p){var d=le.registeredVariables[f];n.accumulatedFirstMoment[p]==null&&(n.accumulatedFirstMoment[p]={originalName:f+"/m",variable:Ut(d).variable(!1)}),n.accumulatedWeightedInfNorm[p]==null&&(n.accumulatedWeightedInfNorm[p]={originalName:f+"/v",variable:Ut(d).variable(!1)});var x=Array.isArray(e)?e[p].tensor:e[f];if(x!=null){var w=n.accumulatedFirstMoment[p].variable,C=n.accumulatedWeightedInfNorm[p].variable,S=w.mul(n.beta1).add(x.mul(1-n.beta1)),R=C.mul(n.beta2),N=x.abs(),D=R.maximum(N);w.assign(S),C.assign(D);var M=c.div(i).mul(S.div(D.add(n.epsilon))).add(d);d.assign(M)}})),n.iteration.assign(n.iteration.add(1)),n.accBeta1.assign(n.accBeta1.mul(n.beta1))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&ra(this.accumulatedFirstMoment.map((function(e){return e.variable}))),this.accumulatedWeightedInfNorm!=null&&ra(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(e){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},t.prototype.setWeights=function(e){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(n){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)},t.className="Adamax",t})(js);Gs(FR);var Pb=(function(r){function t(e){var n=r.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return Za(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map((function(a){return a.name})):Object.keys(e)).forEach((function(a,i){var c=Array.isArray(e)?e[i].tensor:e[a];if(c!=null){var f=le.registeredVariables[a];Xe((function(){var p=n.c.mul(c).add(f);f.assign(p)}))}})),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=rS(Ge(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}}))}))},t.prototype.setWeights=function(e){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:if((e=n.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,n){return new e(n.learningRate)},t.className="SGD",t})(js);Gs(Pb);var PR=(function(r){function t(e,n,a){a===void 0&&(a=!1);var i=r.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=a,i.accumulations=[],i.m=Ge(i.momentum),i}return Za(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map((function(a){return a.name})):Object.keys(e)).forEach((function(a,i){var c=le.registeredVariables[a];n.accumulations[i]==null&&(n.accumulations[i]={originalName:a+"/momentum",variable:Xe((function(){return Ut(c).variable(!1)}))});var f=n.accumulations[i].variable,p=Array.isArray(e)?e[i].tensor:e[a];p!=null&&Xe((function(){var d,x=n.m.mul(f).add(p);d=n.useNesterov?n.c.mul(p.add(x.mul(n.m))).add(c):n.c.mul(x).add(c),f.assign(x),c.assign(d)}))})),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&ra(this.accumulations.map((function(e){return e.variable})))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map((function(n){return{name:n.originalName,tensor:n.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ze(this,void 0,void 0,(function(){return Qe(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),this.accumulations=e.map((function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)},t.className="Momentum",t})(Pb);Gs(PR);var UR=(function(r){function t(e,n,a,i,c){n===void 0&&(n=.9),a===void 0&&(a=0),i===void 0&&(i=null),c===void 0&&(c=!1);var f=r.call(this)||this;if(f.learningRate=e,f.decay=n,f.momentum=a,f.epsilon=i,f.accumulatedMeanSquares=[],f.accumulatedMoments=[],f.accumulatedMeanGrads=[],f.centered=c,i==null&&(f.epsilon=le.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return f}return Za(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map((function(a){return a.name})):Object.keys(e)).forEach((function(a,i){var c=le.registeredVariables[a];n.accumulatedMeanSquares[i]==null&&(n.accumulatedMeanSquares[i]={originalName:a+"/rms",variable:Xe((function(){return Ut(c).variable(!1)}))}),n.accumulatedMoments[i]==null&&(n.accumulatedMoments[i]={originalName:a+"/momentum",variable:Xe((function(){return Ut(c).variable(!1)}))}),n.accumulatedMeanGrads[i]==null&&n.centered&&(n.accumulatedMeanGrads[i]={originalName:a+"/mg",variable:Xe((function(){return Ut(c).variable(!1)}))});var f=Array.isArray(e)?e[i].tensor:e[a];if(f!=null){var p=n.accumulatedMeanSquares[i].variable,d=n.accumulatedMoments[i].variable;Xe((function(){var x=p.mul(n.decay).add(f.square().mul(1-n.decay));if(n.centered){var w=n.accumulatedMeanGrads[i].variable,C=w.mul(n.decay).add(f.mul(1-n.decay)),S=d.mul(n.momentum).add(f.mul(n.learningRate).div(x.sub(C.square().add(n.epsilon)).sqrt()));p.assign(x),w.assign(C),d.assign(S);var R=c.sub(S);c.assign(R)}else{var N=p.mul(n.decay).add(f.square().mul(1-n.decay));S=d.mul(n.momentum).add(f.mul(n.learningRate).div(N.add(n.epsilon).sqrt())),p.assign(N),d.assign(S),R=c.sub(S),c.assign(R)}}))}})),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&ra(this.accumulatedMeanSquares.map((function(e){return e.variable}))),this.accumulatedMeanGrads!=null&&this.centered&&ra(this.accumulatedMeanGrads.map((function(e){return e.variable}))),this.accumulatedMoments!=null&&ra(this.accumulatedMoments.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return Ze(this,void 0,void 0,(function(){var e;return Qe(this,(function(n){switch(n.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map((function(a){return{name:a.originalName,tensor:a.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ze(this,void 0,void 0,(function(){var n;return Qe(this,(function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),n=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,n).map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),this.accumulatedMoments=e.slice(n,2*n).map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*n,3*n).map((function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}))),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)},t.className="RMSProp",t})(js);Gs(UR);_n.prototype.squaredDifference=function(r){return $y(this,r)},_e=fR;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Zp=function(r,t){return Zp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])},Zp(r,t)};function vt(r,t){Zp(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Lr=function(){return Lr=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Lr.apply(this,arguments)};function et(r,t,e,n){function a(i){return i instanceof e?i:new e(function(c){c(i)})}return new(e||(e=Promise))(function(i,c){function f(x){try{d(n.next(x))}catch(w){c(w)}}function p(x){try{d(n.throw(x))}catch(w){c(w)}}function d(x){x.done?i(x.value):a(x.value).then(f,p)}d((n=n.apply(r,[])).next())})}function tt(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(d){return function(x){return p([d,x])}}function p(d){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,a&&(i=d[0]&2?a.return:d[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,d[1])).done)return i;switch(a=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return e.label++,{value:d[1],done:!1};case 5:e.label++,a=d[1],d=[0];continue;case 7:d=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){e=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){e.label=d[1];break}if(d[0]===6&&e.label<i[1]){e.label=i[1],i=d;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(d);break}i[2]&&e.ops.pop(),e.trys.pop();continue}d=t.call(r,e)}catch(x){d=[6,x],a=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function lc(){for(var r=0,t=0,e=arguments.length;t<e;t++)r+=arguments[t].length;for(var n=Array(r),a=0,t=0;t<e;t++)for(var i=arguments[t],c=0,f=i.length;c<f;c++,a++)n[a]=i[c];return n}var qu=(function(){function r(t,e){if(!Fs(t)||!Fs(e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(r.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),r.prototype.reverse=function(){return new r(1/this.width,1/this.height)},r})();function Gh(r,t){return r instanceof _n&&r.shape.length===t}function zR(r){return Gh(r,2)}function jh(r){return Gh(r,3)}function $o(r){return Gh(r,4)}function HR(r){return r%1!==0}function _x(r){return r%2===0}function VR(r,t){t===void 0&&(t=2);var e=Math.pow(10,t);return Math.floor(r*e)/e}function Tx(r){return r&&r.width&&r.height}function WR(r,t){var e=r.width,n=r.height,a=t/Math.max(n,e);return new qu(Math.round(e*a),Math.round(n*a))}function F1(r){return r.reduce(function(t,e){return t.add(e)},new Kt(0,0)).div(new Kt(r.length,r.length))}function vc(r,t,e){return Array(r).fill(0).map(function(n,a){return t+a*e})}function Fs(r){return!!r&&r!==1/0&&r!==-1/0&&!isNaN(r)||r===0}function Ix(r){return Fs(r)&&0<=r&&r<=1}var Kt=(function(){function r(t,e){this._x=t,this._y=e}return Object.defineProperty(r.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),r.prototype.add=function(t){return new r(this.x+t.x,this.y+t.y)},r.prototype.sub=function(t){return new r(this.x-t.x,this.y-t.y)},r.prototype.mul=function(t){return new r(this.x*t.x,this.y*t.y)},r.prototype.div=function(t){return new r(this.x/t.x,this.y/t.y)},r.prototype.abs=function(){return new r(Math.abs(this.x),Math.abs(this.y))},r.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},r.prototype.floor=function(){return new r(Math.floor(this.x),Math.floor(this.y))},r})(),ns=(function(){function r(t,e){e===void 0&&(e=!0);var n=t||{},a=[n.left,n.top,n.right,n.bottom].every(Fs),i=[n.x,n.y,n.width,n.height].every(Fs);if(!i&&!a)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(n));var c=i?[n.x,n.y,n.width,n.height]:[n.left,n.top,n.right-n.left,n.bottom-n.top],f=c[0],p=c[1],d=c[2],x=c[3];r.assertIsValidBox({x:f,y:p,width:d,height:x},"Box.constructor",e),this._x=f,this._y=p,this._width=d,this._height=x}return r.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(Fs)},r.assertIsValidBox=function(t,e,n){if(n===void 0&&(n=!1),!r.isRect(t))throw new Error(e+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!n&&(t.width<0||t.height<0))throw new Error(e+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(r.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topLeft",{get:function(){return new Kt(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topRight",{get:function(){return new Kt(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomLeft",{get:function(){return new Kt(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomRight",{get:function(){return new Kt(this.right,this.bottom)},enumerable:!0,configurable:!0}),r.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(c){return Math.round(c)}),e=t[0],n=t[1],a=t[2],i=t[3];return new r({x:e,y:n,width:a,height:i})},r.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(c){return Math.floor(c)}),e=t[0],n=t[1],a=t[2],i=t[3];return new r({x:e,y:n,width:a,height:i})},r.prototype.toSquare=function(){var t=this,e=t.x,n=t.y,a=t.width,i=t.height,c=Math.abs(a-i);return a<i&&(e-=c/2,a+=c),i<a&&(n-=c/2,i+=c),new r({x:e,y:n,width:a,height:i})},r.prototype.rescale=function(t){var e=Tx(t)?t.width:t,n=Tx(t)?t.height:t;return new r({x:this.x*e,y:this.y*n,width:this.width*e,height:this.height*n})},r.prototype.pad=function(t,e){var n=[this.x-t/2,this.y-e/2,this.width+t,this.height+e],a=n[0],i=n[1],c=n[2],f=n[3];return new r({x:a,y:i,width:c,height:f})},r.prototype.clipAtImageBorders=function(t,e){var n=this,a=n.x,i=n.y,c=n.right,f=n.bottom,p=Math.max(a,0),d=Math.max(i,0),x=c-p,w=f-d,C=Math.min(x,t-p),S=Math.min(w,e-d);return new r({x:p,y:d,width:C,height:S}).floor()},r.prototype.shift=function(t,e){var n=this,a=n.width,i=n.height,c=this.x+t,f=this.y+e;return new r({x:c,y:f,width:a,height:i})},r.prototype.padAtBorders=function(t,e){var n=this.width+1,a=this.height+1,i=1,c=1,f=n,p=a,d=this.left,x=this.top,w=this.right,C=this.bottom;return w>e&&(f=-w+e+n,w=e),C>t&&(p=-C+t+a,C=t),d<1&&(p=2-d,d=1),x<1&&(p=2-x,x=1),{dy:c,edy:p,dx:i,edx:f,y:x,ey:C,x:d,ex:w,w:n,h:a}},r.prototype.calibrate=function(t){return new r({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},r})(),Xh=(function(r){vt(t,r);function t(e,n,a,i,c){return c===void 0&&(c=!1),r.call(this,{left:e,top:n,right:a,bottom:i},c)||this}return t})(ns),Ub=(function(){function r(t,e,n,a,i){this._imageDims=new qu(i.width,i.height),this._score=t,this._classScore=e,this._className=n,this._box=new ns(a).rescale(this._imageDims)}return Object.defineProperty(r.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relativeBox",{get:function(){return new ns(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),r.prototype.forSize=function(t,e){return new r(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:e})},r})(),Mi=(function(r){vt(t,r);function t(e,n,a){return r.call(this,e,e,"",n,a)||this}return t.prototype.forSize=function(e,n){var a=r.prototype.forSize.call(this,e,n),i=a.score,c=a.relativeBox,f=a.imageDims;return new t(i,c,f)},t})(Ub);function GR(r,t,e){e===void 0&&(e=!0);var n=Math.max(0,Math.min(r.right,t.right)-Math.max(r.left,t.left)),a=Math.max(0,Math.min(r.bottom,t.bottom)-Math.max(r.top,t.top)),i=n*a;return e?i/(r.area+t.area-i):i/Math.min(r.area,t.area)}function jR(r){var t=r.map(function(f){return f.x}),e=r.map(function(f){return f.y}),n=t.reduce(function(f,p){return p<f?p:f},1/0),a=e.reduce(function(f,p){return p<f?p:f},1/0),i=t.reduce(function(f,p){return f<p?p:f},0),c=e.reduce(function(f,p){return f<p?p:f},0);return new Xh(n,a,i,c)}function mc(r,t,e,n){n===void 0&&(n=!0);for(var a=t.map(function(f,p){return{score:f,boxIndex:p}}).sort(function(f,p){return f.score-p.score}).map(function(f){return f.boxIndex}),i=[],c=function(){var f=a.pop();i.push(f);for(var p=a,d=[],x=0;x<p.length;x++){var w=p[x],C=r[f],S=r[w];d.push(GR(C,S,n))}a=a.filter(function(R,N){return d[N]<=e})};a.length>0;)c();return i}function Rc(r,t){return Xe(function(){var e=t[0],n=t[1],a=t[2],i=Si(lc(r.shape.slice(0,3),[1]),e),c=Si(lc(r.shape.slice(0,3),[1]),n),f=Si(lc(r.shape.slice(0,3),[1]),a),p=or([i,c,f],3);return lr(r,p)})}function XR(r,t){return t===void 0&&(t=!1),Xe(function(){var e=r.shape.slice(1),n=e[0],a=e[1];if(n===a)return r;var i=Math.abs(n-a),c=Math.round(i*(t?.5:1)),f=n>a?2:1,p=function(S){var R=r.shape.slice();return R[f]=S,Si(R,0)},d=p(c),x=i-d.shape[f],w=t&&x?p(x):null,C=[w,r,d].filter(function(S){return!!S}).map(function(S){return S.toFloat()});return or(C,f)})}function Cp(r){return 1/(1+Math.exp(-r))}var P1=(function(r){vt(t,r);function t(e,n,a,i,c){return c===void 0&&(c=!1),r.call(this,{x:e,y:n,width:a,height:i},c)||this}return t})(ns),YR=.5,qR=.43,KR=.45,Rh=(function(){function r(t,e,n){n===void 0&&(n=new Kt(0,0));var a=e.width,i=e.height;this._imgDims=new qu(a,i),this._shift=n,this._positions=t.map(function(c){return c.mul(new Kt(a,i)).add(n)})}return Object.defineProperty(r.prototype,"shift",{get:function(){return new Kt(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(e){return e.sub(t._shift).div(new Kt(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),r.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},r.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new Kt(t,e))},r.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},r.prototype.align=function(t,e){if(e===void 0&&(e={}),t){var n=t instanceof Mi?t.box.floor():new ns(t);return this.shiftBy(n.x,n.y).align(null,e)}var a=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),i=a.useDlibAlignment,c=a.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(c)},r.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),e=t[0],n=t[1],a=t[2],i=function(w){return a.sub(w).magnitude()},c=(i(e)+i(n))/2,f=Math.floor(c/KR),p=F1(t),d=Math.floor(Math.max(0,p.x-YR*f)),x=Math.floor(Math.max(0,p.y-qR*f));return new P1(d,x,Math.min(f,this.imageWidth+d),Math.min(f,this.imageHeight+x))},r.prototype.alignMinBbox=function(t){var e=jR(this.positions);return e.pad(e.width*t,e.height*t)},r.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},r})(),ZR=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],F1([e[3],e[4]])]},t})(Rh),QR=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(F1)},t})(Rh),Rx=(function(){function r(t,e){this._label=t,this._distance=e}return Object.defineProperty(r.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),r.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+VR(this.distance)+")":"")},r})(),Nx=(function(r){vt(t,r);function t(e,n){var a=r.call(this,e)||this;return a._label=n,a}return t.assertIsValidLabeledBox=function(e,n){if(ns.assertIsValidBox(e,n),!Fs(e.label))throw new Error(n+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t})(ns),$f=(function(){function r(t,e){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(e)||e.some(function(n){return!(n instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=e}return Object.defineProperty(r.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),r.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},r.fromJSON=function(t){var e=t.descriptors.map(function(n){return new Float32Array(n)});return new r(t.label,e)},r})();(function(r){vt(t,r);function t(e,n,a,i){var c=r.call(this,e,n)||this;return c._score=a,c._classScore=i,c}return t.assertIsValidPredictedBox=function(e,n){if(Nx.assertIsValidLabeledBox(e,n),!Ix(e.score)||!Ix(e.classScore))throw new Error(n+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(Nx);function JR(r){return r.detection instanceof Mi}function U1(r,t){var e={detection:t};return Object.assign({},r,e)}function zb(){var r=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:r,readFile:t}}function Hb(r){var t="";if(!r)try{r=require("fs")}catch(n){t=n.toString()}var e=r?function(n){return new Promise(function(a,i){r.readFile(n,function(c,f){return c?i(c):a(f)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:e}}function Vb(){var r=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,e=function(){if(r)return new r;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},n=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},a=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=Hb();return Lr({Canvas:r||(function(){function c(){}return c})(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||(function(){function c(){}return c})(),Image:t||(function(){function c(){}return c})(),ImageData:global.ImageData||(function(){function c(){}return c})(),Video:global.HTMLVideoElement||(function(){function c(){}return c})(),createCanvasElement:e,createImageElement:n,fetch:a},i)}function Wb(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function Gb(){return typeof global=="object"&&typeof require=="function"&&typeof Ew<"u"&&typeof process<"u"&&!!process.version}var ir;function $R(){if(!ir)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return ir}function Qp(r){ir=r}function z1(){Wb()&&Qp(zb()),Gb()&&Qp(Vb())}function eN(r){if(ir||z1(),!ir)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=r.Canvas,e=t===void 0?ir.Canvas:t,n=r.Image,a=n===void 0?ir.Image:n;ir.Canvas=e,ir.Image=a,ir.createCanvasElement=r.createCanvasElement||(function(){return new e}),ir.createImageElement=r.createImageElement||(function(){return new a}),ir.ImageData=r.ImageData||ir.ImageData,ir.Video=r.Video||ir.Video,ir.fetch=r.fetch||ir.fetch,ir.readFile=r.readFile||ir.readFile}var zr={getEnv:$R,setEnv:Qp,initialize:z1,createBrowserEnv:zb,createFileSystem:Hb,createNodejsEnv:Vb,monkeyPatch:eN,isBrowser:Wb,isNodejs:Gb};z1();function jb(r){return!zr.isNodejs()&&typeof r=="string"?document.getElementById(r):r}function Us(r){var t=zr.getEnv(),e=t.Canvas,n=t.CanvasRenderingContext2D;if(r instanceof n)return r;var a=jb(r);if(!(a instanceof e))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=a.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var Dx;(function(r){r.TOP_LEFT="TOP_LEFT",r.TOP_RIGHT="TOP_RIGHT",r.BOTTOM_LEFT="BOTTOM_LEFT",r.BOTTOM_RIGHT="BOTTOM_RIGHT"})(Dx||(Dx={}));function Xb(r){var t=zr.getEnv(),e=t.Image,n=t.Video;return r instanceof e&&r.complete||r instanceof n&&r.readyState>=3}function tN(r){return new Promise(function(t,e){if(r instanceof zr.getEnv().Canvas||Xb(r))return t();function n(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",n),i.currentTarget.removeEventListener("error",a),t(i))}function a(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",n),i.currentTarget.removeEventListener("error",a),e(i))}r.addEventListener("load",n),r.addEventListener("error",a)})}function Yb(r){var t=zr.getEnv(),e=t.Image,n=t.Video;return r instanceof e?new qu(r.naturalWidth,r.naturalHeight):r instanceof n?new qu(r.videoWidth,r.videoHeight):new qu(r.width,r.height)}function Yh(r){var t=r.width,e=r.height,n=zr.getEnv().createCanvasElement,a=n();return a.width=t,a.height=e,a}function H1(r,t){var e=zr.getEnv().ImageData;if(!(r instanceof e)&&!Xb(r))throw new Error("createCanvasFromMedia - media has not finished loading yet");var n=Yb(r),a=n.width,i=n.height,c=Yh({width:a,height:i});return r instanceof e?Us(c).putImageData(r,0,0):Us(c).drawImage(r,0,0,a,i),c}function nN(r,t){return et(this,void 0,void 0,function(){var e,n,a,i,c,f;return tt(this,function(p){switch(p.label){case 0:return e=zr.getEnv().createCanvasElement(),n=r.shape.slice($o(r)?1:0),a=n[0],i=n[1],c=n[2],f=Xe(function(){return r.as3D(a,i,c).toInt()}),[4,L1.toPixels(f,e)];case 1:return p.sent(),f.dispose(),[2,e]}})})}function Mx(r){var t=zr.getEnv(),e=t.Image,n=t.Canvas,a=t.Video;return r instanceof e||r instanceof n||r instanceof a}function rN(r,t,e){e===void 0&&(e=!1);var n=zr.getEnv(),a=n.Image,i=n.Canvas;if(!(r instanceof a||r instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var c=Yb(r),f=t/Math.max(c.height,c.width),p=f*c.width,d=f*c.height,x=Yh({width:t,height:t}),w=r instanceof i?r:H1(r),C=Math.abs(p-d)/2,S=e&&p<d?C:0,R=e&&d<p?C:0;return Us(x).drawImage(w,S,R,p,d),x}var Nh=(function(){function r(t,e){var n=this;if(e===void 0&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach(function(a,i){if(jh(a)){n._imageTensors[i]=a,n._inputDimensions[i]=a.shape;return}if($o(a)){var c=a.shape[0];if(c!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+c+" passed, but not supported in input array");n._imageTensors[i]=a,n._inputDimensions[i]=a.shape.slice(1);return}var f=a instanceof zr.getEnv().Canvas?a:H1(a);n._canvases[i]=f,n._inputDimensions[i]=[f.height,f.width,3]})}return Object.defineProperty(r.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"reshapedInputDimensions",{get:function(){var t=this;return vc(this.batchSize,0,1).map(function(e,n){return t.getReshapedInputDimensions(n)})},enumerable:!0,configurable:!0}),r.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},r.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},r.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},r.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},r.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var e=this.getInputWidth(t),n=this.getInputHeight(t);return WR({width:e,height:n},this.inputSize)},r.prototype.toBatchTensor=function(t,e){var n=this;return e===void 0&&(e=!0),this._inputSize=t,Xe(function(){var a=vc(n.batchSize,0,1).map(function(c){var f=n.getInput(c);if(f instanceof _n){var p=$o(f)?f:f.expandDims();return p=XR(p,e),(p.shape[1]!==t||p.shape[2]!==t)&&(p=N1.resizeBilinear(p,[t,t])),p.as3D(t,t,3)}if(f instanceof zr.getEnv().Canvas)return L1.fromPixels(rN(f,t,e));throw new Error("toBatchTensor - at batchIdx "+c+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+f)}),i=Sa(a.map(function(c){return c.toFloat()})).as4D(n.batchSize,t,t,3);return i})},r})();function br(r){return et(this,void 0,void 0,function(){var t,e,n;return tt(this,function(a){switch(a.label){case 0:if(r instanceof Nh)return[2,r];if(t=Array.isArray(r)?r:[r],!t.length)throw new Error("toNetInput - empty array passed as input");return e=function(i){return Array.isArray(r)?" at input index "+i+":":""},n=t.map(jb),n.forEach(function(i,c){if(!Mx(i)&&!jh(i)&&!$o(i))throw typeof t[c]=="string"?new Error("toNetInput -"+e(c)+" string passed, but could not resolve HTMLElement for element id "+t[c]):new Error("toNetInput -"+e(c)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if($o(i)){var f=i.shape[0];if(f!==1)throw new Error("toNetInput -"+e(c)+" tf.Tensor4D with batchSize "+f+" passed, but not supported in input array")}}),[4,Promise.all(n.map(function(i){return Mx(i)&&tN(i)}))];case 1:return a.sent(),[2,new Nh(n,Array.isArray(r))]}})})}function V1(r,t){return et(this,void 0,void 0,function(){var e,n,a,i,c,f,p;return tt(this,function(d){switch(d.label){case 0:return e=zr.getEnv().Canvas,n=r,r instanceof e?[3,5]:[4,br(r)];case 1:if(a=d.sent(),a.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=a.getInput(0),i instanceof e?(c=i,[3,4]):[3,2];case 2:return[4,nN(i)];case 3:c=d.sent(),d.label=4;case 4:n=c,d.label=5;case 5:return f=Us(n),p=t.map(function(x){return x instanceof Mi?x.forSize(n.width,n.height).box.floor():x}).map(function(x){return x.clipAtImageBorders(n.width,n.height)}),[2,p.map(function(x){var w=x.x,C=x.y,S=x.width,R=x.height,N=Yh({width:S,height:R});return Us(N).putImageData(f.getImageData(w,C,S,R),0,0),N})]}})})}function W1(r,t){return et(this,void 0,void 0,function(){return tt(this,function(e){if(!jh(r)&&!$o(r))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if($o(r)&&r.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,Xe(function(){var n=r.shape.slice($o(r)?1:0),a=n[0],i=n[1],c=n[2],f=t.map(function(d){return d instanceof Mi?d.forSize(i,a).box:d}).map(function(d){return d.clipAtImageBorders(i,a)}),p=f.map(function(d){var x=d.x,w=d.y,C=d.width,S=d.height;return bb(r.as3D(a,i,c),[w,x,0],[S,C,c])});return p})]})})}function aN(r,t){return et(this,void 0,void 0,function(){var e,n;return tt(this,function(a){switch(a.label){case 0:return e=zr.getEnv().fetch,[4,e(r,t)];case 1:if(n=a.sent(),!(n.status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}})})}function iN(r){return et(this,void 0,void 0,function(){return tt(this,function(t){switch(t.label){case 0:return[4,aN(r)];case 1:return[2,t.sent().json()]}})})}function qb(r,t){var e=t+"-weights_manifest.json";if(!r)return{modelBaseUri:"",manifestUri:e};if(r==="/")return{modelBaseUri:"/",manifestUri:"/"+e};var n=r.startsWith("http://")?"http://":r.startsWith("https://")?"https://":"";r=r.replace(n,"");var a=r.split("/").filter(function(f){return f}),i=r.endsWith(".json")?a[a.length-1]:e,c=n+(r.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return c=r.startsWith("/")?"/"+c:c,{modelBaseUri:c,manifestUri:c==="/"?"/"+i:c+"/"+i}}function oN(r,t){return et(this,void 0,void 0,function(){var e,n,a,i;return tt(this,function(c){switch(c.label){case 0:return e=qb(r,t),n=e.manifestUri,a=e.modelBaseUri,[4,iN(n)];case 1:return i=c.sent(),[2,Fb.loadWeights(i,a)]}})})}var lo=(function(){function r(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(r.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),r.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t),n=e.obj,a=e.objProp;return n[a]},r.prototype.reassignParamFromPath=function(t,e){var n=this.traversePropertyPath(t),a=n.obj,i=n.objProp;a[i].dispose(),a[i]=e},r.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(e){var n=e.paramPath;return{path:n,tensor:t.getParamFromPath(n)}})},r.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Qu})},r.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Qu)})},r.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(e){var n=e.path,a=e.tensor;t.reassignParamFromPath(n,a.variable())})},r.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(e){var n=e.path,a=e.tensor,i=Tr(a.dataSync());a.dispose(),t.reassignParamFromPath(n,i)})},r.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(e){if(t&&e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()}),this._params=void 0},r.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var e=t.tensor;return Array.from(e.dataSync())}).reduce(function(t,e){return t.concat(e)}))},r.prototype.load=function(t){return et(this,void 0,void 0,function(){return tt(this,function(e){switch(e.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}})})},r.prototype.loadFromUri=function(t){return et(this,void 0,void 0,function(){var e;return tt(this,function(n){switch(n.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,oN(t,this.getDefaultModelName())];case 1:return e=n.sent(),this.loadFromWeightMap(e),[2]}})})},r.prototype.loadFromDisk=function(t){return et(this,void 0,void 0,function(){var e,n,a,i,c,f,p,d,x,w;return tt(this,function(C){switch(C.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return e=zr.getEnv().readFile,n=qb(t,this.getDefaultModelName()),a=n.manifestUri,i=n.modelBaseUri,c=function(S){return Promise.all(S.map(function(R){return e(R).then(function(N){return N.buffer})}))},f=Fb.weightsLoaderFactory(c),x=(d=JSON).parse,[4,e(a)];case 1:return p=x.apply(d,[C.sent().toString()]),[4,f(p,i)];case 2:return w=C.sent(),this.loadFromWeightMap(w),[2]}})})},r.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),n=e.paramMappings,a=e.params;this._paramMappings=n,this._params=a},r.prototype.extractWeights=function(t){var e=this.extractParams(t),n=e.paramMappings,a=e.params;this._paramMappings=n,this._params=a},r.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce(function(i,c){if(!i.nextObj.hasOwnProperty(c))throw new Error("traversePropertyPath - object does not have property "+c+", for path "+t);return{obj:i.nextObj,objProp:c,nextObj:i.nextObj[c]}},{nextObj:this.params}),n=e.obj,a=e.objProp;if(!n||!a||!(n[a]instanceof _n))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:n,objProp:a}},r})();function Ca(r,t,e){return Xe(function(){var n=S1(r,t.depthwise_filter,t.pointwise_filter,e,"same");return n=It(n,t.bias),n})}function Ap(r,t,e){return e===void 0&&(e=!1),Xe(function(){var n=Tn(e?It(Pa(r,t.conv0.filters,[2,2],"same"),t.conv0.bias):Ca(r,t.conv0,[2,2])),a=Ca(n,t.conv1,[1,1]),i=Tn(It(n,a)),c=Ca(i,t.conv2,[1,1]);return Tn(It(n,It(a,c)))})}function eh(r,t,e,n){return e===void 0&&(e=!1),n===void 0&&(n=!0),Xe(function(){var a=Tn(e?It(Pa(r,t.conv0.filters,n?[2,2]:[1,1],"same"),t.conv0.bias):Ca(r,t.conv0,n?[2,2]:[1,1])),i=Ca(a,t.conv1,[1,1]),c=Tn(It(a,i)),f=Ca(c,t.conv2,[1,1]),p=Tn(It(a,It(i,f))),d=Ca(p,t.conv3,[1,1]);return Tn(It(a,It(i,It(f,d))))})}function Ka(r,t,e,n){return e===void 0&&(e="same"),n===void 0&&(n=!1),Xe(function(){var a=It(Pa(r,t.filters,[1,1],e),t.bias);return n?Tn(a):a})}function co(r,t){Object.keys(r).forEach(function(e){t.some(function(n){return n.originalPath===e})||r[e].dispose()})}function qh(r,t){return function(e,n,a,i){var c=ta(r(e*n*a*a),[a,a,e,n]),f=Zn(r(n));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:c,bias:f}}}function G1(r,t){return function(e,n,a){var i=Qo(r(e*n),[e,n]),c=Zn(r(n));return t.push({paramPath:a+"/weights"},{paramPath:a+"/bias"}),{weights:i,bias:c}}}var Kb=(function(){function r(t,e,n){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=n}return r})();function j1(r,t){return function(e,n,a){var i=ta(r(9*e),[3,3,e,1]),c=ta(r(e*n),[1,1,e,n]),f=Zn(r(n));return t.push({paramPath:a+"/depthwise_filter"},{paramPath:a+"/pointwise_filter"},{paramPath:a+"/bias"}),new Kb(i,c,f)}}function X1(r){return function(t){var e=r(t+"/depthwise_filter",4),n=r(t+"/pointwise_filter",4),a=r(t+"/bias",1);return new Kb(e,n,a)}}function is(r,t){return function(e,n,a){var i=r[e];if(!Gh(i,n))throw new Error("expected weightMap["+e+"] to be a Tensor"+n+"D, instead have "+i);return t.push({originalPath:e,paramPath:a||e}),i}}function fo(r){var t=r;function e(a){var i=t.slice(0,a);return t=t.slice(a),i}function n(){return t}return{extractWeights:e,getRemainingWeights:n}}function Zb(r,t){var e=qh(r,t),n=j1(r,t);function a(c,f,p,d){d===void 0&&(d=!1);var x=d?e(c,f,3,p+"/conv0"):n(c,f,p+"/conv0"),w=n(f,f,p+"/conv1"),C=n(f,f,p+"/conv2");return{conv0:x,conv1:w,conv2:C}}function i(c,f,p,d){d===void 0&&(d=!1);var x=a(c,f,p,d),w=x.conv0,C=x.conv1,S=x.conv2,R=n(f,f,p+"/conv3");return{conv0:w,conv1:C,conv2:S,conv3:R}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:i}}function sN(r){var t=[],e=fo(r),n=e.extractWeights,a=e.getRemainingWeights,i=Zb(n,t).extractDenseBlock4Params,c=i(3,32,"dense0",!0),f=i(32,64,"dense1"),p=i(64,128,"dense2"),d=i(128,256,"dense3");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:c,dense1:f,dense2:p,dense3:d}}}function Qb(r){return function(t){var e=r(t+"/filters",4),n=r(t+"/bias",1);return{filters:e,bias:n}}}function Jb(r,t){var e=is(r,t),n=Qb(e),a=X1(e);function i(f,p){p===void 0&&(p=!1);var d=p?n(f+"/conv0"):a(f+"/conv0"),x=a(f+"/conv1"),w=a(f+"/conv2");return{conv0:d,conv1:x,conv2:w}}function c(f,p){p===void 0&&(p=!1);var d=p?n(f+"/conv0"):a(f+"/conv0"),x=a(f+"/conv1"),w=a(f+"/conv2"),C=a(f+"/conv3");return{conv0:d,conv1:x,conv2:w,conv3:C}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:c}}function uN(r){var t=[],e=Jb(r,t).extractDenseBlock4Params,n={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2"),dense3:e("dense3")};return co(r,t),{params:n,paramMappings:t}}var $b=(function(r){vt(t,r);function t(){return r.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("FaceFeatureExtractor - load model before inference");return Xe(function(){var a=e.toBatchTensor(112,!0),i=[122.782,117.001,104.298],c=Rc(a,i).div(Ge(255)),f=eh(c,n.dense0,!0);return f=eh(f,n.dense1),f=eh(f,n.dense2),f=eh(f,n.dense3),f=Tc(f,[7,7],[2,2],"valid"),f})},t.prototype.forward=function(e){return et(this,void 0,void 0,function(){var n;return tt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,br(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return uN(e)},t.prototype.extractParams=function(e){return sN(e)},t})(lo);function Ei(r,t){return Xe(function(){return It(Hh(r,t.weights),t.bias)})}function lN(r,t,e){var n=[],a=fo(r),i=a.extractWeights,c=a.getRemainingWeights,f=G1(i,n),p=f(t,e,"fc");if(c().length!==0)throw new Error("weights remaing after extract: "+c().length);return{paramMappings:n,params:{fc:p}}}function cN(r){var t=[],e=is(r,t);function n(i){var c=e(i+"/weights",2),f=e(i+"/bias",1);return{weights:c,bias:f}}var a={fc:n("fc")};return co(r,t),{params:a,paramMappings:t}}function ew(r){var t={},e={};return Object.keys(r).forEach(function(n){var a=n.startsWith("fc")?e:t;a[n]=r[n]}),{featureExtractorMap:t,classifierMap:e}}var tw=(function(r){vt(t,r);function t(e,n){var a=r.call(this,e)||this;return a._faceFeatureExtractor=n,a}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var n=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return Xe(function(){var i=e instanceof Nh?n.faceFeatureExtractor.forwardInput(e):e;return Ei(i.as2D(i.shape[0],-1),a.fc)})},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),r.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var n=this.extractClassifierParams(e),a=n.params,i=n.paramMappings;this._params=a,this._paramMappings=i},t.prototype.extractClassifierParams=function(e){return lN(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var n=ew(e),a=n.featureExtractorMap,i=n.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),cN(i)},t.prototype.extractParams=function(e){var n=this.getClassifierChannelsIn(),a=this.getClassifierChannelsOut(),i=a*n+a,c=e.slice(0,e.length-i),f=e.slice(e.length-i);return this.faceFeatureExtractor.extractWeights(c),this.extractClassifierParams(f)},t})(lo),Ox=["neutral","happy","sad","angry","fearful","disgusted","surprised"],fN=(function(){function r(t){var e=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);Ox.forEach(function(n,a){e[n]=t[a]})}return r.prototype.asSortedArray=function(){var t=this;return Ox.map(function(e){return{expression:e,probability:t[e]}}).sort(function(e,n){return n.probability-e.probability})},r})(),hN=(function(r){vt(t,r);function t(e){return e===void 0&&(e=new $b),r.call(this,"FaceExpressionNet",e)||this}return t.prototype.forwardInput=function(e){var n=this;return Xe(function(){return so(n.runNet(e))})},t.prototype.forward=function(e){return et(this,void 0,void 0,function(){var n;return tt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,br(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.predictExpressions=function(e){return et(this,void 0,void 0,function(){var n,a,i,c,f=this;return tt(this,function(p){switch(p.label){case 0:return[4,br(e)];case 1:return n=p.sent(),[4,this.forwardInput(n)];case 2:return a=p.sent(),[4,Promise.all(sr(a).map(function(d){return et(f,void 0,void 0,function(){var x;return tt(this,function(w){switch(w.label){case 0:return[4,d.data()];case 1:return x=w.sent(),d.dispose(),[2,x]}})})}))];case 3:return i=p.sent(),a.dispose(),c=i.map(function(d){return new fN(d)}),[2,n.isBatchInput?c:c[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t})(tw);function nw(r,t){var e={expressions:t};return Object.assign({},r,e)}function dN(r){return JR(r)&&r.landmarks instanceof Rh&&r.unshiftedLandmarks instanceof Rh&&r.alignedRect instanceof Mi}function Y1(r,t){var e=r.detection.box,n=t.shiftBy(e.x,e.y),a=n.align(),i=r.detection.imageDims,c=new Mi(r.detection.score,a.rescale(i.reverse()),i),f={landmarks:n,unshiftedLandmarks:t,alignedRect:c};return Object.assign({},r,f)}function pN(r,t){var e=qh(r,t),n=j1(r,t);function a(c,f,p){var d=n(c,f,p+"/separable_conv0"),x=n(f,f,p+"/separable_conv1"),w=e(c,f,1,p+"/expansion_conv");return{separable_conv0:d,separable_conv1:x,expansion_conv:w}}function i(c,f){var p=n(c,c,f+"/separable_conv0"),d=n(c,c,f+"/separable_conv1"),x=n(c,c,f+"/separable_conv2");return{separable_conv0:p,separable_conv1:d,separable_conv2:x}}return{extractConvParams:e,extractSeparableConvParams:n,extractReductionBlockParams:a,extractMainBlockParams:i}}function gN(r,t){var e=[],n=fo(r),a=n.extractWeights,i=n.getRemainingWeights,c=pN(a,e),f=c.extractConvParams,p=c.extractSeparableConvParams,d=c.extractReductionBlockParams,x=c.extractMainBlockParams,w=f(3,32,3,"entry_flow/conv_in"),C=d(32,64,"entry_flow/reduction_block_0"),S=d(64,128,"entry_flow/reduction_block_1"),R={conv_in:w,reduction_block_0:C,reduction_block_1:S},N={};vc(t,0,1).forEach(function(k){N["main_block_"+k]=x(128,"middle_flow/main_block_"+k)});var D=d(128,256,"exit_flow/reduction_block"),M=p(256,512,"exit_flow/separable_conv"),B={reduction_block:D,separable_conv:M};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{entry_flow:R,middle_flow:N,exit_flow:B}}}function vN(r,t){var e=is(r,t),n=Qb(e),a=X1(e);function i(f){var p=a(f+"/separable_conv0"),d=a(f+"/separable_conv1"),x=n(f+"/expansion_conv");return{separable_conv0:p,separable_conv1:d,expansion_conv:x}}function c(f){var p=a(f+"/separable_conv0"),d=a(f+"/separable_conv1"),x=a(f+"/separable_conv2");return{separable_conv0:p,separable_conv1:d,separable_conv2:x}}return{extractConvParams:n,extractSeparableConvParams:a,extractReductionBlockParams:i,extractMainBlockParams:c}}function mN(r,t){var e=[],n=vN(r,e),a=n.extractConvParams,i=n.extractSeparableConvParams,c=n.extractReductionBlockParams,f=n.extractMainBlockParams,p=a("entry_flow/conv_in"),d=c("entry_flow/reduction_block_0"),x=c("entry_flow/reduction_block_1"),w={conv_in:p,reduction_block_0:d,reduction_block_1:x},C={};vc(t,0,1).forEach(function(D){C["main_block_"+D]=f("middle_flow/main_block_"+D)});var S=c("exit_flow/reduction_block"),R=i("exit_flow/separable_conv"),N={reduction_block:S,separable_conv:R};return co(r,e),{params:{entry_flow:w,middle_flow:C,exit_flow:N},paramMappings:e}}function rw(r,t,e){return It(Pa(r,t.filters,e,"same"),t.bias)}function Sp(r,t,e){e===void 0&&(e=!0);var n=e?Tn(r):r;return n=Ca(n,t.separable_conv0,[1,1]),n=Ca(Tn(n),t.separable_conv1,[1,1]),n=xr(n,[3,3],[2,2],"same"),n=It(n,rw(r,t.expansion_conv,[2,2])),n}function xN(r,t){var e=Ca(Tn(r),t.separable_conv0,[1,1]);return e=Ca(Tn(e),t.separable_conv1,[1,1]),e=Ca(Tn(e),t.separable_conv2,[1,1]),e=It(e,r),e}var yN=(function(r){vt(t,r);function t(e){var n=r.call(this,"TinyXception")||this;return n._numMainBlocks=e,n}return t.prototype.forwardInput=function(e){var n=this,a=this.params;if(!a)throw new Error("TinyXception - load model before inference");return Xe(function(){var i=e.toBatchTensor(112,!0),c=[122.782,117.001,104.298],f=Rc(i,c).div(Ge(256)),p=Tn(rw(f,a.entry_flow.conv_in,[2,2]));return p=Sp(p,a.entry_flow.reduction_block_0,!1),p=Sp(p,a.entry_flow.reduction_block_1),vc(n._numMainBlocks,0,1).forEach(function(d){p=xN(p,a.middle_flow["main_block_"+d])}),p=Sp(p,a.exit_flow.reduction_block),p=Tn(Ca(p,a.exit_flow.separable_conv,[1,1])),p})},t.prototype.forward=function(e){return et(this,void 0,void 0,function(){var n;return tt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,br(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return mN(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return gN(e,this._numMainBlocks)},t})(lo);function bN(r){var t=[],e=fo(r),n=e.extractWeights,a=e.getRemainingWeights,i=G1(n,t),c=i(512,1,"fc/age"),f=i(512,2,"fc/gender");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{fc:{age:c,gender:f}}}}function wN(r){var t=[],e=is(r,t);function n(i){var c=e(i+"/weights",2),f=e(i+"/bias",1);return{weights:c,bias:f}}var a={fc:{age:n("fc/age"),gender:n("fc/gender")}};return co(r,t),{params:a,paramMappings:t}}var Dh;(function(r){r.FEMALE="female",r.MALE="male"})(Dh||(Dh={}));var EN=(function(r){vt(t,r);function t(e){e===void 0&&(e=new yN(2));var n=r.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=e,n}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var n=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return Xe(function(){var i=e instanceof Nh?n.faceFeatureExtractor.forwardInput(e):e,c=Tc(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),f=Ei(c,a.fc.age).as1D(),p=Ei(c,a.fc.gender);return{age:f,gender:p}})},t.prototype.forwardInput=function(e){var n=this;return Xe(function(){var a=n.runNet(e),i=a.age,c=a.gender;return{age:i,gender:so(c)}})},t.prototype.forward=function(e){return et(this,void 0,void 0,function(){var n;return tt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,br(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.predictAgeAndGender=function(e){return et(this,void 0,void 0,function(){var n,a,i,c,f,p,d=this;return tt(this,function(x){switch(x.label){case 0:return[4,br(e)];case 1:return n=x.sent(),[4,this.forwardInput(n)];case 2:return a=x.sent(),i=sr(a.age),c=sr(a.gender),f=i.map(function(w,C){return{ageTensor:w,genderTensor:c[C]}}),[4,Promise.all(f.map(function(w){var C=w.ageTensor,S=w.genderTensor;return et(d,void 0,void 0,function(){var R,N,D,M,B;return tt(this,function(k){switch(k.label){case 0:return[4,C.data()];case 1:return R=k.sent()[0],[4,S.data()];case 2:return N=k.sent()[0],D=N>.5,M=D?Dh.MALE:Dh.FEMALE,B=D?N:1-N,C.dispose(),S.dispose(),[2,{age:R,gender:M,genderProbability:B}]}})})}))];case 3:return p=x.sent(),a.age.dispose(),a.gender.dispose(),[2,n.isBatchInput?p:p[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),r.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var n=this.extractClassifierParams(e),a=n.params,i=n.paramMappings;this._params=a,this._paramMappings=i},t.prototype.extractClassifierParams=function(e){return bN(e)},t.prototype.extractParamsFromWeigthMap=function(e){var n=ew(e),a=n.featureExtractorMap,i=n.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),wN(i)},t.prototype.extractParams=function(e){var n=1539,a=e.slice(0,e.length-n),i=e.slice(e.length-n);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(i)},t})(lo),aw=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.postProcess=function(e,n,a){var i=a.map(function(f){var p=f.width,d=f.height,x=n/Math.max(d,p);return{width:p*x,height:d*x}}),c=i.length;return Xe(function(){var f=function(C,S){return Sa([Si([68],C),Si([68],S)],1).as2D(1,136).as1D()},p=function(C,S){var R=i[C],N=R.width,D=R.height;return S(N,D)?Math.abs(N-D)/2:0},d=function(C){return p(C,function(S,R){return S<R})},x=function(C){return p(C,function(S,R){return R<S})},w=e.mul(Si([c,136],n)).sub(Sa(Array.from(Array(c),function(C,S){return f(d(S),x(S))}))).div(Sa(Array.from(Array(c),function(C,S){return f(i[S].width,i[S].height)})));return w})},t.prototype.forwardInput=function(e){var n=this;return Xe(function(){var a=n.runNet(e);return n.postProcess(a,e.inputSize,e.inputDimensions.map(function(i){var c=i[0],f=i[1];return{height:c,width:f}}))})},t.prototype.forward=function(e){return et(this,void 0,void 0,function(){var n;return tt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,br(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.detectLandmarks=function(e){return et(this,void 0,void 0,function(){var n,a,i,c=this;return tt(this,function(f){switch(f.label){case 0:return[4,br(e)];case 1:return n=f.sent(),a=Xe(function(){return sr(c.forwardInput(n))}),[4,Promise.all(a.map(function(p,d){return et(c,void 0,void 0,function(){var x,w,C,S,R;return tt(this,function(N){switch(N.label){case 0:return C=(w=Array).from,[4,p.data()];case 1:return x=C.apply(w,[N.sent()]),S=x.filter(function(D,M){return _x(M)}),R=x.filter(function(D,M){return!_x(M)}),[2,new QR(Array(68).fill(0).map(function(D,M){return new Kt(S[M],R[M])}),{height:n.getInputHeight(d),width:n.getInputWidth(d)})]}})})}))];case 2:return i=f.sent(),a.forEach(function(p){return p.dispose()}),[2,n.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t})(tw),iw=(function(r){vt(t,r);function t(e){return e===void 0&&(e=new $b),r.call(this,"FaceLandmark68Net",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t})(aw);function CN(r){var t=[],e=Jb(r,t).extractDenseBlock3Params,n={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2")};return co(r,t),{params:n,paramMappings:t}}function AN(r){var t=[],e=fo(r),n=e.extractWeights,a=e.getRemainingWeights,i=Zb(n,t).extractDenseBlock3Params,c=i(3,32,"dense0",!0),f=i(32,64,"dense1"),p=i(64,128,"dense2");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:c,dense1:f,dense2:p}}}var SN=(function(r){vt(t,r);function t(){return r.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("TinyFaceFeatureExtractor - load model before inference");return Xe(function(){var a=e.toBatchTensor(112,!0),i=[122.782,117.001,104.298],c=Rc(a,i).div(Ge(255)),f=Ap(c,n.dense0,!0);return f=Ap(f,n.dense1),f=Ap(f,n.dense2),f=Tc(f,[14,14],[2,2],"valid"),f})},t.prototype.forward=function(e){return et(this,void 0,void 0,function(){var n;return tt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,br(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return CN(e)},t.prototype.extractParams=function(e){return AN(e)},t})(lo),_N=(function(r){vt(t,r);function t(e){return e===void 0&&(e=new SN),r.call(this,"FaceLandmark68TinyNet",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t})(aw);(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t})(iw);function TN(r,t){return It(Ur(r,t.weights),t.biases)}function q1(r,t,e,n,a){a===void 0&&(a="same");var i=t.conv,c=i.filters,f=i.bias,p=Pa(r,c,e,a);return p=It(p,f),p=TN(p,t.scale),n?Tn(p):p}function IN(r,t){return q1(r,t,[1,1],!0)}function ow(r,t){return q1(r,t,[1,1],!1)}function sw(r,t){return q1(r,t,[2,2],!0,"valid")}function RN(r,t){function e(f,p,d){var x=r(f),w=x.length/(p*d*d);if(HR(w))throw new Error("depth has to be an integer: "+w+", weights.length: "+x.length+", numFilters: "+p+", filterSize: "+d);return Xe(function(){return ts(ta(x,[p,w,d,d]),[2,3,1,0])})}function n(f,p,d,x){var w=e(f,p,d),C=Zn(r(p));return t.push({paramPath:x+"/filters"},{paramPath:x+"/bias"}),{filters:w,bias:C}}function a(f,p){var d=Zn(r(f)),x=Zn(r(f));return t.push({paramPath:p+"/weights"},{paramPath:p+"/biases"}),{weights:d,biases:x}}function i(f,p,d,x){var w=n(f,p,d,x+"/conv"),C=a(p,x+"/scale");return{conv:w,scale:C}}function c(f,p,d,x,w){w===void 0&&(w=!1);var C=i((w?.5:1)*f,p,d,x+"/conv1"),S=i(f,p,d,x+"/conv2");return{conv1:C,conv2:S}}return{extractConvLayerParams:i,extractResidualLayerParams:c}}function NN(r){var t=fo(r),e=t.extractWeights,n=t.getRemainingWeights,a=[],i=RN(e,a),c=i.extractConvLayerParams,f=i.extractResidualLayerParams,p=c(4704,32,7,"conv32_down"),d=f(9216,32,3,"conv32_1"),x=f(9216,32,3,"conv32_2"),w=f(9216,32,3,"conv32_3"),C=f(36864,64,3,"conv64_down",!0),S=f(36864,64,3,"conv64_1"),R=f(36864,64,3,"conv64_2"),N=f(36864,64,3,"conv64_3"),D=f(147456,128,3,"conv128_down",!0),M=f(147456,128,3,"conv128_1"),B=f(147456,128,3,"conv128_2"),k=f(589824,256,3,"conv256_down",!0),L=f(589824,256,3,"conv256_1"),F=f(589824,256,3,"conv256_2"),W=f(589824,256,3,"conv256_down_out"),G=Xe(function(){return ts(Qo(e(256*128),[128,256]),[1,0])});if(a.push({paramPath:"fc"}),n().length!==0)throw new Error("weights remaing after extract: "+n().length);var q={conv32_down:p,conv32_1:d,conv32_2:x,conv32_3:w,conv64_down:C,conv64_1:S,conv64_2:R,conv64_3:N,conv128_down:D,conv128_1:M,conv128_2:B,conv256_down:k,conv256_1:L,conv256_2:F,conv256_down_out:W,fc:G};return{params:q,paramMappings:a}}function DN(r,t){var e=is(r,t);function n(c){var f=e(c+"/scale/weights",1),p=e(c+"/scale/biases",1);return{weights:f,biases:p}}function a(c){var f=e(c+"/conv/filters",4),p=e(c+"/conv/bias",1),d=n(c);return{conv:{filters:f,bias:p},scale:d}}function i(c){return{conv1:a(c+"/conv1"),conv2:a(c+"/conv2")}}return{extractConvLayerParams:a,extractResidualLayerParams:i}}function MN(r){var t=[],e=DN(r,t),n=e.extractConvLayerParams,a=e.extractResidualLayerParams,i=n("conv32_down"),c=a("conv32_1"),f=a("conv32_2"),p=a("conv32_3"),d=a("conv64_down"),x=a("conv64_1"),w=a("conv64_2"),C=a("conv64_3"),S=a("conv128_down"),R=a("conv128_1"),N=a("conv128_2"),D=a("conv256_down"),M=a("conv256_1"),B=a("conv256_2"),k=a("conv256_down_out"),L=r.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!zR(L))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+L);var F={conv32_down:i,conv32_1:c,conv32_2:f,conv32_3:p,conv64_down:d,conv64_1:x,conv64_2:w,conv64_3:C,conv128_down:S,conv128_1:R,conv128_2:N,conv256_down:D,conv256_1:M,conv256_2:B,conv256_down_out:k,fc:L};return co(r,t),{params:F,paramMappings:t}}function vi(r,t){var e=IN(r,t.conv1);return e=ow(e,t.conv2),e=It(e,r),e=Tn(e),e}function th(r,t){var e=sw(r,t.conv1);e=ow(e,t.conv2);var n=Tc(r,2,2,"valid"),a=yn(n.shape),i=n.shape[3]!==e.shape[3],c=n.shape[1]!==e.shape[1]||n.shape[2]!==e.shape[2];if(c){var f=lc(e.shape);f[1]=1;var p=yn(f);e=or([e,p],1);var d=lc(e.shape);d[2]=1;var x=yn(d);e=or([e,x],2)}return n=i?or([n,a],3):n,e=It(n,e),e=Tn(e),e}var ON=(function(r){vt(t,r);function t(){return r.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("FaceRecognitionNet - load model before inference");return Xe(function(){var a=e.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],c=Rc(a,i).div(Ge(256)),f=sw(c,n.conv32_down);f=xr(f,3,2,"valid"),f=vi(f,n.conv32_1),f=vi(f,n.conv32_2),f=vi(f,n.conv32_3),f=th(f,n.conv64_down),f=vi(f,n.conv64_1),f=vi(f,n.conv64_2),f=vi(f,n.conv64_3),f=th(f,n.conv128_down),f=vi(f,n.conv128_1),f=vi(f,n.conv128_2),f=th(f,n.conv256_down),f=vi(f,n.conv256_1),f=vi(f,n.conv256_2),f=th(f,n.conv256_down_out);var p=f.mean([1,2]),d=Hh(p,n.fc);return d})},t.prototype.forward=function(e){return et(this,void 0,void 0,function(){var n;return tt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,br(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.computeFaceDescriptor=function(e){return et(this,void 0,void 0,function(){var n,a,i,c=this;return tt(this,function(f){switch(f.label){case 0:return[4,br(e)];case 1:return n=f.sent(),a=Xe(function(){return sr(c.forwardInput(n))}),[4,Promise.all(a.map(function(p){return p.data()}))];case 2:return i=f.sent(),a.forEach(function(p){return p.dispose()}),[2,n.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return MN(e)},t.prototype.extractParams=function(e){return NN(e)},t})(lo);function uw(r,t){var e={descriptor:t};return Object.assign({},r,e)}function lw(r,t){var e={age:t};return Object.assign({},r,e)}function cw(r,t,e){var n={gender:t,genderProbability:e};return Object.assign({},r,n)}var fw=(function(){function r(t){var e=t===void 0?{}:t,n=e.minFaceSize,a=e.scaleFactor,i=e.maxNumScales,c=e.scoreThresholds,f=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=a||.709,this._maxNumScales=i||10,this._scoreThresholds=c||[.6,.7,.7],this._scaleSteps=f,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(p){return typeof p!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(p){return typeof p!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(r.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),r})();function BN(r,t){function e(p,d){var x=ta(r(9*p),[3,3,p,1]),w=Zn(r(p)),C=Zn(r(p)),S=Zn(r(p)),R=Zn(r(p));return t.push({paramPath:d+"/filters"},{paramPath:d+"/batch_norm_scale"},{paramPath:d+"/batch_norm_offset"},{paramPath:d+"/batch_norm_mean"},{paramPath:d+"/batch_norm_variance"}),{filters:x,batch_norm_scale:w,batch_norm_offset:C,batch_norm_mean:S,batch_norm_variance:R}}function n(p,d,x,w,C){var S=ta(r(p*d*x*x),[x,x,p,d]),R=Zn(r(d));return t.push({paramPath:w+"/filters"},{paramPath:w+"/"+(C?"batch_norm_offset":"bias")}),{filters:S,bias:R}}function a(p,d,x,w){var C=n(p,d,x,w,!0),S=C.filters,R=C.bias;return{filters:S,batch_norm_offset:R}}function i(p,d,x){var w=e(p,x+"/depthwise_conv"),C=a(p,d,1,x+"/pointwise_conv");return{depthwise_conv:w,pointwise_conv:C}}function c(){var p=a(3,32,3,"mobilenetv1/conv_0"),d=i(32,64,"mobilenetv1/conv_1"),x=i(64,128,"mobilenetv1/conv_2"),w=i(128,128,"mobilenetv1/conv_3"),C=i(128,256,"mobilenetv1/conv_4"),S=i(256,256,"mobilenetv1/conv_5"),R=i(256,512,"mobilenetv1/conv_6"),N=i(512,512,"mobilenetv1/conv_7"),D=i(512,512,"mobilenetv1/conv_8"),M=i(512,512,"mobilenetv1/conv_9"),B=i(512,512,"mobilenetv1/conv_10"),k=i(512,512,"mobilenetv1/conv_11"),L=i(512,1024,"mobilenetv1/conv_12"),F=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:p,conv_1:d,conv_2:x,conv_3:w,conv_4:C,conv_5:S,conv_6:R,conv_7:N,conv_8:D,conv_9:M,conv_10:B,conv_11:k,conv_12:L,conv_13:F}}function f(){var p=a(1024,256,1,"prediction_layer/conv_0"),d=a(256,512,3,"prediction_layer/conv_1"),x=a(512,128,1,"prediction_layer/conv_2"),w=a(128,256,3,"prediction_layer/conv_3"),C=a(256,128,1,"prediction_layer/conv_4"),S=a(128,256,3,"prediction_layer/conv_5"),R=a(256,64,1,"prediction_layer/conv_6"),N=a(64,128,3,"prediction_layer/conv_7"),D=n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),M=n(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),B=n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),k=n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),L=n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),F=n(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),W=n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),G=n(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),q=n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),H=n(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),Z=n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),ie=n(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),ee={box_encoding_predictor:D,class_predictor:M},me={box_encoding_predictor:B,class_predictor:k},xe={box_encoding_predictor:L,class_predictor:F},$={box_encoding_predictor:W,class_predictor:G},te={box_encoding_predictor:q,class_predictor:H},re={box_encoding_predictor:Z,class_predictor:ie};return{conv_0:p,conv_1:d,conv_2:x,conv_3:w,conv_4:C,conv_5:S,conv_6:R,conv_7:N,box_predictor_0:ee,box_predictor_1:me,box_predictor_2:xe,box_predictor_3:$,box_predictor_4:te,box_predictor_5:re}}return{extractMobilenetV1Params:c,extractPredictionLayerParams:f}}function kN(r){var t=[],e=fo(r),n=e.extractWeights,a=e.getRemainingWeights,i=BN(n,t),c=i.extractMobilenetV1Params,f=i.extractPredictionLayerParams,p=c(),d=f(),x=c1(n(5118*4),[1,5118,4]),w={extra_dim:x};if(t.push({paramPath:"output_layer/extra_dim"}),a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:{mobilenetv1:p,prediction_layer:d,output_layer:w},paramMappings:t}}function LN(r,t){var e=is(r,t);function n(d,x,w){var C=e(d+"/Conv2d_"+x+"_pointwise/weights",4,w+"/filters"),S=e(d+"/Conv2d_"+x+"_pointwise/convolution_bn_offset",1,w+"/batch_norm_offset");return{filters:C,batch_norm_offset:S}}function a(d){var x="mobilenetv1/conv_"+d,w="MobilenetV1/Conv2d_"+d+"_depthwise",C=x+"/depthwise_conv",S=x+"/pointwise_conv",R=e(w+"/depthwise_weights",4,C+"/filters"),N=e(w+"/BatchNorm/gamma",1,C+"/batch_norm_scale"),D=e(w+"/BatchNorm/beta",1,C+"/batch_norm_offset"),M=e(w+"/BatchNorm/moving_mean",1,C+"/batch_norm_mean"),B=e(w+"/BatchNorm/moving_variance",1,C+"/batch_norm_variance");return{depthwise_conv:{filters:R,batch_norm_scale:N,batch_norm_offset:D,batch_norm_mean:M,batch_norm_variance:B},pointwise_conv:n("MobilenetV1",d,S)}}function i(){return{conv_0:n("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function c(d,x){var w=e(d+"/weights",4,x+"/filters"),C=e(d+"/biases",1,x+"/bias");return{filters:w,bias:C}}function f(d){var x=c("Prediction/BoxPredictor_"+d+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+d+"/box_encoding_predictor"),w=c("Prediction/BoxPredictor_"+d+"/ClassPredictor","prediction_layer/box_predictor_"+d+"/class_predictor");return{box_encoding_predictor:x,class_predictor:w}}function p(){return{conv_0:n("Prediction",0,"prediction_layer/conv_0"),conv_1:n("Prediction",1,"prediction_layer/conv_1"),conv_2:n("Prediction",2,"prediction_layer/conv_2"),conv_3:n("Prediction",3,"prediction_layer/conv_3"),conv_4:n("Prediction",4,"prediction_layer/conv_4"),conv_5:n("Prediction",5,"prediction_layer/conv_5"),conv_6:n("Prediction",6,"prediction_layer/conv_6"),conv_7:n("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:f(0),box_predictor_1:f(1),box_predictor_2:f(2),box_predictor_3:f(3),box_predictor_4:f(4),box_predictor_5:f(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:p}}function FN(r){var t=[],e=LN(r,t),n=e.extractMobilenetV1Params,a=e.extractPredictionLayerParams,i=r["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!jh(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var c={mobilenetv1:n(),prediction_layer:a(),output_layer:{extra_dim:i}};return co(r,t),{params:c,paramMappings:t}}function xi(r,t,e){return Xe(function(){var n=Pa(r,t.filters,e,"same");return n=It(n,t.batch_norm_offset),w1(n,0,6)})}var PN=.0010000000474974513;function UN(r,t,e){return Xe(function(){var n=zh(r,t.filters,e,"same");return n=ib(n,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,PN),w1(n,0,6)})}function zN(r){return[2,4,6,12].some(function(t){return t===r})?[2,2]:[1,1]}function HN(r,t){return Xe(function(){var e=null,n=xi(r,t.conv_0,[2,2]),a=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(a.forEach(function(i,c){var f=c+1,p=zN(f);n=UN(n,i.depthwise_conv,p),n=xi(n,i.pointwise_conv,[1,1]),f===11&&(e=n)}),e===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:n,conv11:e}})}function VN(r,t,e,n,a){var i=r.shape[0],c=Math.min(e,i),f=t.map(function(x,w){return{score:x,boxIndex:w}}).filter(function(x){return x.score>a}).sort(function(x,w){return w.score-x.score}),p=function(x){return x<=n?1:0},d=[];return f.forEach(function(x){if(!(d.length>=c)){for(var w=x.score,C=d.length-1;C>=0;--C){var S=WN(r,x.boxIndex,d[C]);if(S!==0&&(x.score*=p(S),x.score<=a))break}w===x.score&&d.push(x.boxIndex)}}),d}function WN(r,t,e){var n=r.arraySync(),a=Math.min(n[t][0],n[t][2]),i=Math.min(n[t][1],n[t][3]),c=Math.max(n[t][0],n[t][2]),f=Math.max(n[t][1],n[t][3]),p=Math.min(n[e][0],n[e][2]),d=Math.min(n[e][1],n[e][3]),x=Math.max(n[e][0],n[e][2]),w=Math.max(n[e][1],n[e][3]),C=(c-a)*(f-i),S=(x-p)*(w-d);if(C<=0||S<=0)return 0;var R=Math.max(a,p),N=Math.max(i,d),D=Math.min(c,x),M=Math.min(f,w),B=Math.max(D-R,0)*Math.max(M-N,0);return B/(C+S-B)}function GN(r){var t=sr(ts(r,[1,0])),e=[lr(t[2],t[0]),lr(t[3],t[1])],n=[It(t[0],Ya(e[0],Ge(2))),It(t[1],Ya(e[1],Ge(2)))];return{sizes:e,centers:n}}function jN(r,t){var e=GN(r),n=e.sizes,a=e.centers,i=sr(ts(t,[1,0])),c=Ya(Ur(Gp(Ya(i[2],Ge(5))),n[0]),Ge(2)),f=It(Ur(Ya(i[0],Ge(10)),n[0]),a[0]),p=Ya(Ur(Gp(Ya(i[3],Ge(5))),n[1]),Ge(2)),d=It(Ur(Ya(i[1],Ge(10)),n[1]),a[1]);return ts(Sa([lr(f,c),lr(d,p),It(f,c),It(d,p)]),[1,0])}function XN(r,t,e){return Xe(function(){var n=r.shape[0],a=jN(qa(Wu(e.extra_dim,[n,1,1]),[-1,4]),qa(r,[-1,4]));a=qa(a,[n,a.shape[0]/n,4]);var i=tb(Ti(t,[0,0,1],[-1,-1,-1])),c=Ti(i,[0,0,0],[-1,-1,1]);c=qa(c,[n,c.shape[1]]);var f=sr(a),p=sr(c);return{boxes:f,scores:p}})}function Lu(r,t){return Xe(function(){var e=r.shape[0],n=qa(Ka(r,t.box_encoding_predictor),[e,-1,1,4]),a=qa(Ka(r,t.class_predictor),[e,-1,3]);return{boxPredictionEncoding:n,classPrediction:a}})}function YN(r,t,e){return Xe(function(){var n=xi(r,e.conv_0,[1,1]),a=xi(n,e.conv_1,[2,2]),i=xi(a,e.conv_2,[1,1]),c=xi(i,e.conv_3,[2,2]),f=xi(c,e.conv_4,[1,1]),p=xi(f,e.conv_5,[2,2]),d=xi(p,e.conv_6,[1,1]),x=xi(d,e.conv_7,[2,2]),w=Lu(t,e.box_predictor_0),C=Lu(r,e.box_predictor_1),S=Lu(a,e.box_predictor_2),R=Lu(c,e.box_predictor_3),N=Lu(p,e.box_predictor_4),D=Lu(x,e.box_predictor_5),M=or([w.boxPredictionEncoding,C.boxPredictionEncoding,S.boxPredictionEncoding,R.boxPredictionEncoding,N.boxPredictionEncoding,D.boxPredictionEncoding],1),B=or([w.classPrediction,C.classPrediction,S.classPrediction,R.classPrediction,N.classPrediction,D.classPrediction],1);return{boxPredictions:M,classPredictions:B}})}var Kh=(function(){function r(t){var e=t===void 0?{}:t,n=e.minConfidence,a=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=a||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(r.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),r})(),hw=(function(r){vt(t,r);function t(){return r.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("SsdMobilenetv1 - load model before inference");return Xe(function(){var a=e.toBatchTensor(512,!1).toFloat(),i=lr(Ur(a,Ge(.007843137718737125)),Ge(1)),c=HN(i,n.mobilenetv1),f=YN(c.out,c.conv11,n.prediction_layer),p=f.boxPredictions,d=f.classPredictions;return XN(p,d,n.output_layer)})},t.prototype.forward=function(e){return et(this,void 0,void 0,function(){var n;return tt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,br(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.locateFaces=function(e,n){return n===void 0&&(n={}),et(this,void 0,void 0,function(){var a,i,c,f,p,d,x,w,C,S,R,N,D,M,B,k,L,F,W,G,q;return tt(this,function(H){switch(H.label){case 0:return a=new Kh(n),i=a.maxResults,c=a.minConfidence,[4,br(e)];case 1:for(f=H.sent(),p=this.forwardInput(f),d=p.boxes,x=p.scores,w=d[0],C=x[0],S=1;S<d.length;S++)d[S].dispose(),x[S].dispose();return D=(N=Array).from,[4,C.data()];case 2:return R=D.apply(N,[H.sent()]),M=.5,B=VN(w,R,i,M,c),k=f.getReshapedInputDimensions(0),L=f.inputSize,F=L/k.width,W=L/k.height,G=w.arraySync(),q=B.map(function(Z){var ie=[Math.max(0,G[Z][0]),Math.min(1,G[Z][2])].map(function(re){return re*W}),ee=ie[0],me=ie[1],xe=[Math.max(0,G[Z][1]),Math.min(1,G[Z][3])].map(function(re){return re*F}),$=xe[0],te=xe[1];return new Mi(R[Z],new P1($,ee,te-$,me-ee),{height:f.getInputHeight(0),width:f.getInputWidth(0)})}),w.dispose(),C.dispose(),[2,q]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return FN(e)},t.prototype.extractParams=function(e){return kN(e)},t})(lo);(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t})(hw);var qN=.4,KN=[new Kt(.738768,.874946),new Kt(2.42204,2.65704),new Kt(4.30971,7.04493),new Kt(10.246,4.59428),new Kt(12.6868,11.8741)],ZN=[new Kt(1.603231,2.094468),new Kt(6.041143,7.080126),new Kt(2.882459,3.518061),new Kt(4.266906,5.178857),new Kt(9.041765,10.66308)],QN=[117.001,114.697,97.404],JN="tiny_yolov2_model",$N="tiny_yolov2_separable_conv_model",nh=function(r){return typeof r=="number"};function eD(r){if(!r)throw new Error("invalid config: "+r);if(typeof r.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+r.withSeparableConvs);if(!nh(r.iouThreshold)||r.iouThreshold<0||r.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+r.iouThreshold);if(!Array.isArray(r.classes)||!r.classes.length||!r.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(r.classes));if(!Array.isArray(r.anchors)||!r.anchors.length||!r.anchors.map(function(t){return t||{}}).every(function(t){return nh(t.x)&&nh(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(r.anchors));if(r.meanRgb&&(!Array.isArray(r.meanRgb)||r.meanRgb.length!==3||!r.meanRgb.every(nh)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(r.meanRgb))}function K1(r){return Xe(function(){var t=Ur(r,Ge(.10000000149011612));return It(Tn(lr(r,t)),t)})}function Yo(r,t){return Xe(function(){var e=Vs(r,[[0,0],[1,1],[1,1],[0,0]]);return e=Pa(e,t.conv.filters,[1,1],"valid"),e=lr(e,t.bn.sub),e=Ur(e,t.bn.truediv),e=It(e,t.conv.bias),K1(e)})}function qo(r,t){return Xe(function(){var e=Vs(r,[[0,0],[1,1],[1,1],[0,0]]);return e=S1(e,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),e=It(e,t.bias),K1(e)})}function tD(r,t){var e=qh(r,t);function n(c,f){var p=Zn(r(c)),d=Zn(r(c));return t.push({paramPath:f+"/sub"},{paramPath:f+"/truediv"}),{sub:p,truediv:d}}function a(c,f,p){var d=e(c,f,3,p+"/conv"),x=n(f,p+"/bn");return{conv:d,bn:x}}var i=j1(r,t);return{extractConvParams:e,extractConvWithBatchNormParams:a,extractSeparableConvParams:i}}function nD(r,t,e,n){var a=fo(r),i=a.extractWeights,c=a.getRemainingWeights,f=[],p=tD(i,f),d=p.extractConvParams,x=p.extractConvWithBatchNormParams,w=p.extractSeparableConvParams,C;if(t.withSeparableConvs){var S=n[0],R=n[1],N=n[2],D=n[3],M=n[4],B=n[5],k=n[6],L=n[7],F=n[8],W=t.isFirstLayerConv2d?d(S,R,3,"conv0"):w(S,R,"conv0"),G=w(R,N,"conv1"),q=w(N,D,"conv2"),H=w(D,M,"conv3"),Z=w(M,B,"conv4"),ie=w(B,k,"conv5"),ee=L?w(k,L,"conv6"):void 0,me=F?w(L,F,"conv7"):void 0,xe=d(F||L||k,5*e,1,"conv8");C={conv0:W,conv1:G,conv2:q,conv3:H,conv4:Z,conv5:ie,conv6:ee,conv7:me,conv8:xe}}else{var S=n[0],R=n[1],N=n[2],D=n[3],M=n[4],B=n[5],k=n[6],L=n[7],F=n[8],W=x(S,R,"conv0"),G=x(R,N,"conv1"),q=x(N,D,"conv2"),H=x(D,M,"conv3"),Z=x(M,B,"conv4"),ie=x(B,k,"conv5"),ee=x(k,L,"conv6"),me=x(L,F,"conv7"),xe=d(F,5*e,1,"conv8");C={conv0:W,conv1:G,conv2:q,conv3:H,conv4:Z,conv5:ie,conv6:ee,conv7:me,conv8:xe}}if(c().length!==0)throw new Error("weights remaing after extract: "+c().length);return{params:C,paramMappings:f}}function rD(r,t){var e=is(r,t);function n(f){var p=e(f+"/sub",1),d=e(f+"/truediv",1);return{sub:p,truediv:d}}function a(f){var p=e(f+"/filters",4),d=e(f+"/bias",1);return{filters:p,bias:d}}function i(f){var p=a(f+"/conv"),d=n(f+"/bn");return{conv:p,bn:d}}var c=X1(e);return{extractConvParams:a,extractConvWithBatchNormParams:i,extractSeparableConvParams:c}}function aD(r,t){var e=[],n=rD(r,e),a=n.extractConvParams,i=n.extractConvWithBatchNormParams,c=n.extractSeparableConvParams,f;if(t.withSeparableConvs){var p=t.filterSizes&&t.filterSizes.length||9;f={conv0:t.isFirstLayerConv2d?a("conv0"):c("conv0"),conv1:c("conv1"),conv2:c("conv2"),conv3:c("conv3"),conv4:c("conv4"),conv5:c("conv5"),conv6:p>7?c("conv6"):void 0,conv7:p>8?c("conv7"):void 0,conv8:a("conv8")}}else f={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:a("conv8")};return co(r,e),{params:f,paramMappings:e}}var Bx;(function(r){r[r.XS=224]="XS",r[r.SM=320]="SM",r[r.MD=416]="MD",r[r.LG=608]="LG"})(Bx||(Bx={}));var Z1=(function(){function r(t){var e=t===void 0?{}:t,n=e.inputSize,a=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=a||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(r.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),r})(),dw=(function(r){vt(t,r);function t(e){var n=r.call(this,"TinyYolov2")||this;return eD(e),n._config=e,n}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,n){var a=Yo(e,n.conv0);return a=xr(a,[2,2],[2,2],"same"),a=Yo(a,n.conv1),a=xr(a,[2,2],[2,2],"same"),a=Yo(a,n.conv2),a=xr(a,[2,2],[2,2],"same"),a=Yo(a,n.conv3),a=xr(a,[2,2],[2,2],"same"),a=Yo(a,n.conv4),a=xr(a,[2,2],[2,2],"same"),a=Yo(a,n.conv5),a=xr(a,[2,2],[1,1],"same"),a=Yo(a,n.conv6),a=Yo(a,n.conv7),Ka(a,n.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,n){var a=this.config.isFirstLayerConv2d?K1(Ka(e,n.conv0,"valid",!1)):qo(e,n.conv0);return a=xr(a,[2,2],[2,2],"same"),a=qo(a,n.conv1),a=xr(a,[2,2],[2,2],"same"),a=qo(a,n.conv2),a=xr(a,[2,2],[2,2],"same"),a=qo(a,n.conv3),a=xr(a,[2,2],[2,2],"same"),a=qo(a,n.conv4),a=xr(a,[2,2],[2,2],"same"),a=qo(a,n.conv5),a=xr(a,[2,2],[1,1],"same"),a=n.conv6?qo(a,n.conv6):a,a=n.conv7?qo(a,n.conv7):a,Ka(a,n.conv8,"valid",!1)},t.prototype.forwardInput=function(e,n){var a=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return Xe(function(){var c=e.toBatchTensor(n,!1).toFloat();return c=a.config.meanRgb?Rc(c,a.config.meanRgb):c,c=c.div(Ge(256)),a.config.withSeparableConvs?a.runMobilenet(c,i):a.runTinyYolov2(c,i)})},t.prototype.forward=function(e,n){return et(this,void 0,void 0,function(){var a;return tt(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,br(e)];case 1:return[4,a.apply(this,[i.sent(),n])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(e,n){return n===void 0&&(n={}),et(this,void 0,void 0,function(){var a,i,c,f,p,d,x,w,C,S,R,N,D,M,B=this;return tt(this,function(k){switch(k.label){case 0:return a=new Z1(n),i=a.inputSize,c=a.scoreThreshold,[4,br(e)];case 1:return f=k.sent(),[4,this.forwardInput(f,i)];case 2:return p=k.sent(),d=Xe(function(){return sr(p)[0].expandDims()}),x={width:f.getInputWidth(0),height:f.getInputHeight(0)},[4,this.extractBoxes(d,f.getReshapedInputDimensions(0),c)];case 3:return w=k.sent(),p.dispose(),d.dispose(),C=w.map(function(L){return L.box}),S=w.map(function(L){return L.score}),R=w.map(function(L){return L.classScore}),N=w.map(function(L){return B.config.classes[L.label]}),D=mc(C.map(function(L){return L.rescale(i)}),S,this.config.iouThreshold,!0),M=D.map(function(L){return new Ub(S[L],R[L],N[L],C[L],x)}),[2,M]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return aD(e,this.config)},t.prototype.extractParams=function(e){var n=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,a=n?n.length:void 0;if(a!==7&&a!==8&&a!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+a+" filterSizes in config");return nD(e,this.config,this.boxEncodingSize,n)},t.prototype.extractBoxes=function(e,n,a){return et(this,void 0,void 0,function(){var i,c,f,p,d,x,w,C,S,R,N,D,M,B,k,L,F,W,G,q,H,Z,ie,ee,me,xe,$,te,re,he=this;return tt(this,function(Se){switch(Se.label){case 0:return i=n.width,c=n.height,f=Math.max(i,c),p=f/i,d=f/c,x=e.shape[1],w=this.config.anchors.length,C=Xe(function(){var Y=e.reshape([x,x,w,he.boxEncodingSize]),fe=Y.slice([0,0,0,0],[x,x,w,4]),Ae=Y.slice([0,0,0,4],[x,x,w,1]),Te=he.withClassScores?so(Y.slice([0,0,0,5],[x,x,w,he.config.classes.length]),3):Ge(0);return[fe,Ae,Te]}),S=C[0],R=C[1],N=C[2],D=[],[4,R.array()];case 1:return M=Se.sent(),[4,S.array()];case 2:B=Se.sent(),k=0,Se.label=3;case 3:if(!(k<x))return[3,12];L=0,Se.label=4;case 4:if(!(L<x))return[3,11];F=0,Se.label=5;case 5:return F<w?(W=Cp(M[k][L][F][0]),!a||W>a?(G=(L+Cp(B[k][L][F][0]))/x*p,q=(k+Cp(B[k][L][F][1]))/x*d,H=Math.exp(B[k][L][F][2])*this.config.anchors[F].x/x*p,Z=Math.exp(B[k][L][F][3])*this.config.anchors[F].y/x*d,ie=G-H/2,ee=q-Z/2,me={row:k,col:L,anchor:F},this.withClassScores?[4,this.extractPredictedClass(N,me)]:[3,7]):[3,9]):[3,10];case 6:return re=Se.sent(),[3,8];case 7:re={classScore:1,label:0},Se.label=8;case 8:xe=re,$=xe.classScore,te=xe.label,D.push(Lr({box:new Xh(ie,ee,ie+H,ee+Z),score:W,classScore:W*$,label:te},me)),Se.label=9;case 9:return F++,[3,5];case 10:return L++,[3,4];case 11:return k++,[3,3];case 12:return S.dispose(),R.dispose(),N.dispose(),[2,D]}})})},t.prototype.extractPredictedClass=function(e,n){return et(this,void 0,void 0,function(){var a,i,c,f;return tt(this,function(p){switch(p.label){case 0:return a=n.row,i=n.col,c=n.anchor,[4,e.array()];case 1:return f=p.sent(),[2,Array(this.config.classes.length).fill(0).map(function(d,x){return f[a][i][c][x]}).map(function(d,x){return{classScore:d,label:x}}).reduce(function(d,x){return d.classScore>x.classScore?d:x})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t})(lo),iD=(function(r){vt(t,r);function t(e){e===void 0&&(e=!0);var n=this,a=Object.assign({},{withSeparableConvs:e,iouThreshold:qN,classes:["face"]},e?{anchors:ZN,meanRgb:QN}:{anchors:KN,withClassScores:!0});return n=r.call(this,a)||this,n}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,n){return et(this,void 0,void 0,function(){var a;return tt(this,function(i){switch(i.label){case 0:return[4,this.detect(e,n)];case 1:return a=i.sent(),[2,a.map(function(c){return new Mi(c.score,c.relativeBox,{width:c.imageWidth,height:c.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?$N:JN},t.prototype.extractParamsFromWeigthMap=function(e){return r.prototype.extractParamsFromWeigthMap.call(this,e)},t})(dw),pw=(function(r){vt(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return t})(Z1),Nc=(function(){function r(){}return r.prototype.then=function(t){return et(this,void 0,void 0,function(){var e;return tt(this,function(n){switch(n.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[n.sent()])]}})})},r.prototype.run=function(){return et(this,void 0,void 0,function(){return tt(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},r})();function Zh(r,t,e,n,a){return a===void 0&&(a=function(i){var c=i.alignedRect;return c}),et(this,void 0,void 0,function(){var i,c,f,p,d;return tt(this,function(x){switch(x.label){case 0:return i=r.map(function(w){return dN(w)?a(w):w.detection}),f=n,f?[3,5]:t instanceof _n?[4,W1(t,i)]:[3,2];case 1:return p=x.sent(),[3,4];case 2:return[4,V1(t,i)];case 3:p=x.sent(),x.label=4;case 4:f=p,x.label=5;case 5:return c=f,[4,e(c)];case 6:return d=x.sent(),c.forEach(function(w){return w instanceof _n&&w.dispose()}),[2,d]}})})}function Q1(r,t,e,n,a){return et(this,void 0,void 0,function(){var i=this;return tt(this,function(c){return[2,Zh([r],t,function(f){return et(i,void 0,void 0,function(){return tt(this,function(p){return[2,e(f[0])]})})},n,a)]})})}function oD(r){return Xe(function(){return Sa(sr(r,3).reverse(),3)})}var rh=2,Mh=12;function sD(r,t){var e=qh(r,t),n=G1(r,t);function a(d,x){var w=Zn(r(d));return t.push({paramPath:x}),w}function i(d,x,w){w===void 0&&(w=!1);var C=e(d[0],d[1],3,x+"/conv1"),S=a(d[1],x+"/prelu1_alpha"),R=e(d[1],d[2],3,x+"/conv2"),N=a(d[2],x+"/prelu2_alpha"),D=e(d[2],d[3],w?2:3,x+"/conv3"),M=a(d[3],x+"/prelu3_alpha");return{conv1:C,prelu1_alpha:S,conv2:R,prelu2_alpha:N,conv3:D,prelu3_alpha:M}}function c(){var d=i([3,10,16,32],"pnet"),x=e(32,2,1,"pnet/conv4_1"),w=e(32,4,1,"pnet/conv4_2");return Lr(Lr({},d),{conv4_1:x,conv4_2:w})}function f(){var d=i([3,28,48,64],"rnet",!0),x=n(576,128,"rnet/fc1"),w=a(128,"rnet/prelu4_alpha"),C=n(128,2,"rnet/fc2_1"),S=n(128,4,"rnet/fc2_2");return Lr(Lr({},d),{fc1:x,prelu4_alpha:w,fc2_1:C,fc2_2:S})}function p(){var d=i([3,32,64,64],"onet"),x=e(64,128,2,"onet/conv4"),w=a(128,"onet/prelu4_alpha"),C=n(1152,256,"onet/fc1"),S=a(256,"onet/prelu5_alpha"),R=n(256,2,"onet/fc2_1"),N=n(256,4,"onet/fc2_2"),D=n(256,10,"onet/fc2_3");return Lr(Lr({},d),{conv4:x,prelu4_alpha:w,fc1:C,prelu5_alpha:S,fc2_1:R,fc2_2:N,fc2_3:D})}return{extractPNetParams:c,extractRNetParams:f,extractONetParams:p}}function uD(r){var t=fo(r),e=t.extractWeights,n=t.getRemainingWeights,a=[],i=sD(e,a),c=i.extractPNetParams,f=i.extractRNetParams,p=i.extractONetParams,d=c(),x=f(),w=p();if(n().length!==0)throw new Error("weights remaing after extract: "+n().length);return{params:{pnet:d,rnet:x,onet:w},paramMappings:a}}function lD(r,t){var e=is(r,t);function n(x){var w=e(x+"/weights",4,x+"/filters"),C=e(x+"/bias",1);return{filters:w,bias:C}}function a(x){var w=e(x+"/weights",2),C=e(x+"/bias",1);return{weights:w,bias:C}}function i(x){return e(x,1)}function c(x){var w=n(x+"/conv1"),C=i(x+"/prelu1_alpha"),S=n(x+"/conv2"),R=i(x+"/prelu2_alpha"),N=n(x+"/conv3"),D=i(x+"/prelu3_alpha");return{conv1:w,prelu1_alpha:C,conv2:S,prelu2_alpha:R,conv3:N,prelu3_alpha:D}}function f(){var x=c("pnet"),w=n("pnet/conv4_1"),C=n("pnet/conv4_2");return Lr(Lr({},x),{conv4_1:w,conv4_2:C})}function p(){var x=c("rnet"),w=a("rnet/fc1"),C=i("rnet/prelu4_alpha"),S=a("rnet/fc2_1"),R=a("rnet/fc2_2");return Lr(Lr({},x),{fc1:w,prelu4_alpha:C,fc2_1:S,fc2_2:R})}function d(){var x=c("onet"),w=n("onet/conv4"),C=i("onet/prelu4_alpha"),S=a("onet/fc1"),R=i("onet/prelu5_alpha"),N=a("onet/fc2_1"),D=a("onet/fc2_2"),M=a("onet/fc2_3");return Lr(Lr({},x),{conv4:w,prelu4_alpha:C,fc1:S,prelu5_alpha:R,fc2_1:N,fc2_2:D,fc2_3:M})}return{extractPNetParams:f,extractRNetParams:p,extractONetParams:d}}function cD(r){var t=[],e=lD(r,t),n=e.extractPNetParams,a=e.extractRNetParams,i=e.extractONetParams,c=n(),f=a(),p=i();return co(r,t),{params:{pnet:c,rnet:f,onet:p},paramMappings:t}}function Jp(r,t){var e=t[0],n=t[1];return{height:Math.floor(e*r),width:Math.floor(n*r)}}function fD(r,t,e){for(var n=e[0],a=e[1],i=Mh/r,c=[],f=Math.min(n,a)*i,p=0;f>=12;)c.push(i*Math.pow(t,p)),f=f*t,p+=1;return c}var J1=(function(r){vt(t,r);function t(e,n,a,i){return r.call(this,{left:e,top:n,right:a,bottom:i},!0)||this}return t})(ns);function gw(r){return Xe(function(){return Ur(lr(r,Ge(127.5)),Ge(.0078125))})}function Ku(r,t){return Xe(function(){return It(Tn(r),Ur(t,Sh(Tn(Sh(r)))))})}function $1(r,t,e){return e===void 0&&(e=!1),Xe(function(){var n=Ka(r,t.conv1,"valid");return n=Ku(n,t.prelu1_alpha),n=xr(n,e?[2,2]:[3,3],[2,2],"same"),n=Ka(n,t.conv2,"valid"),n=Ku(n,t.prelu2_alpha),n=e?n:xr(n,[3,3],[2,2],"valid"),n=Ka(n,t.conv3,"valid"),n=Ku(n,t.prelu3_alpha),n})}function hD(r,t){return Xe(function(){var e=$1(r,t,!0),n=Ka(e,t.conv4_1,"valid"),a=ka(Vh(n,3),3),i=so(lr(n,a),3),c=Ka(e,t.conv4_2,"valid");return{prob:i,regions:c}})}function dD(r,t){return Xe(function(){var e=Jp(t,r.shape.slice(1)),n=e.height,a=e.width,i=N1.resizeBilinear(r,[n,a]),c=gw(i);return ts(c,[0,2,1,3])})}function pD(r,t,e,n){for(var a=[],i=r.arraySync(),c=0;c<r.shape[0];c++)for(var f=0;f<r.shape[1];f++)i[c][f]>=n&&a.push(new Kt(f,c));var p=a.map(function(d){var x=new Xh(Math.round((d.y*rh+1)/e),Math.round((d.x*rh+1)/e),Math.round((d.y*rh+Mh)/e),Math.round((d.x*rh+Mh)/e)),w=i[d.y][d.x],C=t.arraySync(),S=new J1(C[d.y][d.x][0],C[d.y][d.x][1],C[d.y][d.x][2],C[d.y][d.x][3]);return{cell:x,score:w,region:S}});return p}function gD(r,t,e,n,a){a.stage1=[];var i=t.map(function(C){return Xe(function(){var S={scale:C},R=dD(r,C),N=Date.now(),D=hD(R,n),M=D.prob,B=D.regions;S.pnet=Date.now()-N;var k=sr(sr(M,3)[1])[0],L=sr(B)[0];return{scoresTensor:k,regionsTensor:L,scale:C,statsForScale:S}})}),c=i.map(function(C){var S=C.scoresTensor,R=C.regionsTensor,N=C.scale,D=C.statsForScale,M=pD(S,R,N,e);if(S.dispose(),R.dispose(),!M.length)return a.stage1.push(D),[];var B=Date.now(),k=mc(M.map(function(L){return L.cell}),M.map(function(L){return L.score}),.5);return D.nms=Date.now()-B,D.numBoxes=k.length,a.stage1.push(D),k.map(function(L){return M[L]})}),f=c.reduce(function(C,S){return C.concat(S)},[]),p=[],d=[];if(f.length>0){var x=Date.now(),w=mc(f.map(function(C){return C.cell}),f.map(function(C){return C.score}),.7);a.stage1_nms=Date.now()-x,d=w.map(function(C){return f[C].score}),p=w.map(function(C){return f[C]}).map(function(C){var S=C.cell,R=C.region;return new Xh(S.left+R.left*S.width,S.top+R.top*S.height,S.right+R.right*S.width,S.bottom+R.bottom*S.height).toSquare().round()})}return{boxes:p,scores:d}}function vw(r,t,e){var n=e.width,a=e.height;return et(this,void 0,void 0,function(){var i,c,f,p=this;return tt(this,function(d){switch(d.label){case 0:return i=Us(r),[4,Promise.all(t.map(function(x){return et(p,void 0,void 0,function(){var w,C,S,R,N,D,M,B;return tt(this,function(k){return w=x.padAtBorders(r.height,r.width),C=w.y,S=w.ey,R=w.x,N=w.ex,D=R-1,M=C-1,B=i.getImageData(D,M,N-D,S-M),[2,zr.isNodejs()?H1(B):createImageBitmap(B)]})})}))];case 1:return c=d.sent(),f=[],c.forEach(function(x){var w=Yh({width:n,height:a}),C=Us(w);C.drawImage(x,0,0,n,a);for(var S=C.getImageData(0,0,n,a).data,R=[],N=0;N<S.length;N+=4)R.push(S[N+2]),R.push(S[N+1]),R.push(S[N]);f.push(R)}),[2,f.map(function(x){var w=Xe(function(){var C=ts(ta(x,[1,n,a,3]),[0,2,1,3]).toFloat();return gw(C)});return w})]}})})}function vD(r,t){return Xe(function(){var e=$1(r,t),n=qa(e,[e.shape[0],t.fc1.weights.shape[0]]),a=Ei(n,t.fc1),i=Ku(a,t.prelu4_alpha),c=Ei(i,t.fc2_1),f=ka(Vh(c,1),1),p=so(lr(c,f),1),d=Ei(i,t.fc2_2),x=sr(p,1)[1];return{scores:x,regions:d}})}function mD(r,t,e,n,a){return et(this,void 0,void 0,function(){var i,c,f,p,d,x,w,C,S,R,N,D,M,B;return tt(this,function(k){switch(k.label){case 0:return i=Date.now(),[4,vw(r,t,{width:24,height:24})];case 1:return c=k.sent(),a.stage2_extractImagePatches=Date.now()-i,i=Date.now(),f=c.map(function(L){var F=vD(L,n);return L.dispose(),F}),a.stage2_rnet=Date.now()-i,p=f.length>1?or(f.map(function(L){return L.scores})):f[0].scores,w=(x=Array).from,[4,p.data()];case 2:return d=w.apply(x,[k.sent()]),p.dispose(),C=d.map(function(L,F){return{score:L,idx:F}}).filter(function(L){return L.score>e}).map(function(L){var F=L.idx;return F}),S=C.map(function(L){return t[L]}),R=C.map(function(L){return d[L]}),N=[],D=[],S.length>0&&(i=Date.now(),M=mc(S,R,.7),a.stage2_nms=Date.now()-i,B=M.map(function(L){var F=f[C[L]].regions.arraySync();return new J1(F[0][0],F[0][1],F[0][2],F[0][3])}),D=M.map(function(L){return R[L]}),N=M.map(function(L,F){return S[L].calibrate(B[F])})),f.forEach(function(L){L.regions.dispose(),L.scores.dispose()}),[2,{boxes:N,scores:D}]}})})}function xD(r,t){return Xe(function(){var e=$1(r,t);e=xr(e,[2,2],[2,2],"same"),e=Ka(e,t.conv4,"valid"),e=Ku(e,t.prelu4_alpha);var n=qa(e,[e.shape[0],t.fc1.weights.shape[0]]),a=Ei(n,t.fc1),i=Ku(a,t.prelu5_alpha),c=Ei(i,t.fc2_1),f=ka(Vh(c,1),1),p=so(lr(c,f),1),d=Ei(i,t.fc2_2),x=Ei(i,t.fc2_3),w=sr(p,1)[1];return{scores:w,regions:d,points:x}})}function yD(r,t,e,n,a){return et(this,void 0,void 0,function(){var i,c,f,p,d,x,w,C,S,R,N,D,M,B,k;return tt(this,function(L){switch(L.label){case 0:return i=Date.now(),[4,vw(r,t,{width:48,height:48})];case 1:return c=L.sent(),a.stage3_extractImagePatches=Date.now()-i,i=Date.now(),f=c.map(function(F){var W=xD(F,n);return F.dispose(),W}),a.stage3_onet=Date.now()-i,p=f.length>1?or(f.map(function(F){return F.scores})):f[0].scores,w=(x=Array).from,[4,p.data()];case 2:return d=w.apply(x,[L.sent()]),p.dispose(),C=d.map(function(F,W){return{score:F,idx:W}}).filter(function(F){return F.score>e}).map(function(F){var W=F.idx;return W}),S=C.map(function(F){var W=f[F].regions.arraySync();return new J1(W[0][0],W[0][1],W[0][2],W[0][3])}),R=C.map(function(F,W){return t[F].calibrate(S[W])}),N=C.map(function(F){return d[F]}),D=[],M=[],B=[],R.length>0&&(i=Date.now(),k=mc(R,N,.7,!1),a.stage3_nms=Date.now()-i,D=k.map(function(F){return R[F]}),M=k.map(function(F){return N[F]}),B=k.map(function(F,W){return Array(5).fill(0).map(function(G,q){var H=f[F].points.arraySync();return new Kt(H[0][q]*(D[W].width+1)+D[W].left,H[0][q+5]*(D[W].height+1)+D[W].top)})})),f.forEach(function(F){F.regions.dispose(),F.scores.dispose(),F.points.dispose()}),[2,{boxes:D,scores:M,points:B}]}})})}var bD=(function(r){vt(t,r);function t(){return r.call(this,"Mtcnn")||this}return t.prototype.load=function(e){return et(this,void 0,void 0,function(){return tt(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,r.prototype.load.call(this,e)]})})},t.prototype.loadFromDisk=function(e){return et(this,void 0,void 0,function(){return tt(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,r.prototype.loadFromDisk.call(this,e)]})})},t.prototype.forwardInput=function(e,n){return n===void 0&&(n={}),et(this,void 0,void 0,function(){var a,i,c,f,p,d,x,w,C,S,R,N,D,M,B,k,L,F,W,G,q;return tt(this,function(H){switch(H.label){case 0:if(a=this.params,!a)throw new Error("Mtcnn - load model before inference");if(i=e.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return c={},f=Date.now(),p=Xe(function(){return oD(ka(L1.fromPixels(i)).toFloat())}),d=function(Z){return p.dispose(),c.total=Date.now()-f,Z},x=p.shape.slice(1),w=x[0],C=x[1],S=new fw(n),R=S.minFaceSize,N=S.scaleFactor,D=S.maxNumScales,M=S.scoreThresholds,B=S.scaleSteps,k=(B||fD(R,N,[w,C])).filter(function(Z){var ie=Jp(Z,[w,C]);return Math.min(ie.width,ie.height)>Mh}).slice(0,D),c.scales=k,c.pyramid=k.map(function(Z){return Jp(Z,[w,C])}),L=Date.now(),[4,gD(p,k,M[0],a.pnet,c)];case 1:return F=H.sent(),c.total_stage1=Date.now()-L,F.boxes.length?(c.stage2_numInputBoxes=F.boxes.length,L=Date.now(),[4,mD(i,F.boxes,M[1],a.rnet,c)]):[2,d({results:[],stats:c})];case 2:return W=H.sent(),c.total_stage2=Date.now()-L,W.boxes.length?(c.stage3_numInputBoxes=W.boxes.length,L=Date.now(),[4,yD(i,W.boxes,M[2],a.onet,c)]):[2,d({results:[],stats:c})];case 3:return G=H.sent(),c.total_stage3=Date.now()-L,q=G.boxes.map(function(Z,ie){return Y1(U1({},new Mi(G.scores[ie],new P1(Z.left/C,Z.top/w,Z.width/C,Z.height/w),{height:w,width:C})),new ZR(G.points[ie].map(function(ee){return ee.sub(new Kt(Z.left,Z.top)).div(new Kt(Z.width,Z.height))}),{width:Z.width,height:Z.height}))}),[2,d({results:q,stats:c})]}})})},t.prototype.forward=function(e,n){return n===void 0&&(n={}),et(this,void 0,void 0,function(){var a;return tt(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,br(e)];case 1:return[4,a.apply(this,[i.sent(),n])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(e,n){return n===void 0&&(n={}),et(this,void 0,void 0,function(){var a;return tt(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,br(e)];case 1:return[2,a.apply(this,[i.sent(),n])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return cD(e)},t.prototype.extractParams=function(e){return uD(e)},t})(lo),wD=.4,ED=[new Kt(1.603231,2.094468),new Kt(6.041143,7.080126),new Kt(2.882459,3.518061),new Kt(4.266906,5.178857),new Kt(9.041765,10.66308)],CD=[117.001,114.697,97.404],AD=(function(r){vt(t,r);function t(){var e=this,n={withSeparableConvs:!0,iouThreshold:wD,classes:["face"],anchors:ED,meanRgb:CD,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return e=r.call(this,n)||this,e}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,n){return et(this,void 0,void 0,function(){var a;return tt(this,function(i){switch(i.label){case 0:return[4,this.detect(e,n)];case 1:return a=i.sent(),[2,a.map(function(c){return new Mi(c.score,c.relativeBox,{width:c.imageWidth,height:c.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(e){return r.prototype.extractParamsFromWeigthMap.call(this,e)},t})(dw),Aa={ssdMobilenetv1:new hw,tinyFaceDetector:new AD,tinyYolov2:new iD,mtcnn:new bD,faceLandmark68Net:new iw,faceLandmark68TinyNet:new _N,faceRecognitionNet:new ON,faceExpressionNet:new hN,ageGenderNet:new EN},mw=(function(r){vt(t,r);function t(e,n,a){var i=r.call(this)||this;return i.parentTask=e,i.input=n,i.extractedFaces=a,i}return t})(Nc),eg=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return et(this,void 0,void 0,function(){var e,n,a=this;return tt(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return e=i.sent(),[4,Zh(e,this.input,function(c){return et(a,void 0,void 0,function(){return tt(this,function(f){switch(f.label){case 0:return[4,Promise.all(c.map(function(p){return Aa.faceExpressionNet.predictExpressions(p)}))];case 1:return[2,f.sent()]}})})},this.extractedFaces)];case 2:return n=i.sent(),[2,e.map(function(c,f){return nw(c,n[f])})]}})})},t.prototype.withAgeAndGender=function(){return new ag(this,this.input)},t})(mw),tg=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return et(this,void 0,void 0,function(){var e,n;return tt(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,Q1(e,this.input,function(i){return Aa.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return n=a.sent(),[2,nw(e,n)]}})})},t.prototype.withAgeAndGender=function(){return new ig(this,this.input)},t})(mw),ng=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new og(this,this.input)},t.prototype.withFaceDescriptors=function(){return new ug(this,this.input)},t})(eg),rg=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new sg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new lg(this,this.input)},t})(tg),xw=(function(r){vt(t,r);function t(e,n,a){var i=r.call(this)||this;return i.parentTask=e,i.input=n,i.extractedFaces=a,i}return t})(Nc),ag=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return et(this,void 0,void 0,function(){var e,n,a=this;return tt(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return e=i.sent(),[4,Zh(e,this.input,function(c){return et(a,void 0,void 0,function(){return tt(this,function(f){switch(f.label){case 0:return[4,Promise.all(c.map(function(p){return Aa.ageGenderNet.predictAgeAndGender(p)}))];case 1:return[2,f.sent()]}})})},this.extractedFaces)];case 2:return n=i.sent(),[2,e.map(function(c,f){var p=n[f],d=p.age,x=p.gender,w=p.genderProbability;return lw(cw(c,x,w),d)})]}})})},t.prototype.withFaceExpressions=function(){return new eg(this,this.input)},t})(xw),ig=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return et(this,void 0,void 0,function(){var e,n,a,i,c;return tt(this,function(f){switch(f.label){case 0:return[4,this.parentTask];case 1:return e=f.sent(),e?[4,Q1(e,this.input,function(p){return Aa.ageGenderNet.predictAgeAndGender(p)},this.extractedFaces)]:[2];case 2:return n=f.sent(),a=n.age,i=n.gender,c=n.genderProbability,[2,lw(cw(e,i,c),a)]}})})},t.prototype.withFaceExpressions=function(){return new tg(this,this.input)},t})(xw),og=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new ng(this,this.input)},t.prototype.withFaceDescriptors=function(){return new ug(this,this.input)},t})(ag),sg=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new rg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new lg(this,this.input)},t})(ig),yw=(function(r){vt(t,r);function t(e,n){var a=r.call(this)||this;return a.parentTask=e,a.input=n,a}return t})(Nc),ug=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return et(this,void 0,void 0,function(){var e,n;return tt(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),[4,Zh(e,this.input,function(i){return Promise.all(i.map(function(c){return Aa.faceRecognitionNet.computeFaceDescriptor(c)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return n=a.sent(),[2,n.map(function(i,c){return uw(e[c],i)})]}})})},t.prototype.withFaceExpressions=function(){return new ng(this,this.input)},t.prototype.withAgeAndGender=function(){return new og(this,this.input)},t})(yw),lg=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return et(this,void 0,void 0,function(){var e,n;return tt(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,Q1(e,this.input,function(i){return Aa.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return n=a.sent(),[2,uw(e,n)]}})})},t.prototype.withFaceExpressions=function(){return new rg(this,this.input)},t.prototype.withAgeAndGender=function(){return new sg(this,this.input)},t})(yw),bw=(function(r){vt(t,r);function t(e,n,a){var i=r.call(this)||this;return i.parentTask=e,i.input=n,i.useTinyLandmarkNet=a,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Aa.faceLandmark68TinyNet:Aa.faceLandmark68Net},enumerable:!0,configurable:!0}),t})(Nc),SD=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return et(this,void 0,void 0,function(){var e,n,a,i,c,f=this;return tt(this,function(p){switch(p.label){case 0:return[4,this.parentTask];case 1:return e=p.sent(),n=e.map(function(d){return d.detection}),this.input instanceof _n?[4,W1(this.input,n)]:[3,3];case 2:return i=p.sent(),[3,5];case 3:return[4,V1(this.input,n)];case 4:i=p.sent(),p.label=5;case 5:return a=i,[4,Promise.all(a.map(function(d){return f.landmarkNet.detectLandmarks(d)}))];case 6:return c=p.sent(),a.forEach(function(d){return d instanceof _n&&d.dispose()}),[2,e.map(function(d,x){return Y1(d,c[x])})]}})})},t.prototype.withFaceExpressions=function(){return new ng(this,this.input)},t.prototype.withAgeAndGender=function(){return new og(this,this.input)},t.prototype.withFaceDescriptors=function(){return new ug(this,this.input)},t})(bw),_D=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return et(this,void 0,void 0,function(){var e,n,a,i,c;return tt(this,function(f){switch(f.label){case 0:return[4,this.parentTask];case 1:return e=f.sent(),e?(n=e.detection,this.input instanceof _n?[4,W1(this.input,[n])]:[3,3]):[2];case 2:return i=f.sent(),[3,5];case 3:return[4,V1(this.input,[n])];case 4:i=f.sent(),f.label=5;case 5:return a=i,[4,this.landmarkNet.detectLandmarks(a[0])];case 6:return c=f.sent(),a.forEach(function(p){return p instanceof _n&&p.dispose()}),[2,Y1(e,c)]}})})},t.prototype.withFaceExpressions=function(){return new rg(this,this.input)},t.prototype.withAgeAndGender=function(){return new sg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new lg(this,this.input)},t})(bw),ww=(function(r){vt(t,r);function t(e,n){n===void 0&&(n=new Kh);var a=r.call(this)||this;return a.input=e,a.options=n,a}return t})(Nc),TD=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return et(this,void 0,void 0,function(){var e,n,a,i;return tt(this,function(c){switch(c.label){case 0:return e=this,n=e.input,a=e.options,a instanceof fw?[4,Aa.mtcnn.forward(n,a)]:[3,2];case 1:return[2,c.sent().map(function(f){return f.detection})];case 2:if(i=a instanceof pw?function(f){return Aa.tinyFaceDetector.locateFaces(f,a)}:a instanceof Kh?function(f){return Aa.ssdMobilenetv1.locateFaces(f,a)}:a instanceof Z1?function(f){return Aa.tinyYolov2.locateFaces(f,a)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(n)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise(function(n){return et(e,void 0,void 0,function(){var a;return tt(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,n(a.map(function(c){return U1({},c)}))]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new SD(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new eg(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new ag(this.runAndExtendWithFaceDetections(),this.input)},t})(ww),ID=(function(r){vt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return et(this,void 0,void 0,function(){var e,n;return tt(this,function(a){switch(a.label){case 0:return[4,new TD(this.input,this.options)];case 1:return e=a.sent(),n=e[0],e.forEach(function(i){i.score>n.score&&(n=i)}),[2,n]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise(function(n){return et(e,void 0,void 0,function(){var a;return tt(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,n(a?U1({},a):void 0)]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new _D(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new tg(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new ig(this.runAndExtendWithFaceDetection(),this.input)},t})(ww);function RD(r,t){return t===void 0&&(t=new Kh),new ID(r,t)}function ND(r,t){if(r.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var e=Array.from(r),n=Array.from(t);return Math.sqrt(e.map(function(a,i){return a-n[i]}).reduce(function(a,i){return a+Math.pow(i,2)},0))}(function(){function r(t,e){e===void 0&&(e=.6),this._distanceThreshold=e;var n=Array.isArray(t)?t:[t];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var a=1,i=function(){return"person "+a++};this._labeledDescriptors=n.map(function(c){if(c instanceof $f)return c;if(c instanceof Float32Array)return new $f(i(),[c]);if(c.descriptor&&c.descriptor instanceof Float32Array)return new $f(i(),[c.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(r.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),r.prototype.computeMeanDistance=function(t,e){return e.map(function(n){return ND(n,t)}).reduce(function(n,a){return n+a},0)/(e.length||1)},r.prototype.matchDescriptor=function(t){var e=this;return this.labeledDescriptors.map(function(n){var a=n.descriptors,i=n.label;return new Rx(i,e.computeMeanDistance(t,a))}).reduce(function(n,a){return n.distance<a.distance?n:a})},r.prototype.findBestMatch=function(t){var e=this.matchDescriptor(t);return e.distance<this.distanceThreshold?e:new Rx("unknown",e.distance)},r.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},r.fromJSON=function(t){var e=t.labeledDescriptors.map(function(n){return $f.fromJSON(n)});return new r(e,t.distanceThreshold)},r})();const DD=({onVerify:r})=>{const t=De.useRef(null),[e,n]=De.useState(!1);De.useEffect(()=>{const i=async()=>{const f="/models";try{await Aa.tinyFaceDetector.loadFromUri(f)}catch(p){console.error("Model load failed:",p),alert("Biometric model failed to load. Please check your internet or model files.")}},c=()=>{navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}}).then(f=>{t.current.srcObject=f})};i().then(c)},[]);const a=async()=>{await RD(t.current,new pw)?(n(!0),r(!0)):alert("Face not detected ❌")};return Fn.jsxs("div",{className:"p-4 flex flex-col items-center justify-center min-h-screen bg-gray-50",children:[Fn.jsx("h2",{className:"text-xl font-bold mb-4",children:"Biometric Verification"}),Fn.jsx("video",{ref:t,autoPlay:!0,muted:!0,className:"w-64 h-48 rounded shadow"}),Fn.jsx("button",{onClick:a,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded",children:"Verify Face"}),e&&Fn.jsx("p",{className:"mt-4 text-green-600 font-semibold",children:"Verified ✅"})]})},MD=({sessionId:r})=>{const t=new Date().toLocaleString();return console.log(`Attendance marked for session ${r} at ${t}`),Fn.jsx("p",{className:"text-green-600 font-semibold",children:"Attendance marked ✅"})},OD=()=>{const r=window.location.hostname;return r.startsWith("192.168")||r.startsWith("10.")||r==="localhost"},BD=()=>{const[r,t]=De.useState(null),[e,n]=De.useState(!1);return r?e?Fn.jsx(MD,{sessionId:r}):Fn.jsx(DD,{onVerify:a=>n(a)}):Fn.jsx(sA,{onScan:a=>{OD()?t(a):alert("Not on same Wi-Fi network ❌")}})};function kD(){return Fn.jsx(c3,{basename:"/Photons-Prototype",children:Fn.jsxs(HC,{children:[Fn.jsx(Tp,{path:"/teacher",element:Fn.jsx(b3,{})}),Fn.jsx(Tp,{path:"/student",element:Fn.jsx(BD,{})})]})})}ZE.createRoot(document.getElementById("root")).render(Fn.jsx(De.StrictMode,{children:Fn.jsx(kD,{})}))});export default LD();
